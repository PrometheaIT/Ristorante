import{a as de}from"./chunk-NEWS4CPW.js";import{a as oe}from"./chunk-IA35PSVO.js";import{a as re}from"./chunk-5VB7O5BW.js";import{a as C}from"./chunk-AMYEPXIV.js";import"./chunk-SY2ZWW6D.js";import{Ab as se,Sa as ae,zb as le}from"./chunk-N3VPFYDE.js";import{B as ne,a as U,b as j,c as x,d as B,e as R,j as H,k as K,o as W,r as J,s as X,t as Y,u as Z,w as ee,x as te,z as ie}from"./chunk-45CSFDAZ.js";import"./chunk-TB7INTC7.js";import{e as Q}from"./chunk-Q3EITIAW.js";import"./chunk-RC3HHTXM.js";import{k as $,l as z,s as P,v as A}from"./chunk-MPTEMNWF.js";import{I as G,Ib as o,Jb as S,Kb as v,La as l,Lb as k,Va as N,Vb as O,Xb as M,Y as F,_a as g,ca as I,fb as q,gb as d,ib as b,kb as D,la as m,ma as _,qb as n,rb as i,sb as y,vb as w,yb as p,zb as u}from"./chunk-5BU4UD4M.js";import{a as E,b as T,g as h}from"./chunk-RA2WU32H.js";var L=class s extends C{constructor(){super(),this.loadData()}getTableName(){return"ingredient_groups"}loadData(){return h(this,null,function*(){try{this.loadingSubject.next(!0),console.log("\u{1F504} Caricamento gruppi ingredienti (globali)...");let{data:t,error:e}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).select(`
          *,
          ingredients:ingredients(count)
        `).eq("is_active",!0).order("sort_order").order("name");if(e)throw console.error("\u274C Errore query gruppi:",e),e;console.log(`\u2705 ${t?.length||0} gruppi caricati con successo`);let r=(t||[]).map(a=>T(E({},a),{ingredient_count:a.ingredients?.[0]?.count||0}));this.dataSubject.next(r)}catch(t){console.error("Error loading ingredient groups:",t),this.handleError("loadData",t)}finally{this.loadingSubject.next(!1)}})}getCurrentRestaurantId(){return h(this,null,function*(){return null})}getGroups(){return this.dataSubject.value}getGroupById(t){return this.dataSubject.value.find(e=>e.id===t)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=F({token:s,factory:s.\u0275fac,providedIn:"root"})};var V=class s extends C{constructor(){super(),this.loadData()}getTableName(){return"ingredient_types"}loadData(){return h(this,null,function*(){try{this.loadingSubject.next(!0);let{data:t,error:e}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).select(`
          *,
          group:ingredient_groups(*),
          ingredients:ingredients(count)
        `).eq("is_active",!0).order("name");if(e)throw e;let r=(t||[]).map(a=>T(E({},a),{ingredient_count:a.ingredients?.[0]?.count||0}));this.dataSubject.next(r)}catch(t){console.error("Error loading ingredient types:",t),this.handleError("loadData",t)}finally{this.loadingSubject.next(!1)}})}createType(t){return h(this,null,function*(){try{let r=(yield this.authService.currentUser$.pipe(G(1)).toPromise())?.id;if(!r)throw new Error("Utente non autenticato");let a=T(E({},t),{is_system:!1,created_by_user_id:r,restaurant_id:null}),{data:c,error:f}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).insert(a).select(`
        *,
        group:ingredient_groups(*)
      `).single();if(f)throw f;return yield this.loadData(),c}catch(e){return console.error("Error creating type:",e),null}})}updateType(t,e){return h(this,null,function*(){try{let{error:r}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).update(e).eq("id",t);if(r)throw r;return yield this.loadData(),!0}catch(r){return console.error("Error updating type:",r),!1}})}deleteType(t){return h(this,null,function*(){try{let{data:e,error:r}=yield this.supabaseService.getSupabaseClient().from("ingredients").select("id").eq("type_id",t).eq("is_active",!0).limit(1);if(r)throw r;if(e&&e.length>0)throw new Error("Non puoi eliminare una tipologia con ingredienti associati");let{error:a}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).update({is_active:!1}).eq("id",t);if(a)throw a;return yield this.loadData(),!0}catch(e){throw console.error("Error deleting type:",e),e}})}getTypes(){return this.dataSubject.value}getTypeById(t){return this.dataSubject.value.find(e=>e.id===t)}getTypesByGroup(t){return this.dataSubject.value.filter(e=>e.group_id===t)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=F({token:s,factory:s.\u0275fac,providedIn:"root"})};function ue(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),v(" ",e.name," ")}}function me(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),v(" ",e.name," ")}}function _e(s,t){if(s&1&&(n(0,"span",44),o(1),i()),s&2){let e=u();l(),v(" (",e.getShoppingList().length,") ")}}function ge(s,t){s&1&&(n(0,"tr")(1,"td",45)(2,"div",46)(3,"span",47),o(4,"refresh"),i(),n(5,"span"),o(6,"Caricamento ingredienti..."),i()()()())}function ye(s,t){if(s&1&&(n(0,"span",44),o(1),i()),s&2){let e=u().$implicit,r=u();l(),v(" (+",r.formatQuantity(e.to_buy_quantity,e),") ")}}function ve(s,t){if(s&1){let e=w();n(0,"tr",48)(1,"td")(2,"strong"),o(3),i()(),n(4,"td",39)(5,"span",49),o(6),i()(),n(7,"td")(8,"span"),o(9),g(10,ye,2,1,"span",30),i()(),n(11,"td")(12,"span",49),o(13),i()(),n(14,"td")(15,"strong"),o(16),O(17,"number"),i()(),n(18,"td")(19,"span",50),o(20),i()(),n(21,"td")(22,"div",51)(23,"button",52),p("click",function(){let a=m(e).$implicit,c=u();return _(a.to_buy?c.removeFromShoppingList(a):c.addToShoppingList(a))}),n(24,"span",17),o(25),i()(),n(26,"button",53),p("click",function(){let a=m(e).$implicit,c=u();return _(c.editIngredient(a))}),n(27,"span",17),o(28,"edit"),i()(),n(29,"button",54),p("click",function(){let a=m(e).$implicit,c=u();return _(c.deleteIngredient(a.id))}),y(30,"lucide-angular",55),i()()()()}if(s&2){let e=t.$implicit,r=u();b("bg-green-50",e.to_buy),l(3),S(e.name),l(3),S(e.description||"Nessuna descrizione"),l(2),b("text-red-500",e.current_stock<=e.minimum_stock),l(),k(" ",e.current_stock," ",r.getUnitSymbol(e.unit_id)," "),l(),d("ngIf",e.to_buy&&e.to_buy_quantity),l(3),S(r.getSupplierName(e)),l(3),v("\u20AC",M(17,19,e.cost_per_unit,"1.2-2"),""),l(3),D(r.getStockStatus(e).class),l(),v(" ",r.getStockStatus(e).text," "),l(3),b("text-green-500",e.to_buy),d("title",e.to_buy?"Rimuovi dalla lista spesa":"Aggiungi alla lista spesa"),l(2),v(" ",e.to_buy?"shopping_cart_checkout":"add_shopping_cart"," "),l(5),d("size",20)}}function he(s,t){s&1&&(n(0,"p",59),o(1," Prova a modificare i filtri di ricerca "),i())}function fe(s,t){if(s&1){let e=w();n(0,"tr")(1,"td",56)(2,"div",57)(3,"span",17),o(4,"search_off"),i(),n(5,"h3"),o(6,"Nessun ingrediente trovato"),i(),g(7,he,2,0,"p",58),n(8,"button",32),p("click",function(){m(e);let a=u();return _(a.newIngredient())}),y(9,"lucide-angular",33),o(10," Aggiungi il primo ingrediente "),i()()()()}if(s&2){let e=u();l(7),d("ngIf",e.searchTerm||e.showLowStockOnly),l(2),d("size",20)}}function xe(s,t){s&1&&(n(0,"div",101),o(1," Il nome \xE8 obbligatorio e deve essere di almeno 2 caratteri "),i())}function Se(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function be(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function Ie(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function Ee(s,t){s&1&&(n(0,"div",101),o(1," Il costo per unit\xE0 \xE8 obbligatorio "),i())}function Te(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),v(" ",e.name," ")}}function we(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),v(" ",e.name," ")}}function ke(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),v(" ",e.company_name," ")}}function Fe(s,t){if(s&1){let e=w();n(0,"div",60),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(1,"div",61),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",62)(3,"div",63)(4,"div",64)(5,"span",17),o(6),i()(),n(7,"div")(8,"h1",65),o(9),i()()(),n(10,"button",66),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(11,"span",17),o(12,"close"),i()()(),n(13,"form",67),p("ngSubmit",function(){m(e);let a=u();return _(a.onSubmit())}),n(14,"div",68)(15,"label",69)(16,"span",17),o(17,"label"),i(),o(18," Nome Ingrediente * "),i(),y(19,"input",70),g(20,xe,2,0,"div",71),i(),n(21,"div",25)(22,"div",68)(23,"label",72)(24,"span",17),o(25,"straighten"),i(),o(26," Unit\xE0 di Misura "),i(),n(27,"select",73)(28,"option",23),o(29,"Seleziona unit\xE0"),i(),n(30,"optgroup",74),g(31,Se,2,3,"option",24),i(),n(32,"optgroup",75),g(33,be,2,3,"option",24),i(),n(34,"optgroup",76),g(35,Ie,2,3,"option",24),i()()(),n(36,"div",68)(37,"label",77)(38,"span",17),o(39,"euro"),i(),o(40," Costo per Unit\xE0 * "),i(),y(41,"input",78),g(42,Ee,2,0,"div",71),i()(),n(43,"div",79)(44,"label",80)(45,"span",17),o(46,"description"),i(),o(47," Descrizione "),i(),y(48,"textarea",81),i(),n(49,"div",25)(50,"div",68)(51,"label",82)(52,"span",17),o(53,"inventory"),i(),o(54," Scorta attuale "),i(),y(55,"input",83),i(),n(56,"div",68)(57,"label",77)(58,"span",17),o(59,"warning"),i(),o(60," Scorta Minima "),i(),y(61,"input",84),i()(),n(62,"div",25)(63,"div",68)(64,"label",85)(65,"span",17),o(66,"category"),i(),o(67," Gruppo "),i(),n(68,"select",86),p("change",function(){m(e);let a=u();return _(a.onGroupChangeInForm())}),n(69,"option",23),o(70,"Nessun gruppo"),i(),g(71,Te,2,2,"option",24),i()(),n(72,"div",68)(73,"label",87)(74,"span",17),o(75,"label"),i(),o(76," Tipologia "),i(),n(77,"div",88)(78,"select",89)(79,"option",23),o(80,"Nessuna tipologia"),i(),g(81,we,2,2,"option",24),i(),n(82,"button",90),p("click",function(){m(e);let a=u();return _(a.openTypeModal())}),y(83,"lucide-angular",33),i()(),n(84,"div",91),o(85," Le tipologie dipendono dal gruppo selezionato "),i()()(),n(86,"div",68)(87,"label",92),y(88,"lucide-angular",93),o(89," Fornitore "),i(),n(90,"div",88)(91,"select",94)(92,"option",23),o(93,"Nessun fornitore"),i(),g(94,ke,2,2,"option",24),i(),n(95,"div",51)(96,"button",95),p("click",function(){m(e);let a=u();return _(a.goToSupplierManager())}),y(97,"lucide-angular",33),i()()()(),n(98,"div",25)(99,"div",68)(100,"label",96)(101,"span",17),o(102,"event"),i(),o(103," Data di Scadenza "),i(),y(104,"input",97),i(),n(105,"div",68)(106,"label",27),y(107,"input",98),n(108,"div",29)(109,"strong"),o(110,"Attiva avvisi scorta bassa"),i(),n(111,"div",49),o(112,"Ricevi un avviso quando la scorta scende sotto il livello minimo"),i()()()()()(),n(113,"div",31)(114,"button",99),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(115,"span",17),o(116,"close"),i(),o(117," Annulla "),i(),n(118,"button",100),p("click",function(){m(e);let a=u();return _(a.onSubmit())}),n(119,"span",17),o(120),i(),o(121),i()()()()}if(s&2){let e=u();l(6),S(e.isEditing?"edit":"add_circle"),l(3),S(e.isEditing?"Modifica Ingrediente":"Nuovo Ingrediente"),l(4),d("formGroup",e.ingredientForm),l(6),b("border-red-500",(e.name==null?null:e.name.invalid)&&(e.name==null?null:e.name.touched)),l(),d("ngIf",(e.name==null?null:e.name.invalid)&&(e.name==null?null:e.name.touched)),l(11),d("ngForOf",e.getUnitsByType("weight")),l(2),d("ngForOf",e.getUnitsByType("volume")),l(2),d("ngForOf",e.getUnitsByType("piece")),l(6),b("border-red-500",(e.cost_per_unit==null?null:e.cost_per_unit.invalid)&&(e.cost_per_unit==null?null:e.cost_per_unit.touched)),l(),d("ngIf",(e.cost_per_unit==null?null:e.cost_per_unit.invalid)&&(e.cost_per_unit==null?null:e.cost_per_unit.touched)),l(13),b("border-red-500",(e.current_stock==null?null:e.current_stock.invalid)&&(e.current_stock==null?null:e.current_stock.touched)),l(6),b("border-red-500",(e.minimum_stock==null?null:e.minimum_stock.invalid)&&(e.minimum_stock==null?null:e.minimum_stock.touched)),l(10),d("ngForOf",e.sortedIngredientGroups),l(7),d("disabled",!e.getFilteredTypesForForm().length),l(3),d("ngForOf",e.getFilteredTypesForForm()),l(2),d("size",20),l(5),d("size",20),l(6),d("ngForOf",e.suppliers),l(3),d("size",20),l(21),d("disabled",e.ingredientForm.invalid),l(2),S(e.isEditing?"save":"add"),l(),v(" ",e.isEditing?"Aggiorna":"Crea"," Ingrediente ")}}function Ce(s,t){s&1&&(n(0,"div",57)(1,"span",17),o(2,"shopping_basket"),i(),n(3,"h3"),o(4,"Nessun ingrediente nella lista"),i(),n(5,"p",49),o(6,"Clicca sull'icona del carrello per aggiungere ingredienti"),i()())}function Le(s,t){if(s&1){let e=w();n(0,"tr")(1,"td")(2,"strong"),o(3),i()(),n(4,"td")(5,"div",113)(6,"button",114),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.decreaseQuantity(a))}),n(7,"span",17),o(8,"remove"),i()(),n(9,"div",115)(10,"input",116),p("change",function(a){let c=m(e).$implicit,f=u(3);return _(f.updateShoppingListQuantity(c,a))}),i()(),n(11,"button",114),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.increaseQuantity(a))}),y(12,"lucide-angular",33),i()()(),n(13,"td")(14,"span",117),o(15),i()(),n(16,"td"),o(17),i(),n(18,"td"),o(19),i(),n(20,"td")(21,"button",118),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.removeFromShoppingList(a))}),n(22,"span",17),o(23,"remove_shopping_cart"),i()()()()}if(s&2){let e=t.$implicit,r=u(3);l(3),S(e.name),l(3),d("title","Diminuisci di "+r.getQuantityStep(e)),l(4),d("step",r.getQuantityStep(e))("min",r.allowsDecimals(e)?.1:1)("value",e.to_buy_quantity||r.getStandardQuantity(e)),q("inputmode",r.allowsDecimals(e)?"decimal":"numeric"),l(),d("title","Aumenta di "+r.getQuantityStep(e)),l(),d("size",20),l(3),S(r.getUnitSymbol(e.unit_id)),l(2),S(r.getSupplierName(e)),l(2),v("\u20AC",(e.cost_per_unit*(e.to_buy_quantity||1)).toFixed(2),"")}}function Ve(s,t){if(s&1&&(n(0,"div")(1,"div",107)(2,"table",38)(3,"thead")(4,"tr")(5,"th"),o(6,"Ingrediente"),i(),n(7,"th"),o(8,"Quantit\xE0"),i(),n(9,"th"),o(10,"Unit\xE0"),i(),n(11,"th"),o(12,"Fornitore"),i(),n(13,"th"),o(14,"Costo"),i(),n(15,"th"),o(16,"Azioni"),i()()(),n(17,"tbody"),g(18,Le,24,11,"tr",108),i()()(),n(19,"div",109)(20,"div",110)(21,"div")(22,"h3",111),o(23,"Totale stimato"),i()(),n(24,"div",112),o(25),i()()()()),s&2){let e=u(2);l(18),d("ngForOf",e.getShoppingList()),l(7),v(" \u20AC",e.shoppingListTotal.toFixed(2)," ")}}function Ge(s,t){if(s&1){let e=w();n(0,"div",60),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(1,"div",61),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",62)(3,"div",63)(4,"div",64)(5,"span",17),o(6,"shopping_cart"),i()(),n(7,"div")(8,"h1",65),o(9,"Lista della Spesa"),i(),n(10,"p",49),o(11),i()()(),n(12,"button",66),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(13,"span",17),o(14,"close"),i()()(),n(15,"div",102)(16,"div",103),g(17,Ce,7,0,"div",104)(18,Ve,26,2,"div",40),i()(),n(19,"div",31)(20,"button",34),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(21,"span",17),o(22,"close"),i(),o(23," Chiudi "),i(),n(24,"button",105),p("click",function(){m(e);let a=u();return _(a.printShoppingList())}),n(25,"span",17),o(26,"print"),i(),o(27," Stampa Lista "),i(),n(28,"button",106),p("click",function(){m(e);let a=u();return _(a.clearShoppingList())}),n(29,"span",17),o(30,"check_circle"),i(),o(31," Acquisto Completato "),i()()()()}if(s&2){let e=u();l(11),v("",e.getShoppingList().length," ingredienti da acquistare"),l(6),d("ngIf",e.getShoppingList().length===0),l(),d("ngIf",e.getShoppingList().length>0),l(6),d("disabled",e.getShoppingList().length===0),l(4),d("disabled",e.getShoppingList().length===0)}}function Ne(s,t){if(s&1&&(n(0,"option",43),o(1),i()),s&2){let e=t.$implicit,r=t.index;d("value",e.id),l(),k(" ",e.name," (",r,") ")}}function qe(s,t){s&1&&(n(0,"div",101),o(1," Seleziona un gruppo "),i())}function De(s,t){s&1&&(n(0,"div",101),o(1," Il nome \xE8 obbligatorio (min. 2 caratteri) "),i())}function Oe(s,t){s&1&&(n(0,"div",128)(1,"div",51)(2,"span",129),o(3,"info"),i(),n(4,"div",130),o(5," Questa tipologia sar\xE0 visibile a "),n(6,"strong"),o(7,"tutti i ristoranti"),i(),o(8,". "),i()()())}function Me(s,t){if(s&1){let e=w();n(0,"div",60),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(1,"div",119),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",62)(3,"div",63)(4,"div",64)(5,"span",17),o(6,"add_circle"),i()(),n(7,"div")(8,"h1",65),o(9,"Nuova Tipologia"),i(),n(10,"p",49),o(11,"Crea una nuova tipologia di ingrediente"),i()()(),n(12,"button",66),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(13,"span",17),o(14,"close"),i()()(),n(15,"div",103)(16,"form",120),p("ngSubmit",function(){m(e);let a=u();return _(a.saveType())}),n(17,"div",14)(18,"label",121)(19,"span",17),o(20,"category"),i(),o(21," Gruppo * "),i(),n(22,"select",86),p("change",function(){m(e);let a=u();return _(a.onGroupChangeInForm())}),n(23,"option",23),o(24,"Nessun gruppo"),i(),g(25,Ne,2,3,"option",24),i(),g(26,qe,2,0,"div",71),i(),n(27,"div",14)(28,"label",122)(29,"span",17),o(30,"label"),i(),o(31," Nome Tipologia * "),i(),y(32,"input",123),g(33,De,2,0,"div",71),i(),n(34,"div",14)(35,"label",124)(36,"span",17),o(37,"description"),i(),o(38," Descrizione (opzionale) "),i(),y(39,"textarea",125),i(),g(40,Oe,9,0,"div",126),i()(),n(41,"div",31)(42,"button",99),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(43,"span",17),o(44,"close"),i(),o(45," Annulla "),i(),n(46,"button",127),p("click",function(){m(e);let a=u();return _(a.saveType())}),y(47,"lucide-angular",33),o(48," Crea Tipologia "),i()()()()}if(s&2){let e,r,a,c=u();l(16),d("formGroup",c.typeForm),l(9),d("ngForOf",c.sortedIngredientGroups),l(),d("ngIf",((e=c.typeForm.get("group_id"))==null?null:e.invalid)&&((e=c.typeForm.get("group_id"))==null?null:e.touched)),l(7),d("ngIf",((r=c.typeForm.get("name"))==null?null:r.invalid)&&((r=c.typeForm.get("name"))==null?null:r.touched)),l(7),d("ngIf",(a=c.typeForm.get("group_id"))==null?null:a.value),l(6),d("disabled",c.typeForm.invalid),l(),d("size",20)}}var pe=class s{ingredientService=I(re);unitService=I(oe);supplierService=I(de);ingredientGroupService=I(L);ingredientTypeService=I(V);fb=I(ie);router=I(Q);SearchIcon=ae;ingredients=[];units=[];suppliers=[];ingredientGroups=[];ingredientTypes=[];filteredIngredients=[];showTypeModal=!1;typeForm;previousGroupId=null;filteredTypesForForm=[];showIngredientForm=!1;isEditing=!1;currentIngredientId=null;searchTerm="";ingredientForm;isLoading=!0;showLowStockOnly=!1;showShoppingListOnly=!1;sortBy="name";selectedGroupId=null;selectedTypeId=null;showShoppingList=!1;shoppingListTotal=0;get lowStockCount(){return this.ingredientService.getLowStockIngredients().length}get shoppingListCount(){return this.getShoppingList().length}constructor(){this.ingredientForm=this.fb.group({name:["",[x.required,x.minLength(2)]],description:[""],unit_id:[""],current_stock:[0,[x.required,x.min(0)]],minimum_stock:[0,[x.required,x.min(0)]],cost_per_unit:[0,[x.required,x.min(0)]],alert_enabled:[!0],expiry_date:[null],supplier_id:[null],to_buy:[!1],to_buy_quantity:[null],group_id:[null],type_id:[null]}),this.typeForm=this.fb.group({group_id:["",x.required],name:["",[x.required,x.minLength(2)]],description:[""]})}ngOnInit(){return h(this,null,function*(){this.loadData()})}loadData(){return h(this,null,function*(){this.isLoading=!0,console.log("\u{1F504} Inizio caricamento dati..."),this.setupSubscriptions();try{yield this.loadAllServices(),console.log("\u2705 Dati caricati con successo")}catch(t){console.error("\u274C Errore nel caricamento dati:",t),this.loadFallbackData()}finally{this.isLoading=!1}})}setupSubscriptions(){this.unitService.units$.subscribe(t=>{console.log("\u{1F4CF} Unit\xE0 caricate:",t.length),this.units=t}),this.supplierService.suppliers$.subscribe(t=>{console.log("\u{1F3ED} Fornitori caricati:",t.length),this.suppliers=t}),this.ingredientGroupService.data$.subscribe(t=>{console.log("\u{1F4C2} Gruppi caricati:",t.length),this.ingredientGroups=t}),this.ingredientTypeService.data$.subscribe(t=>{console.log("\u{1F3F7}\uFE0F Tipologie caricate:",t.length),this.ingredientTypes=t}),this.ingredientService.data$.subscribe(t=>{console.log("\u{1F969} Ingredienti caricati:",t.length),this.ingredients=t,this.applyFilters(),this.calculateShoppingListTotal()})}loadAllServices(){return h(this,null,function*(){let t=[this.ingredientService.loadIngredients(),this.supplierService.loadSuppliers(),this.ingredientTypeService.loadData(),this.ingredientGroupService.loadData()];yield Promise.all(t)})}loadFallbackData(){console.log("\u{1F4CB} Caricamento dati di fallback..."),this.ingredientGroups=[{id:"1",name:"Pesce",color:"#3B82F6",sort_order:1,is_active:!0,is_system:!0},{id:"2",name:"Carni Rosse",color:"#DC2626",sort_order:2,is_active:!0,is_system:!0},{id:"3",name:"Carni Bianche",color:"#F87171",sort_order:3,is_active:!0,is_system:!0},{id:"4",name:"Verdura",color:"#10B981",sort_order:4,is_active:!0,is_system:!0},{id:"5",name:"Frutta",color:"#34D399",sort_order:5,is_active:!0,is_system:!0},{id:"6",name:"Formaggi",color:"#F59E0B",sort_order:6,is_active:!0,is_system:!0},{id:"7",name:"Latticini",color:"#FCD34D",sort_order:7,is_active:!0,is_system:!0},{id:"8",name:"Pasta",color:"#D97706",sort_order:8,is_active:!0,is_system:!0},{id:"9",name:"Oli e Grassi",color:"#A3E635",sort_order:9,is_active:!0,is_system:!0},{id:"10",name:"Spezie",color:"#65A30D",sort_order:10,is_active:!0,is_system:!0}],this.ingredientTypes=[],console.log(`\u2705 ${this.ingredientGroups.length} gruppi di fallback caricati`)}applyFilters(){let t=this.ingredients;this.searchTerm&&(t=this.ingredientService.searchIngredients(this.searchTerm)),this.selectedGroupId&&(t=t.filter(e=>e.group_id===this.selectedGroupId)),this.selectedTypeId&&(t=t.filter(e=>e.type_id===this.selectedTypeId)),this.showLowStockOnly&&(t=t.filter(e=>e.alert_enabled&&e.current_stock<=e.minimum_stock)),this.showShoppingListOnly&&(t=t.filter(e=>e.to_buy)),t=[...t].sort((e,r)=>{switch(this.sortBy){case"name":return e.name.localeCompare(r.name);case"stock":return e.current_stock-r.current_stock;case"cost":return e.cost_per_unit-r.cost_per_unit;default:return 0}}),this.filteredIngredients=t}onGroupFilterChange(t){this.selectedGroupId=t||null,this.selectedTypeId=null,this.applyFilters()}onTypeFilterChange(t){this.selectedTypeId=t||null,this.applyFilters()}clearAllFilters(){this.searchTerm="",this.selectedGroupId=null,this.selectedTypeId=null,this.showLowStockOnly=!1,this.showShoppingListOnly=!1,this.applyFilters()}getGroupName(t){if(!t)return"Senza gruppo";let e=this.ingredientGroups.find(r=>r.id===t);return e?e.name:"Sconosciuto"}getTypeName(t){if(!t)return"Senza tipologia";let e=this.ingredientTypes.find(r=>r.id===t);return e?e.name:"Sconosciuto"}getGroupColor(t){if(!t)return"#9CA3AF";let e=this.ingredientGroups.find(r=>r.id===t);return e?e.color:"#808080"}editIngredient(t){this.isEditing=!0,this.currentIngredientId=t.id;let e={name:t.name,description:t.description||"",unit_id:t.unit_id||"",current_stock:t.current_stock,minimum_stock:t.minimum_stock,cost_per_unit:t.cost_per_unit,alert_enabled:t.alert_enabled,expiry_date:t.expiry_date||"",supplier_id:t.supplier_id||null,to_buy:t.to_buy||!1,to_buy_quantity:t.to_buy_quantity||null,group_id:t.group_id||null,type_id:t.type_id||null};this.ingredientForm.patchValue(e),this.showIngredientForm=!0}onSearchChange(t){this.searchTerm=t,this.applyFilters()}toggleLowStockFilter(){this.showLowStockOnly=!this.showLowStockOnly,this.applyFilters()}toggleShoppingListFilter(){this.showShoppingListOnly=!this.showShoppingListOnly,this.applyFilters()}onSortChange(t){this.sortBy=t,this.applyFilters()}addToShoppingList(t){let e,r=Math.max(t.minimum_stock-t.current_stock,0);r>0?e=r:e=this.getStandardQuantity(t);let a=this.ingredients.findIndex(f=>f.id===t.id);a!==-1&&(this.ingredients[a].to_buy=!0,this.ingredients[a].to_buy_quantity=e,this.calculateShoppingListTotal(),this.applyFilters());let c={to_buy:!0,to_buy_quantity:e};this.ingredientService.updateIngredient(t.id,c).then(f=>{f||(console.error("Errore nell'aggiornamento del database"),a!==-1&&(this.ingredients[a].to_buy=!1,this.ingredients[a].to_buy_quantity=null,this.calculateShoppingListTotal(),this.applyFilters()))})}getStandardQuantity(t){switch(this.getUnitSymbol(t.unit_id)){case"kg":return 1;case"L":return 1;case"g":return 1e3;case"mL":return 1e3;case"pz":return 1;default:return 1}}updateShoppingListQuantity(t,e){let r=e.target,a=parseFloat(r.value);isNaN(a)&&(a=this.getStandardQuantity(t));let c=this.allowsDecimals(t)?.1:1;a=Math.max(a,c),this.allowsDecimals(t)||(a=Math.ceil(a)),this.updateIngredientQuantity(t,a)}increaseQuantity(t){let e=t.to_buy_quantity||this.getStandardQuantity(t),r=this.getQuantityStep(t),a=e+r;this.updateIngredientQuantity(t,a)}decreaseQuantity(t){let e=t.to_buy_quantity||this.getStandardQuantity(t),r=this.getQuantityStep(t),a=this.allowsDecimals(t)?.1:1,c=Math.max(e-r,a);this.updateIngredientQuantity(t,c)}updateIngredientQuantity(t,e){let r=this.ingredients.findIndex(c=>c.id===t.id);r!==-1&&(this.ingredients[r].to_buy_quantity=e,this.calculateShoppingListTotal(),this.applyFilters());let a={to_buy_quantity:e};this.ingredientService.updateIngredient(t.id,a).then(c=>{c||console.error("Errore nell'aggiornamento del database")})}getQuantityStep(t){if(!t.unit_id)return 1;let e=this.units.find(r=>r.id===t.unit_id);if(!e)return 1;if(e.type==="weight"){if(e.symbol==="kg")return 1;if(e.symbol==="g")return 1e3}if(e.type==="volume"){if(e.symbol==="L")return 1;if(e.symbol==="mL")return 1e3}return 1}allowsDecimals(t){if(!t.unit_id)return!1;let e=this.units.find(r=>r.id===t.unit_id);return e?e.type==="weight"||e.type==="volume":!1}removeFromShoppingList(t){let e=this.ingredients.findIndex(a=>a.id===t.id);e!==-1&&(this.ingredients[e].to_buy=!1,this.ingredients[e].to_buy_quantity=null,this.calculateShoppingListTotal(),this.applyFilters());let r={to_buy:!1,to_buy_quantity:null};this.ingredientService.updateIngredient(t.id,r).then(a=>{a||(console.error("Errore nell'aggiornamento del database"),e!==-1&&(this.ingredients[e].to_buy=!0,this.ingredients[e].to_buy_quantity=t.to_buy_quantity,this.calculateShoppingListTotal(),this.applyFilters()))})}calculateShoppingListTotal(){let t=this.getShoppingList();this.shoppingListTotal=t.reduce((e,r)=>{let a=r.to_buy_quantity||1;return e+r.cost_per_unit*a},0)}getShoppingList(){return this.ingredients.filter(t=>t.to_buy)}clearShoppingList(){return h(this,null,function*(){if(confirm("Vuoi azzerare la lista della spesa? Le scorte verranno aggiornate con le quantit\xE0 acquistate.")){let t=this.getShoppingList();for(let e of t){let a={to_buy:!1,to_buy_quantity:null,current_stock:e.current_stock+(e.to_buy_quantity||0)};yield this.ingredientService.updateIngredient(e.id,a)}console.log("Lista della spesa azzerata e scorte aggiornate"),this.loadData(),this.showShoppingList=!1}})}printShoppingList(){let t=this.getShoppingList();if(t.length===0){alert("La lista della spesa \xE8 vuota!");return}let e=t.map(c=>`- ${c.name}: ${c.to_buy_quantity||1} ${this.getUnitSymbol(c.unit_id)}`).join(`
`),r=`

Totale stimato: \u20AC${this.shoppingListTotal.toFixed(2)}`,a=`LISTA DELLA SPESA

${e}${r}`;if(confirm(a+`

Vuoi stampare la lista?`)){let c=window.open("","_blank");c&&(c.document.write(`
          <html>
            <head>
              <title>Lista della Spesa</title>
              <style>
                body { font-family: Arial, sans-serif; padding: 20px; }
                h1 { color: #333; }
                ul { list-style-type: none; padding: 0; }
                li { padding: 5px 0; border-bottom: 1px solid #eee; }
                .total { font-size: 18px; font-weight: bold; margin-top: 20px; }
              </style>
            </head>
            <body>
              <h1>Lista della Spesa</h1>
              <ul>
                ${t.map(f=>`<li>${f.name}: ${f.to_buy_quantity||1} ${this.getUnitSymbol(f.unit_id)} - \u20AC${(f.cost_per_unit*(f.to_buy_quantity||1)).toFixed(2)}</li>`).join("")}
              </ul>
              <div class="total">
                Totale: \u20AC${this.shoppingListTotal.toFixed(2)}
              </div>
              <p style="margin-top: 30px; color: #666; font-size: 12px;">
                Data: ${new Date().toLocaleDateString("it-IT")}
              </p>
            </body>
          </html>
        `),c.document.close(),c.print())}}onSubmit(){return h(this,null,function*(){if(this.ingredientForm.invalid){this.markFormGroupTouched();return}let t=this.ingredientForm.value,e=T(E({},t),{expiry_date:t.expiry_date===""?null:t.expiry_date,supplier_id:t.supplier_id===""?null:t.supplier_id,to_buy_quantity:t.to_buy_quantity===""?null:t.to_buy_quantity,group_id:t.group_id===""?null:t.group_id,type_id:t.type_id===""?null:t.type_id});try{this.isEditing&&this.currentIngredientId?(yield this.ingredientService.updateIngredient(this.currentIngredientId,e))&&(console.log("Ingrediente aggiornato con successo"),this.resetForm()):(yield this.ingredientService.createIngredient(e))&&(console.log("Ingrediente creato con successo"),this.resetForm())}catch(r){console.error("Errore durante il salvataggio:",r)}})}deleteIngredient(t){return h(this,null,function*(){confirm("Sei sicuro di voler eliminare questo ingrediente?")&&(yield this.ingredientService.deleteIngredient(t))&&console.log("Ingrediente eliminato")})}newIngredient(){this.resetForm(),this.showIngredientForm=!0,this.isEditing=!1}resetForm(){this.ingredientForm.reset({name:"",description:"",unit_id:"",current_stock:0,minimum_stock:0,cost_per_unit:0,alert_enabled:!0,expiry_date:"",supplier_id:null,to_buy:!1,to_buy_quantity:null,group_id:null,type_id:null}),this.isEditing=!1,this.currentIngredientId=null,this.showIngredientForm=!1}goToSupplierManager(){this.router.navigate(["/restaurant/suppliers"])}getUnitSymbol(t){if(!t)return"";let e=this.units.find(r=>r.id===t);return e?e.symbol:""}shouldAlert(t){return t.alert_enabled&&t.current_stock<=t.minimum_stock}getStockStatus(t){return this.shouldAlert(t)?{class:"inactive",text:"Scorta Bassa"}:t.current_stock<=t.minimum_stock*1.5?{class:"warning",text:"Scorta Media"}:{class:"active",text:"Scorta OK"}}getSupplierName(t){if(!t.supplier_id)return"Nessun fornitore";if(t.suppliers)return t.suppliers.company_name;let e=this.suppliers.find(r=>r.id===t.supplier_id);return e?e.company_name:"Fornitore sconosciuto"}markFormGroupTouched(){Object.keys(this.ingredientForm.controls).forEach(t=>{this.ingredientForm.get(t)?.markAsTouched()})}get name(){return this.ingredientForm.get("name")}get current_stock(){return this.ingredientForm.get("current_stock")}get minimum_stock(){return this.ingredientForm.get("minimum_stock")}get cost_per_unit(){return this.ingredientForm.get("cost_per_unit")}getUnitsByType(t){return this.unitService.getUnitsByType(t)}formatQuantity(t,e){return t?this.allowsDecimals(e)?t.toFixed(3).replace(/\.?0+$/,""):Math.round(t).toString():"0"}get group_id(){return this.ingredientForm.get("group_id")}get type_id(){return this.ingredientForm.get("type_id")}goToIngredientGroups(){this.router.navigate(["/ingredients/groups"])}goToIngredientTypes(){this.router.navigate(["/ingredients/types"])}openTypeModal(){this.showTypeModal=!0}closeTypeModal(){this.showTypeModal=!1,this.typeForm.reset()}getSelectedGroupName(){let t=this.typeForm.get("group_id")?.value;if(!t)return"";let e=this.ingredientGroups.find(r=>r.id===t);return e?e.name:""}saveType(){return h(this,null,function*(){if(this.typeForm.invalid){this.markTypeFormTouched();return}try{let t=this.typeForm.value;(yield this.ingredientTypeService.createType(t))&&(console.log("Tipologia creata con successo"),alert("Tipologia creata con successo! Sar\xE0 visibile a tutti i ristoranti."),this.closeTypeModal(),yield this.ingredientTypeService.loadData())}catch(t){console.error("Errore durante la creazione della tipologia:",t),alert(`Errore: ${t.message||"Impossibile creare la tipologia"}`)}})}markTypeFormTouched(){Object.keys(this.typeForm.controls).forEach(t=>{this.typeForm.get(t)?.markAsTouched()})}onGroupChangeInForm(){let t=this.ingredientForm.get("group_id")?.value;t!==this.previousGroupId&&(this.ingredientForm.get("type_id")?.setValue(""),this.previousGroupId=t),this.filteredTypesForForm=this.getFilteredTypesForForm()}openNewTypeModalFromForm(){let t=this.ingredientForm.get("group_id")?.value;t&&this.typeForm.patchValue({group_id:t}),this.showTypeModal=!0}loadGroupsDirectly(){return h(this,null,function*(){try{console.log("\u{1F504} Tentativo caricamento diretto gruppi...");let{data:t,error:e}=yield this.ingredientGroupService.getSupabaseClientPublic().from("ingredient_groups").select("*").eq("is_active",!0).order("sort_order").order("name");if(e){console.error("\u274C Errore caricamento diretto gruppi:",e);return}console.log(`\u2705 ${t?.length||0} gruppi caricati direttamente`),this.ingredientGroups=t||[]}catch(t){console.error("\u{1F4A5} Errore in loadGroupsDirectly:",t)}})}createComposedIngredient(){this.router.navigate(["/food-cost"],{queryParams:{mode:"ingredient",fromInventory:!0}})}get sortedIngredientGroups(){return!this.ingredientGroups||!Array.isArray(this.ingredientGroups)?[]:[...this.ingredientGroups].filter(t=>t.is_active!==!1).sort((t,e)=>t.name.toLowerCase().localeCompare(e.name.toLowerCase()))}get sortedIngredientTypes(){return!this.ingredientTypes||!Array.isArray(this.ingredientTypes)?[]:[...this.ingredientTypes].sort((t,e)=>t.name.localeCompare(e.name))}getFilteredTypes(){let t=this.ingredientForm.get("group_id")?.value;return t?this.sortedIngredientTypes.filter(e=>e.group_id===t):this.sortedIngredientTypes}getFilteredTypesForForm(){let t=this.ingredientForm.get("group_id")?.value;return t?this.sortedIngredientTypes.filter(e=>e.group_id===t):this.sortedIngredientTypes}goToIngredientSearch(){this.router.navigate(["/restaurant/ingredient-search"])}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["app-inventory"]],decls:121,vars:26,consts:[[1,"page-container"],[1,"grid-cards","p-sm"],["data-tutorial","inventory-total",1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"text-md","font-bold","text-primary","justify-center","flex"],[1,"text-muted","card-footer"],["data-tutorial","inventory-low-stock",1,"card"],["data-tutorial","inventory-shopping-list",1,"card"],[1,"card-footer"],[1,"promethea-button","ghost","mt-auto",3,"click","disabled"],[1,"form-card","mt-lg"],["data-tutorial","inventory-search"],[1,"form-row"],[1,"form-group","mb-lg"],[1,"standard-label"],[1,"material-icons"],["type","text","placeholder","Cerca per nome o descrizione...",3,"input","value"],[3,"change","value"],["value","name"],["value","stock"],["value","cost"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-row","mt-sm"],[1,"form-group",2,"justify-content","center"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"checkbox-content"],["class","text-green-600 font-bold",4,"ngIf"],[1,"modal-footer"],[1,"promethea-button",3,"click"],["name","plus",3,"size"],[1,"promethea-button","ghost",3,"click"],["data-tutorial","inventory-ingredient-search",1,"promethea-button","ghost",3,"click"],["name","package-search","size","16"],["data-tutorial","inventory-table",1,"table-section","p-sm"],[1,"crm-table"],[1,"desktop-only"],[4,"ngIf"],["class","ingredient-row",3,"bg-green-50",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[3,"value"],[1,"text-green-600","font-bold"],["colspan","7",1,"text-center","p-xl"],[1,"flex","flex-col","items-center","justify-center","gap-md"],[1,"material-icons","animate-spin"],[1,"ingredient-row"],[1,"text-muted"],[1,"chip"],[1,"flex","gap-sm"],[1,"icon-button",3,"click","title"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["name","trash-2",3,"size"],["colspan","7",1,"empty-state-row"],[1,"empty-state"],["class","text-muted mb-4",4,"ngIf"],[1,"text-muted","mb-4"],[1,"modal-overlay",3,"click"],[1,"modal-container","modal-lg",3,"click"],[1,"modal-header"],[1,"flex"],[1,"header-icon"],[1,"section-title"],[1,"icon-button",3,"click"],[1,"form-card",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name",1,"standard-label"],["id","name","formControlName","name","type","text","placeholder","Es: Pomodoro San Marzano"],["class","text-red-500 text-sm",4,"ngIf"],["for","unit_id",1,"standard-label"],["id","unit_id","formControlName","unit_id"],["label","Peso"],["label","Volume"],["label","Conteggio"],["for","cost_per_unit",1,"standard-label"],["id","cost_per_unit","formControlName","cost_per_unit","type","number","step","0.001","min","0","placeholder","0.000"],[1,"form-group","mt-sm"],["for","description",1,"standard-label"],["id","description","formControlName","description","rows","2","placeholder","Descrizione opzionale dell'ingrediente"],["for","current_stock",1,"standard-label"],["id","current_stock","formControlName","current_stock","type","number","step","0.001","min","0","placeholder","0"],["id","minimum_stock","formControlName","minimum_stock","type","number","step","0.001","min","0","placeholder","0"],["for","group_id",1,"standard-label"],["id","group_id","formControlName","group_id",3,"change"],["for","type_id",1,"standard-label"],[1,"flex","gap-sm","items-center"],["id","type_id","formControlName","type_id",1,"flex-1",3,"disabled"],["type","button","title","Crea nuova tipologia",1,"icon-button",3,"click"],[1,"mt-sm","text-mini"],["for","supplier_id",1,"standard-label"],["name","truck",1,"nav-icon",3,"size"],["id","supplier_id","formControlName","supplier_id",1,"flex-1"],["type","button","title","Gestisci Fornitori",1,"icon-button",3,"click"],["for","expiry_date",1,"standard-label"],["id","expiry_date","formControlName","expiry_date","type","date"],["type","checkbox","formControlName","alert_enabled"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button",3,"click","disabled"],[1,"text-red-500","text-sm"],[1,"modal-content"],[1,"form-card"],["class","empty-state",4,"ngIf"],[1,"promethea-button",3,"click","disabled"],[1,"promethea-button","success",3,"click","disabled"],[1,"table-section"],[4,"ngFor","ngForOf"],[1,"mt-lg","p-md","bg-smoke","rounded-lg"],[1,"flex","justify-between","items-center"],[1,"font-bold"],[1,"text-md","font-bold","text-primary"],[1,"flex","items-center","gap-2"],[1,"icon-button","x-small",3,"click","title"],[1,"flex","flex-col","items-center"],["type","number",1,"w-16",3,"change","step","min","value"],[1,"text-mini","text-muted","mt-sm"],[1,"icon-button","text-red-500",3,"click"],[1,"modal-container","modal-md",3,"click"],[1,"grid-form","gap-md",3,"ngSubmit","formGroup"],["for","type_group_id",1,"standard-label"],["for","type_name",1,"standard-label"],["id","type_name","type","text","formControlName","name","placeholder","Es: Tonno Rosso, Pomodoro San Marzano, etc.","required","",1,"w-full"],["for","type_description",1,"standard-label"],["id","type_description","formControlName","description","rows","3","placeholder","Descrizione della tipologia...",1,"w-full"],["class","bg-blue-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"promethea-button",3,"click","disabled"],[1,"bg-blue-50","rounded-lg","p-4"],[1,"material-icons","text-blue-500","mr-2"],[1,"text-sm"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),o(5,"inventory"),i(),n(6,"h3",5),o(7,"Ingredienti Totali"),i()(),n(8,"div",6),o(9),i(),n(10,"span",7),o(11,"Ingredienti in inventario"),i()(),n(12,"div",8)(13,"div",3)(14,"span",4),o(15,"warning"),i(),n(16,"h3",5),o(17,"Scorte Basse"),i()(),n(18,"div",6),o(19),i(),n(20,"span",7),o(21),i()(),n(22,"div",9)(23,"div",3)(24,"span",4),o(25,"shopping_cart"),i(),n(26,"h3",5),o(27,"Lista Spesa"),i()(),n(28,"div",6),o(29),i(),n(30,"div",10)(31,"button",11),p("click",function(){return r.showShoppingList=!0}),o(32),i()()()(),n(33,"div",12)(34,"div",13)(35,"div",14)(36,"div",15)(37,"label",16)(38,"span",17),o(39,"search"),i(),o(40," Cerca Ingredienti "),i(),n(41,"input",18),p("input",function(c){return r.onSearchChange(c.target.value)}),i()(),n(42,"div",15)(43,"label",16)(44,"span",17),o(45,"sort"),i(),o(46," Ordina per "),i(),n(47,"select",19),p("change",function(c){return r.onSortChange(c.target.value)}),n(48,"option",20),o(49,"Nome"),i(),n(50,"option",21),o(51,"Scorta"),i(),n(52,"option",22),o(53,"Costo"),i()()()(),n(54,"div",14)(55,"div",15)(56,"label",16)(57,"span",17),o(58,"category"),i(),o(59," Filtra per Gruppo "),i(),n(60,"select",19),p("change",function(c){return r.onGroupFilterChange(c.target.value)}),n(61,"option",23),o(62,"Tutti i gruppi"),i(),g(63,ue,2,2,"option",24),i()(),n(64,"div",15)(65,"label",16)(66,"span",17),o(67,"category"),i(),o(68," Filtra per Tipologia "),i(),n(69,"select",19),p("change",function(c){return r.onTypeFilterChange(c.target.value)}),n(70,"option",23),o(71,"Tutte le tipologie"),i(),g(72,me,2,2,"option",24),i()()(),n(73,"div",25)(74,"div",26)(75,"label",27)(76,"input",28),p("change",function(){return r.toggleLowStockFilter()}),i(),n(77,"div",29),o(78,"Mostra solo scorte basse "),i()()(),n(79,"div",26)(80,"label",27)(81,"input",28),p("change",function(){return r.toggleShoppingListFilter()}),i(),n(82,"div",29),o(83,"Mostra solo da acquistare "),g(84,_e,2,1,"span",30),i()()()()(),n(85,"div",31)(86,"button",32),p("click",function(){return r.newIngredient()}),y(87,"lucide-angular",33),o(88," Nuovo Ingrediente "),i(),n(89,"button",34),p("click",function(){return r.createComposedIngredient()}),n(90,"span",17),o(91,"add_circle"),i(),o(92," Crea Ingrediente Composto "),i(),n(93,"button",35),p("click",function(){return r.goToIngredientSearch()}),y(94,"lucide-angular",36),o(95," Cerca Ingrediente "),i()()(),n(96,"div",37)(97,"table",38)(98,"thead")(99,"tr")(100,"th"),o(101,"Nome"),i(),n(102,"th",39),o(103,"Descrizione"),i(),n(104,"th"),o(105,"Scorta Attuale"),i(),n(106,"th"),o(107,"Fornitore"),i(),n(108,"th"),o(109,"Costo/Unit\xE0"),i(),n(110,"th"),o(111,"Stato"),i(),n(112,"th"),o(113,"Azioni"),i()()(),n(114,"tbody"),g(115,ge,7,0,"tr",40)(116,ve,31,22,"tr",41)(117,fe,11,2,"tr",40),i()()()(),g(118,Fe,122,26,"div",42)(119,Ge,32,5,"div",42)(120,Me,49,7,"div",42)),e&2&&(l(9),S(r.ingredients.length),l(9),b("text-red-500",r.lowStockCount>0),l(),v(" ",r.lowStockCount," "),l(),b("text-red-500",r.lowStockCount>0),l(),v(" ",r.lowStockCount>0?"Attenzione!":"Tutto ok"," "),l(8),v(" ",r.getShoppingList().length," "),l(2),d("disabled",r.getShoppingList().length===0),l(),v(" Vedi Lista (\u20AC",r.shoppingListTotal.toFixed(2),") "),l(9),d("value",r.searchTerm),l(6),d("value",r.sortBy),l(13),d("value",r.selectedGroupId||""),l(3),d("ngForOf",r.sortedIngredientGroups),l(6),d("value",r.selectedTypeId||""),l(3),d("ngForOf",r.ingredientTypes),l(4),d("checked",r.showLowStockOnly),l(5),d("checked",r.showShoppingListOnly),l(3),d("ngIf",r.showShoppingListOnly),l(3),d("size",20),l(28),d("ngIf",r.isLoading),l(),d("ngForOf",r.filteredIngredients),l(),d("ngIf",!r.isLoading&&r.filteredIngredients.length===0),l(),d("ngIf",r.showIngredientForm),l(),d("ngIf",r.showShoppingList),l(),d("ngIf",r.showTypeModal))},dependencies:[A,$,z,P,ne,H,Y,Z,j,K,U,X,B,R,te,ee,W,J,se,le],styles:[".chip.in-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#10b981 20%,transparent);color:#10b981}.chip.low-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 20%,transparent);color:#f59e0b}.chip.out-of-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 20%,transparent);color:#ef4444}.flex.items-center.gap-2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.w-16[_ngcontent-%COMP%]{min-width:3rem}"]})};export{pe as Inventory};
