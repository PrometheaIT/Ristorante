import{a as ie}from"./chunk-THIV3BQJ.js";import{a as te}from"./chunk-7QR2BAVO.js";import{a as re}from"./chunk-WUX2K4S7.js";import{a as G,b as B,c as _,d as q,e as L,f as U,i as $,j as R,l as Q,m as j,n as W,o as H,p as J,q as K,r as X,t as Y,v as Z,x as ee}from"./chunk-77SKEQNN.js";import{a as ne}from"./chunk-7V5YPNIB.js";import{d as A,e as M,i as D,k as z,r as T,t as V}from"./chunk-DCWKKS33.js";import{$b as p,Db as b,Eb as v,La as l,Mb as I,Nb as N,Qb as o,Rb as P,Sb as m,Tb as O,ab as k,bc as u,ea as y,f as S,fb as f,ja as x,ka as F,qb as c,rb as r,sb as i,tb as h,zb as w}from"./chunk-K5RDB55Y.js";function le(s,t){s&1&&(r(0,"span"),o(1,"(Predefinita)"),i())}function se(s,t){if(s&1&&(r(0,"option",53),o(1),f(2,le,2,0,"span",37),i()),s&2){let n=t.$implicit;c("value",n.id),l(),m(" ",n.name," "),l(),c("ngIf",n.is_default)}}function de(s,t){s&1&&(r(0,"div",54),o(1," La categoria \xE8 obbligatoria "),i())}function ce(s,t){s&1&&(r(0,"div",54),o(1," Il nome \xE8 obbligatorio "),i())}function me(s,t){s&1&&(r(0,"span",2),o(1,"hourglass_empty"),i())}function ge(s,t){s&1&&(r(0,"span",2),o(1,"add"),i())}function pe(s,t){if(s&1){let n=w();r(0,"div",55)(1,"h3",56),o(2,"Nuova Categoria"),i(),r(3,"div",57)(4,"div",9)(5,"label",58),o(6,"Nome Categoria *"),i(),h(7,"input",59),f(8,ce,2,0,"div",18),i(),r(9,"div",9)(10,"label",60),o(11,"Descrizione"),i(),h(12,"textarea",61),i(),r(13,"div",9)(14,"label",62),h(15,"input",63)(16,"span",64),o(17," Imposta come categoria predefinita "),i()(),r(18,"div",65)(19,"button",66),b("click",function(){x(n);let a=v();return F(a.toggleNewCategoryForm())}),o(20," Annulla "),i(),r(21,"button",67),b("click",function(){x(n);let a=v();return F(a.onCreateCategory())}),f(22,me,2,0,"span",68)(23,ge,2,0,"span",68),o(24),i()()()()}if(s&2){let n,e=v();l(3),c("formGroup",e.newCategoryForm),l(5),c("ngIf",((n=e.newCategoryForm.get("name"))==null?null:n.invalid)&&((n=e.newCategoryForm.get("name"))==null?null:n.touched)),l(11),c("disabled",e.isCreatingCategory),l(2),c("disabled",e.isCreatingCategory),l(),c("ngIf",e.isCreatingCategory),l(),c("ngIf",!e.isCreatingCategory),l(),m(" ",e.isCreatingCategory?"Creazione...":"Crea Categoria"," ")}}function ue(s,t){if(s&1&&(r(0,"span"),o(1),p(2,"number"),i()),s&2){let n=v().$implicit;l(),O(" (\u20AC",u(2,2,n.cost_per_unit,"1.2-2"),"/",n.units.symbol,") ")}}function Ce(s,t){if(s&1&&(r(0,"option",53),o(1),f(2,ue,3,5,"span",37),i()),s&2){let n=t.$implicit;c("value",n.name),l(),m(" ",n.name," "),l(),c("ngIf",n.unit_id&&n.units)}}function fe(s,t){if(s&1&&(r(0,"option",53),o(1),i()),s&2){let n=t.$implicit;c("value",n.id),l(),m(" ",n.name," ")}}function ve(s,t){if(s&1&&(r(0,"span",79),o(1),i()),s&2){let n,e=v().$implicit,a=v();l(),m(" ",a.getQuantityUnitLabel((n=e.get("ingredient_id"))==null?null:n.value)," ")}}function _e(s,t){if(s&1){let n=w();r(0,"div",69)(1,"div",9)(2,"input",70),b("input",function(a){let d=x(n).index,g=v();return F(g.onIngredientSelected(a,d))})("blur",function(a){let d=x(n).index,g=v();return F(g.onIngredientSelected(a,d))})("change",function(){x(n);let a=v();return F(a.manualCalculateCost())}),i(),r(3,"datalist",71),f(4,Ce,3,3,"option",16),i(),r(5,"select",72)(6,"option",15),o(7,"Seleziona un ingrediente"),i(),f(8,fe,2,2,"option",16),i()(),r(9,"div",9)(10,"div",73)(11,"input",74),b("change",function(){x(n);let a=v();return F(a.manualCalculateCost())}),i(),f(12,ve,2,1,"span",75),i()(),r(13,"div",76),o(14),p(15,"number"),i(),r(16,"div")(17,"button",77),b("click",function(){let a=x(n).index,d=v();return F(d.removeIngredient(a))}),r(18,"span",78),o(19,"delete"),i()()()()}if(s&2){let n,e,a,d=t.$implicit,g=t.index,C=v();c("formGroupName",g),l(2),c("value",C.getIngredientName((n=d.get("ingredient_id"))==null?null:n.value)),l(2),c("ngForOf",C.ingredients),l(4),c("ngForOf",C.ingredients),l(4),c("ngIf",(e=d.get("ingredient_id"))==null?null:e.value),l(2),m(" \u20AC",u(15,6,(a=d.get("cost"))==null?null:a.value,"1.2-2")," ")}}function he(s,t){s&1&&(r(0,"span"),o(1,"\u26A1"),i())}function be(s,t){s&1&&(r(0,"span"),o(1,"\u2713"),i())}var oe=class s{ingredientService=y(te);unitService=y(ie);dishService=y(ne);fb=y(Z);categoryService=y(re);route=y(T);router=y(V);dishId;foodCostForm;ingredients=[];totalCost=0;suggestedPrice=0;isEditing=!1;currentDish=null;categories=[];showNewCategoryForm=!1;newCategoryForm;isCreatingCategory=!1;constructor(){this.foodCostForm=this.fb.group({dishName:["",_.required],sellingPrice:[0,[_.required,_.min(0)]],category_id:["",_.required],description:[""],preparation_time:[0,[_.min(0)]],ingredients:this.fb.array([])}),this.newCategoryForm=this.fb.group({name:["",_.required],description:[""],is_default:[!1]})}ngOnInit(){this.ingredientService.ingredients$.subscribe(t=>{this.ingredients=t,this.route.paramMap.subscribe(n=>{let e=n.get("id");e?this.loadDishForEditing(e):this.ingredientsArray.length===0&&this.addIngredient()})}),this.categoryService.categories$.subscribe(t=>{if(this.categories=t,t.length>0&&!this.foodCostForm.get("category_id")?.value){let n=t.find(e=>e.is_default)||t[0];this.foodCostForm.patchValue({category_id:n.id})}})}loadDishForEditing(t){return S(this,null,function*(){try{let n=this.dishService.getDishById(t);if(n)this.currentDish=n,this.isEditing=!0,this.populateFormWithDish(n);else{console.error("Piatto non trovato:",t),yield this.dishService.loadDishes();let e=this.dishService.getDishById(t);e?(this.currentDish=e,this.isEditing=!0,this.populateFormWithDish(e)):(alert("Piatto non trovato"),this.router.navigate(["/food-cost-calculator"]))}}catch(n){console.error("Errore nel caricamento del piatto:",n),alert("Errore nel caricamento del piatto"),this.router.navigate(["/food-cost-calculator"])}})}populateFormWithDish(t){for(this.foodCostForm.patchValue({dishName:t.name,sellingPrice:t.base_price,category_id:t.category_id,description:t.description||"",preparation_time:t.preparation_time||0});this.ingredientsArray.length;)this.ingredientsArray.removeAt(0);t.ingredients_composition&&Array.isArray(t.ingredients_composition)?t.ingredients_composition.forEach(n=>{let e=this.fb.group({ingredient_id:[n.ingredient_id,_.required],quantity:[n.quantity,[_.required,_.min(0)]],cost:[n.cost||0]});this.ingredientsArray.push(e)}):this.addIngredient(),setTimeout(()=>{this.calculateCost()},100)}get ingredientsArray(){return this.foodCostForm.get("ingredients")}addIngredient(){let t=this.fb.group({ingredient_id:["",_.required],quantity:[0,[_.required,_.min(0)]],cost:[0]});this.ingredientsArray.push(t)}removeIngredient(t){this.ingredientsArray.removeAt(t),this.manualCalculateCost()}getIngredientUnitSymbol(t){let n=this.ingredients.find(a=>a.id===t);if(!n||!n.unit_id)return"";let e=this.unitService.getUnitById(n.unit_id);return e?e.symbol:""}calculateIngredientCost(t,n){if(!t||!t.unit_id||!t.units)return t.cost_per_unit*n;let e=t.units,a=n;switch(e.symbol){case"kg":a=n/1e3;break;case"L":a=n/1e3;break;case"g":case"mL":case"pz":a=n;break;default:a=n}return t.cost_per_unit*a}manualCalculateCost(){this.calculateCost()}calculateCost(){this.totalCost=0,this.ingredientsArray.controls.forEach(t=>{let n=t.get("ingredient_id")?.value,e=t.get("quantity")?.value||0;if(n&&e>0){let a=this.ingredients.find(d=>d.id===n);if(a){let d=this.calculateIngredientCost(a,e);this.totalCost+=d,t.patchValue({cost:d},{emitEvent:!1})}}else t.patchValue({cost:0},{emitEvent:!1})}),this.calculateSuggestedPrice()}calculateSuggestedPrice(){this.suggestedPrice=this.totalCost/.3}getFoodCostPercentage(){let t=this.foodCostForm.get("sellingPrice")?.value||0;return t>0?this.totalCost/t*100:0}getIngredientCost(t,n){let e=this.ingredients.find(a=>a.id===t);return e?this.calculateIngredientCost(e,n):0}onSubmit(){return S(this,null,function*(){if(this.foodCostForm.valid){let t=this.foodCostForm.value,n=[];this.ingredientsArray.controls.forEach(a=>{let d=a.get("ingredient_id")?.value,g=a.get("quantity")?.value||0;if(d&&g>0){let C=this.ingredients.find(E=>E.id===d);if(C){let E=this.calculateIngredientCost(C,g),ae=this.getQuantityUnitLabel(d);n.push({ingredient_id:d,quantity:g,cost:E,unit_symbol:ae})}}});let e={name:t.dishName,base_price:t.sellingPrice,food_cost:this.totalCost,ingredients_composition:n,delivery_price:t.sellingPrice,takeaway_price:t.sellingPrice,status:"available",description:t.description||"",preparation_time:t.preparation_time||0,category_id:t.category_id};try{if(this.isEditing&&this.currentDish){let a={name:t.dishName,base_price:t.sellingPrice,food_cost:this.totalCost,ingredients_composition:n,delivery_price:t.sellingPrice,takeaway_price:t.sellingPrice,status:"available",description:t.description||"",preparation_time:t.preparation_time||0,category_id:t.category_id};yield this.dishService.updateDish(this.currentDish.id,a),alert("Piatto aggiornato con successo!")}else(yield this.dishService.createDish(e))?(alert("Piatto creato con successo!"),this.resetForm()):alert("Errore nella creazione del piatto")}catch(a){console.error("Errore nel salvataggio:",a),alert("Errore nel salvataggio del piatto")}}else this.markFormGroupTouched(this.foodCostForm),alert("Compila tutti i campi obbligatori")})}resetForm(){for(this.foodCostForm.reset();this.ingredientsArray.length;)this.ingredientsArray.removeAt(0);this.addIngredient(),this.totalCost=0,this.suggestedPrice=0;let t=this.categories.find(n=>n.is_default)||this.categories[0];t&&this.foodCostForm.patchValue({category_id:t.id})}markFormGroupTouched(t){Object.keys(t.controls).forEach(n=>{let e=t.get(n);e instanceof U?this.markFormGroupTouched(e):e?.markAsTouched()})}getQuantityUnitLabel(t){let n=this.ingredients.find(a=>a.id===t);if(!n||!n.unit_id||!n.units)return"pz";let e=n.units;switch(e.symbol){case"kg":return"g";case"L":return"mL";case"g":case"mL":case"pz":default:return e.symbol}}canSave(){let t=!!this.foodCostForm.get("dishName")?.valid,e=(this.foodCostForm.get("sellingPrice")?.value??0)>0,a=!!this.foodCostForm.get("category_id")?.value&&!this.showNewCategoryForm,d=this.ingredientsArray.controls.some(g=>{let C=g.get("ingredient_id")?.value,E=Number(g.get("quantity")?.value??0);return!!C&&E>0});return t&&e&&a&&d}onIngredientSearch(t,n){let e=t.target.value.toLowerCase();if(e){let a=this.ingredients.filter(d=>d.name.toLowerCase().includes(e)||d.description?.toLowerCase().includes(e))}}onIngredientSelected(t,n){let e=t.target.value,a=this.ingredients.find(d=>d.name===e);a?(this.ingredientsArray.at(n).patchValue({ingredient_id:a.id},{emitEvent:!1}),this.manualCalculateCost()):(this.ingredientsArray.at(n).patchValue({ingredient_id:""},{emitEvent:!1}),this.manualCalculateCost())}getIngredientName(t){if(!t)return"";let n=this.ingredients.find(e=>e.id===t);return n?n.name:""}toggleNewCategoryForm(){this.showNewCategoryForm=!this.showNewCategoryForm,this.showNewCategoryForm||this.newCategoryForm.reset()}onCreateCategory(){return S(this,null,function*(){if(this.newCategoryForm.valid){this.isCreatingCategory=!0;try{let t={name:this.newCategoryForm.get("name")?.value,description:this.newCategoryForm.get("description")?.value,is_default:this.newCategoryForm.get("is_default")?.value},n=yield this.categoryService.createCategoryForCurrentUser(t);n?(this.foodCostForm.patchValue({category_id:n.id}),this.showNewCategoryForm=!1,this.newCategoryForm.reset(),alert("Categoria creata con successo!")):alert("Errore nella creazione della categoria")}catch(t){console.error("Errore nella creazione della categoria:",t),alert("Errore nella creazione della categoria")}finally{this.isCreatingCategory=!1}}else this.markFormGroupTouched(this.newCategoryForm)})}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=k({type:s,selectors:[["app-food-cost-calculator"]],inputs:{dishId:"dishId"},decls:178,vars:73,consts:[[1,"page-container"],[1,"section-header"],[1,"material-icons"],[1,"section-titles"],[1,"text-muted"],[1,"dashboard-grid"],[1,"form-card"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","dishName",1,"form-label"],["id","dishName","formControlName","dishName","type","text","placeholder","Inserisci il nome del piatto"],["for","category_id",1,"form-label"],[1,"category-select-container"],["id","category_id","formControlName","category_id",1,"form-select",3,"disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","button","title","Aggiungi nuova categoria",1,"icon-button",3,"click","disabled"],["class","error-message",4,"ngIf"],["class","form-subsection","style","margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; border-radius: 4px;",4,"ngIf"],["for","preparation_time",1,"form-label"],["id","preparation_time","formControlName","preparation_time","type","number","min","0","placeholder","0"],["for","sellingPrice",1,"form-label"],["id","sellingPrice","formControlName","sellingPrice","type","number","step","0.01","min","0","placeholder","0.00",3,"change"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Descrizione del piatto (opzionale)"],[1,"form-section","ingredients-section"],[1,"section-title"],[1,"chip",2,"margin-left","auto"],[1,"ingredients-header"],["formArrayName","ingredients"],["class","ingredient-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"promethea-button","secondary",2,"margin-top","var(--gutter-md)",3,"click"],[1,"costs-grid"],[1,"compact-cost-item"],[1,"cost-value"],[1,"cost-label"],[4,"ngIf"],[1,"form-actions"],["type","submit",1,"promethea-button",3,"disabled"],[1,"card-content"],[1,"info-item"],[1,"contact-info"],[1,"info-label"],[1,"info-value"],[1,"info-detail"],[1,"chart-container",2,"margin-top","var(--gutter-lg)"],[1,"chart-bars"],[1,"chart-bar"],[1,"bar-label"],[1,"bar-container"],[1,"bar-fill"],[1,"bar-value"],[3,"value"],[1,"error-message"],[1,"form-subsection",2,"margin-top","1rem","padding","1rem","border","1px solid #ccc","border-radius","4px"],[2,"margin-top","0"],[3,"formGroup"],["for","newCategoryName",1,"form-label"],["id","newCategoryName","formControlName","name","type","text","placeholder","Inserisci il nome della categoria",1,"form-input"],["for","newCategoryDescription",1,"form-label"],["id","newCategoryDescription","formControlName","description","rows","2","placeholder","Descrizione della categoria (opzionale)",1,"form-input"],[1,"checkbox-label"],["type","checkbox","formControlName","is_default"],[1,"checkmark"],[1,"form-actions",2,"margin-top","1rem"],["type","button",1,"promethea-button","secondary",3,"click","disabled"],["type","button",1,"promethea-button",3,"click","disabled"],["class","material-icons",4,"ngIf"],[1,"ingredient-row",3,"formGroupName"],["list","ingredientsList","placeholder","Cerca ingrediente...",1,"searchable-select","compact-input",3,"input","blur","change","value"],["id","ingredientsList"],["formControlName","ingredient_id",2,"display","none"],[2,"display","flex","align-items","center","gap","0.5rem"],["formControlName","quantity","type","number","step","0.001","min","0","placeholder","0",1,"compact-input",2,"flex","1",3,"change"],["class","text-muted","style","font-size: 0.8rem; white-space: nowrap;",4,"ngIf"],[1,"ingredient-cost"],["type","button","title","Rimuovi ingrediente",1,"icon-button","compact-remove-btn",3,"click"],[1,"material-icons",2,"font-size","18px"],[1,"text-muted",2,"font-size","0.8rem","white-space","nowrap"]],template:function(n,e){if(n&1&&(r(0,"div",0)(1,"div",1)(2,"span",2),o(3),i(),r(4,"div",3)(5,"h1"),o(6),i(),r(7,"p",4),o(8),i()()(),r(9,"div",5)(10,"div",6)(11,"form",7),b("ngSubmit",function(){return e.onSubmit()}),r(12,"div",8)(13,"div",9)(14,"label",10)(15,"span",2),o(16,"restaurant"),i(),o(17," Nome Piatto * "),i(),h(18,"input",11),i(),r(19,"div",9)(20,"label",12)(21,"span",2),o(22,"category"),i(),o(23," Categoria * "),i(),r(24,"div",13)(25,"select",14)(26,"option",15),o(27,"Seleziona una categoria"),i(),f(28,se,3,3,"option",16),i(),r(29,"button",17),b("click",function(){return e.toggleNewCategoryForm()}),r(30,"span",2),o(31,"add"),i()()(),f(32,de,2,0,"div",18),i()(),f(33,pe,25,7,"div",19),r(34,"div",8)(35,"div",9)(36,"label",20)(37,"span",2),o(38,"timer"),i(),o(39," Tempo di Preparazione (minuti) "),i(),h(40,"input",21),i(),r(41,"div",9)(42,"label",22)(43,"span",2),o(44,"euro"),i(),o(45," Prezzo di Vendita * "),i(),r(46,"input",23),b("change",function(){return e.manualCalculateCost()}),i()()(),r(47,"div",9)(48,"label",24)(49,"span",2),o(50,"description"),i(),o(51," Descrizione "),i(),h(52,"textarea",25),i(),r(53,"div",26)(54,"h2",27)(55,"span",2),o(56,"list"),i(),o(57," Ingredienti "),r(58,"span",28),o(59),i()(),r(60,"div",29)(61,"div"),o(62,"Ingrediente"),i(),r(63,"div"),o(64,"Quantit\xE0"),i(),r(65,"div"),o(66,"Costo"),i(),h(67,"div"),i(),r(68,"div",30),f(69,_e,20,9,"div",31),i(),r(70,"button",32),b("click",function(){return e.addIngredient()}),r(71,"span",2),o(72,"add"),i(),o(73," Aggiungi Ingrediente "),i()(),r(74,"div",6)(75,"h2",27)(76,"span",2),o(77,"analytics"),i(),o(78," Riepilogo Costi "),i(),r(79,"div",33)(80,"div",34)(81,"div",35),o(82),p(83,"number"),i(),r(84,"div",36),o(85,"Costo Ingredienti"),i()(),r(86,"div",34)(87,"div",35),o(88),p(89,"number"),i(),r(90,"div",36),o(91," Food Cost "),f(92,he,2,0,"span",37)(93,be,2,0,"span",37),i()(),r(94,"div",34)(95,"div",35),o(96),p(97,"number"),i(),r(98,"div",36),o(99,"Prezzo Suggerito"),i()(),r(100,"div",34)(101,"div",35),o(102),p(103,"number"),i(),r(104,"div",36),o(105,"Margine"),i()()()(),r(106,"div",38)(107,"button",39)(108,"span",2),o(109),i(),o(110),i()()()(),r(111,"div",6)(112,"h2",27)(113,"span",2),o(114,"analytics"),i(),o(115," Riepilogo Costi "),i(),r(116,"div",40)(117,"div",41)(118,"span",2),o(119,"shopping_basket"),i(),r(120,"div",42)(121,"span",43),o(122,"Costo Totale Ingredienti"),i(),r(123,"span",44),o(124),p(125,"number"),i()()(),r(126,"div",41)(127,"span",2),o(128,"percent"),i(),r(129,"div",42)(130,"span",43),o(131,"Percentuale Food Cost"),i(),r(132,"span",44),o(133),p(134,"number"),i(),r(135,"span",45),o(136),i()()(),r(137,"div",41)(138,"span",2),o(139,"lightbulb"),i(),r(140,"div",42)(141,"span",43),o(142,"Prezzo Suggerito (30% FC)"),i(),r(143,"span",44),o(144),p(145,"number"),i(),r(146,"span",45),o(147,"Per mantenere il food cost al 30%"),i()()(),r(148,"div",41)(149,"span",2),o(150,"trending_up"),i(),r(151,"div",42)(152,"span",43),o(153,"Margine di Guadagno"),i(),r(154,"span",44),o(155),p(156,"number"),i(),r(157,"span",45),o(158),p(159,"number"),i()()()(),r(160,"div",46)(161,"div",47)(162,"div",48)(163,"div",49),o(164,"Costo"),i(),r(165,"div",50),h(166,"div",51),i(),r(167,"div",52),o(168),p(169,"number"),i()(),r(170,"div",48)(171,"div",49),o(172,"Margine"),i(),r(173,"div",50),h(174,"div",51),i(),r(175,"div",52),o(176),p(177,"number"),i()()()()()()()),n&2){let a,d,g,C;l(3),P(e.isEditing?"edit":"calculate"),l(3),P(e.isEditing?"Modifica Piatto":"Calcolo Food Cost"),l(2),m(" ",e.isEditing?"Modifica il piatto esistente":"Calcola il costo degli ingredienti e il prezzo di vendita ottimale"," "),l(3),c("formGroup",e.foodCostForm),l(14),c("disabled",e.showNewCategoryForm),l(3),c("ngForOf",e.categories),l(),c("disabled",e.showNewCategoryForm),l(3),c("ngIf",((a=e.foodCostForm.get("category_id"))==null?null:a.invalid)&&((a=e.foodCostForm.get("category_id"))==null?null:a.touched)),l(),c("ngIf",e.showNewCategoryForm),l(26),m(" ",e.ingredientsArray.length," ingredienti "),l(10),c("ngForOf",e.ingredientsArray.controls),l(13),m("\u20AC",u(83,40,e.totalCost,"1.2-2")),l(6),m("",u(89,43,e.getFoodCostPercentage(),"1.1-1"),"%"),l(2),N("food-cost-warning",e.getFoodCostPercentage()>35)("food-cost-optimal",e.getFoodCostPercentage()<=35),l(2),c("ngIf",e.getFoodCostPercentage()>35),l(),c("ngIf",e.getFoodCostPercentage()<=35),l(3),m("\u20AC",u(97,46,e.suggestedPrice,"1.2-2")),l(6),m("\u20AC",u(103,49,((d=e.foodCostForm.get("sellingPrice"))==null?null:d.value)-e.totalCost,"1.2-2")),l(5),c("disabled",!e.canSave()),l(2),P(e.isEditing?"update":"save"),l(),m(" ",e.isEditing?"Aggiorna Piatto":"Salva Piatto"," "),l(14),m("\u20AC",u(125,52,e.totalCost,"1.2-2")),l(9),m("",u(134,55,e.getFoodCostPercentage(),"1.1-1"),"%"),l(2),N("error",e.getFoodCostPercentage()>35),l(),m(" ",e.getFoodCostPercentage()>35?"Alta - Considera di aumentare il prezzo":"Ottimale"," "),l(8),m("\u20AC",u(145,58,e.suggestedPrice,"1.2-2")),l(11),m(" \u20AC",u(156,61,((g=e.foodCostForm.get("sellingPrice"))==null?null:g.value)-e.totalCost,"1.2-2")," "),l(3),m(" ",u(159,64,(((C=e.foodCostForm.get("sellingPrice"))==null?null:C.value)-e.totalCost)/((C=e.foodCostForm.get("sellingPrice"))==null?null:C.value)*100,"1.1-1"),"% di margine "),l(8),I("height",e.getFoodCostPercentage(),"%"),l(2),m("",u(169,67,e.getFoodCostPercentage(),"1.0-0"),"%"),l(6),I("height",100-e.getFoodCostPercentage(),"%")("background","var(--tertiary)"),l(2),m("",u(177,70,100-e.getFoodCostPercentage(),"1.0-0"),"%")}},dependencies:[z,A,M,ee,$,K,X,B,R,G,J,q,L,Y,Q,H,j,W,D],styles:[".dashboard-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-md);align-items:start}.form-card[_ngcontent-%COMP%]{padding:var(--gutter-md)}.ingredients-section[_ngcontent-%COMP%]{margin-top:var(--gutter-md)}.ingredient-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr auto auto;gap:var(--gutter-sm);align-items:start;padding:var(--gutter-sm);border-bottom:1px solid var(--smoke-color-1);transition:background-color .2s ease}.ingredient-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.ingredient-row[_ngcontent-%COMP%]:hover{background:var(--smoke-color-1);border-radius:8px}.ingredients-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr auto auto;gap:var(--gutter-sm);padding:var(--gutter-sm);background:var(--smoke-color-1);border-radius:8px;margin-bottom:var(--gutter-sm);font-weight:600;font-size:var(--fs-sm)}.compact-input[_ngcontent-%COMP%]{padding:.5rem .75rem;height:38px;font-size:.9rem}.compact-select[_ngcontent-%COMP%]{padding:.5rem .75rem;height:38px;font-size:.9rem;background-size:12px}.ingredient-cost[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:var(--primary);min-width:80px;padding:.5rem 0}.compact-remove-btn[_ngcontent-%COMP%]{padding:.5rem;min-width:38px;height:38px;display:flex;align-items:center;justify-content:center}.costs-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--gutter-sm);margin-bottom:var(--gutter-md)}.compact-cost-item[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:12px;padding:var(--gutter-sm);text-align:center}.cost-value[_ngcontent-%COMP%]{font-size:var(--fs-md);font-weight:800;color:var(--primary);line-height:1.2}.cost-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-muted);margin-top:.25rem}.compact-chart[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-md);margin-top:var(--gutter-md)}.compact-chart-bar[_ngcontent-%COMP%]{flex:1;text-align:center}.compact-bar-container[_ngcontent-%COMP%]{height:80px;width:var(--fs-lg);background:var(--smoke-color-1);border-radius:8px;position:relative;overflow:hidden;margin-bottom:.5rem}.compact-bar-fill[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:var(--gradiente);transition:height .3s ease}.compact-bar-fill.margin[_ngcontent-%COMP%]{background:var(--tertiary)}.food-cost-warning[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.food-cost-optimal[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.category-select-container[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);align-items:center}.category-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1}.new-category-compact[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:12px;padding:var(--gutter-md);margin-top:var(--gutter-sm)}@media (max-width: 968px){.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm)}.ingredient-row[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr auto;gap:var(--gutter-sm)}.ingredients-header[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr auto}.costs-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]{padding:var(--gutter-sm)}.ingredient-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm);padding:var(--gutter-sm) 0}.ingredients-header[_ngcontent-%COMP%]{display:none}.compact-chart[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}}.searchable-select[_ngcontent-%COMP%]{width:100%;background:var(--background);border-radius:12px;border:1px solid var(--smoke-color-1)}.form-label[_ngcontent-%COMP%]{margin-bottom:0}"]})};export{oe as a};
