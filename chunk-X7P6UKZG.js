import{a as D}from"./chunk-WV4FX7XH.js";import{db as q,eb as V}from"./chunk-4Q6XQXJD.js";import{a as E,b as k,c as p,d as I,e as x,i as F,j as O,m as T,p as A,w as z,y as L}from"./chunk-D6L6OQLW.js";import{d as M}from"./chunk-M5ABBUWH.js";import{d as C,f as R,g as S}from"./chunk-TSK5DXKO.js";import{k as N,u as P}from"./chunk-WSJCHGNS.js";import{Bb as f,Ha as o,Kb as c,Nb as s,Ob as b,Pb as w,Xa as y,ab as u,ca as g,nb as l,ob as n,pb as i,qb as m,zb as h}from"./chunk-QIXMMTC2.js";import{j as _}from"./chunk-4ZZIO3ZI.js";function G(a,t){a&1&&(n(0,"div",34),s(1," Il nome \xE8 obbligatorio "),i())}function Y(a,t){a&1&&(n(0,"div",34),s(1," Il cognome \xE8 obbligatorio "),i())}function H(a,t){a&1&&(n(0,"span"),s(1,"Email obbligatoria"),i())}function U(a,t){a&1&&(n(0,"span"),s(1,"Email non valida"),i())}function B(a,t){if(a&1&&(n(0,"div",34),u(1,H,2,0,"span",15)(2,U,2,0,"span",15),i()),a&2){let r=f();o(),l("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.required),o(),l("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.email)}}function J(a,t){a&1&&(n(0,"div",34),s(1," Il nome del ristorante \xE8 obbligatorio "),i())}function K(a,t){if(a&1&&(n(0,"div")(1,"h2",5),m(2,"lucide-icon",35),s(3," Informazioni Ristorante "),i(),n(4,"div",8)(5,"label",9),s(6,"Nome Ristorante *"),i(),m(7,"input",36),u(8,J,2,0,"div",11),i()()),a&2){let r=f();o(7),c("error",(r.restaurantName==null?null:r.restaurantName.invalid)&&(r.restaurantName==null?null:r.restaurantName.touched)),o(),l("ngIf",(r.restaurantName==null?null:r.restaurantName.invalid)&&(r.restaurantName==null?null:r.restaurantName.touched))}}function Q(a,t){a&1&&(n(0,"div",34),s(1," Password obbligatoria (min. 6 caratteri) "),i())}function W(a,t){a&1&&(n(0,"div",34),s(1," Le password non coincidono "),i())}function X(a,t){if(a&1&&(n(0,"div",37),s(1),i()),a&2){let r=f();o(),w(" ",r.errorMessage," ")}}function Z(a,t){a&1&&m(0,"span",38)}function $(a,t){if(a&1&&(n(0,"span"),s(1),i()),a&2){let r=f();o(),b(r.isRestaurant?"Registra Ristorante":"Crea Account")}}var j=class a{fb=g(z);authService=g(M);router=g(R);route=g(C);registerForm;isLoading=!1;errorMessage="";isRestaurant=!1;isSupplier=!1;showPassword=!1;showConfirmPassword=!1;ngOnInit(){let t=this.route.snapshot.paramMap.get("role");this.isRestaurant=t==="restaurant",this.isSupplier=t==="supplier",this.initializeForm()}initializeForm(){this.registerForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]],confirmPassword:["",[p.required]],firstName:["",[p.required]],lastName:["",[p.required]],phone:[""],policy:[!1,[p.requiredTrue]],restaurantName:[(this.isRestaurant,""),this.isRestaurant?p.required:[]],companyName:[(this.isSupplier,""),this.isSupplier?p.required:[]],contactName:[(this.isSupplier,""),this.isSupplier?p.required:[]],supplierAddress:[(this.isSupplier,"")],supplierDescription:[(this.isSupplier,"")]},{validators:this.passwordMatchValidator})}get rememberMe(){return this.registerForm.get("policy")}passwordMatchValidator(t){let r=t.get("password")?.value,e=t.get("confirmPassword")?.value;return r===e?null:{passwordMismatch:!0}}onSubmit(){return _(this,null,function*(){if(this.registerForm.invalid||this.isLoading)return;this.isLoading=!0,this.errorMessage="";let t=this.registerForm.value;try{let r=this.determineUserRole(),e={email:t.email.toLowerCase().trim(),password:t.password,user_data:{first_name:t.firstName,last_name:t.lastName,phone:t.phone,role:r},restaurant_data:this.isRestaurant?{name:t.restaurantName,address:"",phone:t.phone||"",email:t.email,description:"",cuisine_type:"",allow_table_selection:!1,accepts_delivery:!1,accepts_takeaway:!1}:void 0,supplier_data:this.isSupplier?{company_name:t.companyName,contact_name:t.contactName,email:t.email,phone:t.phone||"",address:t.supplierAddress,description:t.supplierDescription}:void 0},d=yield this.authService.register(e);if(d.error){if(typeof d.error=="string")this.errorMessage=d.error;else if(d.error&&typeof d.error=="object"){let v=d.error;this.errorMessage=v.message||v.toString()}else this.errorMessage="Errore durante la registrazione";console.error("Registration error details:",d.error)}else d.user&&(console.log("\u2705 Registration successful, user:",d.user.id),this.errorMessage="Registrazione completata! Reindirizzamento...",this.redirectAfterRegistration(d))}catch(r){r instanceof Error?this.errorMessage="Errore durante la registrazione: "+r.message:typeof r=="string"?this.errorMessage="Errore durante la registrazione: "+r:this.errorMessage="Errore sconosciuto durante la registrazione",console.error("Registration exception:",r)}finally{this.isLoading=!1}})}determineUserRole(){return this.isRestaurant?"restaurant_owner":this.isSupplier?"supplier":"customer"}redirectAfterRegistration(t){setTimeout(()=>{this.isRestaurant&&t.restaurant?this.router.navigate(["/restaurant/dashboard"]):this.isSupplier?this.router.navigate(["/supplier/dashboard"]):this.router.navigate(["/customer/menu-display"])},2e3)}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}get firstName(){return this.registerForm.get("firstName")}get lastName(){return this.registerForm.get("lastName")}get restaurantName(){return this.registerForm.get("restaurantName")}get companyName(){return this.registerForm.get("companyName")}get contactName(){return this.registerForm.get("contactName")}get supplierAddress(){return this.registerForm.get("supplierAddress")}get supplierDescription(){return this.registerForm.get("supplierDescription")}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=y({type:a,selectors:[["app-register"]],decls:65,vars:30,consts:[[3,"title","icon","showToggle"],[1,"page-container"],[1,"gradient-container"],[1,"flex","flex-col","p-lg"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"text-md","font-semibold","mb-md"],["name","user",1,"nav-icon",3,"size"],[1,"form-row","mb-md"],[1,"form-group"],[1,"standard-label"],["formControlName","firstName","placeholder","Il tuo nome","type","text"],["class","error-message",4,"ngIf"],["formControlName","lastName","placeholder","Il tuo cognome","type","text"],["formControlName","email","type","email","placeholder","tua.email@esempio.com"],["formControlName","phone","placeholder","+39 123 456 7890","type","number"],[4,"ngIf"],[1,"mt-lg"],["name","lock",1,"nav-icon",3,"size"],[1,"form-row"],[1,"flex","gap-sm","items-center"],["formControlName","password","placeholder","Almeno 6 caratteri",1,"pr-[50px]","w-full",3,"type"],["type","button",1,"icon-button","absolute","right-sm","top-1/2","-translate-y-1/2","bg-transparent","border-none","text-[var(--text-muted)]","hover:text-[var(--primary)]",3,"click"],[3,"name"],["formControlName","confirmPassword","placeholder","Ripeti la password",1,"pr-[50px]","w-full",3,"type"],[1,"flex","justify-between","items-center","my-md"],[1,"checkbox-label","hover:bg-[var(--smoke-1)]"],["type","checkbox","formControlName","policy"],[1,"checkbox-content"],["href","#/policy",1,"link"],["class","error-message","style","margin: 1rem 0; padding: 1rem; background: #fee;",4,"ngIf"],[1,"flex","justify-between","items-center","gap-md","mt-lg","pt-md"],["routerLink","/login",1,"link"],["type","submit",1,"promethea-button",3,"disabled"],["class","loading-spinner",4,"ngIf"],[1,"error-message"],["name","building-2"],["formControlName","restaurantName","placeholder","Il nome del tuo ristorante","type","text"],[1,"error-message",2,"margin","1rem 0","padding","1rem","background","#fee"],[1,"loading-spinner"]],template:function(r,e){r&1&&(m(0,"app-header",0),n(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),h("ngSubmit",function(){return e.onSubmit()}),n(5,"h2",5),m(6,"lucide-icon",6),s(7," Informazioni Personali "),i(),n(8,"div",7)(9,"div",8)(10,"label",9),s(11,"Nome *"),i(),m(12,"input",10),u(13,G,2,0,"div",11),i(),n(14,"div",8)(15,"label",9),s(16,"Cognome *"),i(),m(17,"input",12),u(18,Y,2,0,"div",11),i()(),n(19,"div",7)(20,"div",8)(21,"label",9),s(22,"Email *"),i(),m(23,"input",13),u(24,B,3,2,"div",11),i(),n(25,"div",8)(26,"label",9),s(27,"Telefono"),i(),m(28,"input",14),i()(),u(29,K,9,3,"div",15),n(30,"div",16)(31,"h2",5),m(32,"lucide-icon",17),s(33," Password "),i(),n(34,"div",18)(35,"div",8)(36,"label",9),s(37,"Password *"),i(),n(38,"div",19),m(39,"input",20),n(40,"button",21),h("click",function(){return e.togglePasswordVisibility()}),m(41,"lucide-icon",22),i()(),u(42,Q,2,0,"div",11),i(),n(43,"div",8)(44,"label",9),s(45,"Conferma Password *"),i(),n(46,"div",19),m(47,"input",23),n(48,"button",21),h("click",function(){return e.toggleConfirmPasswordVisibility()}),m(49,"lucide-icon",22),i()(),u(50,W,2,0,"div",11),i()()(),n(51,"div",24)(52,"label",25),m(53,"input",26),n(54,"div",27),s(55," Dichiaro di aver letto, compreso e accettato la "),n(56,"a",28),s(57,"Privacy Policy e i Termini e Condizioni"),i()()()(),u(58,X,2,1,"div",29),n(59,"div",30)(60,"a",31),s(61," \u2190 Hai gi\xE0 un account? Accedi "),i(),n(62,"button",32),u(63,Z,1,0,"span",33)(64,$,2,1,"span",15),i()()()()()()),r&2&&(l("title",e.isRestaurant?"Registra il tuo Ristorante":"Crea Account")("icon",e.isRestaurant?"utensils-crossed":"user")("showToggle",!1),o(4),l("formGroup",e.registerForm),o(2),l("size",20),o(6),c("error",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),o(),l("ngIf",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),o(4),c("error",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),o(),l("ngIf",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),o(5),c("error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),o(),l("ngIf",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),o(5),l("ngIf",e.isRestaurant),o(3),l("size",20),o(7),c("error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),l("type",e.showPassword?"text":"password"),o(2),l("name",e.showPassword?"eye-off":"eye"),o(),l("ngIf",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),o(5),c("error",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),l("type",e.showConfirmPassword?"text":"password"),o(2),l("name",e.showConfirmPassword?"eye-off":"eye"),o(),l("ngIf",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),o(8),l("ngIf",e.errorMessage),o(4),l("disabled",e.registerForm.invalid||e.isLoading),o(),l("ngIf",e.isLoading),o(),l("ngIf",!e.isLoading))},dependencies:[P,N,L,F,k,O,E,I,x,T,A,S,V,q,D],styles:['.gradient-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;justify-content:center;background:var(--background);padding:var(--gutter-sm);position:relative;overflow:hidden}.gradient-container[_ngcontent-%COMP%]:before, .gradient-container[_ngcontent-%COMP%]:after, .gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{content:"";position:absolute;border-radius:50%;filter:blur(90px);opacity:.22;pointer-events:none;animation:vapor 28s ease-in-out infinite}.gradient-container[_ngcontent-%COMP%]:before{width:700px;height:700px;background:radial-gradient(circle at 30%,var(--primary) 0%,transparent 65%);top:-20%;left:-15%;animation-delay:0s}.gradient-container[_ngcontent-%COMP%]:after{width:600px;height:600px;background:radial-gradient(circle at 40%,var(--secondary) 0%,transparent 70%);bottom:-10%;right:-10%;animation-delay:-9s}.gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{width:700px;height:700px;background:radial-gradient(circle at 30% 40%,var(--tertiary) 0%,transparent 70%);top:50%;left:50%;transform:translate(-50%,-50%);animation-delay:-14s;opacity:.15;filter:blur(100px)}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0) translate(0) rotate(0)}33%{transform:translateY(-40px) translate(30px) rotate(120deg)}66%{transform:translateY(30px) translate(-40px) rotate(240deg)}}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]{position:absolute;width:4px;height:4px;background:var(--secondary);border-radius:50%;opacity:0;animation:_ngcontent-%COMP%_sparkle 8s linear infinite}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(1){top:20%;left:15%;animation-delay:1s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(2){top:70%;right:20%;animation-delay:3s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(3){bottom:30%;left:30%;animation-delay:5s}@keyframes _ngcontent-%COMP%_sparkle{0%,to{opacity:0;transform:scale(0)}50%{opacity:.8;transform:scale(1)}}.gradient-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{border-radius:var(--fs-md)}']})};export{j as Register};
