import{a as V,b as A,c as I,d as N,e as q,i as G,l as $,o as U,p as L,q as B,r as j,v as H,x as Q}from"./chunk-HTWH3NPU.js";import{B as F,D as z,d as D,e as O,l as T}from"./chunk-KBL2L3GY.js";import{Cb as x,Gb as _,Hb as c,Na as o,Qb as w,Tb as r,Ub as g,Vb as b,Wb as R,a as P,b as k,cb as C,f as u,ga as y,hb as p,la as h,ma as S,tb as m,ub as a,vb as n,wb as E}from"./chunk-UE7YVF6I.js";function J(s,t){s&1&&(a(0,"span"),r(1,"L'email \xE8 obbligatoria"),n())}function X(s,t){s&1&&(a(0,"span"),r(1,"Inserisci un'email valida"),n())}function Y(s,t){if(s&1&&(a(0,"div",31),p(1,J,2,0,"span",27)(2,X,2,0,"span",27),n()),s&2){let e,i,l=c();o(),m("ngIf",(e=l.staffForm.get("email"))==null||e.errors==null?null:e.errors.required),o(),m("ngIf",(i=l.staffForm.get("email"))==null||i.errors==null?null:i.errors.email)}}function Z(s,t){if(s&1&&(a(0,"option",32),r(1),n()),s&2){let e=t.$implicit;m("value",e.value),o(),b(" ",e.label," ")}}function K(s,t){s&1&&(a(0,"span"),r(1,"Il ruolo \xE8 obbligatorio"),n())}function ee(s,t){if(s&1&&(a(0,"div",31),p(1,K,2,0,"span",27),n()),s&2){let e,i=c();o(),m("ngIf",(e=i.staffForm.get("role"))==null||e.errors==null?null:e.errors.required)}}function te(s,t){if(s&1&&(a(0,"div",33)(1,"strong"),r(2),n(),a(3,"p",34),r(4),n()()),s&2){let e,i,l=c();o(2),g(l.getRoleDisplayName((e=l.staffForm.get("role"))==null?null:e.value)),o(2),g(l.getRoleDescription((i=l.staffForm.get("role"))==null?null:i.value))}}function ie(s,t){s&1&&(a(0,"span",3),r(1,"sync"),n())}function ne(s,t){s&1&&(a(0,"span",3),r(1,"person_add"),n())}function ae(s,t){s&1&&(a(0,"span"),r(1,"Aggiunta in corso..."),n())}function re(s,t){s&1&&(a(0,"span"),r(1,"Aggiungi Membro"),n())}function se(s,t){s&1&&(a(0,"div",38)(1,"span",39),r(2,"group_off"),n(),a(3,"h3",40),r(4,"Nessun membro dello staff"),n(),a(5,"p",6),r(6,"Aggiungi il primo membro del team utilizzando il form sopra."),n()())}function oe(s,t){if(s&1&&(a(0,"div",47)(1,"div",48)(2,"div",49)(3,"span",3),r(4,"email"),n()(),a(5,"div",50)(6,"div",51),r(7),n(),a(8,"div",52)(9,"span",53)(10,"span",3),r(11,"schedule"),n(),r(12," Invito in attesa "),n()()()()()),s&2){let e=c().$implicit;o(7),g(e.email)}}function le(s,t){if(s&1&&(a(0,"div",47)(1,"div",48)(2,"div",54)(3,"span",3),r(4,"person"),n()(),a(5,"div",50)(6,"div",55),r(7),n(),a(8,"div",51),r(9),n()()()()),s&2){let e=c().$implicit;o(7),R("",e.user.first_name," ",e.user.last_name),o(2),g(e.user.email)}}function me(s,t){if(s&1){let e=x();a(0,"div",56)(1,"button",57),_("click",function(){h(e);let l=c().$implicit,d=c(3);return S(d.resendInvitation(l))}),a(2,"span",3),r(3,"send"),n(),r(4," Reinvia "),n(),a(5,"button",58),_("click",function(){h(e);let l=c().$implicit,d=c(3);return S(d.cancelInvitation(l))}),a(6,"span",3),r(7,"cancel"),n(),r(8," Annulla "),n()()}}function de(s,t){s&1&&E(0,"div",56)}function ce(s,t){if(s&1&&(a(0,"div",43),p(1,oe,13,1,"div",44)(2,le,10,3,"div",44),a(3,"div",45),p(4,me,9,0,"div",46)(5,de,1,0,"div",46),n()()),s&2){let e=t.$implicit,i=c(3);w("pending-invitation",i.isPendingInvitation(e)),o(),m("ngIf",e.invitation_status==="pending"),o(),m("ngIf",e.invitation_status==="accepted"&&e.user),o(2),m("ngIf",i.isPendingInvitation(e)),o(),m("ngIf",i.isActiveMember(e))}}function fe(s,t){if(s&1&&(a(0,"div",41),p(1,ce,6,6,"div",42),n()),s&2){let e=c(2);o(),m("ngForOf",e.staffMembers)}}function pe(s,t){if(s&1&&(a(0,"div",8)(1,"div",9)(2,"span",3),r(3,"list"),n(),a(4,"h2",10),r(5,"Team del Ristorante"),n(),a(6,"span",35),r(7),n()(),p(8,se,7,0,"div",36)(9,fe,2,1,"div",37),n()),s&2){let e=c();o(7),b("",e.staffMembers.length," tra membri e inviti"),o(),m("ngIf",e.staffMembers.length===0),o(),m("ngIf",e.staffMembers.length>0)}}function ue(s,t){if(s&1){let e=x();a(0,"label",22)(1,"input",66),_("change",function(l){let d=h(e).$implicit,f=c(2);return S(f.togglePermission("manager",d.key,l))}),n(),a(2,"div")(3,"strong"),r(4),n(),a(5,"div",6),r(6),n()()()}if(s&2){let e=t.$implicit,i=c(2);o(),m("checked",i.isPermissionEnabled("manager",e.key)),o(3),g(e.label),o(2),g(e.description)}}function ge(s,t){if(s&1){let e=x();a(0,"label",22)(1,"input",66),_("change",function(l){let d=h(e).$implicit,f=c(2);return S(f.togglePermission("chef",d.key,l))}),n(),a(2,"div")(3,"strong"),r(4),n(),a(5,"div",6),r(6),n()()()}if(s&2){let e=t.$implicit,i=c(2);o(),m("checked",i.isPermissionEnabled("chef",e.key)),o(3),g(e.label),o(2),g(e.description)}}function _e(s,t){if(s&1){let e=x();a(0,"label",22)(1,"input",66),_("change",function(l){let d=h(e).$implicit,f=c(2);return S(f.togglePermission("waiter",d.key,l))}),n(),a(2,"div")(3,"strong"),r(4),n(),a(5,"div",6),r(6),n()()()}if(s&2){let e=t.$implicit,i=c(2);o(),m("checked",i.isPermissionEnabled("waiter",e.key)),o(3),g(e.label),o(2),g(e.description)}}function ve(s,t){if(s&1){let e=x();a(0,"label",22)(1,"input",66),_("change",function(l){let d=h(e).$implicit,f=c(2);return S(f.togglePermission("kitchen_staff",d.key,l))}),n(),a(2,"div")(3,"strong"),r(4),n(),a(5,"div",6),r(6),n()()()}if(s&2){let e=t.$implicit,i=c(2);o(),m("checked",i.isPermissionEnabled("kitchen_staff",e.key)),o(3),g(e.label),o(2),g(e.description)}}function he(s,t){if(s&1&&(a(0,"div",8)(1,"div",9)(2,"span",3),r(3,"admin_panel_settings"),n(),a(4,"h2",10),r(5,"Gestione Permessi Ruoli"),n(),a(6,"p",6),r(7,"Configura cosa pu\xF2 fare ogni ruolo nel tuo ristorante"),n()(),a(8,"div",59)(9,"div",60)(10,"h3",61)(11,"span",3),r(12,"supervisor_account"),n(),r(13),n(),a(14,"div",62),p(15,ue,7,3,"label",63),n()(),a(16,"div",60)(17,"h3",61)(18,"span",3),r(19,"restaurant"),n(),r(20),n(),a(21,"div",62),p(22,ge,7,3,"label",63),n()(),a(23,"div",60)(24,"h3",61)(25,"span",3),r(26,"person"),n(),r(27),n(),a(28,"div",62),p(29,_e,7,3,"label",63),n()(),a(30,"div",60)(31,"h3",61)(32,"span",3),r(33,"kitchen"),n(),r(34),n(),a(35,"div",62),p(36,ve,7,3,"label",63),n()()(),a(37,"div",64)(38,"p",65)(39,"span",3),r(40,"info"),n(),r(41," I permessi verranno applicati automaticamente ai nuovi membri dello staff "),n()()()),s&2){let e=c();o(13),b(" ",e.getRoleDisplayName("manager")," "),o(2),m("ngForOf",e.allAvailablePermissions),o(5),b(" ",e.getRoleDisplayName("chef")," "),o(2),m("ngForOf",e.allAvailablePermissions),o(5),b(" ",e.getRoleDisplayName("waiter")," "),o(2),m("ngForOf",e.allAvailablePermissions),o(5),b(" ",e.getRoleDisplayName("kitchen_staff")," "),o(2),m("ngForOf",e.allAvailablePermissions)}}function Se(s,t){s&1&&(a(0,"div",67)(1,"div",38)(2,"span",3),r(3,"block"),n(),a(4,"h3"),r(5,"Accesso Negato"),n(),a(6,"p",6),r(7,"Non hai i permessi per gestire il personale del ristorante."),n(),a(8,"p",6),r(9,"Solo il titolare e i responsabili possono accedere a questa sezione."),n()()())}var W=class s{supabase=y(F).getSupabaseClient();fb=y(H);authService=y(z);staffForm;staffMembers=[];loading=!1;addingStaff=!1;showPermissionsSection=!1;savingPermissions={};rolePermissions=[];allAvailablePermissions=[{key:"view_dashboard",label:"Visualizza Dashboard",description:"Accesso alla dashboard principale"},{key:"manage_menu",label:"Gestione Men\xF9",description:"Aggiungere, modificare e eliminare piatti e categorie"},{key:"manage_orders",label:"Gestione Ordini",description:"Visualizzare e gestire gli ordini dei clienti"},{key:"manage_reservations",label:"Gestione Prenotazioni",description:"Gestire le prenotazioni dei tavoli"},{key:"view_reports",label:"Visualizza Report",description:"Accesso ai report finanziari e statistiche"},{key:"view_kitchen_display",label:"Pannello Cucina",description:"Visualizzare gli ordini in cucina"},{key:"manage_inventory",label:"Gestione Inventario",description:"Gestire ingredienti e scorte"},{key:"view_ingredients",label:"Visualizza Ingredienti",description:"Visualizzare la lista ingredienti"},{key:"view_table_map",label:"Mappa Tavoli",description:"Visualizzare la mappa dei tavoli"},{key:"take_orders",label:"Prendere Ordini",description:"Registrare nuovi ordini"},{key:"manage_restaurant_settings",label:"Impostazioni Ristorante",description:"Modificare le impostazioni del ristorante"},{key:"manage_staff",label:"Gestione Staff",description:"Aggiungere e gestire il personale"}];roleOptions=[{value:"manager",label:"Responsabile",description:"Gestione completa eccetto eliminazioni"},{value:"chef",label:"Chef",description:"Cucina e ingredienti"},{value:"waiter",label:"Dipendente di Sala",description:"Prenotazioni e gestione tavoli"},{value:"kitchen_staff",label:"Dipendente di Cucina",description:"Solo visualizzazione cucina"}];constructor(){this.staffForm=this.fb.group({email:["",[I.required,I.email]],role:["",I.required],send_invitation:[!0]})}ngOnInit(){return u(this,null,function*(){console.log("\u{1F50D} StaffManagement OnInit - DEBUG:"),console.log(" - Authenticated:",this.authService.isAuthenticated()),console.log(" - User:",this.authService.currentUserValue),console.log(" - Staff:",this.authService.getCurrentStaff()),console.log(" - Staff Role:",this.authService.getStaffRole()),console.log(" - Restaurant ID:",this.authService.getCurrentRestaurantId()),yield this.loadStaffMembers(),yield this.loadRolePermissions()})}loadStaffMembers(){return u(this,null,function*(){this.loading=!0;try{let t=this.authService.getCurrentRestaurantId();if(!t){console.error("Nessun ristorante associato");return}console.log("\u{1F50D} Loading staff for restaurant:",t);let{data:e,error:i}=yield this.supabase.from("restaurant_staff").select("*").eq("restaurant_id",t).in("invitation_status",["pending","accepted"]).order("created_at",{ascending:!1});if(i)throw console.error("\u274C Error loading staff:",i),i;let l=yield Promise.all((e||[]).map(d=>u(this,null,function*(){let f=null,v=null;if(d.user_id){let{data:M}=yield this.supabase.from("users").select("id, first_name, last_name, email, phone").eq("id",d.user_id).single();f=M}if(d.invited_by){let{data:M}=yield this.supabase.from("users").select("first_name, last_name").eq("id",d.invited_by).single();v=M}return k(P({},d),{user:f,inviter:v})})));console.log("\u2705 Staff loaded with users:",l.length),this.staffMembers=l}catch(t){console.error("Error loading staff members:",t),alert("Errore nel caricamento del personale: "+t.message)}finally{this.loading=!1}})}onAddStaff(){return u(this,null,function*(){if(!this.staffForm.invalid){this.addingStaff=!0;try{let t=this.staffForm.value,e=this.authService.getCurrentRestaurantId(),i=this.authService.currentUserValue;if(!e||!i)throw new Error("Ristorante o utente non trovato");let{data:l}=yield this.supabase.from("restaurant_staff").select("id").eq("restaurant_id",e).eq("email",t.email.toLowerCase().trim()).eq("invitation_status","pending").single();if(l)throw new Error("Esiste gi\xE0 un invito pendente per questa email");let{error:d}=yield this.supabase.from("restaurant_staff").insert({restaurant_id:e,email:t.email.toLowerCase().trim(),role:t.role,invitation_status:"pending",invitation_token:this.generateToken(),invitation_expires_at:new Date(Date.now()+720*60*60*1e3).toISOString(),invited_by:i.id,permissions:yield this.getRolePermissions(t.role)});if(d)throw d;alert("Invito creato con successo!"),this.staffForm.reset(),yield this.loadStaffMembers()}catch(t){alert("Errore: "+t.message),console.error("Error in onAddStaff:",t)}finally{this.addingStaff=!1}}})}getRolePermissions(t){return u(this,null,function*(){let e=this.authService.getCurrentRestaurantId();if(!e)return this.getDefaultPermissions(t);try{let{data:i,error:l}=yield this.supabase.from("restaurant_role_permissions").select("permissions").eq("restaurant_id",e).eq("role",t).single();if(l){if(l.code==="PGRST116")return this.getDefaultPermissions(t);throw l}return i.permissions||this.getDefaultPermissions(t)}catch(i){return console.error("Error getting role permissions:",i),this.getDefaultPermissions(t)}})}getPermissionsStatus(){console.log("\u{1F50D} DEBUG Permissions Status:"),console.log(" - Restaurant ID:",this.authService.getCurrentRestaurantId()),console.log(" - Role Permissions loaded:",this.rolePermissions.length),this.rolePermissions.forEach(t=>{console.log(`   - ${t.role}:`,t.permissions)})}updateExistingStaffPermissions(t){return u(this,null,function*(){if(!confirm(`Vuoi applicare i nuovi permessi a tutti i membri esistenti con ruolo "${this.getRoleDisplayName(t)}"?`))return;let e=this.authService.getCurrentRestaurantId();if(e)try{let i=this.rolePermissions.find(d=>d.role===t);if(!i)return;let{error:l}=yield this.supabase.from("restaurant_staff").update({permissions:i.permissions,updated_at:new Date().toISOString()}).eq("restaurant_id",e).eq("role",t).eq("invitation_status","accepted");if(l)throw l;yield this.authService.loadPermissions(),alert(`Permessi aggiornati per tutti i membri con ruolo ${this.getRoleDisplayName(t)}`)}catch(i){console.error("Error updating staff permissions:",i),alert("Errore nell'aggiornamento dei permessi: "+i.message)}})}generateToken(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}generateTemporaryPassword(){return Math.random().toString(36).slice(-8)+"A1!"}getDefaultPermissions(t){return{manager:["view_dashboard","manage_menu","manage_orders","manage_reservations","view_reports","view_kitchen_display","manage_inventory","view_ingredients","view_table_map","take_orders","manage_restaurant_settings","manage_staff"],chef:["view_dashboard","view_kitchen_display","manage_inventory","view_ingredients"],waiter:["view_dashboard","manage_reservations","take_orders"],kitchen_staff:["view_kitchen_display"]}[t]||[]}getRoleDisplayName(t){return{manager:"Responsabile",chef:"Chef",waiter:"Cameriere",kitchen_staff:"Staff Cucina"}[t]||t}getRoleDescription(t){return{owner:"Accesso completo a tutte le funzionalit\xE0",manager:"Gestione completa eccetto eliminazioni definitive",chef:"Gestione cucina, ingredienti e inventario",waiter:"Gestione prenotazioni, tavoli e ordini",kitchen_staff:"Visualizzazione ordini in cucina"}[t]||"Ruolo del personale"}updateStaffRole(t,e){return u(this,null,function*(){if(!this.canEditStaff(t)){alert("Non hai i permessi per modificare questo membro dello staff");return}if(confirm(`Sei sicuro di voler cambiare il ruolo di ${t.user?.first_name} ${t.user?.last_name} in ${this.getRoleDisplayName(e)}?`))try{let{error:i}=yield this.supabase.from("restaurant_staff").update({role:e,permissions:this.getDefaultPermissions(e),updated_at:new Date().toISOString()}).eq("id",t.id);if(i)throw i;yield this.loadStaffMembers(),alert("Ruolo aggiornato con successo!")}catch(i){console.error("Error updating staff role:",i),alert("Errore: "+i.message)}})}removeStaff(t){return u(this,null,function*(){if(!this.canRemoveStaff(t)){alert("Non hai i permessi per rimuovere questo membro dello staff");return}if(confirm(`Sei sicuro di voler rimuovere ${t.user?.first_name} ${t.user?.last_name} dallo staff? Questa azione non pu\xF2 essere annullata.`))try{let{error:e}=yield this.supabase.from("restaurant_staff").delete().eq("id",t.id);if(e)throw e;yield this.loadStaffMembers(),alert("Membro rimosso con successo dallo staff!")}catch(e){console.error("Error removing staff:",e),alert("Errore: "+e.message)}})}markFormGroupTouched(){Object.keys(this.staffForm.controls).forEach(t=>{this.staffForm.get(t)?.markAsTouched()})}isFieldInvalid(t){let e=this.staffForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}ngAfterViewInit(){console.log("\u{1F50D} DEBUG Staff Management:"),console.log(" - Utente autenticato:",this.authService.isAuthenticated()),console.log(" - Utente ristorante:",this.authService.isRestaurantUser()),console.log(" - Ruolo staff:",this.authService.getStaffRole()),console.log(" - isOwner():",this.authService.isOwner()),console.log(" - isManager():",this.authService.isManager()),console.log(" - Staff record:",this.authService.getCurrentStaff()),console.log(" - Restaurant ID:",this.authService.getCurrentRestaurantId())}canEditStaff(t){let e=this.authService.isOwner(),i=this.authService.getStaffRole();return e?!0:i==="manager"?t.role!=="manager":!1}canRemoveStaff(t){let e=this.authService.isOwner(),i=this.authService.getStaffRole();return e?!0:i==="manager"?["chef","waiter","kitchen_staff"].includes(t.role):!1}isPendingInvitation(t){return t.invitation_status==="pending"}isActiveMember(t){return t.invitation_status==="accepted"}getInvitationStatusDisplay(t){return{pending:"In attesa",accepted:"Accettato",active:"Attivo",expired:"Scaduto"}[t]||t}resendInvitation(t){return u(this,null,function*(){try{console.log(`Reinvio invito a ${t.email}`),alert("Invito reinviato (funzionalit\xE0 email da implementare)")}catch(e){console.error("Error resending invitation:",e),alert("Errore: "+e.message)}})}cancelInvitation(t){return u(this,null,function*(){if(confirm(`Sei sicuro di voler annullare l'invito per ${t.email}?`))try{let{error:e}=yield this.supabase.from("restaurant_staff").delete().eq("id",t.id);if(e)throw e;yield this.loadStaffMembers(),alert("Invito annullato con successo!")}catch(e){console.error("Error canceling invitation:",e),alert("Errore: "+e.message)}})}togglePermission(t,e,i){return u(this,null,function*(){let l=i.target.checked,d=this.rolePermissions.find(v=>v.role===t);if(!d)return;this.savingPermissions[t]=!0;let f=[...d.permissions];l?f.includes(e)||f.push(e):f=f.filter(v=>v!==e);try{yield this.updateRolePermissions(t,f)}catch(v){i.target.checked=!l,console.error("Errore nel salvataggio del permesso:",v)}finally{this.savingPermissions[t]=!1}})}updateRolePermissions(t,e){return u(this,null,function*(){let i=this.authService.getCurrentRestaurantId();if(!i)return console.error("Nessun restaurantId trovato"),!1;try{let{data:l,error:d}=yield this.supabase.from("restaurant_role_permissions").select("id").eq("restaurant_id",i).eq("role",t).single(),f;if(d&&d.code!=="PGRST116")throw d;if(l?f=yield this.supabase.from("restaurant_role_permissions").update({permissions:e,updated_at:new Date().toISOString()}).eq("id",l.id):f=yield this.supabase.from("restaurant_role_permissions").insert({restaurant_id:i,role:t,permissions:e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),f.error)throw f.error;return yield this.authService.loadPermissions(),console.log(`\u2705 Permessi aggiornati per il ruolo: ${t}`),!0}catch(l){return console.error("\u274C Errore aggiornamento permessi:",l),alert("Errore nel salvataggio dei permessi: "+l.message),!1}})}isPermissionEnabled(t,e){return this.rolePermissions.find(l=>l.role===t)?.permissions.includes(e)||!1}loadRolePermissions(){return u(this,null,function*(){let t=this.authService.getCurrentRestaurantId();if(t)try{let{data:e,error:i}=yield this.supabase.from("restaurant_role_permissions").select("*").eq("restaurant_id",t);if(i)throw i;this.rolePermissions=e||[],this.rolePermissions.length===0&&(yield this.createDefaultPermissions())}catch(e){console.error("Errore caricamento permessi:",e)}})}createDefaultPermissions(){return u(this,null,function*(){let t=this.authService.getCurrentRestaurantId();if(!t)return;let e=[{role:"manager",permissions:["view_dashboard","manage_menu","manage_orders","manage_reservations","view_reports","view_kitchen_display","manage_inventory","view_ingredients","view_table_map","take_orders","manage_restaurant_settings"]},{role:"chef",permissions:["view_dashboard","view_kitchen_display","manage_inventory","view_ingredients"]},{role:"waiter",permissions:["view_dashboard","manage_reservations","take_orders"]},{role:"kitchen_staff",permissions:["view_kitchen_display"]}];try{for(let i of e){let{error:l}=yield this.supabase.from("restaurant_role_permissions").insert({restaurant_id:t,role:i.role,permissions:i.permissions});if(l)throw l}yield this.loadRolePermissions()}catch(i){console.error("Errore creazione permessi predefiniti:",i)}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=C({type:s,selectors:[["app-staff-management"]],decls:58,vars:18,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"card-content"],[1,"form-section"],[1,"card-header"],[1,"card-title"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"grid-form"],[1,"form-group"],[1,"form-label"],["type","email","formControlName","email","placeholder","mario.rossi@example.com"],["class","error-message",4,"ngIf"],["formControlName","role"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","mt-2 p-3 bg-blue-50 rounded-lg",4,"ngIf"],[1,"form-group",2,"grid-column","1 / -1"],[1,"checkbox-label","large"],["type","checkbox","formControlName","send_invitation"],[1,"form-actions"],["type","submit",1,"promethea-button",3,"disabled"],["class","material-icons",4,"ngIf"],[4,"ngIf"],["type","button",1,"promethea-button","secondary",3,"click","disabled"],["class","form-section",4,"ngIf"],["class","card",4,"ngIf"],[1,"error-message"],[3,"value"],[1,"mt-2","p-3","bg-blue-50","rounded-lg"],[1,"text-sm","text-blue-700","mt-1"],[1,"chip"],["class","empty-state",4,"ngIf"],["class","team-grid",4,"ngIf"],[1,"empty-state"],[1,"material-icons","text-6xl","text-gray-400","mb-4"],[1,"text-xl","font-semibold","mb-2"],[1,"team-grid"],["class","staff-item",3,"pending-invitation",4,"ngFor","ngForOf"],[1,"staff-item"],["class","staff-info",4,"ngIf"],[1,"staff-actions"],["class","action-group",4,"ngIf"],[1,"staff-info"],[1,"staff-main"],[1,"staff-avatar","pending"],[1,"staff-details"],[1,"staff-email"],[1,"staff-meta"],[1,"staff-status","pending"],[1,"staff-avatar"],[1,"staff-name"],[1,"action-group"],["title","Reinvia invito",1,"btn-action",3,"click"],["title","Annulla invito",1,"btn-delete","btn-action",3,"click"],[1,"settings-grid"],[1,"form-subsection"],[1,"subsection-title"],[1,"grid-alternative"],["class","checkbox-label large",4,"ngFor","ngForOf"],[1,"form-footer"],[1,"text-muted","text-center"],["type","checkbox",3,"change","checked"],[1,"card"]],template:function(e,i){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),r(4,"groups"),n()(),a(5,"div",4)(6,"h1",5),r(7,"Gestione Personale"),n(),a(8,"p",6),r(9,"Gestisci il team del tuo ristorante"),n()()(),a(10,"div",7)(11,"div",8)(12,"div",9)(13,"span",3),r(14,"person_add"),n(),a(15,"h2",10),r(16,"Aggiungi Nuovo Membro"),n()(),a(17,"form",11),_("ngSubmit",function(){return i.onAddStaff()}),a(18,"div",12)(19,"div",13)(20,"label",14)(21,"span",3),r(22,"email"),n(),r(23," Email * "),n(),E(24,"input",15),p(25,Y,3,2,"div",16),n(),a(26,"div",13)(27,"label",14)(28,"span",3),r(29,"badge"),n(),r(30," Ruolo * "),n(),a(31,"select",17)(32,"option",18),r(33,"Seleziona un ruolo"),n(),p(34,Z,2,2,"option",19),n(),p(35,ee,2,1,"div",16)(36,te,5,2,"div",20),n(),a(37,"div",21)(38,"label",22),E(39,"input",23),a(40,"div")(41,"strong"),r(42,"Invia invito via email"),n(),a(43,"div",6),r(44,"Invia un'email di invito con le credenziali di accesso"),n()()()()(),a(45,"div",24)(46,"button",25),p(47,ie,2,0,"span",26)(48,ne,2,0,"span",26)(49,ae,2,0,"span",27)(50,re,2,0,"span",27),n(),a(51,"button",28),_("click",function(){return i.staffForm.reset({send_invitation:!0})}),a(52,"span",3),r(53,"clear"),n(),r(54," Pulisci "),n()()()(),p(55,pe,10,3,"div",29),n(),p(56,he,42,8,"div",29)(57,Se,10,0,"div",30),n()),e&2){let l;o(17),m("formGroup",i.staffForm),o(7),w("error",i.isFieldInvalid("email")),o(),m("ngIf",i.isFieldInvalid("email")),o(6),w("error",i.isFieldInvalid("role")),o(3),m("ngForOf",i.roleOptions),o(),m("ngIf",i.isFieldInvalid("role")),o(),m("ngIf",(l=i.staffForm.get("role"))==null?null:l.value),o(10),m("disabled",i.staffForm.invalid||i.addingStaff),o(),m("ngIf",i.addingStaff),o(),m("ngIf",!i.addingStaff),o(),m("ngIf",i.addingStaff),o(),m("ngIf",!i.addingStaff),o(),m("disabled",i.addingStaff),o(4),m("ngIf",!i.loading),o(),m("ngIf",i.authService.isOwner()),o(),m("ngIf",!(i.authService.isOwner()||i.authService.isManager()))}},dependencies:[T,D,O,Q,G,B,j,A,V,L,N,q,$,U],styles:[".staff-item.pending-invitation[_ngcontent-%COMP%]{opacity:.7;border-style:dashed}.member-avatar.preparing[_ngcontent-%COMP%]{background:var(--gradiente-light)}.member-status[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);flex-wrap:wrap;margin-top:var(--gutter-sm)}.grid-alternative[_ngcontent-%COMP%]{gap:var(--gutter-sm)}.action-group[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);flex-wrap:wrap}@media (max-width: 768px){.team-member[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gutter-md)}.action-buttons[_ngcontent-%COMP%]{width:100%}.action-group[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.action-group[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{flex:1;min-width:120px}}"]})};export{W as StaffManagement};
