import{a as ae}from"./chunk-Z7AIH4JL.js";import{a as oe}from"./chunk-OHYT2MFI.js";import{a as re}from"./chunk-4AAJDU75.js";import{a as C}from"./chunk-3SRQJDPW.js";import"./chunk-6N7TSVOQ.js";import"./chunk-ISGJYCJJ.js";import{a as j,b as U,c as f,d as B,e as R,i as H,j as K,m as W,p as J,q as X,r as Y,s as Z,u as ee,v as te,w as ie,y as ne}from"./chunk-LDJ3K2AA.js";import"./chunk-NPOGW2A3.js";import{c as D,d as $,i as A,l as Q,q as z}from"./chunk-SSGQXIGB.js";import{Aa as l,Ab as x,Bb as y,Cb as k,G,Nb as N,Pb as q,Qa as O,V as F,Va as g,_ as I,ab as M,bb as d,cb as n,da as m,db as i,ea as _,eb as S,kb as w,nb as p,pb as u,wb as b,yb as P,zb as r}from"./chunk-UNLQURJ5.js";import{a as E,b as T,j as v}from"./chunk-4ZZIO3ZI.js";var L=class s extends C{constructor(){super(),this.loadData()}getTableName(){return"ingredient_groups"}loadData(){return v(this,null,function*(){try{this.loadingSubject.next(!0),console.log("\u{1F504} Caricamento gruppi ingredienti (globali)...");let{data:t,error:e}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).select(`
          *,
          ingredients:ingredients(count)
        `).eq("is_active",!0).order("sort_order").order("name");if(e)throw console.error("\u274C Errore query gruppi:",e),e;console.log(`\u2705 ${t?.length||0} gruppi caricati con successo`);let o=(t||[]).map(a=>T(E({},a),{ingredient_count:a.ingredients?.[0]?.count||0}));this.dataSubject.next(o)}catch(t){console.error("Error loading ingredient groups:",t),this.handleError("loadData",t)}finally{this.loadingSubject.next(!1)}})}getCurrentRestaurantId(){return v(this,null,function*(){return null})}getGroups(){return this.dataSubject.value}getGroupById(t){return this.dataSubject.value.find(e=>e.id===t)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=F({token:s,factory:s.\u0275fac,providedIn:"root"})};var V=class s extends C{constructor(){super(),this.loadData()}getTableName(){return"ingredient_types"}loadData(){return v(this,null,function*(){try{this.loadingSubject.next(!0);let{data:t,error:e}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).select(`
          *,
          group:ingredient_groups(*),
          ingredients:ingredients(count)
        `).eq("is_active",!0).order("name");if(e)throw e;let o=(t||[]).map(a=>T(E({},a),{ingredient_count:a.ingredients?.[0]?.count||0}));this.dataSubject.next(o)}catch(t){console.error("Error loading ingredient types:",t),this.handleError("loadData",t)}finally{this.loadingSubject.next(!1)}})}createType(t){return v(this,null,function*(){try{let o=(yield this.authService.currentUser$.pipe(G(1)).toPromise())?.id;if(!o)throw new Error("Utente non autenticato");let a=T(E({},t),{is_system:!1,created_by_user_id:o,restaurant_id:null}),{data:c,error:h}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).insert(a).select(`
        *,
        group:ingredient_groups(*)
      `).single();if(h)throw h;return yield this.loadData(),c}catch(e){return console.error("Error creating type:",e),null}})}updateType(t,e){return v(this,null,function*(){try{let{error:o}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).update(e).eq("id",t);if(o)throw o;return yield this.loadData(),!0}catch(o){return console.error("Error updating type:",o),!1}})}deleteType(t){return v(this,null,function*(){try{let{data:e,error:o}=yield this.supabaseService.getSupabaseClient().from("ingredients").select("id").eq("type_id",t).eq("is_active",!0).limit(1);if(o)throw o;if(e&&e.length>0)throw new Error("Non puoi eliminare una tipologia con ingredienti associati");let{error:a}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).update({is_active:!1}).eq("id",t);if(a)throw a;return yield this.loadData(),!0}catch(e){throw console.error("Error deleting type:",e),e}})}getTypes(){return this.dataSubject.value}getTypeById(t){return this.dataSubject.value.find(e=>e.id===t)}getTypesByGroup(t){return this.dataSubject.value.filter(e=>e.group_id===t)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=F({token:s,factory:s.\u0275fac,providedIn:"root"})};function de(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),y(" ",e.name," ")}}function ce(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),y(" ",e.name," ")}}function pe(s,t){if(s&1&&(n(0,"span",44),r(1),i()),s&2){let e=u();l(),y(" (",e.getShoppingList().length,") ")}}function ue(s,t){s&1&&(n(0,"tr")(1,"td",45)(2,"div",46)(3,"span",47),r(4,"refresh"),i(),n(5,"span"),r(6,"Caricamento ingredienti..."),i()()()())}function me(s,t){if(s&1&&(n(0,"span",44),r(1),i()),s&2){let e=u().$implicit,o=u();l(),y(" (+",o.formatQuantity(e.to_buy_quantity,e),") ")}}function _e(s,t){if(s&1){let e=w();n(0,"tr",48)(1,"td")(2,"strong"),r(3),i()(),n(4,"td")(5,"span",5),r(6),i()(),n(7,"td")(8,"span"),r(9),g(10,me,2,1,"span",33),i()(),n(11,"td")(12,"span",5),r(13),i()(),n(14,"td")(15,"strong"),r(16),N(17,"number"),i()(),n(18,"td")(19,"span",49),r(20),i()(),n(21,"td")(22,"div",2)(23,"button",50),p("click",function(){let a=m(e).$implicit,c=u();return _(a.to_buy?c.removeFromShoppingList(a):c.addToShoppingList(a))}),n(24,"span",20),r(25),i()(),n(26,"button",51),p("click",function(){let a=m(e).$implicit,c=u();return _(c.editIngredient(a))}),n(27,"span",20),r(28,"edit"),i()(),n(29,"button",52),p("click",function(){let a=m(e).$implicit,c=u();return _(c.deleteIngredient(a.id))}),n(30,"span",20),r(31,"delete"),i()()()()()}if(s&2){let e=t.$implicit,o=u();b("bg-green-50",e.to_buy),l(3),x(e.name),l(3),x(e.description||"Nessuna descrizione"),l(2),b("text-red-500",e.current_stock<=e.minimum_stock),l(),k(" ",e.current_stock," ",o.getUnitSymbol(e.unit_id)," "),l(),d("ngIf",e.to_buy&&e.to_buy_quantity),l(3),x(o.getSupplierName(e)),l(3),y("\u20AC",q(17,18,e.cost_per_unit,"1.2-2")),l(3),P(o.getStockStatus(e).class),l(),y(" ",o.getStockStatus(e).text," "),l(3),b("text-green-500",e.to_buy),d("title",e.to_buy?"Rimuovi dalla lista spesa":"Aggiungi alla lista spesa"),l(2),y(" ",e.to_buy?"shopping_cart_checkout":"add_shopping_cart"," ")}}function ge(s,t){s&1&&(n(0,"p",56),r(1," Prova a modificare i filtri di ricerca "),i())}function ye(s,t){if(s&1){let e=w();n(0,"tr")(1,"td",53)(2,"div",54)(3,"span",20),r(4,"search_off"),i(),n(5,"h3"),r(6,"Nessun ingrediente trovato"),i(),g(7,ge,2,0,"p",55),n(8,"button",35),p("click",function(){m(e);let a=u();return _(a.newIngredient())}),n(9,"span",20),r(10,"add"),i(),r(11," Aggiungi il primo ingrediente "),i()()()()}if(s&2){let e=u();l(7),d("ngIf",e.searchTerm||e.showLowStockOnly)}}function ve(s,t){s&1&&(n(0,"div",99),r(1," Il nome \xE8 obbligatorio e deve essere di almeno 2 caratteri "),i())}function he(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function fe(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function xe(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),k(" ",e.name," (",e.symbol,") ")}}function Se(s,t){s&1&&(n(0,"div",99),r(1," Il costo per unit\xE0 \xE8 obbligatorio "),i())}function be(s,t){s&1&&(n(0,"div",99),r(1," La scorta attuale \xE8 obbligatoria "),i())}function Ie(s,t){s&1&&(n(0,"div",99),r(1," La scorta minima \xE8 obbligatoria "),i())}function Ee(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),y(" ",e.name," ")}}function Te(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),y(" ",e.name," ")}}function we(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit;d("value",e.id),l(),y(" ",e.company_name," ")}}function ke(s,t){if(s&1){let e=w();n(0,"div",57),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(1,"div",58),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",59)(3,"div",60)(4,"div",61)(5,"span",20),r(6),i()(),n(7,"div")(8,"h1",4),r(9),i()()(),n(10,"button",62),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(11,"span",20),r(12,"close"),i()()(),n(13,"form",63),p("ngSubmit",function(){m(e);let a=u();return _(a.onSubmit())}),n(14,"div",64)(15,"label",65)(16,"span",20),r(17,"label"),i(),r(18," Nome Ingrediente * "),i(),S(19,"input",66),g(20,ve,2,0,"div",67),i(),n(21,"div",28)(22,"div",64)(23,"label",68)(24,"span",20),r(25,"straighten"),i(),r(26," Unit\xE0 di Misura "),i(),n(27,"select",69)(28,"option",26),r(29,"Seleziona unit\xE0"),i(),n(30,"optgroup",70),g(31,he,2,3,"option",27),i(),n(32,"optgroup",71),g(33,fe,2,3,"option",27),i(),n(34,"optgroup",72),g(35,xe,2,3,"option",27),i()()(),n(36,"div",64)(37,"label",73)(38,"span",20),r(39,"euro"),i(),r(40," Costo per Unit\xE0 * "),i(),S(41,"input",74),g(42,Se,2,0,"div",67),i()(),n(43,"div",75)(44,"label",76)(45,"span",20),r(46,"description"),i(),r(47," Descrizione "),i(),S(48,"textarea",77),i(),n(49,"div",28)(50,"div",78)(51,"label",79)(52,"span",20),r(53,"inventory"),i(),r(54," Scorta Attuale * "),i(),S(55,"input",80),g(56,be,2,0,"div",67),i(),n(57,"div",78)(58,"label",81)(59,"span",20),r(60,"warning"),i(),r(61," Scorta Minima * "),i(),S(62,"input",82),g(63,Ie,2,0,"div",67),i()(),n(64,"div",28)(65,"div",78)(66,"label",83)(67,"span",20),r(68,"category"),i(),r(69," Gruppo "),i(),n(70,"select",84),p("change",function(){m(e);let a=u();return _(a.onGroupChangeInForm())}),n(71,"option",26),r(72,"Nessun gruppo"),i(),g(73,Ee,2,2,"option",27),i()(),n(74,"div",78)(75,"label",85)(76,"span",20),r(77,"label"),i(),r(78," Tipologia "),i(),n(79,"div",86)(80,"select",87)(81,"option",26),r(82,"Nessuna tipologia"),i(),g(83,Te,2,2,"option",27),i(),n(84,"button",88),p("click",function(){m(e);let a=u();return _(a.openTypeModal())}),n(85,"span",20),r(86,"add"),i()()(),n(87,"div",89),r(88," Le tipologie dipendono dal gruppo selezionato "),i()()(),n(89,"div",78)(90,"label",90)(91,"span",20),r(92,"local_shipping"),i(),r(93," Fornitore "),i(),n(94,"div",86)(95,"select",91)(96,"option",26),r(97,"Nessun fornitore"),i(),g(98,we,2,2,"option",27),i(),n(99,"div",2)(100,"button",92),p("click",function(){m(e);let a=u();return _(a.goToSupplierManager())}),n(101,"span",20),r(102,"add"),i()()()()(),n(103,"div",28)(104,"div",78)(105,"label",93)(106,"span",20),r(107,"event"),i(),r(108," Data di Scadenza "),i(),S(109,"input",94),i(),n(110,"div",78)(111,"label",30),S(112,"input",95),n(113,"div",32)(114,"strong"),r(115,"Attiva avvisi scorta bassa"),i(),n(116,"div",5),r(117,"Ricevi un avviso quando la scorta scende sotto il livello minimo"),i()()()()()(),n(118,"div",96)(119,"button",97),p("click",function(){m(e);let a=u();return _(a.resetForm())}),n(120,"span",20),r(121,"close"),i(),r(122," Annulla "),i(),n(123,"button",98),p("click",function(){m(e);let a=u();return _(a.onSubmit())}),n(124,"span",20),r(125),i(),r(126),i()()()()}if(s&2){let e=u();l(6),x(e.isEditing?"edit":"add_circle"),l(3),x(e.isEditing?"Modifica Ingrediente":"Nuovo Ingrediente"),l(4),d("formGroup",e.ingredientForm),l(6),b("border-red-500",(e.name==null?null:e.name.invalid)&&(e.name==null?null:e.name.touched)),l(),d("ngIf",(e.name==null?null:e.name.invalid)&&(e.name==null?null:e.name.touched)),l(11),d("ngForOf",e.getUnitsByType("weight")),l(2),d("ngForOf",e.getUnitsByType("volume")),l(2),d("ngForOf",e.getUnitsByType("piece")),l(6),b("border-red-500",(e.cost_per_unit==null?null:e.cost_per_unit.invalid)&&(e.cost_per_unit==null?null:e.cost_per_unit.touched)),l(),d("ngIf",(e.cost_per_unit==null?null:e.cost_per_unit.invalid)&&(e.cost_per_unit==null?null:e.cost_per_unit.touched)),l(13),b("border-red-500",(e.current_stock==null?null:e.current_stock.invalid)&&(e.current_stock==null?null:e.current_stock.touched)),l(),d("ngIf",(e.current_stock==null?null:e.current_stock.invalid)&&(e.current_stock==null?null:e.current_stock.touched)),l(6),b("border-red-500",(e.minimum_stock==null?null:e.minimum_stock.invalid)&&(e.minimum_stock==null?null:e.minimum_stock.touched)),l(),d("ngIf",(e.minimum_stock==null?null:e.minimum_stock.invalid)&&(e.minimum_stock==null?null:e.minimum_stock.touched)),l(10),d("ngForOf",e.sortedIngredientGroups),l(7),d("disabled",!e.getFilteredTypesForForm().length),l(3),d("ngForOf",e.getFilteredTypesForForm()),l(15),d("ngForOf",e.suppliers),l(25),d("disabled",e.ingredientForm.invalid),l(2),x(e.isEditing?"save":"add"),l(),y(" ",e.isEditing?"Aggiorna":"Crea"," Ingrediente ")}}function Fe(s,t){s&1&&(n(0,"div",54)(1,"span",20),r(2,"shopping_basket"),i(),n(3,"h3"),r(4,"Nessun ingrediente nella lista"),i(),n(5,"p",5),r(6,"Clicca sull'icona del carrello per aggiungere ingredienti"),i()())}function Ce(s,t){if(s&1){let e=w();n(0,"tr")(1,"td")(2,"strong"),r(3),i()(),n(4,"td")(5,"div",110)(6,"button",111),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.decreaseQuantity(a))}),n(7,"span",20),r(8,"remove"),i()(),n(9,"div",112)(10,"input",113),p("change",function(a){let c=m(e).$implicit,h=u(3);return _(h.updateShoppingListQuantity(c,a))}),i()(),n(11,"button",111),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.increaseQuantity(a))}),n(12,"span",20),r(13,"add"),i()()()(),n(14,"td")(15,"span",114),r(16),i()(),n(17,"td"),r(18),i(),n(19,"td"),r(20),i(),n(21,"td")(22,"button",115),p("click",function(){let a=m(e).$implicit,c=u(3);return _(c.removeFromShoppingList(a))}),n(23,"span",20),r(24,"remove_shopping_cart"),i()()()()}if(s&2){let e=t.$implicit,o=u(3);l(3),x(e.name),l(3),d("title","Diminuisci di "+o.getQuantityStep(e)),l(4),d("step",o.getQuantityStep(e))("min",o.allowsDecimals(e)?.1:1)("value",e.to_buy_quantity||o.getStandardQuantity(e)),M("inputmode",o.allowsDecimals(e)?"decimal":"numeric"),l(),d("title","Aumenta di "+o.getQuantityStep(e)),l(5),x(o.getUnitSymbol(e.unit_id)),l(2),x(o.getSupplierName(e)),l(2),y("\u20AC",(e.cost_per_unit*(e.to_buy_quantity||1)).toFixed(2))}}function Le(s,t){if(s&1&&(n(0,"div")(1,"table",39)(2,"thead")(3,"tr")(4,"th"),r(5,"Ingrediente"),i(),n(6,"th"),r(7,"Quantit\xE0"),i(),n(8,"th"),r(9,"Unit\xE0"),i(),n(10,"th"),r(11,"Fornitore"),i(),n(12,"th"),r(13,"Costo"),i(),n(14,"th"),r(15,"Azioni"),i()()(),n(16,"tbody"),g(17,Ce,25,10,"tr",105),i()(),n(18,"div",106)(19,"div",107)(20,"div")(21,"h3",108),r(22,"Totale stimato"),i()(),n(23,"div",109),r(24),i()()()()),s&2){let e=u(2);l(17),d("ngForOf",e.getShoppingList()),l(7),y(" \u20AC",e.shoppingListTotal.toFixed(2)," ")}}function Ve(s,t){if(s&1){let e=w();n(0,"div",57),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(1,"div",58),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",59)(3,"div",60)(4,"div",61)(5,"span",20),r(6,"shopping_cart"),i()(),n(7,"div")(8,"h1",4),r(9,"Lista della Spesa"),i(),n(10,"p",5),r(11),i()()(),n(12,"button",62),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(13,"span",20),r(14,"close"),i()()(),n(15,"div",100)(16,"div",101),g(17,Fe,7,0,"div",102)(18,Le,25,2,"div",40),i()(),n(19,"div",96)(20,"button",36),p("click",function(){m(e);let a=u();return _(a.showShoppingList=!1)}),n(21,"span",20),r(22,"close"),i(),r(23," Chiudi "),i(),n(24,"button",103),p("click",function(){m(e);let a=u();return _(a.printShoppingList())}),n(25,"span",20),r(26,"print"),i(),r(27," Stampa Lista "),i(),n(28,"button",104),p("click",function(){m(e);let a=u();return _(a.clearShoppingList())}),n(29,"span",20),r(30,"check_circle"),i(),r(31," Acquisto Completato "),i()()()()}if(s&2){let e=u();l(11),y("",e.getShoppingList().length," ingredienti da acquistare"),l(6),d("ngIf",e.getShoppingList().length===0),l(),d("ngIf",e.getShoppingList().length>0),l(6),d("disabled",e.getShoppingList().length===0),l(4),d("disabled",e.getShoppingList().length===0)}}function Ge(s,t){if(s&1&&(n(0,"option",43),r(1),i()),s&2){let e=t.$implicit,o=t.index;d("value",e.id),l(),k(" ",e.name," (",o,") ")}}function Oe(s,t){s&1&&(n(0,"div",99),r(1," Seleziona un gruppo "),i())}function Me(s,t){s&1&&(n(0,"div",99),r(1," Il nome \xE8 obbligatorio (min. 2 caratteri) "),i())}function Pe(s,t){s&1&&(n(0,"div",125)(1,"div",2)(2,"span",126),r(3,"info"),i(),n(4,"div",127),r(5," Questa tipologia sar\xE0 visibile a "),n(6,"strong"),r(7,"tutti i ristoranti"),i(),r(8,". "),i()()())}function Ne(s,t){if(s&1){let e=w();n(0,"div",57),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(1,"div",116),p("click",function(a){return m(e),_(a.stopPropagation())}),n(2,"div",59)(3,"div",60)(4,"div",61)(5,"span",20),r(6,"add_circle"),i()(),n(7,"div")(8,"h1",4),r(9,"Nuova Tipologia"),i(),n(10,"p",5),r(11,"Crea una nuova tipologia di ingrediente"),i()()(),n(12,"button",62),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(13,"span",20),r(14,"close"),i()()(),n(15,"div",101)(16,"form",117),p("ngSubmit",function(){m(e);let a=u();return _(a.saveType())}),n(17,"div",17)(18,"label",118)(19,"span",20),r(20,"category"),i(),r(21," Gruppo * "),i(),n(22,"select",84),p("change",function(){m(e);let a=u();return _(a.onGroupChangeInForm())}),n(23,"option",26),r(24,"Nessun gruppo"),i(),g(25,Ge,2,3,"option",27),i(),g(26,Oe,2,0,"div",67),i(),n(27,"div",17)(28,"label",119)(29,"span",20),r(30,"label"),i(),r(31," Nome Tipologia * "),i(),S(32,"input",120),g(33,Me,2,0,"div",67),i(),n(34,"div",17)(35,"label",121)(36,"span",20),r(37,"description"),i(),r(38," Descrizione (opzionale) "),i(),S(39,"textarea",122),i(),g(40,Pe,9,0,"div",123),i()(),n(41,"div",96)(42,"button",97),p("click",function(){m(e);let a=u();return _(a.closeTypeModal())}),n(43,"span",20),r(44,"close"),i(),r(45," Annulla "),i(),n(46,"button",124),p("click",function(){m(e);let a=u();return _(a.saveType())}),n(47,"span",20),r(48,"add"),i(),r(49," Crea Tipologia "),i()()()()}if(s&2){let e,o,a,c=u();l(16),d("formGroup",c.typeForm),l(9),d("ngForOf",c.sortedIngredientGroups),l(),d("ngIf",((e=c.typeForm.get("group_id"))==null?null:e.invalid)&&((e=c.typeForm.get("group_id"))==null?null:e.touched)),l(7),d("ngIf",((o=c.typeForm.get("name"))==null?null:o.invalid)&&((o=c.typeForm.get("name"))==null?null:o.touched)),l(7),d("ngIf",(a=c.typeForm.get("group_id"))==null?null:a.value),l(6),d("disabled",c.typeForm.invalid)}}var se=class s{ingredientService=I(re);unitService=I(oe);supplierService=I(ae);ingredientGroupService=I(L);ingredientTypeService=I(V);fb=I(ie);router=I(z);ingredients=[];units=[];suppliers=[];ingredientGroups=[];ingredientTypes=[];filteredIngredients=[];showTypeModal=!1;typeForm;previousGroupId=null;filteredTypesForForm=[];showIngredientForm=!1;isEditing=!1;currentIngredientId=null;searchTerm="";ingredientForm;isLoading=!0;showLowStockOnly=!1;showShoppingListOnly=!1;sortBy="name";selectedGroupId=null;selectedTypeId=null;showShoppingList=!1;shoppingListTotal=0;get lowStockCount(){return this.ingredientService.getLowStockIngredients().length}get shoppingListCount(){return this.getShoppingList().length}constructor(){this.ingredientForm=this.fb.group({name:["",[f.required,f.minLength(2)]],description:[""],unit_id:[""],current_stock:[0,[f.required,f.min(0)]],minimum_stock:[0,[f.required,f.min(0)]],cost_per_unit:[0,[f.required,f.min(0)]],alert_enabled:[!0],expiry_date:[null],supplier_id:[null],to_buy:[!1],to_buy_quantity:[null],group_id:[null],type_id:[null]}),this.typeForm=this.fb.group({group_id:["",f.required],name:["",[f.required,f.minLength(2)]],description:[""]})}ngOnInit(){return v(this,null,function*(){this.loadData()})}loadData(){return v(this,null,function*(){this.isLoading=!0,console.log("\u{1F504} Inizio caricamento dati..."),this.setupSubscriptions();try{yield this.loadAllServices(),console.log("\u2705 Dati caricati con successo")}catch(t){console.error("\u274C Errore nel caricamento dati:",t),this.loadFallbackData()}finally{this.isLoading=!1}})}setupSubscriptions(){this.unitService.units$.subscribe(t=>{console.log("\u{1F4CF} Unit\xE0 caricate:",t.length),this.units=t}),this.supplierService.suppliers$.subscribe(t=>{console.log("\u{1F3ED} Fornitori caricati:",t.length),this.suppliers=t}),this.ingredientGroupService.data$.subscribe(t=>{console.log("\u{1F4C2} Gruppi caricati:",t.length),this.ingredientGroups=t}),this.ingredientTypeService.data$.subscribe(t=>{console.log("\u{1F3F7}\uFE0F Tipologie caricate:",t.length),this.ingredientTypes=t}),this.ingredientService.data$.subscribe(t=>{console.log("\u{1F969} Ingredienti caricati:",t.length),this.ingredients=t,this.applyFilters(),this.calculateShoppingListTotal()})}loadAllServices(){return v(this,null,function*(){let t=[this.ingredientService.loadIngredients(),this.supplierService.loadSuppliers(),this.ingredientTypeService.loadData(),this.ingredientGroupService.loadData()];yield Promise.all(t)})}loadFallbackData(){console.log("\u{1F4CB} Caricamento dati di fallback..."),this.ingredientGroups=[{id:"1",name:"Pesce",color:"#3B82F6",sort_order:1,is_active:!0,is_system:!0},{id:"2",name:"Carni Rosse",color:"#DC2626",sort_order:2,is_active:!0,is_system:!0},{id:"3",name:"Carni Bianche",color:"#F87171",sort_order:3,is_active:!0,is_system:!0},{id:"4",name:"Verdura",color:"#10B981",sort_order:4,is_active:!0,is_system:!0},{id:"5",name:"Frutta",color:"#34D399",sort_order:5,is_active:!0,is_system:!0},{id:"6",name:"Formaggi",color:"#F59E0B",sort_order:6,is_active:!0,is_system:!0},{id:"7",name:"Latticini",color:"#FCD34D",sort_order:7,is_active:!0,is_system:!0},{id:"8",name:"Pasta",color:"#D97706",sort_order:8,is_active:!0,is_system:!0},{id:"9",name:"Oli e Grassi",color:"#A3E635",sort_order:9,is_active:!0,is_system:!0},{id:"10",name:"Spezie",color:"#65A30D",sort_order:10,is_active:!0,is_system:!0}],this.ingredientTypes=[],console.log(`\u2705 ${this.ingredientGroups.length} gruppi di fallback caricati`)}applyFilters(){let t=this.ingredients;this.searchTerm&&(t=this.ingredientService.searchIngredients(this.searchTerm)),this.selectedGroupId&&(t=t.filter(e=>e.group_id===this.selectedGroupId)),this.selectedTypeId&&(t=t.filter(e=>e.type_id===this.selectedTypeId)),this.showLowStockOnly&&(t=t.filter(e=>e.alert_enabled&&e.current_stock<=e.minimum_stock)),this.showShoppingListOnly&&(t=t.filter(e=>e.to_buy)),t=[...t].sort((e,o)=>{switch(this.sortBy){case"name":return e.name.localeCompare(o.name);case"stock":return e.current_stock-o.current_stock;case"cost":return e.cost_per_unit-o.cost_per_unit;default:return 0}}),this.filteredIngredients=t}onGroupFilterChange(t){this.selectedGroupId=t||null,this.selectedTypeId=null,this.applyFilters()}onTypeFilterChange(t){this.selectedTypeId=t||null,this.applyFilters()}clearAllFilters(){this.searchTerm="",this.selectedGroupId=null,this.selectedTypeId=null,this.showLowStockOnly=!1,this.showShoppingListOnly=!1,this.applyFilters()}getGroupName(t){if(!t)return"Senza gruppo";let e=this.ingredientGroups.find(o=>o.id===t);return e?e.name:"Sconosciuto"}getTypeName(t){if(!t)return"Senza tipologia";let e=this.ingredientTypes.find(o=>o.id===t);return e?e.name:"Sconosciuto"}getGroupColor(t){if(!t)return"#9CA3AF";let e=this.ingredientGroups.find(o=>o.id===t);return e?e.color:"#808080"}editIngredient(t){this.isEditing=!0,this.currentIngredientId=t.id;let e={name:t.name,description:t.description||"",unit_id:t.unit_id||"",current_stock:t.current_stock,minimum_stock:t.minimum_stock,cost_per_unit:t.cost_per_unit,alert_enabled:t.alert_enabled,expiry_date:t.expiry_date||"",supplier_id:t.supplier_id||null,to_buy:t.to_buy||!1,to_buy_quantity:t.to_buy_quantity||null,group_id:t.group_id||null,type_id:t.type_id||null};this.ingredientForm.patchValue(e),this.showIngredientForm=!0}onSearchChange(t){this.searchTerm=t,this.applyFilters()}toggleLowStockFilter(){this.showLowStockOnly=!this.showLowStockOnly,this.applyFilters()}toggleShoppingListFilter(){this.showShoppingListOnly=!this.showShoppingListOnly,this.applyFilters()}onSortChange(t){this.sortBy=t,this.applyFilters()}addToShoppingList(t){let e,o=Math.max(t.minimum_stock-t.current_stock,0);o>0?e=o:e=this.getStandardQuantity(t);let a=this.ingredients.findIndex(h=>h.id===t.id);a!==-1&&(this.ingredients[a].to_buy=!0,this.ingredients[a].to_buy_quantity=e,this.calculateShoppingListTotal(),this.applyFilters());let c={to_buy:!0,to_buy_quantity:e};this.ingredientService.updateIngredient(t.id,c).then(h=>{h||(console.error("Errore nell'aggiornamento del database"),a!==-1&&(this.ingredients[a].to_buy=!1,this.ingredients[a].to_buy_quantity=null,this.calculateShoppingListTotal(),this.applyFilters()))})}getStandardQuantity(t){switch(this.getUnitSymbol(t.unit_id)){case"kg":return 1;case"L":return 1;case"g":return 1e3;case"mL":return 1e3;case"pz":return 1;default:return 1}}updateShoppingListQuantity(t,e){let o=e.target,a=parseFloat(o.value);isNaN(a)&&(a=this.getStandardQuantity(t));let c=this.allowsDecimals(t)?.1:1;a=Math.max(a,c),this.allowsDecimals(t)||(a=Math.ceil(a)),this.updateIngredientQuantity(t,a)}increaseQuantity(t){let e=t.to_buy_quantity||this.getStandardQuantity(t),o=this.getQuantityStep(t),a=e+o;this.updateIngredientQuantity(t,a)}decreaseQuantity(t){let e=t.to_buy_quantity||this.getStandardQuantity(t),o=this.getQuantityStep(t),a=this.allowsDecimals(t)?.1:1,c=Math.max(e-o,a);this.updateIngredientQuantity(t,c)}updateIngredientQuantity(t,e){let o=this.ingredients.findIndex(c=>c.id===t.id);o!==-1&&(this.ingredients[o].to_buy_quantity=e,this.calculateShoppingListTotal(),this.applyFilters());let a={to_buy_quantity:e};this.ingredientService.updateIngredient(t.id,a).then(c=>{c||console.error("Errore nell'aggiornamento del database")})}getQuantityStep(t){if(!t.unit_id)return 1;let e=this.units.find(o=>o.id===t.unit_id);if(!e)return 1;if(e.type==="weight"){if(e.symbol==="kg")return 1;if(e.symbol==="g")return 1e3}if(e.type==="volume"){if(e.symbol==="L")return 1;if(e.symbol==="mL")return 1e3}return 1}allowsDecimals(t){if(!t.unit_id)return!1;let e=this.units.find(o=>o.id===t.unit_id);return e?e.type==="weight"||e.type==="volume":!1}removeFromShoppingList(t){let e=this.ingredients.findIndex(a=>a.id===t.id);e!==-1&&(this.ingredients[e].to_buy=!1,this.ingredients[e].to_buy_quantity=null,this.calculateShoppingListTotal(),this.applyFilters());let o={to_buy:!1,to_buy_quantity:null};this.ingredientService.updateIngredient(t.id,o).then(a=>{a||(console.error("Errore nell'aggiornamento del database"),e!==-1&&(this.ingredients[e].to_buy=!0,this.ingredients[e].to_buy_quantity=t.to_buy_quantity,this.calculateShoppingListTotal(),this.applyFilters()))})}calculateShoppingListTotal(){let t=this.getShoppingList();this.shoppingListTotal=t.reduce((e,o)=>{let a=o.to_buy_quantity||1;return e+o.cost_per_unit*a},0)}getShoppingList(){return this.ingredients.filter(t=>t.to_buy)}clearShoppingList(){return v(this,null,function*(){if(confirm("Vuoi azzerare la lista della spesa? Le scorte verranno aggiornate con le quantit\xE0 acquistate.")){let t=this.getShoppingList();for(let e of t){let a={to_buy:!1,to_buy_quantity:null,current_stock:e.current_stock+(e.to_buy_quantity||0)};yield this.ingredientService.updateIngredient(e.id,a)}console.log("Lista della spesa azzerata e scorte aggiornate"),this.loadData(),this.showShoppingList=!1}})}printShoppingList(){let t=this.getShoppingList();if(t.length===0){alert("La lista della spesa \xE8 vuota!");return}let e=t.map(c=>`- ${c.name}: ${c.to_buy_quantity||1} ${this.getUnitSymbol(c.unit_id)}`).join(`
`),o=`

Totale stimato: \u20AC${this.shoppingListTotal.toFixed(2)}`,a=`LISTA DELLA SPESA

${e}${o}`;if(confirm(a+`

Vuoi stampare la lista?`)){let c=window.open("","_blank");c&&(c.document.write(`
          <html>
            <head>
              <title>Lista della Spesa</title>
              <style>
                body { font-family: Arial, sans-serif; padding: 20px; }
                h1 { color: #333; }
                ul { list-style-type: none; padding: 0; }
                li { padding: 5px 0; border-bottom: 1px solid #eee; }
                .total { font-size: 18px; font-weight: bold; margin-top: 20px; }
              </style>
            </head>
            <body>
              <h1>Lista della Spesa</h1>
              <ul>
                ${t.map(h=>`<li>${h.name}: ${h.to_buy_quantity||1} ${this.getUnitSymbol(h.unit_id)} - \u20AC${(h.cost_per_unit*(h.to_buy_quantity||1)).toFixed(2)}</li>`).join("")}
              </ul>
              <div class="total">
                Totale: \u20AC${this.shoppingListTotal.toFixed(2)}
              </div>
              <p style="margin-top: 30px; color: #666; font-size: 12px;">
                Data: ${new Date().toLocaleDateString("it-IT")}
              </p>
            </body>
          </html>
        `),c.document.close(),c.print())}}onSubmit(){return v(this,null,function*(){if(this.ingredientForm.invalid){this.markFormGroupTouched();return}let t=this.ingredientForm.value,e=T(E({},t),{expiry_date:t.expiry_date===""?null:t.expiry_date,supplier_id:t.supplier_id===""?null:t.supplier_id,to_buy_quantity:t.to_buy_quantity===""?null:t.to_buy_quantity,group_id:t.group_id===""?null:t.group_id,type_id:t.type_id===""?null:t.type_id});try{this.isEditing&&this.currentIngredientId?(yield this.ingredientService.updateIngredient(this.currentIngredientId,e))&&(console.log("Ingrediente aggiornato con successo"),this.resetForm()):(yield this.ingredientService.createIngredient(e))&&(console.log("Ingrediente creato con successo"),this.resetForm())}catch(o){console.error("Errore durante il salvataggio:",o)}})}deleteIngredient(t){return v(this,null,function*(){confirm("Sei sicuro di voler eliminare questo ingrediente?")&&(yield this.ingredientService.deleteIngredient(t))&&console.log("Ingrediente eliminato")})}newIngredient(){this.resetForm(),this.showIngredientForm=!0,this.isEditing=!1}resetForm(){this.ingredientForm.reset({name:"",description:"",unit_id:"",current_stock:0,minimum_stock:0,cost_per_unit:0,alert_enabled:!0,expiry_date:"",supplier_id:null,to_buy:!1,to_buy_quantity:null,group_id:null,type_id:null}),this.isEditing=!1,this.currentIngredientId=null,this.showIngredientForm=!1}goToSupplierManager(){this.router.navigate(["/restaurant/suppliers"])}getUnitSymbol(t){if(!t)return"";let e=this.units.find(o=>o.id===t);return e?e.symbol:""}shouldAlert(t){return t.alert_enabled&&t.current_stock<=t.minimum_stock}getStockStatus(t){return this.shouldAlert(t)?{class:"inactive",text:"Scorta Bassa"}:t.current_stock<=t.minimum_stock*1.5?{class:"warning",text:"Scorta Media"}:{class:"active",text:"Scorta OK"}}getSupplierName(t){if(!t.supplier_id)return"Nessun fornitore";if(t.suppliers)return t.suppliers.company_name;let e=this.suppliers.find(o=>o.id===t.supplier_id);return e?e.company_name:"Fornitore sconosciuto"}markFormGroupTouched(){Object.keys(this.ingredientForm.controls).forEach(t=>{this.ingredientForm.get(t)?.markAsTouched()})}get name(){return this.ingredientForm.get("name")}get current_stock(){return this.ingredientForm.get("current_stock")}get minimum_stock(){return this.ingredientForm.get("minimum_stock")}get cost_per_unit(){return this.ingredientForm.get("cost_per_unit")}getUnitsByType(t){return this.unitService.getUnitsByType(t)}formatQuantity(t,e){return t?this.allowsDecimals(e)?t.toFixed(3).replace(/\.?0+$/,""):Math.round(t).toString():"0"}get group_id(){return this.ingredientForm.get("group_id")}get type_id(){return this.ingredientForm.get("type_id")}goToIngredientGroups(){this.router.navigate(["/ingredients/groups"])}goToIngredientTypes(){this.router.navigate(["/ingredients/types"])}openTypeModal(){this.showTypeModal=!0}closeTypeModal(){this.showTypeModal=!1,this.typeForm.reset()}getSelectedGroupName(){let t=this.typeForm.get("group_id")?.value;if(!t)return"";let e=this.ingredientGroups.find(o=>o.id===t);return e?e.name:""}saveType(){return v(this,null,function*(){if(this.typeForm.invalid){this.markTypeFormTouched();return}try{let t=this.typeForm.value;(yield this.ingredientTypeService.createType(t))&&(console.log("Tipologia creata con successo"),alert("Tipologia creata con successo! Sar\xE0 visibile a tutti i ristoranti."),this.closeTypeModal(),yield this.ingredientTypeService.loadData())}catch(t){console.error("Errore durante la creazione della tipologia:",t),alert(`Errore: ${t.message||"Impossibile creare la tipologia"}`)}})}markTypeFormTouched(){Object.keys(this.typeForm.controls).forEach(t=>{this.typeForm.get(t)?.markAsTouched()})}onGroupChangeInForm(){let t=this.ingredientForm.get("group_id")?.value;t!==this.previousGroupId&&(this.ingredientForm.get("type_id")?.setValue(""),this.previousGroupId=t),this.filteredTypesForForm=this.getFilteredTypesForForm()}openNewTypeModalFromForm(){let t=this.ingredientForm.get("group_id")?.value;t&&this.typeForm.patchValue({group_id:t}),this.showTypeModal=!0}loadGroupsDirectly(){return v(this,null,function*(){try{console.log("\u{1F504} Tentativo caricamento diretto gruppi...");let{data:t,error:e}=yield this.ingredientGroupService.getSupabaseClientPublic().from("ingredient_groups").select("*").eq("is_active",!0).order("sort_order").order("name");if(e){console.error("\u274C Errore caricamento diretto gruppi:",e);return}console.log(`\u2705 ${t?.length||0} gruppi caricati direttamente`),this.ingredientGroups=t||[]}catch(t){console.error("\u{1F4A5} Errore in loadGroupsDirectly:",t)}})}createComposedIngredient(){this.router.navigate(["/food-cost"],{queryParams:{mode:"ingredient",fromInventory:!0}})}get sortedIngredientGroups(){return!this.ingredientGroups||!Array.isArray(this.ingredientGroups)?[]:[...this.ingredientGroups].filter(t=>t.is_active!==!1).sort((t,e)=>t.name.toLowerCase().localeCompare(e.name.toLowerCase()))}get sortedIngredientTypes(){return!this.ingredientTypes||!Array.isArray(this.ingredientTypes)?[]:[...this.ingredientTypes].sort((t,e)=>t.name.localeCompare(e.name))}getFilteredTypes(){let t=this.ingredientForm.get("group_id")?.value;return t?this.sortedIngredientTypes.filter(e=>e.group_id===t):this.sortedIngredientTypes}getFilteredTypesForForm(){let t=this.ingredientForm.get("group_id")?.value;return t?this.sortedIngredientTypes.filter(e=>e.group_id===t):this.sortedIngredientTypes}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=O({type:s,selectors:[["app-inventory"]],decls:128,vars:25,consts:[[1,"page-container"],[1,"section-header"],[1,"flex","gap-sm"],[1,"material-icons","fs-lg"],[1,"section-title"],[1,"text-muted"],[1,"grid-cards"],[1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"text-md","font-bold","text-primary","justify-center","flex"],[1,"text-muted","card-footer"],[1,"card-footer"],[1,"promethea-button","ghost","mt-auto",3,"click","disabled"],[1,"form-card","mt-lg"],[1,"flex","flex-col","md:flex-row","justify-between","items-start"],[1,"form-row"],[1,"form-group","mb-lg"],[1,"standard-label"],[1,"material-icons"],["type","text","placeholder","Cerca per nome o descrizione...",3,"input","value"],[3,"change","value"],["value","name"],["value","stock"],["value","cost"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-row","mt-sm"],[1,"form-group",2,"justify-content","center"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"checkbox-content"],["class","text-green-600 font-bold",4,"ngIf"],[1,"modal-footer","p-md0"],[1,"promethea-button",3,"click"],[1,"promethea-button","ghost",3,"click"],[1,"mt-lg","bg-body","border","rounded-lg","overflow-hidden","shadow-card","backdrop-blur"],[1,"table-section"],[1,"crm-table"],[4,"ngIf"],["class","ingredient-row",3,"bg-green-50",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[3,"value"],[1,"text-green-600","font-bold"],["colspan","7",1,"text-center","p-xl"],[1,"flex","flex-col","items-center","justify-center","gap-md"],[1,"material-icons","animate-spin"],[1,"ingredient-row"],[1,"chip"],[1,"icon-button",3,"click","title"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["colspan","7",1,"empty-state-row"],[1,"empty-state"],["class","text-muted mb-4",4,"ngIf"],[1,"text-muted","mb-4"],[1,"modal-overlay",3,"click"],[1,"modal-container","modal-lg",3,"click"],[1,"modal-header"],[1,"flex"],[1,"header-icon"],[1,"icon-button",3,"click"],[1,"form-card",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name",1,"standard-label"],["id","name","formControlName","name","type","text","placeholder","Es: Pomodoro San Marzano"],["class","text-red-500 text-sm",4,"ngIf"],["for","unit_id",1,"standard-label"],["id","unit_id","formControlName","unit_id"],["label","Peso"],["label","Volume"],["label","Conteggio"],["for","cost_per_unit",1,"standard-label"],["id","cost_per_unit","formControlName","cost_per_unit","type","number","step","0.001","min","0","placeholder","0.000"],[1,"form-group","mt-sm"],["for","description",1,"standard-label"],["id","description","formControlName","description","rows","2","placeholder","Descrizione opzionale dell'ingrediente"],[1,"form-grup"],["for","current_stock",1,"standard-label"],["id","current_stock","formControlName","current_stock","type","number","step","0.001","min","0","placeholder","0"],["for","minimum_stock",1,"standard-label"],["id","minimum_stock","formControlName","minimum_stock","type","number","step","0.001","min","0","placeholder","0"],["for","group_id",1,"standard-label"],["id","group_id","formControlName","group_id",3,"change"],["for","type_id",1,"standard-label"],[1,"flex","gap-sm","items-center"],["id","type_id","formControlName","type_id",1,"flex-1",3,"disabled"],["type","button","title","Crea nuova tipologia",1,"icon-button",3,"click"],[1,"mt-sm","text-mini"],["for","supplier_id",1,"standard-label"],["id","supplier_id","formControlName","supplier_id",1,"flex-1"],["type","button","title","Gestisci Fornitori",1,"icon-button",3,"click"],["for","expiry_date",1,"standard-label"],["id","expiry_date","formControlName","expiry_date","type","date"],["type","checkbox","formControlName","alert_enabled"],[1,"modal-footer"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button",3,"click","disabled"],[1,"text-red-500","text-sm"],[1,"modal-content"],[1,"form-card"],["class","empty-state",4,"ngIf"],[1,"promethea-button",3,"click","disabled"],[1,"promethea-button","success",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"mt-lg","p-md","bg-smoke","rounded-lg"],[1,"flex","justify-between","items-center"],[1,"font-bold"],[1,"text-md","font-bold","text-primary"],[1,"flex","items-center","gap-2"],[1,"icon-button","x-small",3,"click","title"],[1,"flex","flex-col","items-center"],["type","number",1,"w-16",3,"change","step","min","value"],[1,"text-mini","text-muted","mt-sm"],[1,"icon-button","text-red-500",3,"click"],[1,"modal-container","modal-md",3,"click"],[1,"grid-form","gap-md",3,"ngSubmit","formGroup"],["for","type_group_id",1,"standard-label"],["for","type_name",1,"standard-label"],["id","type_name","type","text","formControlName","name","placeholder","Es: Tonno Rosso, Pomodoro San Marzano, etc.","required","",1,"w-full"],["for","type_description",1,"standard-label"],["id","type_description","formControlName","description","rows","3","placeholder","Descrizione della tipologia...",1,"w-full"],["class","bg-blue-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"promethea-button",3,"click","disabled"],[1,"bg-blue-50","rounded-lg","p-4"],[1,"material-icons","text-blue-500","mr-2"],[1,"text-sm"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),r(4,"inventory_2"),i(),n(5,"h1",4),r(6,"Inventario"),i()(),n(7,"p",5),r(8,"Gestisci gli ingredienti del tuo ristorante"),i()(),n(9,"div",6)(10,"div",7)(11,"div",8)(12,"span",9),r(13,"inventory"),i(),n(14,"h3",10),r(15,"Ingredienti Totali"),i()(),n(16,"div",11),r(17),i(),n(18,"span",12),r(19,"Ingredienti in inventario"),i()(),n(20,"div",7)(21,"div",8)(22,"span",9),r(23,"warning"),i(),n(24,"h3",10),r(25,"Scorte Basse"),i()(),n(26,"div",11),r(27),i(),n(28,"span",12),r(29),i()(),n(30,"div",7)(31,"div",8)(32,"span",9),r(33,"shopping_cart"),i(),n(34,"h3",10),r(35,"Lista Spesa"),i()(),n(36,"div",11),r(37),i(),n(38,"div",13)(39,"button",14),p("click",function(){return o.showShoppingList=!0}),r(40),i()()()(),n(41,"div",15)(42,"div",16)(43,"div",17)(44,"div",18)(45,"label",19)(46,"span",20),r(47,"search"),i(),r(48," Cerca Ingredienti "),i(),n(49,"input",21),p("input",function(c){return o.onSearchChange(c.target.value)}),i()(),n(50,"div",18)(51,"label",19)(52,"span",20),r(53,"sort"),i(),r(54," Ordina per "),i(),n(55,"select",22),p("change",function(c){return o.onSortChange(c.target.value)}),n(56,"option",23),r(57,"Nome"),i(),n(58,"option",24),r(59,"Scorta"),i(),n(60,"option",25),r(61,"Costo"),i()()()(),n(62,"div",17)(63,"div",18)(64,"label",19)(65,"span",20),r(66,"category"),i(),r(67," Filtra per Gruppo "),i(),n(68,"select",22),p("change",function(c){return o.onGroupFilterChange(c.target.value)}),n(69,"option",26),r(70,"Tutti i gruppi"),i(),g(71,de,2,2,"option",27),i()(),n(72,"div",18)(73,"label",19)(74,"span",20),r(75,"category"),i(),r(76," Filtra per Tipologia "),i(),n(77,"select",22),p("change",function(c){return o.onTypeFilterChange(c.target.value)}),n(78,"option",26),r(79,"Tutte le tipologie"),i(),g(80,ce,2,2,"option",27),i()()(),n(81,"div",28)(82,"div",29)(83,"label",30)(84,"input",31),p("change",function(){return o.toggleLowStockFilter()}),i(),n(85,"div",32),r(86,"Mostra solo scorte basse "),i()()(),n(87,"div",29)(88,"label",30)(89,"input",31),p("change",function(){return o.toggleShoppingListFilter()}),i(),n(90,"div",32),r(91,"Mostra solo da acquistare "),g(92,pe,2,1,"span",33),i()()()(),n(93,"div",34)(94,"button",35),p("click",function(){return o.newIngredient()}),n(95,"span",20),r(96,"add"),i(),r(97," Nuovo Ingrediente "),i(),n(98,"button",36),p("click",function(){return o.createComposedIngredient()}),n(99,"span",20),r(100,"add_circle"),i(),r(101," Crea Ingrediente Composto "),i()()()(),n(102,"div",37)(103,"div",38)(104,"table",39)(105,"thead")(106,"tr")(107,"th"),r(108,"Nome"),i(),n(109,"th"),r(110,"Descrizione"),i(),n(111,"th"),r(112,"Scorta Attuale"),i(),n(113,"th"),r(114,"Fornitore"),i(),n(115,"th"),r(116,"Costo/Unit\xE0"),i(),n(117,"th"),r(118,"Stato"),i(),n(119,"th"),r(120,"Azioni"),i()()(),n(121,"tbody"),g(122,ue,7,0,"tr",40)(123,_e,32,21,"tr",41)(124,ye,12,1,"tr",40),i()()()()(),g(125,ke,127,25,"div",42)(126,Ve,32,5,"div",42)(127,Ne,50,6,"div",42)),e&2&&(l(17),x(o.ingredients.length),l(9),b("text-red-500",o.lowStockCount>0),l(),y(" ",o.lowStockCount," "),l(),b("text-red-500",o.lowStockCount>0),l(),y(" ",o.lowStockCount>0?"Attenzione!":"Tutto ok"," "),l(8),y(" ",o.getShoppingList().length," "),l(2),d("disabled",o.getShoppingList().length===0),l(),y(" Vedi Lista (\u20AC",o.shoppingListTotal.toFixed(2),") "),l(9),d("value",o.searchTerm),l(6),d("value",o.sortBy),l(13),d("value",o.selectedGroupId||""),l(3),d("ngForOf",o.sortedIngredientGroups),l(6),d("value",o.selectedTypeId||""),l(3),d("ngForOf",o.ingredientTypes),l(4),d("checked",o.showLowStockOnly),l(5),d("checked",o.showShoppingListOnly),l(3),d("ngIf",o.showShoppingListOnly),l(30),d("ngIf",o.isLoading),l(),d("ngForOf",o.filteredIngredients),l(),d("ngIf",!o.isLoading&&o.filteredIngredients.length===0),l(),d("ngIf",o.showIngredientForm),l(),d("ngIf",o.showShoppingList),l(),d("ngIf",o.showTypeModal))},dependencies:[Q,D,$,ne,H,Y,Z,U,K,j,X,B,R,te,ee,W,J,A],styles:[".ingredient-row[_ngcontent-%COMP%]{transition:all .2s ease}.ingredient-row[_ngcontent-%COMP%]:hover{background:var(--smoke-1)}.chip.in-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#10b981 20%,transparent);color:#10b981}.chip.low-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 20%,transparent);color:#f59e0b}.chip.out-of-stock[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 20%,transparent);color:#ef4444}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.modal-lg[_ngcontent-%COMP%]{margin:var(--gap-md);max-width:calc(100vw - 2 * var(--gap-md))}.crm-table[_ngcontent-%COMP%]{font-size:.875rem}.crm-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .crm-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:var(--gap-sm)}.modal-footer[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:var(--gap-sm)}.modal-footer[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.grid-cards[_ngcontent-%COMP%]{grid-template-columns:1fr}.crm-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}}.checkbox-label[_ngcontent-%COMP%]{align-items:center;padding:0}.flex.items-center.gap-2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.w-16[_ngcontent-%COMP%]{min-width:3rem}"]})};export{se as Inventory};
