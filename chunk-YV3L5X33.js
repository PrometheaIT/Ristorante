import{a as B}from"./chunk-3LBBIPXR.js";import{b as $,d as j,h as Q,x as N}from"./chunk-2WQQ3H4M.js";import"./chunk-PJAEBTL6.js";import{c as T,d as V,l as F,p as L,r as R,s as z}from"./chunk-JA3GOP6I.js";import{Ab as M,Ba as C,Db as s,Ea as l,Eb as h,Fb as f,Jb as S,Kb as D,Lb as O,Mb as I,Ua as P,Vb as k,Za as m,ba as y,fb as d,ga as g,gb as r,ha as _,hb as a,ob as x,rb as u,tb as c,yb as E}from"./chunk-HZF257L5.js";import{a as b,b as w,j as v}from"./chunk-4ZZIO3ZI.js";function H(n,i){n&1&&(r(0,"div",5)(1,"span",6),s(2,"restaurant"),a(),r(3,"h2",7),s(4,"Menu non disponibile"),a(),r(5,"p",8),s(6,"Il menu del ristorante non \xE8 al momento disponibile."),a(),r(7,"button",9)(8,"span",10),s(9,"arrow_back"),a(),s(10," Torna alla ricerca "),a()())}function U(n,i){if(n&1){let e=x();r(0,"img",31),u("error",function(t){g(e);let p=c(3);return _(p.onLogoError(t))}),a()}if(n&2){let e=c(3);d("src",e.restaurant.logo_url,C)("alt",e.restaurant.name)}}function q(n,i){n&1&&(r(0,"span",10),s(1,"restaurant_menu"),a())}function Y(n,i){if(n&1){let e=x();r(0,"button",24),u("click",function(){let t=g(e).$implicit,p=c(3);return _(p.selectCategory(t.id))}),s(1),a()}if(n&2){let e=i.$implicit,o=c(3);M("active",o.selectedCategory===e.id),l(),f(" ",e.name," ")}}function G(n,i){if(n&1){let e=x();r(0,"img",50),u("error",function(t){g(e);let p=c().$implicit,W=c(4);return _(W.onDishImageError(t,p))}),a()}if(n&2){let e=c().$implicit;d("src",e.image_url,C)("alt",e.name)}}function J(n,i){n&1&&(r(0,"div",51)(1,"span",10),s(2,"restaurant"),a()())}function K(n,i){if(n&1&&(r(0,"p",52),s(1),a()),n&2){let e=c().$implicit;l(),f(" ",e.description," ")}}function X(n,i){if(n&1&&(r(0,"span",53)(1,"span",10),s(2,"schedule"),a(),s(3),a()),n&2){let e=c().$implicit;l(3),f(" ",e.preparation_time," min ")}}function Z(n,i){if(n&1&&(r(0,"span",53)(1,"span",10),s(2,"delivery_dining"),a(),s(3),a()),n&2){let e=c().$implicit,o=c(4);l(3),f(" ",o.formatPrice(e.delivery_price)," ")}}function ee(n,i){if(n&1&&(r(0,"span",53)(1,"span",10),s(2,"takeout_dining"),a(),s(3),a()),n&2){let e=c().$implicit,o=c(4);l(3),f(" ",o.formatPrice(e.takeaway_price)," ")}}function te(n,i){if(n&1){let e=x();r(0,"div",38)(1,"div",39),m(2,G,1,2,"img",40)(3,J,3,0,"div",41),a(),r(4,"div",42)(5,"div",43)(6,"h3",44),s(7),a(),r(8,"span",45),s(9),a()(),m(10,K,2,1,"p",46),r(11,"div",47),m(12,X,4,1,"span",48)(13,Z,4,1,"span",48)(14,ee,4,1,"span",48),a(),r(15,"button",49),u("click",function(){let t=g(e).$implicit,p=c(4);return _(p.addToCart(t))}),r(16,"span",10),s(17,"add_shopping_cart"),a(),s(18," Aggiungi "),a()()()}if(n&2){let e=i.$implicit,o=c(4);l(2),d("ngIf",e.image_url),l(),d("ngIf",!e.image_url),l(4),h(e.name),l(2),h(o.formatPrice(e.base_price)),l(),d("ngIf",e.description),l(2),d("ngIf",e.preparation_time),l(),d("ngIf",e.delivery_price),l(),d("ngIf",e.takeaway_price)}}function ie(n,i){if(n&1&&(r(0,"div",32)(1,"div",33)(2,"h2",34),s(3),a(),r(4,"span",35),s(5),a()(),r(6,"div",36),m(7,te,19,8,"div",37),a()()),n&2){let e=i.$implicit;l(3),h(e.name),l(2),f("",e.dishes.length," piatti"),l(2),d("ngForOf",e.dishes)}}function ne(n,i){if(n&1){let e=x();r(0,"div",54)(1,"span",6),s(2,"search_off"),a(),r(3,"h3"),s(4,"Nessun piatto trovato"),a(),r(5,"p",8),s(6,"Prova a modificare la ricerca o i filtri"),a(),r(7,"button",55),u("click",function(){g(e);let t=c(3);return t.searchQuery="",_(t.selectedCategory=null)}),r(8,"span",10),s(9,"refresh"),a(),s(10," Mostra tutto il menu "),a()()}}function ae(n,i){if(n&1){let e=x();r(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),m(4,U,1,2,"img",15)(5,q,2,0,"span",16),a(),r(6,"div",17)(7,"h1",18),s(8),a(),r(9,"p",8),s(10,"Menu completo"),a()()()(),r(11,"div",19)(12,"div",20)(13,"div",21)(14,"span",10),s(15,"search"),a(),r(16,"input",22),O("ngModelChange",function(t){g(e);let p=c(2);return D(p.searchQuery,t)||(p.searchQuery=t),_(t)}),u("input",function(){g(e);let t=c(2);return _(t.onSearchChange())}),a()(),r(17,"div",23)(18,"button",24),u("click",function(){g(e);let t=c(2);return _(t.selectCategory(null))}),s(19," Tutto "),a(),m(20,Y,2,3,"button",25),a()()(),r(21,"div",26),m(22,ie,8,3,"div",27)(23,ne,11,0,"div",28),a(),r(24,"div",29)(25,"button",30)(26,"span",10),s(27,"arrow_back"),a(),s(28," Torna al ristorante "),a()()()}if(n&2){let e=c(2);l(4),d("ngIf",e.restaurant.logo_url),l(),d("ngIf",!e.restaurant.logo_url),l(3),h(e.restaurant.name),l(8),S("ngModel",e.searchQuery),l(2),M("active",!e.selectedCategory),l(2),d("ngForOf",e.categories),l(2),d("ngForOf",e.filteredCategories),l(),d("ngIf",e.filteredCategories.length===0),l(2),d("routerLink",I("/customer/restaurant/",e.restaurant.id))}}function re(n,i){if(n&1&&(r(0,"div",2),m(1,H,11,0,"div",3)(2,ae,29,11,"div",4),a()),n&2){let e=c();l(),d("ngIf",!e.restaurant),l(),d("ngIf",e.restaurant)}}function oe(n,i){n&1&&(r(0,"div",2)(1,"div",5)(2,"span",56),s(3,"sync"),a(),r(4,"p"),s(5,"Caricamento menu..."),a()()())}var A=class n{restaurantPublicService=y(B);router=y(R);route=y(L);restaurant=null;categories=[];allCategories=[];loading=!0;searchQuery="";selectedCategory=null;ngOnInit(){return v(this,null,function*(){let i=this.route.snapshot.paramMap.get("id");i?yield this.loadMenuData(i):this.router.navigate(["/customer/search"])})}loadMenuData(i){return v(this,null,function*(){try{this.loading=!0;let[e,o,t]=yield Promise.all([this.restaurantPublicService.loadRestaurantById(i),this.restaurantPublicService.loadRestaurantDishes(i),this.restaurantPublicService.loadRestaurantCategories(i)]);console.log("Restaurant:",e),console.log("Dishes:",o),console.log("Categories:",t),this.restaurant=e,this.allCategories=t,this.groupDishesByCategory(o,t)}catch(e){console.error("Error loading menu data:",e),yield this.loadMenuDataFallback(i)}finally{this.loading=!1}})}loadMenuDataFallback(i){return v(this,null,function*(){try{let[e,o]=yield Promise.all([this.restaurantPublicService.loadRestaurantById(i),this.restaurantPublicService.loadRestaurantDishes(i)]);this.restaurant=e,this.groupDishesByCategory(o,[])}catch(e){console.error("Error in fallback loading:",e)}})}groupDishesByCategory(i,e){let o=new Map;e.forEach(t=>{o.set(t.id,{id:t.id,name:t.name,description:t.description,dishes:[]})}),o.set("uncategorized",{id:"uncategorized",name:"Specialit\xE0",description:"Le nostre specialit\xE0",dishes:[]}),i.forEach(t=>{t.category_id&&o.has(t.category_id)?o.get(t.category_id).dishes.push(t):t.category_name&&!o.has(t.category_id||"unknown")?o.set(t.category_id||"unknown",{id:t.category_id||"unknown",name:t.category_name,description:"",dishes:[t]}):o.get("uncategorized").dishes.push(t)}),this.categories=Array.from(o.values()).filter(t=>t.dishes.length>0).sort((t,p)=>t.id==="uncategorized"?1:p.id==="uncategorized"?-1:t.name.localeCompare(p.name))}get filteredCategories(){if(!this.searchQuery&&!this.selectedCategory)return this.categories;let i=[];for(let e of this.categories){if(this.selectedCategory&&e.id!==this.selectedCategory)continue;let o=[...e.dishes];if(this.searchQuery){let t=this.searchQuery.toLowerCase();o=e.dishes.filter(p=>p.name.toLowerCase().includes(t)||p.description?.toLowerCase().includes(t)||p.category_name?.toLowerCase().includes(t))}o.length>0&&i.push(w(b({},e),{dishes:o}))}return i}selectCategory(i){this.selectedCategory=i===this.selectedCategory?null:i}onSearchChange(){}addToCart(i){console.log("Aggiunto al carrello:",i)}formatPrice(i){return`\u20AC${i.toFixed(2).replace(".",",")}`}onDishImageError(i,e){let o=i.target;o.style.display="none"}onLogoError(i){let e=i.target;e.style.display="none"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-menu-display"]],decls:3,vars:2,consts:[["loadingTemplate",""],["class","page-container",4,"ngIf","ngIfElse"],[1,"page-container"],["class","flex flex-col items-center justify-center p-xl gap-md",4,"ngIf"],["class","flex flex-col gap-lg",4,"ngIf"],[1,"flex","flex-col","items-center","justify-center","p-xl","gap-md"],[1,"material-icons","fs-lg"],[1,"text-lg","font-bold"],[1,"text-muted"],["routerLink","/customer/search",1,"promethea-button"],[1,"material-icons"],[1,"flex","flex-col","gap-lg"],[1,"section-header"],[1,"flex","items-center","gap-md"],[1,"header-icon"],["class","logo-image rounded-full",3,"src","alt","error",4,"ngIf"],["class","material-icons",4,"ngIf"],[1,"section-titles"],[1,"section-title"],[1,"card"],[1,"flex","flex-col","md:flex-row","gap-md","items-center","justify-between"],[1,"search-bar","flex-1"],["type","text","placeholder","Cerca nel menu...",3,"ngModelChange","input","ngModel"],[1,"filter-chips","flex","flex-wrap","gap-sm"],[1,"chip",3,"click"],["class","chip",3,"active","click",4,"ngFor","ngForOf"],[1,"flex","flex-col","gap-xl"],["class","category-section",4,"ngFor","ngForOf"],["class","text-center p-xl",4,"ngIf"],[1,"text-center","mt-xl"],[1,"promethea-button","ghost",3,"routerLink"],[1,"logo-image","rounded-full",3,"error","src","alt"],[1,"category-section"],[1,"flex","items-center","gap-sm","mb-lg"],[1,"text-md","font-bold"],[1,"chip"],[1,"dishes-grid"],["class","dish-card",4,"ngFor","ngForOf"],[1,"dish-card"],[1,"dish-image-container"],["class","dish-image",3,"src","alt","error",4,"ngIf"],["class","dish-image-placeholder",4,"ngIf"],[1,"dish-info"],[1,"dish-header"],[1,"dish-name"],[1,"dish-price"],["class","dish-description",4,"ngIf"],[1,"dish-details"],["class","detail-chip",4,"ngIf"],[1,"add-to-cart-button",3,"click"],[1,"dish-image",3,"error","src","alt"],[1,"dish-image-placeholder"],[1,"dish-description"],[1,"detail-chip"],[1,"text-center","p-xl"],[1,"promethea-button","ghost","mt-md",3,"click"],[1,"material-icons","animate-spin"]],template:function(e,o){if(e&1&&m(0,re,3,2,"div",1)(1,oe,6,0,"ng-template",null,0,k),e&2){let t=E(2);d("ngIf",!o.loading)("ngIfElse",t)}},dependencies:[F,T,V,N,$,j,Q,z],styles:[".search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);background:var(--background);border:1px solid var(--smoke-1);border-radius:12px;padding:var(--gap-sm) var(--gap-md);width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;padding:0;width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.category-section[_ngcontent-%COMP%]{margin-bottom:var(--gap-xl)}.dishes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-lg)}.dish-card[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-1);border-radius:16px;overflow:hidden;transition:all .3s cubic-bezier(.2,.9,.2,1);display:flex;flex-direction:column}.dish-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--secondary);box-shadow:0 8px 24px var(--shadow-1)}.dish-image-container[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;overflow:hidden;background:var(--smoke-1)}.dish-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.dish-card[_ngcontent-%COMP%]:hover   .dish-image[_ngcontent-%COMP%]{transform:scale(1.05)}.dish-image-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:var(--text-muted)}.dish-image-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:3rem}.dish-info[_ngcontent-%COMP%]{padding:var(--gap-md);flex:1;display:flex;flex-direction:column;gap:var(--gap-sm)}.dish-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:var(--gap-sm)}.dish-name[_ngcontent-%COMP%]{line-height:1;font-weight:700;margin:0;flex:1}.dish-price[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);white-space:nowrap}.dish-description[_ngcontent-%COMP%]{color:var(--text-muted);line-height:1.4;margin:0;font-size:.95rem}.dish-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-sm)}.detail-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--smoke-1);border-radius:8px;font-size:.85rem;color:var(--text-muted)}.add-to-cart-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);background:var(--gradiente);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;margin-top:auto}.add-to-cart-button[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 4px 12px var(--shadow-1)}.filter-chips[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto;padding-bottom:4px}.filter-chips[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{white-space:nowrap}.logo-image[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:cover;border:3px solid var(--background)}@media (max-width: 768px){.dishes-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.dish-image-container[_ngcontent-%COMP%]{height:180px}.search-bar[_ngcontent-%COMP%]{width:100%}.logo-image[_ngcontent-%COMP%]{width:60px;height:60px}}"]})};export{A as MenuDisplay};
