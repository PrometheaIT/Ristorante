import{a as ne}from"./chunk-KYBBWEXV.js";import{a as ie}from"./chunk-PVAGMHPL.js";import{a as oe}from"./chunk-X3VWO7FL.js";import{a as B,b as q,c as _,d as L,e as $,f as R,i as U,j as Q,l as j,m as W,n as H,o as J,p as K,q as X,r as Y,t as Z,v as ee,x as te}from"./chunk-HTWH3NPU.js";import{a as re}from"./chunk-VMXTU4N2.js";import{d as M,e as D,j as V,l as z,s as T,u as G}from"./chunk-KBL2L3GY.js";import{Cb as I,Gb as y,Hb as v,Na as l,Pb as N,Qb as k,Tb as o,Ub as P,Vb as m,Wb as A,cb as O,cc as p,ec as u,f as S,ga as b,hb as f,la as x,ma as F,tb as c,ub as r,vb as i,wb as h,x as w}from"./chunk-UE7YVF6I.js";function se(s,t){s&1&&(r(0,"span"),o(1,"(Predefinita)"),i())}function de(s,t){if(s&1&&(r(0,"option",54),o(1),f(2,se,2,0,"span",38),i()),s&2){let n=t.$implicit;c("value",n.id),l(),m(" ",n.name," "),l(),c("ngIf",n.is_default)}}function ce(s,t){s&1&&(r(0,"div",55),o(1," La categoria \xE8 obbligatoria "),i())}function me(s,t){s&1&&(r(0,"div",55),o(1," Il nome \xE8 obbligatorio "),i())}function ge(s,t){s&1&&(r(0,"span",3),o(1,"hourglass_empty"),i())}function pe(s,t){s&1&&(r(0,"span",3),o(1,"add"),i())}function ue(s,t){if(s&1){let n=I();r(0,"div",56)(1,"h3",57),o(2,"Nuova Categoria"),i(),r(3,"div",58)(4,"div",11)(5,"label",59),o(6,"Nome Categoria *"),i(),h(7,"input",60),f(8,me,2,0,"div",20),i(),r(9,"div",11)(10,"label",61),o(11,"Descrizione"),i(),h(12,"textarea",62),i(),r(13,"div",11)(14,"label",63),h(15,"input",64)(16,"span",65),o(17," Imposta come categoria predefinita "),i()(),r(18,"div",66)(19,"button",67),y("click",function(){x(n);let a=v();return F(a.toggleNewCategoryForm())}),o(20," Annulla "),i(),r(21,"button",68),y("click",function(){x(n);let a=v();return F(a.onCreateCategory())}),f(22,ge,2,0,"span",69)(23,pe,2,0,"span",69),o(24),i()()()()}if(s&2){let n,e=v();l(3),c("formGroup",e.newCategoryForm),l(5),c("ngIf",((n=e.newCategoryForm.get("name"))==null?null:n.invalid)&&((n=e.newCategoryForm.get("name"))==null?null:n.touched)),l(11),c("disabled",e.isCreatingCategory),l(2),c("disabled",e.isCreatingCategory),l(),c("ngIf",e.isCreatingCategory),l(),c("ngIf",!e.isCreatingCategory),l(),m(" ",e.isCreatingCategory?"Creazione...":"Crea Categoria"," ")}}function Ce(s,t){if(s&1&&(r(0,"span"),o(1),p(2,"number"),i()),s&2){let n=v().$implicit;l(),A(" (\u20AC",u(2,2,n.cost_per_unit,"1.2-2"),"/",n.units.symbol,") ")}}function fe(s,t){if(s&1&&(r(0,"option",54),o(1),f(2,Ce,3,5,"span",38),i()),s&2){let n=t.$implicit;c("value",n.name),l(),m(" ",n.name," "),l(),c("ngIf",n.unit_id&&n.units)}}function ve(s,t){if(s&1&&(r(0,"option",54),o(1),i()),s&2){let n=t.$implicit;c("value",n.id),l(),m(" ",n.name," ")}}function _e(s,t){if(s&1&&(r(0,"span",80),o(1),i()),s&2){let n,e=v().$implicit,a=v();l(),m(" ",a.getQuantityUnitLabel((n=e.get("ingredient_id"))==null?null:n.value)," ")}}function he(s,t){if(s&1){let n=I();r(0,"div",70)(1,"div",11)(2,"input",71),y("input",function(a){let d=x(n).index,g=v();return F(g.onIngredientSelected(a,d))})("blur",function(a){let d=x(n).index,g=v();return F(g.onIngredientSelected(a,d))})("change",function(){x(n);let a=v();return F(a.manualCalculateCost())}),i(),r(3,"datalist",72),f(4,fe,3,3,"option",18),i(),r(5,"select",73)(6,"option",17),o(7,"Seleziona un ingrediente"),i(),f(8,ve,2,2,"option",18),i()(),r(9,"div",11)(10,"div",74)(11,"input",75),y("change",function(){x(n);let a=v();return F(a.manualCalculateCost())}),i(),f(12,_e,2,1,"span",76),i()(),r(13,"div",77),o(14),p(15,"number"),i(),r(16,"div")(17,"button",78),y("click",function(){let a=x(n).index,d=v();return F(d.removeIngredient(a))}),r(18,"span",79),o(19,"delete"),i()()()()}if(s&2){let n,e,a,d=t.$implicit,g=t.index,C=v();c("formGroupName",g),l(2),c("value",C.getIngredientName((n=d.get("ingredient_id"))==null?null:n.value)),l(2),c("ngForOf",C.ingredients),l(4),c("ngForOf",C.ingredients),l(4),c("ngIf",(e=d.get("ingredient_id"))==null?null:e.value),l(2),m(" \u20AC",u(15,6,(a=d.get("cost"))==null?null:a.value,"1.2-2")," ")}}function ye(s,t){s&1&&(r(0,"span"),o(1,"\u26A1"),i())}function be(s,t){s&1&&(r(0,"span"),o(1,"\u2713"),i())}var ae=class s{ingredientService=b(ie);unitService=b(ne);dishService=b(re);fb=b(ee);categoryService=b(oe);route=b(T);router=b(G);dishId;foodCostForm;ingredients=[];totalCost=0;suggestedPrice=0;isEditing=!1;currentDish=null;categories=[];showNewCategoryForm=!1;newCategoryForm;isCreatingCategory=!1;constructor(){this.foodCostForm=this.fb.group({dishName:["",_.required],sellingPrice:[0,[_.required,_.min(0)]],category_id:["",_.required],description:[""],preparation_time:[0,[_.min(0)]],ingredients:this.fb.array([])}),this.newCategoryForm=this.fb.group({name:["",_.required],description:[""],is_default:[!1]})}ngOnInit(){this.ingredientService.ingredients$.subscribe(t=>{this.ingredients=t,this.route.paramMap.subscribe(n=>{let e=n.get("id");e?this.loadDishForEditing(e):this.ingredientsArray.length===0&&this.addIngredient()})}),this.categoryService.data$.subscribe(t=>{if(this.categories=t,t.length>0&&!this.foodCostForm.get("category_id")?.value){let n=t.find(e=>e.is_default)||t[0];this.foodCostForm.patchValue({category_id:n.id})}})}loadDishForEditing(t){return S(this,null,function*(){try{let n=yield w(this.dishService.getDishById$(t));if(n)this.currentDish=n,this.isEditing=!0,this.populateFormWithDish(n);else{console.error("Piatto non trovato:",t),yield this.dishService.loadData();let e=yield w(this.dishService.getDishById$(t));e?(this.currentDish=e,this.isEditing=!0,this.populateFormWithDish(e)):(alert("Piatto non trovato"),this.router.navigate(["/food-cost-calculator"]))}}catch(n){console.error("Errore nel caricamento del piatto:",n),alert("Errore nel caricamento del piatto"),this.router.navigate(["/food-cost-calculator"])}})}populateFormWithDish(t){for(this.foodCostForm.patchValue({dishName:t.name,sellingPrice:t.base_price,category_id:t.category_id,description:t.description||"",preparation_time:t.preparation_time||0});this.ingredientsArray.length;)this.ingredientsArray.removeAt(0);t.ingredients_composition&&Array.isArray(t.ingredients_composition)?t.ingredients_composition.forEach(n=>{let e=this.fb.group({ingredient_id:[n.ingredient_id,_.required],quantity:[n.quantity,[_.required,_.min(0)]],cost:[n.cost||0]});this.ingredientsArray.push(e)}):this.addIngredient(),setTimeout(()=>{this.calculateCost()},100)}get ingredientsArray(){return this.foodCostForm.get("ingredients")}addIngredient(){let t=this.fb.group({ingredient_id:["",_.required],quantity:[0,[_.required,_.min(0)]],cost:[0]});this.ingredientsArray.push(t)}removeIngredient(t){this.ingredientsArray.removeAt(t),this.manualCalculateCost()}getIngredientUnitSymbol(t){let n=this.ingredients.find(a=>a.id===t);if(!n||!n.unit_id)return"";let e=this.unitService.getUnitById(n.unit_id);return e?e.symbol:""}calculateIngredientCost(t,n){if(!t||!t.unit_id||!t.units)return t.cost_per_unit*n;let e=t.units,a=n;switch(e.symbol){case"kg":a=n/1e3;break;case"L":a=n/1e3;break;case"g":case"mL":case"pz":a=n;break;default:a=n}return t.cost_per_unit*a}manualCalculateCost(){this.calculateCost()}calculateCost(){this.totalCost=0,this.ingredientsArray.controls.forEach(t=>{let n=t.get("ingredient_id")?.value,e=t.get("quantity")?.value||0;if(n&&e>0){let a=this.ingredients.find(d=>d.id===n);if(a){let d=this.calculateIngredientCost(a,e);this.totalCost+=d,t.patchValue({cost:d},{emitEvent:!1})}}else t.patchValue({cost:0},{emitEvent:!1})}),this.calculateSuggestedPrice()}calculateSuggestedPrice(){this.suggestedPrice=this.totalCost/.3}getFoodCostPercentage(){let t=this.foodCostForm.get("sellingPrice")?.value||0;return t>0?this.totalCost/t*100:0}getIngredientCost(t,n){let e=this.ingredients.find(a=>a.id===t);return e?this.calculateIngredientCost(e,n):0}onSubmit(){return S(this,null,function*(){if(this.foodCostForm.valid){let t=this.foodCostForm.value,n=[];this.ingredientsArray.controls.forEach(a=>{let d=a.get("ingredient_id")?.value,g=a.get("quantity")?.value||0;if(d&&g>0){let C=this.ingredients.find(E=>E.id===d);if(C){let E=this.calculateIngredientCost(C,g),le=this.getQuantityUnitLabel(d);n.push({ingredient_id:d,quantity:g,cost:E,unit_symbol:le})}}});let e={name:t.dishName,base_price:t.sellingPrice,food_cost:this.totalCost,ingredients_composition:n,delivery_price:t.sellingPrice,takeaway_price:t.sellingPrice,status:"available",description:t.description||"",preparation_time:t.preparation_time||0,category_id:t.category_id};try{if(this.isEditing&&this.currentDish){let a={name:t.dishName,base_price:t.sellingPrice,food_cost:this.totalCost,ingredients_composition:n,delivery_price:t.sellingPrice,takeaway_price:t.sellingPrice,status:"available",description:t.description||"",preparation_time:t.preparation_time||0,category_id:t.category_id};yield this.dishService.updateDish(this.currentDish.id,a),alert("Piatto aggiornato con successo!")}else(yield this.dishService.createDish(e))?(alert("Piatto creato con successo!"),this.resetForm()):alert("Errore nella creazione del piatto")}catch(a){console.error("Errore nel salvataggio:",a),alert("Errore nel salvataggio del piatto")}}else this.markFormGroupTouched(this.foodCostForm),alert("Compila tutti i campi obbligatori")})}resetForm(){for(this.foodCostForm.reset();this.ingredientsArray.length;)this.ingredientsArray.removeAt(0);this.addIngredient(),this.totalCost=0,this.suggestedPrice=0;let t=this.categories.find(n=>n.is_default)||this.categories[0];t&&this.foodCostForm.patchValue({category_id:t.id})}markFormGroupTouched(t){Object.keys(t.controls).forEach(n=>{let e=t.get(n);e instanceof R?this.markFormGroupTouched(e):e?.markAsTouched()})}getQuantityUnitLabel(t){let n=this.ingredients.find(a=>a.id===t);if(!n||!n.unit_id||!n.units)return"pz";let e=n.units;switch(e.symbol){case"kg":return"g";case"L":return"mL";case"g":case"mL":case"pz":default:return e.symbol}}canSave(){let t=!!this.foodCostForm.get("dishName")?.valid,e=(this.foodCostForm.get("sellingPrice")?.value??0)>0,a=!!this.foodCostForm.get("category_id")?.value&&!this.showNewCategoryForm,d=this.ingredientsArray.controls.some(g=>{let C=g.get("ingredient_id")?.value,E=Number(g.get("quantity")?.value??0);return!!C&&E>0});return t&&e&&a&&d}onIngredientSearch(t,n){let e=t.target.value.toLowerCase();if(e){let a=this.ingredients.filter(d=>d.name.toLowerCase().includes(e)||d.description?.toLowerCase().includes(e))}}onIngredientSelected(t,n){let e=t.target.value,a=this.ingredients.find(d=>d.name===e);a?(this.ingredientsArray.at(n).patchValue({ingredient_id:a.id},{emitEvent:!1}),this.manualCalculateCost()):(this.ingredientsArray.at(n).patchValue({ingredient_id:""},{emitEvent:!1}),this.manualCalculateCost())}getIngredientName(t){if(!t)return"";let n=this.ingredients.find(e=>e.id===t);return n?n.name:""}toggleNewCategoryForm(){this.showNewCategoryForm=!this.showNewCategoryForm,this.showNewCategoryForm||this.newCategoryForm.reset()}onCreateCategory(){return S(this,null,function*(){if(this.newCategoryForm.valid){this.isCreatingCategory=!0;try{let t={name:this.newCategoryForm.get("name")?.value,description:this.newCategoryForm.get("description")?.value,is_default:this.newCategoryForm.get("is_default")?.value},n=yield this.categoryService.createCategory(t);n?(this.foodCostForm.patchValue({category_id:n.id}),this.showNewCategoryForm=!1,this.newCategoryForm.reset(),alert("Categoria creata con successo!")):alert("Errore nella creazione della categoria")}catch(t){console.error("Errore nella creazione della categoria:",t),alert("Errore nella creazione della categoria")}finally{this.isCreatingCategory=!1}}else this.markFormGroupTouched(this.newCategoryForm)})}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=O({type:s,selectors:[["app-food-cost-calculator"]],inputs:{dishId:"dishId"},decls:179,vars:73,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"dashboard-grid"],[1,"form-card"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","dishName",1,"form-label"],["id","dishName","formControlName","dishName","type","text","placeholder","Inserisci il nome del piatto"],["for","category_id",1,"form-label"],[1,"category-select-container"],["id","category_id","formControlName","category_id",1,"form-select",3,"disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","button","title","Aggiungi nuova categoria",1,"icon-button",3,"click","disabled"],["class","error-message",4,"ngIf"],["class","form-subsection","style","margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; border-radius: 4px;",4,"ngIf"],["for","preparation_time",1,"form-label"],["id","preparation_time","formControlName","preparation_time","type","number","min","0","placeholder","0"],["for","sellingPrice",1,"form-label"],["id","sellingPrice","formControlName","sellingPrice","type","number","step","0.01","min","0","placeholder","0.00",3,"change"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Descrizione del piatto (opzionale)"],[1,"form-section","ingredients-section"],[1,"chip",2,"margin-left","auto"],[1,"ingredients-header"],["formArrayName","ingredients"],["class","ingredient-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"promethea-button","secondary",2,"margin-top","var(--gutter-md)",3,"click"],[1,"costs-grid"],[1,"compact-cost-item"],[1,"cost-value"],[1,"cost-label"],[4,"ngIf"],[1,"form-actions"],["type","submit",1,"promethea-button",3,"disabled"],[1,"card-content"],[1,"info-item"],[1,"contact-info"],[1,"info-label"],[1,"info-value"],[1,"info-detail"],[1,"chart-container",2,"margin-top","var(--gutter-lg)"],[1,"chart-bars"],[1,"chart-bar"],[1,"bar-label"],[1,"bar-container"],[1,"bar-fill"],[1,"bar-value"],[3,"value"],[1,"error-message"],[1,"form-subsection",2,"margin-top","1rem","padding","1rem","border","1px solid #ccc","border-radius","4px"],[2,"margin-top","0"],[3,"formGroup"],["for","newCategoryName",1,"form-label"],["id","newCategoryName","formControlName","name","type","text","placeholder","Inserisci il nome della categoria",1,"form-input"],["for","newCategoryDescription",1,"form-label"],["id","newCategoryDescription","formControlName","description","rows","2","placeholder","Descrizione della categoria (opzionale)",1,"form-input"],[1,"checkbox-label"],["type","checkbox","formControlName","is_default"],[1,"checkmark"],[1,"form-actions",2,"margin-top","1rem"],["type","button",1,"promethea-button","secondary",3,"click","disabled"],["type","button",1,"promethea-button",3,"click","disabled"],["class","material-icons",4,"ngIf"],[1,"ingredient-row",3,"formGroupName"],["list","ingredientsList","placeholder","Cerca ingrediente...",1,"searchable-select","compact-input",3,"input","blur","change","value"],["id","ingredientsList"],["formControlName","ingredient_id",2,"display","none"],[2,"display","flex","align-items","center","gap","0.5rem"],["formControlName","quantity","type","number","step","0.001","min","0","placeholder","0",1,"compact-input",2,"flex","1",3,"change"],["class","text-muted","style","font-size: 0.8rem; white-space: nowrap;",4,"ngIf"],[1,"ingredient-cost"],["type","button","title","Rimuovi ingrediente",1,"icon-button","compact-remove-btn",3,"click"],[1,"material-icons",2,"font-size","18px"],[1,"text-muted",2,"font-size","0.8rem","white-space","nowrap"]],template:function(n,e){if(n&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),o(4),i()(),r(5,"div",4)(6,"h1",5),o(7),i(),r(8,"p",6),o(9),i()()(),r(10,"div",7)(11,"div",8)(12,"form",9),y("ngSubmit",function(){return e.onSubmit()}),r(13,"div",10)(14,"div",11)(15,"label",12)(16,"span",3),o(17,"restaurant"),i(),o(18," Nome Piatto * "),i(),h(19,"input",13),i(),r(20,"div",11)(21,"label",14)(22,"span",3),o(23,"category"),i(),o(24," Categoria * "),i(),r(25,"div",15)(26,"select",16)(27,"option",17),o(28,"Seleziona una categoria"),i(),f(29,de,3,3,"option",18),i(),r(30,"button",19),y("click",function(){return e.toggleNewCategoryForm()}),r(31,"span",3),o(32,"add"),i()()(),f(33,ce,2,0,"div",20),i()(),f(34,ue,25,7,"div",21),r(35,"div",10)(36,"div",11)(37,"label",22)(38,"span",3),o(39,"timer"),i(),o(40," Tempo di Preparazione (minuti) "),i(),h(41,"input",23),i(),r(42,"div",11)(43,"label",24)(44,"span",3),o(45,"euro"),i(),o(46," Prezzo di Vendita * "),i(),r(47,"input",25),y("change",function(){return e.manualCalculateCost()}),i()()(),r(48,"div",11)(49,"label",26)(50,"span",3),o(51,"description"),i(),o(52," Descrizione "),i(),h(53,"textarea",27),i(),r(54,"div",28)(55,"h2",5)(56,"span",3),o(57,"list"),i(),o(58," Ingredienti "),r(59,"span",29),o(60),i()(),r(61,"div",30)(62,"div"),o(63,"Ingrediente"),i(),r(64,"div"),o(65,"Quantit\xE0"),i(),r(66,"div"),o(67,"Costo"),i(),h(68,"div"),i(),r(69,"div",31),f(70,he,20,9,"div",32),i(),r(71,"button",33),y("click",function(){return e.addIngredient()}),r(72,"span",3),o(73,"add"),i(),o(74," Aggiungi Ingrediente "),i()(),r(75,"div",8)(76,"h2",5)(77,"span",3),o(78,"analytics"),i(),o(79," Riepilogo Costi "),i(),r(80,"div",34)(81,"div",35)(82,"div",36),o(83),p(84,"number"),i(),r(85,"div",37),o(86,"Costo Ingredienti"),i()(),r(87,"div",35)(88,"div",36),o(89),p(90,"number"),i(),r(91,"div",37),o(92," Food Cost "),f(93,ye,2,0,"span",38)(94,be,2,0,"span",38),i()(),r(95,"div",35)(96,"div",36),o(97),p(98,"number"),i(),r(99,"div",37),o(100,"Prezzo Suggerito"),i()(),r(101,"div",35)(102,"div",36),o(103),p(104,"number"),i(),r(105,"div",37),o(106,"Margine"),i()()()(),r(107,"div",39)(108,"button",40)(109,"span",3),o(110),i(),o(111),i()()()(),r(112,"div",8)(113,"h2",5)(114,"span",3),o(115,"analytics"),i(),o(116," Riepilogo Costi "),i(),r(117,"div",41)(118,"div",42)(119,"span",3),o(120,"shopping_basket"),i(),r(121,"div",43)(122,"span",44),o(123,"Costo Totale Ingredienti"),i(),r(124,"span",45),o(125),p(126,"number"),i()()(),r(127,"div",42)(128,"span",3),o(129,"percent"),i(),r(130,"div",43)(131,"span",44),o(132,"Percentuale Food Cost"),i(),r(133,"span",45),o(134),p(135,"number"),i(),r(136,"span",46),o(137),i()()(),r(138,"div",42)(139,"span",3),o(140,"lightbulb"),i(),r(141,"div",43)(142,"span",44),o(143,"Prezzo Suggerito (30% FC)"),i(),r(144,"span",45),o(145),p(146,"number"),i(),r(147,"span",46),o(148,"Per mantenere il food cost al 30%"),i()()(),r(149,"div",42)(150,"span",3),o(151,"trending_up"),i(),r(152,"div",43)(153,"span",44),o(154,"Margine di Guadagno"),i(),r(155,"span",45),o(156),p(157,"number"),i(),r(158,"span",46),o(159),p(160,"number"),i()()()(),r(161,"div",47)(162,"div",48)(163,"div",49)(164,"div",50),o(165,"Costo"),i(),r(166,"div",51),h(167,"div",52),i(),r(168,"div",53),o(169),p(170,"number"),i()(),r(171,"div",49)(172,"div",50),o(173,"Margine"),i(),r(174,"div",51),h(175,"div",52),i(),r(176,"div",53),o(177),p(178,"number"),i()()()()()()()),n&2){let a,d,g,C;l(4),P(e.isEditing?"edit":"calculate"),l(3),P(e.isEditing?"Modifica Piatto":"Calcolo Food Cost"),l(2),m(" ",e.isEditing?"Modifica il piatto esistente":"Calcola il costo degli ingredienti e il prezzo di vendita ottimale"," "),l(3),c("formGroup",e.foodCostForm),l(14),c("disabled",e.showNewCategoryForm),l(3),c("ngForOf",e.categories),l(),c("disabled",e.showNewCategoryForm),l(3),c("ngIf",((a=e.foodCostForm.get("category_id"))==null?null:a.invalid)&&((a=e.foodCostForm.get("category_id"))==null?null:a.touched)),l(),c("ngIf",e.showNewCategoryForm),l(26),m(" ",e.ingredientsArray.length," ingredienti "),l(10),c("ngForOf",e.ingredientsArray.controls),l(13),m("\u20AC",u(84,40,e.totalCost,"1.2-2")),l(6),m("",u(90,43,e.getFoodCostPercentage(),"1.1-1"),"%"),l(2),k("food-cost-warning",e.getFoodCostPercentage()>35)("food-cost-optimal",e.getFoodCostPercentage()<=35),l(2),c("ngIf",e.getFoodCostPercentage()>35),l(),c("ngIf",e.getFoodCostPercentage()<=35),l(3),m("\u20AC",u(98,46,e.suggestedPrice,"1.2-2")),l(6),m("\u20AC",u(104,49,((d=e.foodCostForm.get("sellingPrice"))==null?null:d.value)-e.totalCost,"1.2-2")),l(5),c("disabled",!e.canSave()),l(2),P(e.isEditing?"update":"save"),l(),m(" ",e.isEditing?"Aggiorna Piatto":"Salva Piatto"," "),l(14),m("\u20AC",u(126,52,e.totalCost,"1.2-2")),l(9),m("",u(135,55,e.getFoodCostPercentage(),"1.1-1"),"%"),l(2),k("error",e.getFoodCostPercentage()>35),l(),m(" ",e.getFoodCostPercentage()>35?"Alta - Considera di aumentare il prezzo":"Ottimale"," "),l(8),m("\u20AC",u(146,58,e.suggestedPrice,"1.2-2")),l(11),m(" \u20AC",u(157,61,((g=e.foodCostForm.get("sellingPrice"))==null?null:g.value)-e.totalCost,"1.2-2")," "),l(3),m(" ",u(160,64,(((C=e.foodCostForm.get("sellingPrice"))==null?null:C.value)-e.totalCost)/((C=e.foodCostForm.get("sellingPrice"))==null?null:C.value)*100,"1.1-1"),"% di margine "),l(8),N("height",e.getFoodCostPercentage(),"%"),l(2),m("",u(170,67,e.getFoodCostPercentage(),"1.0-0"),"%"),l(6),N("height",100-e.getFoodCostPercentage(),"%")("background","var(--tertiary)"),l(2),m("",u(178,70,100-e.getFoodCostPercentage(),"1.0-0"),"%")}},dependencies:[z,M,D,te,U,X,Y,q,Q,B,K,L,$,Z,j,J,W,H,V],styles:[".dashboard-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-md);align-items:start}.form-card[_ngcontent-%COMP%]{padding:var(--gutter-md)}.ingredients-section[_ngcontent-%COMP%]{margin-top:var(--gutter-md)}.ingredient-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr auto auto;gap:var(--gutter-sm);align-items:start;padding:var(--gutter-sm);border-bottom:1px solid var(--smoke-color-1);transition:background-color .2s ease}.ingredient-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.ingredient-row[_ngcontent-%COMP%]:hover{background:var(--smoke-color-1);border-radius:8px}.ingredients-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr auto auto;gap:var(--gutter-sm);padding:var(--gutter-sm);background:var(--smoke-color-1);border-radius:8px;margin-bottom:var(--gutter-sm);font-weight:600;font-size:var(--fs-sm)}.compact-input[_ngcontent-%COMP%]{padding:.5rem .75rem;height:38px;font-size:.9rem}.compact-select[_ngcontent-%COMP%]{padding:.5rem .75rem;height:38px;font-size:.9rem;background-size:12px}.ingredient-cost[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:var(--primary);min-width:80px;padding:.5rem 0}.compact-remove-btn[_ngcontent-%COMP%]{padding:.5rem;min-width:38px;height:38px;display:flex;align-items:center;justify-content:center}.costs-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--gutter-sm);margin-bottom:var(--gutter-md)}.compact-cost-item[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:12px;padding:var(--gutter-sm);text-align:center}.cost-value[_ngcontent-%COMP%]{font-size:var(--fs-md);font-weight:800;color:var(--primary);line-height:1.2}.cost-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-muted);margin-top:.25rem}.compact-chart[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-md);margin-top:var(--gutter-md)}.compact-chart-bar[_ngcontent-%COMP%]{flex:1;text-align:center}.compact-bar-container[_ngcontent-%COMP%]{height:80px;width:var(--fs-lg);background:var(--smoke-color-1);border-radius:8px;position:relative;overflow:hidden;margin-bottom:.5rem}.compact-bar-fill[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:var(--gradiente);transition:height .3s ease}.compact-bar-fill.margin[_ngcontent-%COMP%]{background:var(--tertiary)}.food-cost-warning[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.food-cost-optimal[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.category-select-container[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);align-items:center}.category-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1}.new-category-compact[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:12px;padding:var(--gutter-md);margin-top:var(--gutter-sm)}@media (max-width: 968px){.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm)}.ingredient-row[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr auto;gap:var(--gutter-sm)}.ingredients-header[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr auto}.costs-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]{padding:var(--gutter-sm)}.ingredient-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm);padding:var(--gutter-sm) 0}.ingredients-header[_ngcontent-%COMP%]{display:none}.compact-chart[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}}.searchable-select[_ngcontent-%COMP%]{width:100%;background:var(--background);border-radius:12px;border:1px solid var(--smoke-color-1)}.form-label[_ngcontent-%COMP%]{margin-bottom:0}"]})};export{ae as a};
