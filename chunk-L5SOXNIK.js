import{$ as jt,$a as Da,A as vr,Aa as us,Ab as he,B as sa,Ba as pa,Bb as V,C as wn,Ca as Sn,Cb as Ta,Ea as cs,F as je,Fa as ga,Ga as ls,Gb as Oa,H as ut,I as ct,Ia as ma,Ib as Ia,Jb as ka,K as ts,L as Ut,La as ht,Ma as va,N as _n,Na as ya,O as Je,Oa as ds,P as rs,Pa as ft,Q as oa,Qa as Bt,R as aa,Ra as wa,Sa as hs,T as ua,Ta as _a,U as ae,Ua as pt,V as ns,Va as U,W as Z,Wa as ba,X as k,Xa as br,Y as yr,Za as Sa,_ as O,_a as Dn,a as E,aa as ca,ab as zt,b as te,ba as $,bb as Te,c as ot,ca as I,cb as Sr,d as Ul,da as D,e as Lt,ea as la,ec as Pa,f as h,fa as da,fb as Ea,fc as ms,g as ea,ga as lt,gb as fs,gc as $e,h as ta,ha as ve,hb as ps,i as ra,ib as gs,j as Qi,jb as Ca,jc as xa,k as es,kb as Ra,kc as Ma,l as Se,lc as Ht,m as me,ma as wr,mc as Na,n as Ue,na as W,nc as La,o as at,oa as is,oc as Fa,p as y,pa as ss,pc as Dr,q as Ft,qa as _r,r as H,ra as bn,s as re,sa as ha,sb as Aa,sc as Ua,t as C,u as mr,v as na,va as $t,w as ia,wa as os,x as L,xa as as,y as yn,ya as dt,z as oe,za as fa}from"./chunk-KZSY5CHT.js";var vo=ot(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});var go=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};mo.default=go});var _o=ot(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});var Af=(H(),Lt(Ft)),Tf=Af.__importDefault(vo()),yo=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");let r=this.fetch,i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>h(this,null,function*(){var o,a,u,c;let l=null,d=null,p=null,f=s.status,g=s.statusText;if(s.ok){if(this.method!=="HEAD"){let T=yield s.text();T===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?d=T:d=JSON.parse(T))}let m=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");m&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(l={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,p=null,f=406,g="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{let m=yield s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(d=[],l=null,f=200,g="OK")}catch{s.status===404&&m===""?(f=204,g="No Content"):l={message:m}}if(l&&this.isMaybeSingle&&(!((c=l?.details)===null||c===void 0)&&c.includes("0 rows"))&&(l=null,f=200,g="OK"),l&&this.shouldThrowOnError)throw new Tf.default(l)}return{error:l,data:d,count:p,status:f,statusText:g}}));return this.shouldThrowOnError||(i=i.catch(s=>{var o,a,u;return{error:{message:`${(o=s?.name)!==null&&o!==void 0?o:"FetchError"}: ${s?.message}`,details:`${(a=s?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(u=s?.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}returns(){return this}overrideTypes(){return this}};wo.default=yo});var Do=ot(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});var Of=(H(),Lt(Ft)),If=Of.__importDefault(_o()),bo=class extends If.default{select(t){let e=!1,r=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){let o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){let i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:i=r}={}){let s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var a;let u=[t?"analyze":null,e?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};So.default=bo});var yi=ot(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});var kf=(H(),Lt(Ft)),Pf=kf.__importDefault(Do()),xf=new RegExp("[,()]"),Eo=class extends Pf.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let r=Array.from(new Set(e)).map(i=>typeof i=="string"&&xf.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");let o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){let i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}};Co.default=Eo});var To=ot(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});var Mf=(H(),Lt(Ft)),tn=Mf.__importDefault(yi()),Ro=class{constructor(t,{headers:e={},schema:r,fetch:i}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=i}select(t,e){let{head:r=!1,count:i}=e??{},s=r?"HEAD":"GET",o=!1,a=(t??"*").split("").map(u=>/\s/.test(u)&&!o?"":(u==='"'&&(o=!o),u)).join("");return this.url.searchParams.set("select",a),i&&this.headers.append("Prefer",`count=${i}`),new tn.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var i;let s="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){let o=t.reduce((a,u)=>a.concat(Object.keys(u)),[]);if(o.length>0){let a=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",a.join(","))}}return new tn.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){var o;let a="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){let u=t.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(u.length>0){let c=[...new Set(u)].map(l=>`"${l}"`);this.url.searchParams.set("columns",c.join(","))}}return new tn.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:e}={}){var r;let i="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new tn.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;let r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new tn.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}};Ao.default=Ro});var Sc=ot(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});var bc=(H(),Lt(Ft)),Nf=bc.__importDefault(To()),Lf=bc.__importDefault(yi()),Oo=class n{constructor(t,{headers:e={},schema:r,fetch:i}={}){this.url=t,this.headers=new Headers(e),this.schemaName=r,this.fetch=i}from(t){let e=new URL(`${this.url}/${t}`);return new Nf.default(e,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new n(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:r=!1,get:i=!1,count:s}={}){var o;let a,u=new URL(`${this.url}/rpc/${t}`),c;r||i?(a=r?"HEAD":"GET",Object.entries(e).filter(([d,p])=>p!==void 0).map(([d,p])=>[d,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([d,p])=>{u.searchParams.append(d,p)})):(a="POST",c=e);let l=new Headers(this.headers);return s&&l.set("Prefer",`count=${s}`),new Lf.default({method:a,url:u,headers:l,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Io.default=Oo});var Oc=ot(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.PostgrestError=ie.PostgrestBuilder=ie.PostgrestTransformBuilder=ie.PostgrestFilterBuilder=ie.PostgrestQueryBuilder=ie.PostgrestClient=void 0;var ir=(H(),Lt(Ft)),Dc=ir.__importDefault(Sc());ie.PostgrestClient=Dc.default;var Ec=ir.__importDefault(To());ie.PostgrestQueryBuilder=Ec.default;var Cc=ir.__importDefault(yi());ie.PostgrestFilterBuilder=Cc.default;var Rc=ir.__importDefault(Do());ie.PostgrestTransformBuilder=Rc.default;var Ac=ir.__importDefault(_o());ie.PostgrestBuilder=Ac.default;var Tc=ir.__importDefault(vo());ie.PostgrestError=Tc.default;ie.default={PostgrestClient:Dc.default,PostgrestQueryBuilder:Ec.default,PostgrestFilterBuilder:Cc.default,PostgrestTransformBuilder:Rc.default,PostgrestBuilder:Ac.default,PostgrestError:Tc.default}});var Ba=null;function Be(){return Ba}function vs(n){Ba??=n}var Er=class{},Cr=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(za),providedIn:"platform"})}return n})(),ys=new $(""),za=(()=>{class n extends Cr{_location;_history;_doc=D(W);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Be().getBaseHref(this._doc)}onPopState(e){let r=Be().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){let r=Be().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,i){this._history.pushState(e,r,i)}replaceState(e,r,i){this._history.replaceState(e,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function En(n,t){return n?t?n.endsWith("/")?t.startsWith("/")?n+t.slice(1):n+t:t.startsWith("/")?n+t:`${n}/${t}`:n:t}function ja(n){let t=n.search(/#|\?|$/);return n[t-1]==="/"?n.slice(0,t-1)+n.slice(t):n}function De(n){return n&&n[0]!=="?"?`?${n}`:n}var ye=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(Rn),providedIn:"root"})}return n})(),Cn=new $(""),Rn=(()=>{class n extends ye{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??D(W).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return En(this._baseHref,e)}path(e=!1){let r=this._platformLocation.pathname+De(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,s){let o=this.prepareExternalUrl(i+De(s));this._platformLocation.pushState(e,r,o)}replaceState(e,r,i,s){let o=this.prepareExternalUrl(i+De(s));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||n)(I(Cr),I(Cn,8))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ye=(()=>{class n{_subject=new Se;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let r=this._locationStrategy.getBaseHref();this._basePath=Bl(ja($a(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+De(r))}normalize(e){return n.stripTrailingSlash($l(this._basePath,$a(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._locationStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+De(r)),i)}replaceState(e,r="",i=null){this._locationStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+De(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=De;static joinWithSlash=En;static stripTrailingSlash=ja;static \u0275fac=function(r){return new(r||n)(I(ye))};static \u0275prov=O({token:n,factory:()=>jl(),providedIn:"root"})}return n})();function jl(){return new Ye(I(ye))}function $l(n,t){if(!n||!t.startsWith(n))return t;let e=t.substring(n.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function $a(n){return n.replace(/\/index.html$/,"")}function Bl(n){if(new RegExp("^(https?:)?//").test(n)){let[,e]=n.split(/\/\/[^\/]+/);return e}return n}var Ln=(()=>{class n extends ye{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){let r=En(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,i,s){let o=this.prepareExternalUrl(i+De(s))||this._platformLocation.pathname;this._platformLocation.pushState(e,r,o)}replaceState(e,r,i,s){let o=this.prepareExternalUrl(i+De(s))||this._platformLocation.pathname;this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||n)(I(Cr),I(Cn,8))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})();var Cs=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(Cs||{});var X=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(X||{}),M=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(M||{}),ue=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ue||{}),ce={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Ka(n){return he(n)[V.LocaleId]}function Ja(n,t,e){let r=he(n),i=[r[V.DayPeriodsFormat],r[V.DayPeriodsStandalone]],s=we(i,t);return we(s,e)}function Ya(n,t,e){let r=he(n),i=[r[V.DaysFormat],r[V.DaysStandalone]],s=we(i,t);return we(s,e)}function Za(n,t,e){let r=he(n),i=[r[V.MonthsFormat],r[V.MonthsStandalone]],s=we(i,t);return we(s,e)}function Xa(n,t){let r=he(n)[V.Eras];return we(r,t)}function Rr(n,t){let e=he(n);return we(e[V.DateFormat],t)}function Ar(n,t){let e=he(n);return we(e[V.TimeFormat],t)}function Tr(n,t){let r=he(n)[V.DateTimeFormat];return we(r,t)}function Oe(n,t){let e=he(n),r=e[V.NumberSymbols][t];if(typeof r>"u"){if(t===ce.CurrencyDecimal)return e[V.NumberSymbols][ce.Decimal];if(t===ce.CurrencyGroup)return e[V.NumberSymbols][ce.Group]}return r}function Qa(n,t){return he(n)[V.NumberFormats][t]}function eu(n){if(!n[V.ExtraData])throw new k(2303,!1)}function tu(n){let t=he(n);return eu(t),(t[V.ExtraData][2]||[]).map(r=>typeof r=="string"?ws(r):[ws(r[0]),ws(r[1])])}function ru(n,t,e){let r=he(n);eu(r);let i=[r[V.ExtraData][0],r[V.ExtraData][1]],s=we(i,t)||[];return we(s,e)||[]}function we(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new k(2304,!1)}function ws(n){let[t,e]=n.split(":");return{hours:+t,minutes:+e}}var zl=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,An={},Hl=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function nu(n,t,e,r){let i=Xl(n);t=ze(e,t)||t;let o=[],a;for(;t;)if(a=Hl.exec(t),a){o=o.concat(a.slice(1));let l=o.pop();if(!l)break;t=l}else{o.push(t);break}let u=i.getTimezoneOffset();r&&(u=su(r,u),i=Zl(i,r));let c="";return o.forEach(l=>{let d=Jl(l);c+=d?d(i,e,u):l==="''"?"'":l.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Pn(n,t,e){let r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function ze(n,t){let e=Ka(n);if(An[e]??={},An[e][t])return An[e][t];let r="";switch(t){case"shortDate":r=Rr(n,ue.Short);break;case"mediumDate":r=Rr(n,ue.Medium);break;case"longDate":r=Rr(n,ue.Long);break;case"fullDate":r=Rr(n,ue.Full);break;case"shortTime":r=Ar(n,ue.Short);break;case"mediumTime":r=Ar(n,ue.Medium);break;case"longTime":r=Ar(n,ue.Long);break;case"fullTime":r=Ar(n,ue.Full);break;case"short":let i=ze(n,"shortTime"),s=ze(n,"shortDate");r=Tn(Tr(n,ue.Short),[i,s]);break;case"medium":let o=ze(n,"mediumTime"),a=ze(n,"mediumDate");r=Tn(Tr(n,ue.Medium),[o,a]);break;case"long":let u=ze(n,"longTime"),c=ze(n,"longDate");r=Tn(Tr(n,ue.Long),[u,c]);break;case"full":let l=ze(n,"fullTime"),d=ze(n,"fullDate");r=Tn(Tr(n,ue.Full),[l,d]);break}return r&&(An[e][t]=r),r}function Tn(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return t!=null&&r in t?t[r]:e})),n}function Ee(n,t,e="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),s+o}function Vl(n,t){return Ee(n,3).substring(0,t)}function q(n,t,e=0,r=!1,i=!1){return function(s,o){let a=ql(n,s);if((e>0||a>-e)&&(a+=e),n===3)a===0&&e===-12&&(a=12);else if(n===6)return Vl(a,t);let u=Oe(o,ce.MinusSign);return Ee(a,t,u,r,i)}}function ql(n,t){switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new k(2301,!1)}}function j(n,t,e=X.Format,r=!1){return function(i,s){return Gl(i,s,n,t,e,r)}}function Gl(n,t,e,r,i,s){switch(e){case 2:return Za(t,i,r)[n.getMonth()];case 1:return Ya(t,i,r)[n.getDay()];case 0:let o=n.getHours(),a=n.getMinutes();if(s){let c=tu(t),l=ru(t,i,r),d=c.findIndex(p=>{if(Array.isArray(p)){let[f,g]=p,v=o>=f.hours&&a>=f.minutes,m=o<g.hours||o===g.hours&&a<g.minutes;if(f.hours<g.hours){if(v&&m)return!0}else if(v||m)return!0}else if(p.hours===o&&p.minutes===a)return!0;return!1});if(d!==-1)return l[d]}return Ja(t,i,r)[o<12?0:1];case 3:return Xa(t,r)[n.getFullYear()<=0?0:1];default:let u=e;throw new k(2302,!1)}}function On(n){return function(t,e,r){let i=-1*r,s=Oe(e,ce.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+Ee(o,2,s)+Ee(Math.abs(i%60),2,s);case 1:return"GMT"+(i>=0?"+":"")+Ee(o,1,s);case 2:return"GMT"+(i>=0?"+":"")+Ee(o,2,s)+":"+Ee(Math.abs(i%60),2,s);case 3:return r===0?"Z":(i>=0?"+":"")+Ee(o,2,s)+":"+Ee(Math.abs(i%60),2,s);default:throw new k(2310,!1)}}}var Wl=0,kn=4;function Kl(n){let t=Pn(n,Wl,1).getDay();return Pn(n,0,1+(t<=kn?kn:kn+7)-t)}function iu(n){let t=n.getDay(),e=t===0?-3:kn-t;return Pn(n.getFullYear(),n.getMonth(),n.getDate()+e)}function _s(n,t=!1){return function(e,r){let i;if(t){let s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();i=1+Math.floor((o+s)/7)}else{let s=iu(e),o=Kl(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Ee(i,n,Oe(r,ce.MinusSign))}}function In(n,t=!1){return function(e,r){let s=iu(e).getFullYear();return Ee(s,n,Oe(r,ce.MinusSign),t)}}var bs={};function Jl(n){if(bs[n])return bs[n];let t;switch(n){case"G":case"GG":case"GGG":t=j(3,M.Abbreviated);break;case"GGGG":t=j(3,M.Wide);break;case"GGGGG":t=j(3,M.Narrow);break;case"y":t=q(0,1,0,!1,!0);break;case"yy":t=q(0,2,0,!0,!0);break;case"yyy":t=q(0,3,0,!1,!0);break;case"yyyy":t=q(0,4,0,!1,!0);break;case"Y":t=In(1);break;case"YY":t=In(2,!0);break;case"YYY":t=In(3);break;case"YYYY":t=In(4);break;case"M":case"L":t=q(1,1,1);break;case"MM":case"LL":t=q(1,2,1);break;case"MMM":t=j(2,M.Abbreviated);break;case"MMMM":t=j(2,M.Wide);break;case"MMMMM":t=j(2,M.Narrow);break;case"LLL":t=j(2,M.Abbreviated,X.Standalone);break;case"LLLL":t=j(2,M.Wide,X.Standalone);break;case"LLLLL":t=j(2,M.Narrow,X.Standalone);break;case"w":t=_s(1);break;case"ww":t=_s(2);break;case"W":t=_s(1,!0);break;case"d":t=q(2,1);break;case"dd":t=q(2,2);break;case"c":case"cc":t=q(7,1);break;case"ccc":t=j(1,M.Abbreviated,X.Standalone);break;case"cccc":t=j(1,M.Wide,X.Standalone);break;case"ccccc":t=j(1,M.Narrow,X.Standalone);break;case"cccccc":t=j(1,M.Short,X.Standalone);break;case"E":case"EE":case"EEE":t=j(1,M.Abbreviated);break;case"EEEE":t=j(1,M.Wide);break;case"EEEEE":t=j(1,M.Narrow);break;case"EEEEEE":t=j(1,M.Short);break;case"a":case"aa":case"aaa":t=j(0,M.Abbreviated);break;case"aaaa":t=j(0,M.Wide);break;case"aaaaa":t=j(0,M.Narrow);break;case"b":case"bb":case"bbb":t=j(0,M.Abbreviated,X.Standalone,!0);break;case"bbbb":t=j(0,M.Wide,X.Standalone,!0);break;case"bbbbb":t=j(0,M.Narrow,X.Standalone,!0);break;case"B":case"BB":case"BBB":t=j(0,M.Abbreviated,X.Format,!0);break;case"BBBB":t=j(0,M.Wide,X.Format,!0);break;case"BBBBB":t=j(0,M.Narrow,X.Format,!0);break;case"h":t=q(3,1,-12);break;case"hh":t=q(3,2,-12);break;case"H":t=q(3,1);break;case"HH":t=q(3,2);break;case"m":t=q(4,1);break;case"mm":t=q(4,2);break;case"s":t=q(5,1);break;case"ss":t=q(5,2);break;case"S":t=q(6,1);break;case"SS":t=q(6,2);break;case"SSS":t=q(6,3);break;case"Z":case"ZZ":case"ZZZ":t=On(0);break;case"ZZZZZ":t=On(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=On(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=On(2);break;default:return null}return bs[n]=t,t}function su(n,t){n=n.replace(/:/g,"");let e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function Yl(n,t){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+t),n}function Zl(n,t,e){let i=n.getTimezoneOffset(),s=su(t,i);return Yl(n,-1*(s-i))}function Xl(n){if(Ha(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return Pn(i,s-1,o)}let e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(zl))return Ql(r)}let t=new Date(n);if(!Ha(t))throw new k(2311,!1);return t}function Ql(n){let t=new Date(0),e=0,r=0,i=n[8]?t.setUTCFullYear:t.setFullYear,s=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-e,a=Number(n[5]||0)-r,u=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(t,o,a,u,c),t}function Ha(n){return n instanceof Date&&!isNaN(n.valueOf())}var ed=/^(\d+)?\.((\d+)(-(\d+))?)?$/,Va=22,xn=".",Or="0",td=";",rd=",",Ss="#";function nd(n,t,e,r,i,s,o=!1){let a="",u=!1;if(!isFinite(n))a=Oe(e,ce.Infinity);else{let c=od(n);o&&(c=sd(c));let l=t.minInt,d=t.minFrac,p=t.maxFrac;if(s){let T=s.match(ed);if(T===null)throw new k(2306,!1);let _=T[1],w=T[3],P=T[5];_!=null&&(l=Ds(_)),w!=null&&(d=Ds(w)),P!=null?p=Ds(P):w!=null&&d>p&&(p=d)}ad(c,d,p);let f=c.digits,g=c.integerLen,v=c.exponent,m=[];for(u=f.every(T=>!T);g<l;g++)f.unshift(0);for(;g<0;g++)f.unshift(0);g>0?m=f.splice(g,f.length):(m=f,f=[0]);let b=[];for(f.length>=t.lgSize&&b.unshift(f.splice(-t.lgSize,f.length).join(""));f.length>t.gSize;)b.unshift(f.splice(-t.gSize,f.length).join(""));f.length&&b.unshift(f.join("")),a=b.join(Oe(e,r)),m.length&&(a+=Oe(e,i)+m.join("")),v&&(a+=Oe(e,ce.Exponential)+"+"+v)}return n<0&&!u?a=t.negPre+a+t.negSuf:a=t.posPre+a+t.posSuf,a}function ou(n,t,e){let r=Qa(t,Cs.Decimal),i=id(r,Oe(t,ce.MinusSign));return nd(n,i,t,ce.Group,ce.Decimal,e)}function id(n,t="-"){let e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(td),i=r[0],s=r[1],o=i.indexOf(xn)!==-1?i.split(xn):[i.substring(0,i.lastIndexOf(Or)+1),i.substring(i.lastIndexOf(Or)+1)],a=o[0],u=o[1]||"";e.posPre=a.substring(0,a.indexOf(Ss));for(let l=0;l<u.length;l++){let d=u.charAt(l);d===Or?e.minFrac=e.maxFrac=l+1:d===Ss?e.maxFrac=l+1:e.posSuf+=d}let c=a.split(rd);if(e.gSize=c[1]?c[1].length:0,e.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){let l=i.length-e.posPre.length-e.posSuf.length,d=s.indexOf(Ss);e.negPre=s.substring(0,d).replace(/'/g,""),e.negSuf=s.slice(d+l).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}function sd(n){if(n.digits[0]===0)return n;let t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(t===0?n.digits.push(0,0):t===1&&n.digits.push(0),n.integerLen+=2),n}function od(n){let t=Math.abs(n)+"",e=0,r,i,s,o,a;for((i=t.indexOf(xn))>-1&&(t=t.replace(xn,"")),(s=t.search(/e/i))>0?(i<0&&(i=s),i+=+t.slice(s+1),t=t.substring(0,s)):i<0&&(i=t.length),s=0;t.charAt(s)===Or;s++);if(s===(a=t.length))r=[0],i=1;else{for(a--;t.charAt(a)===Or;)a--;for(i-=s,r=[],o=0;s<=a;s++,o++)r[o]=Number(t.charAt(s))}return i>Va&&(r=r.splice(0,Va-1),e=i-1,i=1),{digits:r,exponent:e,integerLen:i}}function ad(n,t,e){if(t>e)throw new k(2307,!1);let r=n.digits,i=r.length-n.integerLen,s=Math.min(Math.max(t,i),e),o=s+n.integerLen,a=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let d=o;d<r.length;d++)r[d]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let d=1;d<o;d++)r[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let u=s!==0,c=t+n.integerLen,l=r.reduceRight(function(d,p,f,g){return p=p+d,g[f]=p<10?p:p-10,u&&(g[f]===0&&f>=c?g.pop():u=!1),p>=10?1:0},0);l&&(r.unshift(l),n.integerLen++)}function Ds(n){let t=parseInt(n);if(isNaN(t))throw new k(2305,!1);return t}var Es=/\s+/,qa=[],ud=(()=>{class n{_ngEl;_renderer;initialClasses=qa;rawClass;stateMap=new Map;constructor(e,r){this._ngEl=e,this._renderer=r}set klass(e){this.initialClasses=e!=null?e.trim().split(Es):qa}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(Es):e}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let r of e)this._updateState(r,!0);else if(e!=null)for(let r of Object.keys(e))this._updateState(r,!!e[r]);this._applyStateDiff()}_updateState(e,r){let i=this.stateMap.get(e);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let r=e[0],i=e[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(e,r){e=e.trim(),e.length>0&&e.split(Es).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(U(dt),U(pt))};static \u0275dir=Te({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Mn=class{$implicit;ngForOf;index;count;constructor(t,e,r,i){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},au=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,r,i){this._viewContainer=e,this._template=r,this._differs=i}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let r=this._viewContainer;e.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Mn(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),Ga(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}e.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);Ga(s,i)})}static ngTemplateContextGuard(e,r){return!0}static \u0275fac=function(r){return new(r||n)(U(br),U(hs),U(Na))};static \u0275dir=Te({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function Ga(n,t){n.context.$implicit=t.item}var cd=(()=>{class n{_viewContainer;_context=new Nn;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,r){this._viewContainer=e,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Wa(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Wa(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,r){return!0}static \u0275fac=function(r){return new(r||n)(U(br),U(hs))};static \u0275dir=Te({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Nn=class{$implicit=null;ngIf=null};function Wa(n,t){if(n&&!n.createEmbeddedView)throw new k(2020,!1)}var ld=(()=>{class n{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(e,r,i){this._ngEl=e,this._differs=r,this._renderer=i}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){let e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){let[i,s]=e.split("."),o=i.indexOf("-")===-1?void 0:ht.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,i,s?`${r}${s}`:r,o):this._renderer.removeStyle(this._ngEl.nativeElement,i,o)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static \u0275fac=function(r){return new(r||n)(U(dt),U(La),U(pt))};static \u0275dir=Te({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return n})();function Fn(n,t){return new k(2100,!1)}var dd=(()=>{class n{transform(e){if(e==null)return null;if(typeof e!="string")throw Fn(n,e);return e.toUpperCase()}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=Sr({name:"uppercase",type:n,pure:!0})}return n})(),hd="mediumDate",uu=new $(""),cu=new $(""),fd=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(e,r,i){this.locale=e,this.defaultTimezone=r,this.defaultOptions=i}transform(e,r,i,s){if(e==null||e===""||e!==e)return null;try{let o=r??this.defaultOptions?.dateFormat??hd,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return nu(e,o,s||this.locale,a)}catch(o){throw Fn(n,o.message)}}static \u0275fac=function(r){return new(r||n)(U(ms,16),U(uu,24),U(cu,24))};static \u0275pipe=Sr({name:"date",type:n,pure:!0})}return n})();var pd=(()=>{class n{_locale;constructor(e){this._locale=e}transform(e,r,i){if(!gd(e))return null;i||=this._locale;try{let s=md(e);return ou(s,i,r)}catch(s){throw Fn(n,s.message)}}static \u0275fac=function(r){return new(r||n)(U(ms,16))};static \u0275pipe=Sr({name:"number",type:n,pure:!0})}return n})();function gd(n){return!(n==null||n===""||n!==n)}function md(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new k(2309,!1);return n}var vd=(()=>{class n{transform(e,r,i){if(e==null)return null;if(!(typeof e=="string"||Array.isArray(e)))throw Fn(n,e);return e.slice(r,i)}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=Sr({name:"slice",type:n,pure:!1})}return n})();var lu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=zt({type:n});static \u0275inj=jt({})}return n})();function Rs(n,t){t=encodeURIComponent(t);for(let e of n.split(";")){let r=e.indexOf("="),[i,s]=r==-1?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===t)return decodeURIComponent(s)}return null}var Ir=class{};var Ts="browser";function Hg(n){return n===Ts}var du=(()=>{class n{static \u0275prov=O({token:n,providedIn:"root",factory:()=>new As(D(W),window)})}return n})(),As=class{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){Array.isArray(t)?this.offset=()=>t:this.offset=t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t,e){this.window.scrollTo(te(E({},e),{left:t[0],top:t[1]}))}scrollToAnchor(t,e){let r=wd(this.document,t);r&&(this.scrollToElement(r,e),r.focus())}setHistoryScrollRestoration(t){try{this.window.history.scrollRestoration=t}catch{console.warn(yr(2400,!1))}}scrollToElement(t,e){let r=t.getBoundingClientRect(),i=r.left+this.window.pageXOffset,s=r.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(te(E({},e),{left:i-o[0],top:s-o[1]}))}};function wd(n,t){let e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}i=r.nextNode()}}return null}var kr=class{_doc;constructor(t){this._doc=t}manager},Un=(()=>{class n extends kr{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i,s){return e.addEventListener(r,i,s),()=>this.removeEventListener(e,r,i,s)}removeEventListener(e,r,i,s){return e.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(I(W))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),$n=new $(""),xs=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,r){this._zone=r,e.forEach(o=>{o.manager=this});let i=e.filter(o=>!(o instanceof Un));this._plugins=i.slice().reverse();let s=e.find(o=>o instanceof Un);s&&this._plugins.push(s)}addEventListener(e,r,i,s){return this._findPluginFor(r).addEventListener(e,r,i,s)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(s=>s.supports(e)),!r)throw new k(5101,!1);return this._eventNameToPlugin.set(e,r),r}static \u0275fac=function(r){return new(r||n)(I($n),I(Bt))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),Os="ng-app-id";function hu(n){for(let t of n)t.remove()}function fu(n,t){let e=t.createElement("style");return e.textContent=n,e}function bd(n,t,e,r){let i=n.head?.querySelectorAll(`style[${Os}="${t}"],link[${Os}="${t}"]`);if(i)for(let s of i)s.removeAttribute(Os),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&e.set(s.textContent,{usage:0,elements:[s]})}function ks(n,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var Ms=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,r,i,s={}){this.doc=e,this.appId=r,this.nonce=i,bd(e,r,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,r){for(let i of e)this.addUsage(i,this.inline,fu);r?.forEach(i=>this.addUsage(i,this.external,ks))}removeStyles(e,r){for(let i of e)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(e,r,i){let s=r.get(e);s?s.usage++:r.set(e,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(e,this.doc)))})}removeUsage(e,r){let i=r.get(e);i&&(i.usage--,i.usage<=0&&(hu(i.elements),r.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])hu(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(e,fu(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(e,ks(r,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,r){return this.nonce&&r.setAttribute("nonce",this.nonce),e.appendChild(r)}static \u0275fac=function(r){return new(r||n)(I(W),I(us),I(cs,8),I(Sn))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),Is={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ns=/%COMP%/g;var gu="%COMP%",Sd=`_nghost-${gu}`,Dd=`_ngcontent-${gu}`,Ed=!0,Cd=new $("",{providedIn:"root",factory:()=>Ed});function Rd(n){return Dd.replace(Ns,n)}function Ad(n){return Sd.replace(Ns,n)}function mu(n,t){return t.map(e=>e.replace(Ns,n))}var Ls=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,r,i,s,o,a,u=null,c=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=a,this.nonce=u,this.tracingService=c,this.platformIsServer=!1,this.defaultRenderer=new Pr(e,o,a,this.platformIsServer,this.tracingService)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(e,r);return i instanceof jn?i.applyToHost(e):i instanceof xr&&i.applyStyles(),i}getOrCreateRenderer(e,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,u=this.eventManager,c=this.sharedStylesHost,l=this.removeStylesOnCompDestroy,d=this.platformIsServer,p=this.tracingService;switch(r.encapsulation){case ls.Emulated:s=new jn(u,c,r,this.appId,l,o,a,d,p);break;case ls.ShadowDom:return new Ps(u,c,e,r,o,a,this.nonce,d,p);default:s=new xr(u,c,r,l,o,a,d,p);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(r){return new(r||n)(I(xs),I(Ms),I(us),I(Cd),I(W),I(Bt),I(cs),I(ya,8))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),Pr=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,r,i,s){this.eventManager=t,this.doc=e,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(Is[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(pu(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(pu(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){e.remove()}selectRootElement(t,e){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new k(-5104,!1);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,i){if(i){e=i+":"+e;let s=Is[i];s?t.setAttributeNS(s,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){let i=Is[r];i?t.removeAttributeNS(i,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,i){i&(ht.DashCase|ht.Important)?t.style.setProperty(e,r,i&ht.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&ht.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t!=null&&(t[e]=r)}setValue(t,e){t.nodeValue=e}listen(t,e,r,i){if(typeof t=="string"&&(t=Be().getGlobalEventTarget(this.doc,t),!t))throw new k(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(t,e,s)),this.eventManager.addEventListener(t,e,s,i)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;t(e)===!1&&e.preventDefault()}}};function pu(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Ps=class extends Pr{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,r,i,s,o,a,u,c){super(t,s,o,u,c),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=i.styles;l=mu(i.id,l);for(let p of l){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=p,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let p of d){let f=ks(p,s);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},xr=class extends Pr{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,r,i,s,o,a,u,c){super(t,s,o,a,u),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=i;let l=r.styles;this.styles=c?mu(c,l):l,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&va.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},jn=class extends xr{contentAttr;hostAttr;constructor(t,e,r,i,s,o,a,u,c){let l=i+"-"+r.id;super(t,e,r,s,o,a,u,c,l),this.contentAttr=Rd(l),this.hostAttr=Ad(l)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}};var Bn=class n extends Er{supportsDOMEvents=!0;static makeCurrent(){vs(new n)}onAndCancel(t,e,r,i){return t.addEventListener(e,r,i),()=>{t.removeEventListener(e,r,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=Td();return e==null?null:Od(e)}resetBaseElement(){Mr=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return Rs(document.cookie,t)}},Mr=null;function Td(){return Mr=Mr||document.head.querySelector("base"),Mr?Mr.getAttribute("href"):null}function Od(n){return new URL(n,document.baseURI).pathname}var Id=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),vu=["alt","control","meta","shift"],kd={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Pd={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},yu=(()=>{class n extends kr{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Be().onAndCancel(e,o.domEventName,a,s))}static parseEventName(e){let r=e.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),vu.forEach(c=>{let l=r.indexOf(c);l>-1&&(r.splice(l,1),o+=c+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let i=kd[e.key]||e.key,s="";return r.indexOf("code.")>-1&&(i=e.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),vu.forEach(o=>{if(o!==i){let a=Pd[o];a(e)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(e,r,i){return s=>{n.matchEventFullKeyCode(s,e)&&i.runGuarded(()=>r(s))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(r){return new(r||n)(I(W))};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})();function xd(n,t,e){let r=E({rootComponent:n,platformRef:e?.platformRef},Md(t));return Fa(r)}function Md(n){return{appProviders:[...jd,...n?.providers??[]],platformProviders:Ud}}function Nd(){Bn.makeCurrent()}function Ld(){return new ss}function Fd(){return fa(document),document}var Ud=[{provide:Sn,useValue:Ts},{provide:pa,useValue:Nd,multi:!0},{provide:W,useFactory:Fd}];var jd=[{provide:da,useValue:"root"},{provide:ss,useFactory:Ld},{provide:$n,useClass:Un,multi:!0,deps:[W]},{provide:$n,useClass:yu,multi:!0,deps:[W]},Ls,Ms,xs,{provide:_a,useExisting:Ls},{provide:Ir,useClass:Id},[]];var wu=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(r){return new(r||n)(I(W))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var A="primary",Wr=Symbol("RouteTitle"),Bs=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function yt(n){return new Bs(n)}function Au(n,t,e){let r=e.path.split("/");if(r.length>n.length||e.pathMatch==="full"&&(t.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Bd(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!Ie(n[e],t[e]))return!1;return!0}function Ie(n,t){let e=n?zs(n):void 0,r=t?zs(t):void 0;if(!e||!r||e.length!=r.length)return!1;let i;for(let s=0;s<e.length;s++)if(i=e[s],!Tu(n[i],t[i]))return!1;return!0}function zs(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Tu(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;let e=[...n].sort(),r=[...t].sort();return e.every((i,s)=>r[s]===i)}else return n===t}function Ou(n){return n.length>0?n[n.length-1]:null}function He(n){return na(n)?n:fs(n)?re(Promise.resolve(n)):C(n)}var zd={exact:ku,subset:Pu},Iu={exact:Hd,subset:Vd,ignored:()=>!0};function _u(n,t,e){return zd[e.paths](n.root,t.root,e.matrixParams)&&Iu[e.queryParams](n.queryParams,t.queryParams)&&!(e.fragment==="exact"&&n.fragment!==t.fragment)}function Hd(n,t){return Ie(n,t)}function ku(n,t,e){if(!mt(n.segments,t.segments)||!Vn(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!n.children[r]||!ku(n.children[r],t.children[r],e))return!1;return!0}function Vd(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>Tu(n[e],t[e]))}function Pu(n,t,e){return xu(n,t,t.segments,e)}function xu(n,t,e,r){if(n.segments.length>e.length){let i=n.segments.slice(0,e.length);return!(!mt(i,e)||t.hasChildren()||!Vn(i,e,r))}else if(n.segments.length===e.length){if(!mt(n.segments,e)||!Vn(n.segments,e,r))return!1;for(let i in t.children)if(!n.children[i]||!Pu(n.children[i],t.children[i],r))return!1;return!0}else{let i=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!mt(n.segments,i)||!Vn(n.segments,i,r)||!n.children[A]?!1:xu(n.children[A],t,s,r)}}function Vn(n,t,e){return t.every((r,i)=>Iu[e](n[i].parameters,r.parameters))}var Pe=class{root;queryParams;fragment;_queryParamMap;constructor(t=new x([],{}),e={},r=null){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=yt(this.queryParams),this._queryParamMap}toString(){return Wd.serialize(this)}},x=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return qn(this)}},Ze=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=yt(this.parameters),this._parameterMap}toString(){return Nu(this)}};function qd(n,t){return mt(n,t)&&n.every((e,r)=>Ie(e.parameters,t[r].parameters))}function mt(n,t){return n.length!==t.length?!1:n.every((e,r)=>e.path===t[r].path)}function Gd(n,t){let e=[];return Object.entries(n.children).forEach(([r,i])=>{r===A&&(e=e.concat(t(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==A&&(e=e.concat(t(i,r)))}),e}var wt=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>new Xe,providedIn:"root"})}return n})(),Xe=class{parse(t){let e=new Vs(t);return new Pe(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${Nr(t.root,!0)}`,r=Yd(t.queryParams),i=typeof t.fragment=="string"?`#${Kd(t.fragment)}`:"";return`${e}${r}${i}`}},Wd=new Xe;function qn(n){return n.segments.map(t=>Nu(t)).join("/")}function Nr(n,t){if(!n.hasChildren())return qn(n);if(t){let e=n.children[A]?Nr(n.children[A],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==A&&r.push(`${i}:${Nr(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}else{let e=Gd(n,(r,i)=>i===A?[Nr(n.children[A],!1)]:[`${i}:${Nr(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[A]!=null?`${qn(n)}/${e[0]}`:`${qn(n)}/(${e.join("//")})`}}function Mu(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function zn(n){return Mu(n).replace(/%3B/gi,";")}function Kd(n){return encodeURI(n)}function Hs(n){return Mu(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gn(n){return decodeURIComponent(n)}function bu(n){return Gn(n.replace(/\+/g,"%20"))}function Nu(n){return`${Hs(n.path)}${Jd(n.parameters)}`}function Jd(n){return Object.entries(n).map(([t,e])=>`;${Hs(t)}=${Hs(e)}`).join("")}function Yd(n){let t=Object.entries(n).map(([e,r])=>Array.isArray(r)?r.map(i=>`${zn(e)}=${zn(i)}`).join("&"):`${zn(e)}=${zn(r)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var Zd=/^[^\/()?;#]+/;function Fs(n){let t=n.match(Zd);return t?t[0]:""}var Xd=/^[^\/()?;=#]+/;function Qd(n){let t=n.match(Xd);return t?t[0]:""}var eh=/^[^=?&#]+/;function th(n){let t=n.match(eh);return t?t[0]:""}var rh=/^[^&#]+/;function nh(n){let t=n.match(rh);return t?t[0]:""}var Vs=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new x([],{}):new x([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[A]=new x(t,e)),r}parseSegment(){let t=Fs(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new k(4009,!1);return this.capture(t),new Ze(Gn(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=Qd(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let i=Fs(this.remaining);i&&(r=i,this.capture(r))}t[Gn(e)]=Gn(r)}parseQueryParam(t){let e=th(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let o=nh(this.remaining);o&&(r=o,this.capture(r))}let i=bu(e),s=bu(r);if(t.hasOwnProperty(i)){let o=t[i];Array.isArray(o)||(o=[o],t[i]=o),o.push(s)}else t[i]=s}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Fs(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new k(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=A);let o=this.parseChildren();e[s??A]=Object.keys(o).length===1&&o[A]?o[A]:new x([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new k(4011,!1)}};function Lu(n){return n.segments.length>0?new x([],{[A]:n}):n}function Fu(n){let t={};for(let[r,i]of Object.entries(n.children)){let s=Fu(i);if(r===A&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))t[o]=a;else(s.segments.length>0||s.hasChildren())&&(t[r]=s)}let e=new x(n.segments,t);return ih(e)}function ih(n){if(n.numberOfChildren===1&&n.children[A]){let t=n.children[A];return new x(n.segments.concat(t.segments),t.children)}return n}function Qe(n){return n instanceof Pe}function Uu(n,t,e=null,r=null){let i=ju(n);return $u(i,t,e,r)}function ju(n){let t;function e(s){let o={};for(let u of s.children){let c=e(u);o[u.outlet]=c}let a=new x(s.url,o);return s===n&&(t=a),a}let r=e(n.root),i=Lu(r);return t??i}function $u(n,t,e,r){let i=n;for(;i.parent;)i=i.parent;if(t.length===0)return Us(i,i,i,e,r);let s=sh(t);if(s.toRoot())return Us(i,i,new x([],{}),e,r);let o=oh(s,i,n),a=o.processChildren?Fr(o.segmentGroup,o.index,s.commands):zu(o.segmentGroup,o.index,s.commands);return Us(i,o.segmentGroup,a,e,r)}function Wn(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function jr(n){return typeof n=="object"&&n!=null&&n.outlets}function Us(n,t,e,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;n===t?o=e:o=Bu(n,t,e);let a=Lu(Fu(o));return new Pe(a,s,i)}function Bu(n,t,e){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===t?r[i]=e:r[i]=Bu(s,t,e)}),new x(n.segments,r)}var Kn=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Wn(r[0]))throw new k(4003,!1);let i=r.find(jr);if(i&&i!==Ou(r))throw new k(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function sh(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Kn(!0,0,n);let t=0,e=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?e=!0:a===".."?t++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Kn(e,t,r)}var Gt=class{segmentGroup;processChildren;index;constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}};function oh(n,t,e){if(n.isAbsolute)return new Gt(t,!0,0);if(!e)return new Gt(t,!1,NaN);if(e.parent===null)return new Gt(e,!0,0);let r=Wn(n.commands[0])?0:1,i=e.segments.length-1+r;return ah(e,i,n.numberOfDoubleDots)}function ah(n,t,e){let r=n,i=t,s=e;for(;s>i;){if(s-=i,r=r.parent,!r)throw new k(4005,!1);i=r.segments.length}return new Gt(r,!1,i-s)}function uh(n){return jr(n[0])?n[0].outlets:{[A]:n}}function zu(n,t,e){if(n??=new x([],{}),n.segments.length===0&&n.hasChildren())return Fr(n,t,e);let r=ch(n,t,e),i=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new x(n.segments.slice(0,r.pathIndex),{});return s.children[A]=new x(n.segments.slice(r.pathIndex),n.children),Fr(s,0,i)}else return r.match&&i.length===0?new x(n.segments,{}):r.match&&!n.hasChildren()?qs(n,t,e):r.match?Fr(n,0,i):qs(n,t,e)}function Fr(n,t,e){if(e.length===0)return new x(n.segments,{});{let r=uh(e),i={};if(Object.keys(r).some(s=>s!==A)&&n.children[A]&&n.numberOfChildren===1&&n.children[A].segments.length===0){let s=Fr(n.children[A],t,e);return new x(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=zu(n.children[s],t,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new x(n.segments,i)}}function ch(n,t,e){let r=0,i=t,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=e.length)return s;let o=n.segments[i],a=e[r];if(jr(a))break;let u=`${a}`,c=r<e.length-1?e[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!Du(u,c,o))return s;r+=2}else{if(!Du(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function qs(n,t,e){let r=n.segments.slice(0,t),i=0;for(;i<e.length;){let s=e[i];if(jr(s)){let u=lh(s.outlets);return new x(r,u)}if(i===0&&Wn(e[0])){let u=n.segments[t];r.push(new Ze(u.path,Su(e[0]))),i++;continue}let o=jr(s)?s.outlets[A]:`${s}`,a=i<e.length-1?e[i+1]:null;o&&a&&Wn(a)?(r.push(new Ze(o,Su(a))),i+=2):(r.push(new Ze(o,{})),i++)}return new x(r,{})}function lh(n){let t={};return Object.entries(n).forEach(([e,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[e]=qs(new x([],{}),0,r))}),t}function Su(n){let t={};return Object.entries(n).forEach(([e,r])=>t[e]=`${r}`),t}function Du(n,t,e){return n==e.path&&Ie(t,e.parameters)}var Wt="imperative",K=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(K||{}),pe=class{id;url;constructor(t,e){this.id=t,this.url=e}},et=class extends pe{type=K.NavigationStart;navigationTrigger;restoredState;constructor(t,e,r="imperative",i=null){super(t,e),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ge=class extends pe{urlAfterRedirects;type=K.NavigationEnd;constructor(t,e,r){super(t,e),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ne=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ne||{}),Jt=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Jt||{}),ke=class extends pe{reason;code;type=K.NavigationCancel;constructor(t,e,r,i){super(t,e),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},xe=class extends pe{reason;code;type=K.NavigationSkipped;constructor(t,e,r,i){super(t,e),this.reason=r,this.code=i}},Yt=class extends pe{error;target;type=K.NavigationError;constructor(t,e,r,i){super(t,e),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},$r=class extends pe{urlAfterRedirects;state;type=K.RoutesRecognized;constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jn=class extends pe{urlAfterRedirects;state;type=K.GuardsCheckStart;constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yn=class extends pe{urlAfterRedirects;state;shouldActivate;type=K.GuardsCheckEnd;constructor(t,e,r,i,s){super(t,e),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Zn=class extends pe{urlAfterRedirects;state;type=K.ResolveStart;constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xn=class extends pe{urlAfterRedirects;state;type=K.ResolveEnd;constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qn=class{route;type=K.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ei=class{route;type=K.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ti=class{snapshot;type=K.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ri=class{snapshot;type=K.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ni=class{snapshot;type=K.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ii=class{snapshot;type=K.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zt=class{routerEvent;position;anchor;type=K.Scroll;constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},Br=class{},Xt=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function dh(n){return!(n instanceof Br)&&!(n instanceof Xt)}function hh(n,t){return n.providers&&!n._injector&&(n._injector=Dn(n.providers,t,`Route: ${n.path}`)),n._injector??t}function Ce(n){return n.outlet||A}function fh(n,t){let e=n.filter(r=>Ce(r)===t);return e.push(...n.filter(r=>Ce(r)!==t)),e}function tr(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){let e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var si=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return tr(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new _t(this.rootInjector)}},_t=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,r){let i=this.getOrCreateContext(e);i.outlet=r,this.contexts.set(e,i)}onChildOutletDestroyed(e){let r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new si(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(r){return new(r||n)(I(lt))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),oi=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=Gs(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){let e=Gs(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=Ws(t,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return Ws(t,this._root).map(e=>e.value)}};function Gs(n,t){if(n===t.value)return t;for(let e of t.children){let r=Gs(n,e);if(r)return r}return null}function Ws(n,t){if(n===t.value)return[t];for(let e of t.children){let r=Ws(n,e);if(r.length)return r.unshift(t),r}return[]}var fe=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function qt(n){let t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}var zr=class extends oi{snapshot;constructor(t,e){super(t),this.snapshot=e,to(this,t)}toString(){return this.snapshot.toString()}};function Hu(n){let t=ph(n),e=new me([new Ze("",{})]),r=new me({}),i=new me({}),s=new me({}),o=new me(""),a=new Me(e,r,s,o,i,A,n,t.root);return a.snapshot=t.root,new zr(new fe(a,[]),t)}function ph(n){let t={},e={},r={},s=new vt([],t,r,"",e,A,n,null,{});return new Hr("",new fe(s,[]))}var Me=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,r,i,s,o,a,u){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(L(c=>c[Wr]))??C(void 0),this.url=t,this.params=e,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(L(t=>yt(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(L(t=>yt(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function ai(n,t,e="emptyOnly"){let r,{routeConfig:i}=n;return t!==null&&(e==="always"||i?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:E(E({},t.params),n.params),data:E(E({},t.data),n.data),resolve:E(E(E(E({},n.data),t.data),i?.data),n._resolvedData)}:r={params:E({},n.params),data:E({},n.data),resolve:E(E({},n.data),n._resolvedData??{})},i&&qu(i)&&(r.resolve[Wr]=i.title),r}var vt=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Wr]}constructor(t,e,r,i,s,o,a,u,c){this.url=t,this.params=e,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=yt(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=yt(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},Hr=class extends oi{url;constructor(t,e){super(e),this.url=t,to(this,e)}toString(){return Vu(this._root)}};function to(n,t){t.value._routerState=n,t.children.forEach(e=>to(n,e))}function Vu(n){let t=n.children.length>0?` { ${n.children.map(Vu).join(", ")} } `:"";return`${n.value}${t}`}function js(n){if(n.snapshot){let t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Ie(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),Ie(t.params,e.params)||n.paramsSubject.next(e.params),Bd(t.url,e.url)||n.urlSubject.next(e.url),Ie(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Ks(n,t){let e=Ie(n.params,t.params)&&qd(n.url,t.url),r=!n.parent!=!t.parent;return e&&!r&&(!n.parent||Ks(n.parent,t.parent))}function qu(n){return typeof n.title=="string"||n.title===null}var Gu=new $(""),ro=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=A;activateEvents=new ft;deactivateEvents=new ft;attachEvents=new ft;detachEvents=new ft;routerOutletData=Ma();parentContexts=D(_t);location=D(br);changeDetector=D(Ht);inputBinder=D(Kr,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:r,previousValue:i}=e.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new k(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new k(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new k(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new k(4013,!1);this._activatedRoute=e;let i=this.location,o=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Js(e,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Te({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[$t]})}return n})(),Js=class{route;childContexts;parent;outletData;constructor(t,e,r,i){this.route=t,this.childContexts=e,this.parent=r,this.outletData=i}get(t,e){return t===Me?this.route:t===_t?this.childContexts:t===Gu?this.outletData:this.parent.get(t,e)}},Kr=new $(""),no=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:r}=e,i=yn([r.queryParams,r.params,r.data]).pipe(ae(([s,o,a],u)=>(a=E(E(E({},s),o),a),u===0?C(a):Promise.resolve(a)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(e);return}let o=Ua(r.component);if(!o){this.unsubscribeFromRouteData(e);return}for(let{templateName:a}of o.inputs)e.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(e,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})(),io=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Da({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Aa(0,"router-outlet")},dependencies:[ro],encapsulation:2})}return n})();function so(n){let t=n.children&&n.children.map(so),e=t?te(E({},n),{children:t}):E({},n);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==A&&(e.component=io),e}function gh(n,t,e){let r=Vr(n,t._root,e?e._root:void 0);return new zr(r,t)}function Vr(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){let r=e.value;r._futureSnapshot=t.value;let i=mh(n,t,e);return new fe(r,i)}else{if(n.shouldAttach(t.value)){let s=n.retrieve(t.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>Vr(n,a)),o}}let r=vh(t.value),i=t.children.map(s=>Vr(n,s));return new fe(r,i)}}function mh(n,t,e){return t.children.map(r=>{for(let i of e.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Vr(n,r,i);return Vr(n,r)})}function vh(n){return new Me(new me(n.url),new me(n.params),new me(n.queryParams),new me(n.fragment),new me(n.data),n.outlet,n.component,n)}var Qt=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},Wu="ngNavigationCancelingError";function ui(n,t){let{redirectTo:e,navigationBehaviorOptions:r}=Qe(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,i=Ku(!1,ne.Redirect);return i.url=e,i.navigationBehaviorOptions=r,i}function Ku(n,t){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[Wu]=!0,e.cancellationCode=t,e}function yh(n){return Ju(n)&&Qe(n.url)}function Ju(n){return!!n&&n[Wu]}var wh=(n,t,e,r)=>L(i=>(new Ys(t,i.targetRouterState,i.currentRouterState,e,r).activate(n),i)),Ys=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,r,i,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(t){let e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),js(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){let i=qt(e);t.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(t,e,r){let i=t.value,s=e?e.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else s&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let r=e.getContext(t.value.outlet),i=r&&t.value.component?r.children:e,s=qt(t);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){let r=e.getContext(t.value.outlet),i=r&&t.value.component?r.children:e,s=qt(t);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,e,r){let i=qt(e);t.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new ii(s.value.snapshot))}),t.children.length&&this.forwardEvent(new ri(t.value.snapshot))}activateRoutes(t,e,r){let i=t.value,s=e?e.value:null;if(js(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),js(a.route.value),this.activateChildRoutes(t,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(t,null,o.children)}else this.activateChildRoutes(t,null,r)}},ci=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Kt=class{component;route;constructor(t,e){this.component=t,this.route=e}};function _h(n,t,e){let r=n._root,i=t?t._root:null;return Lr(r,i,e,[r.value])}function bh(n){let t=n.routeConfig?n.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:n,guards:t}}function rr(n,t){let e=Symbol(),r=t.get(n,e);return r===e?typeof n=="function"&&!ca(n)?n:t.get(n):r}function Lr(n,t,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=qt(t);return n.children.forEach(o=>{Sh(o,s[o.value.outlet],e,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ur(a,e.getContext(o),i)),i}function Sh(n,t,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=Dh(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new ci(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Lr(n,t,a?a.children:null,r,i):Lr(n,t,e,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Kt(a.outlet.component,o))}else o&&Ur(t,a,i),i.canActivateChecks.push(new ci(r)),s.component?Lr(n,null,a?a.children:null,r,i):Lr(n,null,e,r,i);return i}function Dh(n,t,e){if(typeof e=="function")return e(n,t);switch(e){case"pathParamsChange":return!mt(n.url,t.url);case"pathParamsOrQueryParamsChange":return!mt(n.url,t.url)||!Ie(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ks(n,t)||!Ie(n.queryParams,t.queryParams);case"paramsChange":default:return!Ks(n,t)}}function Ur(n,t,e){let r=qt(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?t?Ur(o,t.children.getContext(s),e):Ur(o,null,e):Ur(o,t,e)}),i.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new Kt(t.outlet.component,i)):e.canDeactivateChecks.push(new Kt(null,i)):e.canDeactivateChecks.push(new Kt(null,i))}function Jr(n){return typeof n=="function"}function Eh(n){return typeof n=="boolean"}function Ch(n){return n&&Jr(n.canLoad)}function Rh(n){return n&&Jr(n.canActivate)}function Ah(n){return n&&Jr(n.canActivateChild)}function Th(n){return n&&Jr(n.canDeactivate)}function Oh(n){return n&&Jr(n.canMatch)}function Yu(n){return n instanceof ia||n?.name==="EmptyError"}var Hn=Symbol("INITIAL_VALUE");function er(){return ae(n=>yn(n.map(t=>t.pipe(Ut(1),ua(Hn)))).pipe(L(t=>{for(let e of t)if(e!==!0){if(e===Hn)return Hn;if(e===!1||Ih(e))return e}return!0}),je(t=>t!==Hn),Ut(1)))}function Ih(n){return Qe(n)||n instanceof Qt}function kh(n,t){return oe(e=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=e;return o.length===0&&s.length===0?C(te(E({},e),{guardsResult:!0})):Ph(o,r,i,n).pipe(oe(a=>a&&Eh(a)?xh(r,s,n,t):C(a)),L(a=>te(E({},e),{guardsResult:a})))})}function Ph(n,t,e,r){return re(n).pipe(oe(i=>Uh(i.component,i.route,e,t,r)),Je(i=>i!==!0,!0))}function xh(n,t,e,r){return re(t).pipe(ct(i=>sa(Nh(i.route.parent,r),Mh(i.route,r),Fh(n,i.path,e),Lh(n,i.route,e))),Je(i=>i!==!0,!0))}function Mh(n,t){return n!==null&&t&&t(new ni(n)),C(!0)}function Nh(n,t){return n!==null&&t&&t(new ti(n)),C(!0)}function Lh(n,t,e){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return C(!0);let i=r.map(s=>wn(()=>{let o=tr(t)??e,a=rr(s,o),u=Rh(a)?a.canActivate(t,n):ve(o,()=>a(t,n));return He(u).pipe(Je())}));return C(i).pipe(er())}function Fh(n,t,e){let r=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>bh(o)).filter(o=>o!==null).map(o=>wn(()=>{let a=o.guards.map(u=>{let c=tr(o.node)??e,l=rr(u,c),d=Ah(l)?l.canActivateChild(r,n):ve(c,()=>l(r,n));return He(d).pipe(Je())});return C(a).pipe(er())}));return C(s).pipe(er())}function Uh(n,t,e,r,i){let s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!s||s.length===0)return C(!0);let o=s.map(a=>{let u=tr(t)??i,c=rr(a,u),l=Th(c)?c.canDeactivate(n,t,e,r):ve(u,()=>c(n,t,e,r));return He(l).pipe(Je())});return C(o).pipe(er())}function jh(n,t,e,r){let i=t.canLoad;if(i===void 0||i.length===0)return C(!0);let s=i.map(o=>{let a=rr(o,n),u=Ch(a)?a.canLoad(t,e):ve(n,()=>a(t,e));return He(u)});return C(s).pipe(er(),Zu(r))}function Zu(n){return ta(Z(t=>{if(typeof t!="boolean")throw ui(n,t)}),L(t=>t===!0))}function $h(n,t,e,r){let i=t.canMatch;if(!i||i.length===0)return C(!0);let s=i.map(o=>{let a=rr(o,n),u=Oh(a)?a.canMatch(t,e):ve(n,()=>a(t,e));return He(u)});return C(s).pipe(er(),Zu(r))}var qr=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},Gr=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function Vt(n){return mr(new qr(n))}function Bh(n){return mr(new k(4e3,!1))}function zh(n){return mr(Ku(!1,ne.GuardRejected))}var Zs=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let r=[],i=e.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return C(r);if(i.numberOfChildren>1||!i.children[A])return Bh(`${t.redirectTo}`);i=i.children[A]}}applyRedirectCommands(t,e,r,i,s){return Hh(e,i,s).pipe(L(o=>{if(o instanceof Pe)throw new Gr(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),t,r);if(o[0]==="/")throw new Gr(a);return a}))}applyRedirectCreateUrlTree(t,e,r,i){let s=this.createSegmentGroup(t,e.root,r,i);return new Pe(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let r={};return Object.entries(t).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=e[a]}else r[i]=s}),r}createSegmentGroup(t,e,r,i){let s=this.createSegments(t,e.segments,r,i),o={};return Object.entries(e.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(t,u,r,i)}),new x(s,o)}createSegments(t,e,r,i){return e.map(s=>s.path[0]===":"?this.findPosParam(t,s,i):this.findOrReturn(s,r))}findPosParam(t,e,r){let i=r[e.path.substring(1)];if(!i)throw new k(4001,!1);return i}findOrReturn(t,e){let r=0;for(let i of e){if(i.path===t.path)return e.splice(r),i;r++}return t}};function Hh(n,t,e){if(typeof n=="string")return C(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:a,outlet:u,params:c,data:l,title:d}=t;return He(ve(e,()=>r({params:c,data:l,queryParams:i,fragment:s,routeConfig:o,url:a,outlet:u,title:d})))}var Xs={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Vh(n,t,e,r,i){let s=Xu(n,t,e);return s.matched?(r=hh(t,r),$h(r,t,e,i).pipe(L(o=>o===!0?s:E({},Xs)))):C(s)}function Xu(n,t,e){if(t.path==="**")return qh(e);if(t.path==="")return t.pathMatch==="full"&&(n.hasChildren()||e.length>0)?E({},Xs):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let i=(t.matcher||Au)(e,n,t);if(!i)return E({},Xs);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?E(E({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function qh(n){return{matched:!0,parameters:n.length>0?Ou(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Eu(n,t,e,r){return e.length>0&&Kh(n,e,r)?{segmentGroup:new x(t,Wh(r,new x(e,n.children))),slicedSegments:[]}:e.length===0&&Jh(n,e,r)?{segmentGroup:new x(n.segments,Gh(n,e,r,n.children)),slicedSegments:e}:{segmentGroup:new x(n.segments,n.children),slicedSegments:e}}function Gh(n,t,e,r){let i={};for(let s of e)if(di(n,t,s)&&!r[Ce(s)]){let o=new x([],{});i[Ce(s)]=o}return E(E({},r),i)}function Wh(n,t){let e={};e[A]=t;for(let r of n)if(r.path===""&&Ce(r)!==A){let i=new x([],{});e[Ce(r)]=i}return e}function Kh(n,t,e){return e.some(r=>di(n,t,r)&&Ce(r)!==A)}function Jh(n,t,e){return e.some(r=>di(n,t,r))}function di(n,t,e){return(n.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function Yh(n,t,e){return t.length===0&&!n.children[e]}var Qs=class{};function Zh(n,t,e,r,i,s,o="emptyOnly"){return new eo(n,t,e,r,i,o,s).recognize()}var Xh=31,eo=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,r,i,s,o,a){this.injector=t,this.configLoader=e,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Zs(this.urlSerializer,this.urlTree)}noMatchError(t){return new k(4002,`'${t.segmentGroup}'`)}recognize(){let t=Eu(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(L(({children:e,rootSnapshot:r})=>{let i=new fe(r,e),s=new Hr("",i),o=Uu(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(t){let e=new vt([],Object.freeze({}),Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),A,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,A,e).pipe(L(r=>({children:r,rootSnapshot:e})),ut(r=>{if(r instanceof Gr)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof qr?this.noMatchError(r):r}))}processSegmentGroup(t,e,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,e,r,s):this.processSegment(t,e,r,r.segments,i,!0,s).pipe(L(o=>o instanceof fe?[o]:[]))}processChildren(t,e,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return re(s).pipe(ct(o=>{let a=r.children[o],u=fh(e,o);return this.processSegmentGroup(t,u,a,o,i)}),aa((o,a)=>(o.push(...a),o)),ts(null),oa(),oe(o=>{if(o===null)return Vt(r);let a=Qu(o);return Qh(a),C(a)}))}processSegment(t,e,r,i,s,o,a){return re(e).pipe(ct(u=>this.processSegmentAgainstRoute(u._injector??t,e,u,r,i,s,o,a).pipe(ut(c=>{if(c instanceof qr)return C(null);throw c}))),Je(u=>!!u),ut(u=>{if(Yu(u))return Yh(r,i,s)?C(new Qs):Vt(r);throw u}))}processSegmentAgainstRoute(t,e,r,i,s,o,a,u){return Ce(r)!==o&&(o===A||!di(i,s,r))?Vt(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,i,r,s,o,u):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,i,e,r,s,o,u):Vt(i)}expandSegmentAgainstRouteUsingRedirect(t,e,r,i,s,o,a){let{matched:u,parameters:c,consumedSegments:l,positionalParamSegments:d,remainingSegments:p}=Xu(e,i,s);if(!u)return Vt(e);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Xh&&(this.allowRedirects=!1));let f=new vt(s,c,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Cu(i),Ce(i),i.component??i._loadedComponent??null,i,Ru(i)),g=ai(f,a,this.paramsInheritanceStrategy);return f.params=Object.freeze(g.params),f.data=Object.freeze(g.data),this.applyRedirects.applyRedirectCommands(l,i.redirectTo,d,f,t).pipe(ae(m=>this.applyRedirects.lineralizeSegments(i,m)),oe(m=>this.processSegment(t,r,e,m.concat(p),o,!1,a)))}matchSegmentAgainstRoute(t,e,r,i,s,o){let a=Vh(e,r,i,t,this.urlSerializer);return r.path==="**"&&(e.children={}),a.pipe(ae(u=>u.matched?(t=r._injector??t,this.getChildConfig(t,r,i).pipe(ae(({routes:c})=>{let l=r._loadedInjector??t,{parameters:d,consumedSegments:p,remainingSegments:f}=u,g=new vt(p,d,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Cu(r),Ce(r),r.component??r._loadedComponent??null,r,Ru(r)),v=ai(g,o,this.paramsInheritanceStrategy);g.params=Object.freeze(v.params),g.data=Object.freeze(v.data);let{segmentGroup:m,slicedSegments:b}=Eu(e,p,f,c);if(b.length===0&&m.hasChildren())return this.processChildren(l,c,m,g).pipe(L(_=>new fe(g,_)));if(c.length===0&&b.length===0)return C(new fe(g,[]));let T=Ce(r)===s;return this.processSegment(l,c,m,b,T?A:s,!0,g).pipe(L(_=>new fe(g,_ instanceof fe?[_]:[])))}))):Vt(e)))}getChildConfig(t,e,r){return e.children?C({routes:e.children,injector:t}):e.loadChildren?e._loadedRoutes!==void 0?C({routes:e._loadedRoutes,injector:e._loadedInjector}):jh(t,e,r,this.urlSerializer).pipe(oe(i=>i?this.configLoader.loadChildren(t,e).pipe(Z(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):zh(e))):C({routes:[],injector:t})}};function Qh(n){n.sort((t,e)=>t.value.outlet===A?-1:e.value.outlet===A?1:t.value.outlet.localeCompare(e.value.outlet))}function ef(n){let t=n.value.routeConfig;return t&&t.path===""}function Qu(n){let t=[],e=new Set;for(let r of n){if(!ef(r)){t.push(r);continue}let i=t.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),e.add(i)):t.push(r)}for(let r of e){let i=Qu(r.children);t.push(new fe(r.value,i))}return t.filter(r=>!e.has(r))}function Cu(n){return n.data||{}}function Ru(n){return n.resolve||{}}function tf(n,t,e,r,i,s){return oe(o=>Zh(n,t,e,r,o.extractedUrl,i,s).pipe(L(({state:a,tree:u})=>te(E({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function rf(n,t){return oe(e=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=e;if(!i.length)return C(e);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of ec(u))o.add(c);let a=0;return re(o).pipe(ct(u=>s.has(u)?nf(u,r,n,t):(u.data=ai(u,u.parent,n).resolve,C(void 0))),Z(()=>a++),rs(1),oe(u=>a===o.size?C(e):Ue))})}function ec(n){let t=n.children.map(e=>ec(e)).flat();return[n,...t]}function nf(n,t,e,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!qu(i)&&(s[Wr]=i.title),wn(()=>(n.data=ai(n,n.parent,e).resolve,sf(s,n,t,r).pipe(L(o=>(n._resolvedData=o,n.data=E(E({},n.data),o),null)))))}function sf(n,t,e,r){let i=zs(n);if(i.length===0)return C({});let s={};return re(i).pipe(oe(o=>of(n[o],t,e,r).pipe(Je(),Z(a=>{if(a instanceof Qt)throw ui(new Xe,a);s[o]=a}))),rs(1),L(()=>s),ut(o=>Yu(o)?Ue:mr(o)))}function of(n,t,e,r){let i=tr(t)??r,s=rr(n,i),o=s.resolve?s.resolve(t,e):ve(i,()=>s(t,e));return He(o)}function $s(n){return ae(t=>{let e=n(t);return e?re(e).pipe(L(()=>t)):C(t)})}var oo=(()=>{class n{buildTitle(e){let r,i=e.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===A);return r}getResolvedTitleForRoute(e){return e.data[Wr]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(tc),providedIn:"root"})}return n})(),tc=(()=>{class n extends oo{title;constructor(e){super(),this.title=e}updateTitle(e){let r=this.buildTitle(e);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(I(wu))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),tt=new $("",{providedIn:"root",factory:()=>({})}),bt=new $(""),hi=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=D(Pa);loadComponent(e,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return C(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=He(ve(e,()=>r.loadComponent())).pipe(L(nc),ae(ic),Z(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),_n(()=>{this.componentLoaders.delete(r)})),s=new es(i,()=>new Se).pipe(Qi());return this.componentLoaders.set(r,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return C({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=rc(r,this.compiler,e,this.onLoadEndListener).pipe(_n(()=>{this.childrenLoaders.delete(r)})),o=new es(s,()=>new Se).pipe(Qi());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function rc(n,t,e,r){return He(ve(e,()=>n.loadChildren())).pipe(L(nc),ae(ic),oe(i=>i instanceof Sa||Array.isArray(i)?C(i):re(t.compileModuleAsync(i))),L(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(e).injector,o=s.get(bt,[],{optional:!0,self:!0}).flat()),{routes:o.map(so),injector:s}}))}function af(n){return n&&typeof n=="object"&&"default"in n}function nc(n){return af(n)?n.default:n}function ic(n){return C(n)}var fi=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(uf),providedIn:"root"})}return n})(),uf=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ao=new $(""),uo=new $("");function sc(n,t,e){let r=n.get(uo),i=n.get(W);if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),cf(n)));a.ready.catch(c=>{});let{onViewTransitionCreated:u}=r;return u&&ve(n,()=>u({transition:a,from:t,to:e})),o}function cf(n){return new Promise(t=>{wa({read:()=>setTimeout(t)},{injector:n})})}var co=new $(""),pi=(()=>{class n{currentNavigation=bn(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new Se;transitionAbortWithErrorSubject=new Se;configLoader=D(hi);environmentInjector=D(lt);destroyRef=D(is);urlSerializer=D(wt);rootContexts=D(_t);location=D(Ye);inputBindingEnabled=D(Kr,{optional:!0})!==null;titleStrategy=D(oo);options=D(tt,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=D(fi);createViewTransition=D(ao,{optional:!0});navigationErrorHandler=D(co,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>C(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=i=>this.events.next(new Qn(i)),r=i=>this.events.next(new ei(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let r=++this.navigationId;$e(()=>{this.transitions?.next(te(E({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:r}))})}setupNavigations(e){return this.transitions=new me(null),this.transitions.pipe(je(r=>r!==null),ae(r=>{let i=!1;return C(r).pipe(ae(s=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ne.SupersededByNewNavigation),Ue;this.currentTransition=r,this.currentNavigation.set({id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?te(E({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>s.abortController.abort()});let o=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=s.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!o&&a!=="reload")return this.events.next(new xe(s.id,this.urlSerializer.serialize(s.rawUrl),"",Jt.IgnoredSameUrlNavigation)),s.resolve(!1),Ue;if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return C(s).pipe(ae(u=>(this.events.next(new et(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?Ue:Promise.resolve(u))),tf(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),Z(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation.update(l=>(l.finalUrl=u.urlAfterRedirects,l));let c=new $r(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}));if(o&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:u,extractedUrl:c,source:l,restoredState:d,extras:p}=s,f=new et(u,this.urlSerializer.serialize(c),l,d);this.events.next(f);let g=Hu(this.rootComponentType).snapshot;return this.currentTransition=r=te(E({},s),{targetSnapshot:g,urlAfterRedirects:c,extras:te(E({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(v=>(v.finalUrl=c,v)),C(r)}else return this.events.next(new xe(s.id,this.urlSerializer.serialize(s.extractedUrl),"",Jt.IgnoredByUrlHandlingStrategy)),s.resolve(!1),Ue}),Z(s=>{let o=new Jn(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(o)}),L(s=>(this.currentTransition=r=te(E({},s),{guards:_h(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),r)),kh(this.environmentInjector,s=>this.events.next(s)),Z(s=>{if(r.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw ui(this.urlSerializer,s.guardsResult);let o=new Yn(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(o)}),je(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",ne.GuardRejected),!1)),$s(s=>{if(s.guards.canActivateChecks.length!==0)return C(s).pipe(Z(o=>{let a=new Zn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ae(o=>{let a=!1;return C(o).pipe(rf(this.paramsInheritanceStrategy,this.environmentInjector),Z({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(o,"",ne.NoDataFromResolver)}}))}),Z(o=>{let a=new Xn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}))}),$s(s=>{let o=a=>{let u=[];if(a.routeConfig?.loadComponent){let c=tr(a)??this.environmentInjector;u.push(this.configLoader.loadComponent(c,a.routeConfig).pipe(Z(l=>{a.component=l}),L(()=>{})))}for(let c of a.children)u.push(...o(c));return u};return yn(o(s.targetSnapshot.root)).pipe(ts(null),Ut(1))}),$s(()=>this.afterPreactivation()),ae(()=>{let{currentSnapshot:s,targetSnapshot:o}=r,a=this.createViewTransition?.(this.environmentInjector,s.root,o.root);return a?re(a).pipe(L(()=>r)):C(r)}),L(s=>{let o=gh(e.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=r=te(E({},s),{targetRouterState:o}),this.currentNavigation.update(a=>(a.targetRouterState=o,a)),r}),Z(()=>{this.events.next(new Br)}),wh(this.rootContexts,e.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),Ut(1),ns(new ra(s=>{let o=r.abortController.signal,a=()=>s.next();return o.addEventListener("abort",a),()=>o.removeEventListener("abort",a)}).pipe(je(()=>!i&&!r.targetRouterState),Z(()=>{this.cancelNavigationTransition(r,r.abortController.signal.reason+"",ne.Aborted)}))),Z({next:s=>{i=!0,this.lastSuccessfulNavigation=$e(this.currentNavigation),this.events.next(new ge(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{i=!0}}),ns(this.transitionAbortWithErrorSubject.pipe(Z(s=>{throw s}))),_n(()=>{i||this.cancelNavigationTransition(r,"",ne.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),ut(s=>{if(this.destroyed)return r.resolve(!1),Ue;if(i=!0,Ju(s))this.events.next(new ke(r.id,this.urlSerializer.serialize(r.extractedUrl),s.message,s.cancellationCode)),yh(s)?this.events.next(new Xt(s.url,s.navigationBehaviorOptions)):r.resolve(!1);else{let o=new Yt(r.id,this.urlSerializer.serialize(r.extractedUrl),s,r.targetSnapshot??void 0);try{let a=ve(this.environmentInjector,()=>this.navigationErrorHandler?.(o));if(a instanceof Qt){let{message:u,cancellationCode:c}=ui(this.urlSerializer,a);this.events.next(new ke(r.id,this.urlSerializer.serialize(r.extractedUrl),u,c)),this.events.next(new Xt(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(o),s}catch(a){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(a)}}return Ue}))}))}cancelNavigationTransition(e,r,i){let s=new ke(e.id,this.urlSerializer.serialize(e.extractedUrl),r,i);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=$e(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return e.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lf(n){return n!==Wt}var oc=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(df),providedIn:"root"})}return n})(),li=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}},df=(()=>{class n extends li{static \u0275fac=(()=>{let e;return function(i){return(e||(e=os(n)))(i||n)}})();static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ac=(()=>{class n{urlSerializer=D(wt);options=D(tt,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=D(Ye);urlHandlingStrategy=D(fi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Pe;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:r,targetBrowserUrl:i}){let s=e!==void 0?this.urlHandlingStrategy.merge(e,r):r,o=i??s;return o instanceof Pe?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:e,finalUrl:r,initialUrl:i}){r&&e?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=e):this.rawUrlTree=i}routerState=Hu(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:()=>D(hf),providedIn:"root"})}return n})(),hf=(()=>{class n extends ac{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{e(r.url,r.state,"popstate")})})}handleRouterEvent(e,r){e instanceof et?this.updateStateMemento():e instanceof xe?this.commitTransition(r):e instanceof $r?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof Br?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof ke&&e.code!==ne.SupersededByNewNavigation&&e.code!==ne.Redirect?this.restoreHistory(r):e instanceof Yt?this.restoreHistory(r,!0):e instanceof ge&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(e)||s){let a=this.browserPageId,u=E(E({},o),this.generateNgRouterState(i,a));this.location.replaceState(e,"",u)}else{let a=E(E({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(e,"",a)}}restoreHistory(e,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===e.finalUrl&&s===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(i){return(e||(e=os(n)))(i||n)}})();static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gi(n,t){n.events.pipe(je(e=>e instanceof ge||e instanceof ke||e instanceof Yt||e instanceof xe),L(e=>e instanceof ge||e instanceof xe?0:(e instanceof ke?e.code===ne.Redirect||e.code===ne.SupersededByNewNavigation:!1)?2:1),je(e=>e!==2),Ut(1)).subscribe(()=>{t()})}var ff={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pf={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Re=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=D(Ea);stateManager=D(ac);options=D(tt,{optional:!0})||{};pendingTasks=D(ha);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=D(pi);urlSerializer=D(wt);location=D(Ye);urlHandlingStrategy=D(fi);injector=D(lt);_events=new Se;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=D(oc);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=D(bt,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!D(Kr,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new ea;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=$e(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof ke&&r.code!==ne.Redirect&&r.code!==ne.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ge)this.navigated=!0;else if(r instanceof Xt){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=E({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||lf(i.source)},o);this.scheduleNavigation(a,Wt,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}dh(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Wt,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r,i)=>{this.navigateToSyncWithBrowser(e,i,r)})}navigateToSyncWithBrowser(e,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=E({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let a=this.parseUrl(e);this.scheduleNavigation(a,r,o,s).catch(u=>{this.disposed||this.injector.get(_r)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return $e(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(so),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,c=u?this.currentUrlTree.fragment:o,l=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":l=E(E({},this.currentUrlTree.queryParams),s);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=s||null}l!==null&&(l=this.removeEmptyProps(l));let d;try{let p=i?i.snapshot:this.routerState.snapshot.root;d=ju(p)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),d=this.currentUrlTree.root}return $u(d,e,l,c??null)}navigateByUrl(e,r={skipLocationChange:!1}){let i=Qe(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Wt,null,r)}navigate(e,r={skipLocationChange:!1}){return gf(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.console.warn(yr(4018,!1)),this.urlSerializer.parse("/")}}isActive(e,r){let i;if(r===!0?i=E({},ff):r===!1?i=E({},pf):i=r,Qe(e))return _u(this.currentUrlTree,e,i);let s=this.parseUrl(e);return _u(this.currentUrlTree,s,i)}removeEmptyProps(e){return Object.entries(e).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(e,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,c;o?(a=o.resolve,u=o.reject,c=o.promise):c=new Promise((d,p)=>{a=d,u=p});let l=this.pendingTasks.add();return gi(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(l))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:a,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gf(n){for(let t=0;t<n.length;t++)if(n[t]==null)throw new k(4008,!1)}var mi=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=bn(null);get href(){return $e(this.reactiveHref)}set href(e){this.reactiveHref.set(e)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Se;applicationErrorHandler=D(_r);options=D(tt,{optional:!0});constructor(e,r,i,s,o,a){this.router=e,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.reactiveHref.set(D(new xa("href"),{optional:!0}));let u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area"||!!(typeof customElements=="object"&&customElements.get(u)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let e=this.preserveFragment,r=i=>i==="merge"||i==="preserve";e||=r(this.queryParamsHandling),e||=!this.queryParamsHandling&&!r(this.options?.defaultQueryParamsHandling),e&&(this.subscription=this.router.events.subscribe(i=>{i instanceof ge&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Qe(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(e!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,u)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.reactiveHref.set(e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e))??"":null)}applyAttributeValue(e,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,e,r):i.removeAttribute(s,e)}get urlTree(){return this.routerLinkInput===null?null:Qe(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(U(Re),U(Me),as("tabindex"),U(pt),U(dt),U(ye))};static \u0275dir=Te({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&Ta("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Ra("href",i.reactiveHref(),ma)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Dr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Dr],replaceUrl:[2,"replaceUrl","replaceUrl",Dr],routerLink:"routerLink"},features:[$t]})}return n})(),mf=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new ft;constructor(e,r,i,s,o){this.router=e,this.element=r,this.renderer=i,this.cdr=s,this.link=o,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof ge&&this.update()})}ngAfterContentInit(){C(this.links.changes,C(null)).pipe(vr()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=re(e).pipe(vr()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){let r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let e=this.hasActiveLinks();this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){let r=vf(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>{let s=i.urlTree;return s?e.isActive(s,r):!1}}hasActiveLinks(){let e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static \u0275fac=function(r){return new(r||n)(U(Re),U(dt),U(pt),U(Ht),U(mi,8))};static \u0275dir=Te({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,s){if(r&1&&Oa(s,mi,5),r&2){let o;Ia(o=ka())&&(i.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[$t]})}return n})();function vf(n){return!!n.paths}var Yr=class{};var uc=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,r,i,s){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(je(e=>e instanceof ge),ct(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Dn(s.providers,e,`Route: ${s.path}`));let o=s._injector??e,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return re(i).pipe(vr())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(e,r):i=C(null);let s=i.pipe(oe(o=>o===null?C(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(e,r);return re([s,o]).pipe(vr())}else return s})}static \u0275fac=function(r){return new(r||n)(I(Re),I(lt),I(Yr),I(hi))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cc=new $(""),yf=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=Wt;restoredId=0;store={};constructor(e,r,i,s,o={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof et?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof ge?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof xe&&e.code===Jt.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{if(!(e instanceof Zt))return;let r={behavior:"instant"};e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0],r):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position,r):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>h(this,null,function*(){yield new Promise(i=>{setTimeout(i),typeof requestAnimationFrame<"u"&&requestAnimationFrame(i)}),this.zone.run(()=>{this.transitions.events.next(new Zt(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){ba()};static \u0275prov=O({token:n,factory:n.\u0275fac})}return n})();function wf(n,...t){return la([{provide:bt,multi:!0,useValue:n},[],{provide:Me,useFactory:lc,deps:[Re]},{provide:gs,multi:!0,useFactory:dc},t.map(e=>e.\u0275providers)])}function lc(n){return n.routerState.root}function nr(n,t){return{\u0275kind:n,\u0275providers:t}}function dc(){let n=D(wr);return t=>{let e=n.get(Ca);if(t!==e.components[0])return;let r=n.get(Re),i=n.get(hc);n.get(ho)===1&&r.initialNavigation(),n.get(gc,null,{optional:!0})?.setUpPreloading(),n.get(cc,null,{optional:!0})?.init(),r.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var hc=new $("",{factory:()=>new Se}),ho=new $("",{providedIn:"root",factory:()=>1});function fc(){let n=[{provide:ga,useValue:!0},{provide:ho,useValue:0},ps(()=>{let t=D(wr);return t.get(ys,Promise.resolve()).then(()=>new Promise(r=>{let i=t.get(Re),s=t.get(hc);gi(i,()=>{r(!0)}),t.get(pi).afterPreactivation=()=>(r(!0),s.closed?C(void 0):s),i.initialNavigation()}))})];return nr(2,n)}function pc(){let n=[ps(()=>{D(Re).setUpLocationChangeListener()}),{provide:ho,useValue:2}];return nr(3,n)}var gc=new $("");function mc(n){return nr(0,[{provide:gc,useExisting:uc},{provide:Yr,useExisting:n}])}function _f(){return nr(6,[{provide:ye,useClass:Ln}])}function vc(){return nr(8,[no,{provide:Kr,useExisting:no}])}function yc(n){ds("NgRouterViewTransitions");let t=[{provide:ao,useValue:sc},{provide:uo,useValue:E({skipNextTransition:!!n?.skipInitialTransition},n)}];return nr(9,t)}var wc=[Ye,{provide:wt,useClass:Xe},Re,_t,{provide:Me,useFactory:lc,deps:[Re]},hi,[]],bf=(()=>{class n{constructor(){}static forRoot(e,r){return{ngModule:n,providers:[wc,[],{provide:bt,multi:!0,useValue:e},[],r?.errorHandler?{provide:co,useValue:r.errorHandler}:[],{provide:tt,useValue:r||{}},r?.useHash?Df():Ef(),Sf(),r?.preloadingStrategy?mc(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Cf(r):[],r?.bindToComponentInputs?vc().\u0275providers:[],r?.enableViewTransitions?yc().\u0275providers:[],Rf()]}}static forChild(e){return{ngModule:n,providers:[{provide:bt,multi:!0,useValue:e}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=zt({type:n});static \u0275inj=jt({})}return n})();function Sf(){return{provide:cc,useFactory:()=>{let n=D(du),t=D(Bt),e=D(tt),r=D(pi),i=D(wt);return e.scrollOffset&&n.setOffset(e.scrollOffset),new yf(i,r,n,t,e)}}}function Df(){return{provide:ye,useClass:Ln}}function Ef(){return{provide:ye,useClass:Rn}}function Cf(n){return[n.initialNavigation==="disabled"?pc().\u0275providers:[],n.initialNavigation==="enabledBlocking"?fc().\u0275providers:[]]}var lo=new $("");function Rf(){return[{provide:lo,useFactory:dc},{provide:gs,multi:!0,useExisting:lo}]}var fo={production:!1,supabaseUrl:"https://qhjsweueviqnrlpqozee.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFoanN3ZXVldmlxbnJscHFvemVlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMTk0MTksImV4cCI6MjA3ODU5NTQxOX0.uG_C-MMiRvTNRLS6j6mGagVgqWo_fWhkuU0GrM4GAQA"};H();var _c=n=>n?(...t)=>n(...t):(...t)=>fetch(...t);var Zr=class extends Error{constructor(t,e="FunctionsError",r){super(t),this.name=e,this.context=r}},vi=class extends Zr{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},Xr=class extends Zr{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},Qr=class extends Zr{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}},po=(function(n){return n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2",n})(po||{});var en=class{constructor(t,{headers:e={},customFetch:r,region:i=po.Any}={}){this.url=t,this.headers=e,this.region=i,this.fetch=_c(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return y(this,arguments,void 0,function*(e,r={}){var i;let s,o;try{let{headers:a,method:u,body:c,signal:l,timeout:d}=r,p={},{region:f}=r;f||(f=this.region);let g=new URL(`${this.url}/${e}`);f&&f!=="any"&&(p["x-region"]=f,g.searchParams.set("forceFunctionRegion",f));let v;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",v=c):typeof c=="string"?(p["Content-Type"]="text/plain",v=c):typeof FormData<"u"&&c instanceof FormData?v=c:(p["Content-Type"]="application/json",v=JSON.stringify(c)):v=c;let m=l;d&&(o=new AbortController,s=setTimeout(()=>o.abort(),d),l?(m=o.signal,l.addEventListener("abort",()=>o.abort())):m=o.signal);let b=yield this.fetch(g.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),a),body:v,signal:m}).catch(P=>{throw new vi(P)}),T=b.headers.get("x-relay-error");if(T&&T==="true")throw new Xr(b);if(!b.ok)throw new Qr(b);let _=((i=b.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),w;return _==="application/json"?w=yield b.json():_==="application/octet-stream"||_==="application/pdf"?w=yield b.blob():_==="text/event-stream"?w=b:_==="multipart/form-data"?w=yield b.formData():w=yield b.text(),{data:w,error:null,response:b}}catch(a){return{data:null,error:a,response:a instanceof Qr||a instanceof Xr?a.context:void 0}}finally{s&&clearTimeout(s)}})}};var ko=Ul(Oc(),1),{PostgrestClient:Ic,PostgrestQueryBuilder:Nv,PostgrestFilterBuilder:Lv,PostgrestTransformBuilder:Fv,PostgrestBuilder:Uv,PostgrestError:Ff}=ko.default||ko;var Po=class{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){let e=process.versions;if(e&&e.node){let r=e.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){let r=this.getWebSocketConstructor();return new r(t,e)}static isWebSocketSupported(){try{let t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}},xo=Po;var kc="2.81.1";var Pc=`realtime-js/${kc}`,Mo="1.0.0",xc="2.0.0",No=Mo;var rn=1e4,Mc=1e3,Nc=100,St=(function(n){return n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",n})(St||{}),J=(function(n){return n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving",n})(J||{}),le=(function(n){return n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",n})(le||{}),Lo=(function(n){return n.websocket="websocket",n})(Lo||{}),Dt=(function(n){return n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed",n})(Dt||{});var wi=class{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,e){if(this._isArrayBuffer(t.payload))return e(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(t));let r=[t.join_ref,t.ref,t.topic,t.event,t.payload];return e(JSON.stringify(r))}_binaryEncodePush(t){let{join_ref:e,ref:r,event:i,topic:s,payload:o}=t,a=this.META_LENGTH+e.length+r.length+s.length+i.length,u=new ArrayBuffer(this.HEADER_LENGTH+a),c=new DataView(u),l=0;c.setUint8(l++,this.KINDS.push),c.setUint8(l++,e.length),c.setUint8(l++,r.length),c.setUint8(l++,s.length),c.setUint8(l++,i.length),Array.from(e,p=>c.setUint8(l++,p.charCodeAt(0))),Array.from(r,p=>c.setUint8(l++,p.charCodeAt(0))),Array.from(s,p=>c.setUint8(l++,p.charCodeAt(0))),Array.from(i,p=>c.setUint8(l++,p.charCodeAt(0)));var d=new Uint8Array(u.byteLength+o.byteLength);return d.set(new Uint8Array(u),0),d.set(new Uint8Array(o),u.byteLength),d.buffer}_binaryEncodeUserBroadcastPush(t){var e;return this._isArrayBuffer((e=t.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var e,r;let{join_ref:i,ref:s,topic:o}=t,a=t.payload.event,u=(r=(e=t.payload)===null||e===void 0?void 0:e.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),c=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+o.length+a.length,l=new ArrayBuffer(this.HEADER_LENGTH+c),d=new DataView(l),p=0;d.setUint8(p++,this.KINDS.userBroadcastPush),d.setUint8(p++,i.length),d.setUint8(p++,s.length),d.setUint8(p++,o.length),d.setUint8(p++,a.length),d.setUint8(p++,this.BINARY_ENCODING),Array.from(i,g=>d.setUint8(p++,g.charCodeAt(0))),Array.from(s,g=>d.setUint8(p++,g.charCodeAt(0))),Array.from(o,g=>d.setUint8(p++,g.charCodeAt(0))),Array.from(a,g=>d.setUint8(p++,g.charCodeAt(0)));var f=new Uint8Array(l.byteLength+u.byteLength);return f.set(new Uint8Array(l),0),f.set(new Uint8Array(u),l.byteLength),f.buffer}_encodeJsonUserBroadcastPush(t){var e,r;let{join_ref:i,ref:s,topic:o}=t,a=t.payload.event,u=(r=(e=t.payload)===null||e===void 0?void 0:e.payload)!==null&&r!==void 0?r:{},l=new TextEncoder().encode(JSON.stringify(u)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+o.length+a.length,p=new ArrayBuffer(this.HEADER_LENGTH+d),f=new DataView(p),g=0;f.setUint8(g++,this.KINDS.userBroadcastPush),f.setUint8(g++,i.length),f.setUint8(g++,s.length),f.setUint8(g++,o.length),f.setUint8(g++,a.length),f.setUint8(g++,this.JSON_ENCODING),Array.from(i,m=>f.setUint8(g++,m.charCodeAt(0))),Array.from(s,m=>f.setUint8(g++,m.charCodeAt(0))),Array.from(o,m=>f.setUint8(g++,m.charCodeAt(0))),Array.from(a,m=>f.setUint8(g++,m.charCodeAt(0)));var v=new Uint8Array(p.byteLength+l.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(l),p.byteLength),v.buffer}decode(t,e){if(this._isArrayBuffer(t)){let r=this._binaryDecode(t);return e(r)}if(typeof t=="string"){let r=JSON.parse(t),[i,s,o,a,u]=r;return e({join_ref:i,ref:s,topic:o,event:a,payload:u})}return e({})}_binaryDecode(t){let e=new DataView(t),r=e.getUint8(0),i=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(t,e,i);case this.KINDS.reply:return this._decodeReply(t,e,i);case this.KINDS.broadcast:return this._decodeBroadcast(t,e,i);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,e,i)}}_decodePush(t,e,r){let i=e.getUint8(1),s=e.getUint8(2),o=e.getUint8(3),a=this.HEADER_LENGTH+this.META_LENGTH-1,u=r.decode(t.slice(a,a+i));a=a+i;let c=r.decode(t.slice(a,a+s));a=a+s;let l=r.decode(t.slice(a,a+o));a=a+o;let d=JSON.parse(r.decode(t.slice(a,t.byteLength)));return{join_ref:u,ref:null,topic:c,event:l,payload:d}}_decodeReply(t,e,r){let i=e.getUint8(1),s=e.getUint8(2),o=e.getUint8(3),a=e.getUint8(4),u=this.HEADER_LENGTH+this.META_LENGTH,c=r.decode(t.slice(u,u+i));u=u+i;let l=r.decode(t.slice(u,u+s));u=u+s;let d=r.decode(t.slice(u,u+o));u=u+o;let p=r.decode(t.slice(u,u+a));u=u+a;let f=JSON.parse(r.decode(t.slice(u,t.byteLength))),g={status:p,response:f};return{join_ref:c,ref:l,topic:d,event:le.reply,payload:g}}_decodeBroadcast(t,e,r){let i=e.getUint8(1),s=e.getUint8(2),o=this.HEADER_LENGTH+2,a=r.decode(t.slice(o,o+i));o=o+i;let u=r.decode(t.slice(o,o+s));o=o+s;let c=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{join_ref:null,ref:null,topic:a,event:u,payload:c}}_decodeUserBroadcast(t,e,r){let i=e.getUint8(1),s=e.getUint8(2),o=e.getUint8(3),a=e.getUint8(4),u=this.HEADER_LENGTH+4,c=r.decode(t.slice(u,u+i));u=u+i;let l=r.decode(t.slice(u,u+s));u=u+s;let d=r.decode(t.slice(u,u+o));u=u+o;let p=t.slice(u,t.byteLength),f=a===this.JSON_ENCODING?JSON.parse(r.decode(p)):p,g={type:this.BROADCAST,event:l,payload:f};return o>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST,payload:g}}_isArrayBuffer(t){var e;return t instanceof ArrayBuffer||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}};var sr=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var B=(function(n){return n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange",n})(B||{}),Uo=(n,t,e={})=>{var r;let i=(r=e.skipTypes)!==null&&r!==void 0?r:[];return t?Object.keys(t).reduce((s,o)=>(s[o]=Uf(o,n,t,i),s),{}):{}},Uf=(n,t,e,r)=>{let i=t.find(a=>a.name===n),s=i?.type,o=e[n];return s&&!r.includes(s)?Lc(s,o):Fo(o)},Lc=(n,t)=>{if(n.charAt(0)==="_"){let e=n.slice(1,n.length);return zf(t,e)}switch(n){case B.bool:return jf(t);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return $f(t);case B.json:case B.jsonb:return Bf(t);case B.timestamp:return Hf(t);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return Fo(t);default:return Fo(t)}},Fo=n=>n,jf=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},$f=n=>{if(typeof n=="string"){let t=parseFloat(n);if(!Number.isNaN(t))return t}return n},Bf=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},zf=(n,t)=>{if(typeof n!="string")return n;let e=n.length-1,r=n[e];if(n[0]==="{"&&r==="}"){let s,o=n.slice(1,e);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>Lc(t,a))}return n},Hf=n=>typeof n=="string"?n.replace(" ","T"):n,_i=n=>{let t=new URL(n);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};var or=class{constructor(t,e,r={},i=rn){this.channel=t,this.event=e,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var nn=class n{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{let{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=n.syncState(this.state,i,s,o),this.pendingDiffs.forEach(u=>{this.state=n.syncDiff(this.state,u,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{let{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=n.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,i){let s=this.cloneDeep(t),o=this.transformState(e),a={},u={};return this.map(s,(c,l)=>{o[c]||(u[c]=l)}),this.map(o,(c,l)=>{let d=s[c];if(d){let p=l.map(m=>m.presence_ref),f=d.map(m=>m.presence_ref),g=l.filter(m=>f.indexOf(m.presence_ref)<0),v=d.filter(m=>p.indexOf(m.presence_ref)<0);g.length>0&&(a[c]=g),v.length>0&&(u[c]=v)}else a[c]=l}),this.syncDiff(s,{joins:a,leaves:u},r,i)}static syncDiff(t,e,r,i){let{joins:s,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(a,u)=>{var c;let l=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(u),l.length>0){let d=t[a].map(f=>f.presence_ref),p=l.filter(f=>d.indexOf(f.presence_ref)<0);t[a].unshift(...p)}r(a,l,u)}),this.map(o,(a,u)=>{let c=t[a];if(!c)return;let l=u.map(d=>d.presence_ref);c=c.filter(d=>l.indexOf(d.presence_ref)<0),t[a]=c,i(a,c,u),c.length===0&&delete t[a]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{let i=t[r];return"metas"in i?e[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var sn=(function(n){return n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system",n})(sn||{}),Ve=(function(n){return n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR",n})(Ve||{});var on=class n{constructor(t,e={config:{}},r){var i,s;if(this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new or(this,le.join,this.params,this.timeout),this.rejoinTimer=new sr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(le.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new nn(this),this.broadcastEndpointURL=_i(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==J.closed){let{config:{broadcast:o,presence:a,private:u}}=this.params,c=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&i!==void 0?i:[],l=!!this.bindings[sn.PRESENCE]&&this.bindings[sn.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},p={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:l}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(f=>t?.(Ve.CHANNEL_ERROR,f)),this._onClose(()=>t?.(Ve.CLOSED)),this.updateJoinPayload(Object.assign({config:p},d)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",g=>h(this,[g],function*({postgres_changes:f}){var v;if(this.socket.setAuth(),f===void 0){t?.(Ve.SUBSCRIBED);return}else{let m=this.bindings.postgres_changes,b=(v=m?.length)!==null&&v!==void 0?v:0,T=[];for(let _=0;_<b;_++){let w=m[_],{filter:{event:P,schema:Ae,table:F,filter:G}}=w,Ke=f&&f[_];if(Ke&&Ke.event===P&&Ke.schema===Ae&&Ke.table===F&&Ke.filter===G)T.push(Object.assign(Object.assign({},w),{id:Ke.id}));else{this.unsubscribe(),this.state=J.errored,t?.(Ve.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,t&&t(Ve.SUBSCRIBED);return}})).receive("error",f=>{this.state=J.errored,t?.(Ve.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ve.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(r){return h(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return h(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this.state===J.joined&&t===sn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,r)}httpSend(i,s){return h(this,arguments,function*(t,e,r={}){var o;let a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");let u={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},c=yield this._fetchWithTimeout(this.broadcastEndpointURL,u,(o=r.timeout)!==null&&o!==void 0?o:this.timeout);if(c.status===202)return{success:!0};let l=c.statusText;try{let d=yield c.json();l=d.error||d.message||l}catch{}return Promise.reject(new Error(l))})}send(r){return h(this,arguments,function*(t,e={}){var i,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:o,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{let l=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=e.timeout)!==null&&i!==void 0?i:this.timeout);return yield(s=l.body)===null||s===void 0?void 0:s.cancel(),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,u,c;let l=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(u=(a=this.params)===null||a===void 0?void 0:a.config)===null||u===void 0?void 0:u.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),l.receive("ok",()=>o("ok")),l.receive("error",()=>o("error")),l.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=J.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(le.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new or(this,le.leave,{},t),r.receive("ok",()=>{e(),i("ok")}).receive("timeout",()=>{e(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=J.closed,this.bindings={}}_fetchWithTimeout(t,e,r){return h(this,null,function*(){let i=new AbortController,s=setTimeout(()=>i.abort(),r),o=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:i.signal}));return clearTimeout(s),o})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new or(this,t,e,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Nc){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var i,s;let o=t.toLocaleLowerCase(),{close:a,error:u,leave:c,join:l}=le;if(r&&[a,u,c,l].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,e,r);if(e&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var g,v,m;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(v=f.filter)===null||v===void 0?void 0:v.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(f=>f.callback(p,r)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var g,v,m,b,T,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let w=f.id,P=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((v=e.ids)===null||v===void 0?void 0:v.includes(w))&&(P==="*"||P?.toLocaleLowerCase()===((m=e.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{let w=(T=(b=f?.filter)===null||b===void 0?void 0:b.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return w==="*"||w===((_=e?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let g=p.data,{schema:v,table:m,commit_timestamp:b,type:T,errors:_}=g;p=Object.assign(Object.assign({},{schema:v,table:m,commit_timestamp:b,eventType:T,new:{},old:{},errors:_}),this._getPayloadRecords(g))}f.callback(p,r)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){let i=t.toLocaleLowerCase(),s={type:i,filter:e,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,e){let r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&n.isEqual(i.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(le.close,{},t)}_onError(t){this._on(le.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Uo(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Uo(t.columns,t.old_record)),e}};var jo=()=>{},bi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},qf=[1e3,2e3,5e3,1e4],Gf=1e4,Wf=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,an=class{constructor(t,e){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=rn,this.transport=null,this.heartbeatIntervalMs=bi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=jo,this.ref=0,this.reconnectTimer=null,this.vsn=No,this.logger=jo,this.conn=null,this.sendBuffer=[],this.serializer=new wi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((r=e?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${Lo.websocket}`,this.httpEndpoint=_i(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=xo.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return h(this,null,function*(){let e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return h(this,null,function*(){let t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case St.connecting:return Dt.Connecting;case St.open:return Dt.Open;case St.closing:return Dt.Closing;default:return Dt.Closed}}isConnected(){return this.connectionState()===Dt.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){let r=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{let s=new on(`realtime:${t}`,e,this);return this.channels.push(s),s}}push(t){let{topic:e,event:r,payload:i,ref:s}=t,o=()=>{this.encode(t,a=>{var u;(u=this.conn)===null||u===void 0||u.send(a)})};this.log("push",`${e} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return h(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return h(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Mc,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},bi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:r,event:i,payload:s,ref:o}=e,a=o?`(${o})`:"",u=s.status||"";this.log("receive",`${u} ${r} ${i} ${a}`.trim(),s),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(i,s,o)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===St.open||this.conn.readyState===St.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(le.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;let r=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${r}${i}`}_workerObjectUrl(t){let e;if(t)e=t;else{let r=new Blob([Wf],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}_performAuth(t=null){return h(this,null,function*(){let e;t?e=t:this.accessToken?e=yield this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(r=>{let i={access_token:e,version:Pc};e&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(le.access_token,{access_token:e})}))})}_waitForAuthIfNeeded(){return h(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(e)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new sr(()=>h(this,null,function*(){setTimeout(()=>h(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),bi.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var e,r,i,s,o,a,u,c,l,d,p,f;switch(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(r=t?.timeout)!==null&&r!==void 0?r:rn,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:bi.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=t?.heartbeatCallback)!==null&&a!==void 0?a:jo,this.vsn=(u=t?.vsn)!==null&&u!==void 0?u:No,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:g=>qf[g-1]||Gf,this.vsn){case Mo:this.encode=(l=t?.encode)!==null&&l!==void 0?l:(g,v)=>v(JSON.stringify(g)),this.decode=(d=t?.decode)!==null&&d!==void 0?d:(g,v)=>v(JSON.parse(g));break;case xc:this.encode=(p=t?.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(f=t?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}};H();var ar=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function N(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Si=class extends ar{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Et=class extends ar{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};H();var ur=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),Fc=()=>Response,Di=n=>{if(Array.isArray(n))return n.map(e=>Di(e));if(typeof n=="function"||n!==Object(n))return n;let t={};return Object.entries(n).forEach(([e,r])=>{let i=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Di(r)}),t},Uc=n=>{if(typeof n!="object"||n===null)return!1;let t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var $o=n=>{var t;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(t=n.error)===null||t===void 0?void 0:t.message)||JSON.stringify(n)},Kf=(n,t,e)=>y(void 0,void 0,void 0,function*(){let r=yield Fc();n instanceof r&&!e?.noResolveJson?n.json().then(i=>{let s=n.status||500,o=i?.statusCode||s+"";t(new Si($o(i),s,o))}).catch(i=>{t(new Et($o(i),i))}):t(new Et($o(n),n))}),Jf=(n,t,e,r)=>{let i={method:n,headers:t?.headers||{}};return n==="GET"||!r?i:(Uc(r)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(r)):i.body=r,t?.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),e))};function un(n,t,e,r,i,s){return y(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(e,Jf(t,r,i,s)).then(u=>{if(!u.ok)throw u;return r?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>Kf(u,a,r))})})}function rt(n,t,e,r){return y(this,void 0,void 0,function*(){return un(n,"GET",t,e,r)})}function de(n,t,e,r,i){return y(this,void 0,void 0,function*(){return un(n,"POST",t,r,i,e)})}function cn(n,t,e,r,i){return y(this,void 0,void 0,function*(){return un(n,"PUT",t,r,i,e)})}function jc(n,t,e,r){return y(this,void 0,void 0,function*(){return un(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),r)})}function cr(n,t,e,r,i){return y(this,void 0,void 0,function*(){return un(n,"DELETE",t,r,i,e)})}H();H();var Ei=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return y(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(N(t))return{data:null,error:t};throw t}})}};var $c,Bo=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[$c]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ei(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return y(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(N(t))return{data:null,error:t};throw t}})}};$c=Symbol.toStringTag;var Bc=Bo;var Yf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},Ci=class{constructor(t,e={},r,i){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=ur(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,r,i){return y(this,void 0,void 0,function*(){try{let s,o=Object.assign(Object.assign({},zc),i),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)}),u=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),u&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(u))):(s=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,u&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(u))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),i?.headers&&(a=Object.assign(Object.assign({},a),i.headers));let c=this._removeEmptyFolders(e),l=this._getFinalPath(c),d=yield(t=="PUT"?cn:de)(this.fetch,`${this.url}/object/${l}`,s,Object.assign({headers:a},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(N(s))return{data:null,error:s};throw s}})}upload(t,e,r){return y(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,i){return y(this,void 0,void 0,function*(){let s=this._removeEmptyFolders(t),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let u,c=Object.assign({upsert:zc.upsert},i),l=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,l["cache-control"]=`max-age=${c.cacheControl}`,l["content-type"]=c.contentType);let d=yield cn(this.fetch,a.toString(),u,{headers:l});return{data:{path:s,fullPath:d.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(N(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,e){return y(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),i=Object.assign({},this.headers);e?.upsert&&(i["x-upsert"]="true");let s=yield de(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new ar("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(N(r))return{data:null,error:r};throw r}})}update(t,e,r){return y(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e,r){return y(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}copy(t,e,r){return y(this,void 0,void 0,function*(){try{return{data:{path:(yield de(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}createSignedUrl(t,e,r){return y(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield de(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:this.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,r){return y(this,void 0,void 0,function*(){try{let i=yield de(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}download(t,e){let i=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),o=s?`?${s}`:"",a=this._getFinalPath(t),u=()=>rt(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0});return new Bc(u,this.shouldThrowOnError)}info(t){return y(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{let r=yield rt(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Di(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(N(r))return{data:null,error:r};throw r}})}exists(t){return y(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{return yield jc(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(N(r)&&r instanceof Et){let i=r.originalError;if([400,404].includes(i?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,e){let r=this._getFinalPath(t),i=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);let a=typeof e?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(e?.transform||{});u!==""&&i.push(u);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(t){return y(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}list(t,e,r){return y(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},Yf),e),{prefix:t||""});return{data:yield de(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}listV2(t,e){return y(this,void 0,void 0,function*(){try{let r=Object.assign({},t);return{data:yield de(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(N(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};H();var Ri="2.81.1";var Ai={"X-Client-Info":`storage-js/${Ri}`};var Ti=class{constructor(t,e={},r,i){this.shouldThrowOnError=!1;let s=new URL(t);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ai),e),this.fetch=ur(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return y(this,void 0,void 0,function*(){try{let e=this.listBucketOptionsToQueryString(t);return{data:yield rt(this.fetch,`${this.url}/bucket${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}getBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}createBucket(t){return y(this,arguments,void 0,function*(e,r={public:!1}){try{return{data:yield de(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(N(i))return{data:null,error:i};throw i}})}updateBucket(t,e){return y(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(N(r))return{data:null,error:r};throw r}})}emptyBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}deleteBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}listBucketOptionsToQueryString(t){let e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}};H();var Oi=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ai),e),this.fetch=ur(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}listBuckets(t){return y(this,void 0,void 0,function*(){try{let e=new URLSearchParams;t?.limit!==void 0&&e.set("limit",t.limit.toString()),t?.offset!==void 0&&e.set("offset",t.offset.toString()),t?.sortColumn&&e.set("sortColumn",t.sortColumn),t?.sortOrder&&e.set("sortOrder",t.sortOrder),t?.search&&e.set("search",t.search);let r=e.toString(),i=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield rt(this.fetch,i,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}deleteBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(N(e))return{data:null,error:e};throw e}})}};H();H();var lr={"X-Client-Info":`storage-js/${Ri}`,"Content-Type":"application/json"};var Ii=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Q(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var dr=class extends Ii{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ki=class extends Ii{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};H();var hr=n=>n?(...t)=>n(...t):(...t)=>fetch(...t);var Hc=n=>{if(typeof n!="object"||n===null)return!1;let t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Vc=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Zf=(n,t,e)=>y(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!e?.noResolveJson){let i=n.status||500,s=n;if(typeof s.json=="function")s.json().then(o=>{let a=o?.statusCode||o?.code||i+"";t(new dr(Vc(o),i,a))}).catch(()=>{let o=i+"",a=s.statusText||`HTTP ${i} error`;t(new dr(a,i,o))});else{let o=i+"",a=s.statusText||`HTTP ${i} error`;t(new dr(a,i,o))}}else t(new ki(Vc(n),n))}),Xf=(n,t,e,r)=>{let i={method:n,headers:t?.headers||{}};return n==="GET"||!r?i:(Hc(r)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(r)):i.body=r,Object.assign(Object.assign({},i),e))};function Qf(n,t,e,r,i,s){return y(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(e,Xf(t,r,i,s)).then(u=>{if(!u.ok)throw u;if(r?.noResolveJson)return u;let c=u.headers.get("content-type");return!c||!c.includes("application/json")?{}:u.json()}).then(u=>o(u)).catch(u=>Zf(u,a,r))})})}function ee(n,t,e,r,i){return y(this,void 0,void 0,function*(){return Qf(n,"POST",t,r,i,e)})}var Pi=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lr),e),this.fetch=hr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return y(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}getIndex(t,e){return y(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Q(r))return{data:null,error:r};throw r}})}listIndexes(t){return y(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return y(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Q(r))return{data:null,error:r};throw r}})}};H();var xi=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lr),e),this.fetch=hr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return y(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ee(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}getVectors(t){return y(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}listVectors(t){return y(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield ee(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}queryVectors(t){return y(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}deleteVectors(t){return y(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ee(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}};H();var Mi=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lr),e),this.fetch=hr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return y(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}getBucket(t){return y(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}listBuckets(){return y(this,arguments,void 0,function*(t={}){try{return{data:yield ee(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}deleteBucket(t){return y(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Q(e))return{data:null,error:e};throw e}})}};var ln=class extends Mi{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Ni(this.url,this.headers,t,this.fetch)}},Ni=class extends Pi{constructor(t,e,r,i){super(t,e,i),this.vectorBucketName=r}createIndex(t){let e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return y(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){let t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return y(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){let e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return y(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){let e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return y(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Li(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Li=class extends xi{constructor(t,e,r,i,s){super(t,e,s),this.vectorBucketName=r,this.indexName=i}putVectors(t){let e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return y(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){let e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return y(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){let t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return y(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){let e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return y(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){let e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return y(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}};var dn=class extends Ti{constructor(t,e={},r,i){super(t,e,r,i)}from(t){return new Ci(this.url,this.headers,t,this.fetch)}get vectors(){return new ln(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Oi(this.url+"/iceberg",this.headers,this.fetch)}};var qc="2.81.1";var hn="";typeof Deno<"u"?hn="deno":typeof document<"u"?hn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?hn="react-native":hn="node";var ep={"X-Client-Info":`supabase-js-${hn}/${qc}`},Gc={headers:ep},Wc={schema:"public"},Kc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Jc={};var tp=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),rp=()=>Headers,Yc=(n,t,e)=>{let r=tp(e),i=rp();return(s,o)=>h(null,null,function*(){var a;let u=(a=yield t())!==null&&a!==void 0?a:n,c=new i(o?.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(s,Object.assign(Object.assign({},o),{headers:c}))})};function np(n){return n.endsWith("/")?n:n+"/"}function Zc(n,t){var e,r;let{db:i,auth:s,realtime:o,global:a}=n,{db:u,auth:c,realtime:l,global:d}=t,p={db:Object.assign(Object.assign({},u),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},l),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(e=d?.headers)!==null&&e!==void 0?e:{}),(r=a?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>h(null,null,function*(){return""})};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}function Xc(n){let t=n?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(np(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}H();H();var Fi="2.81.1";var Ct=30*1e3,Ui=3,ji=Ui*Ct,Qc="http://localhost:9999",el="supabase.auth.token";var tl={"X-Client-Info":`gotrue-js/${Fi}`};var fn="X-Supabase-Api-Version",zo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rl=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nl=600*1e3;var nt=class extends Error{constructor(t,e,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=r}};function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}var $i=class extends nt{constructor(t,e,r){super(t,e,r),this.name="AuthApiError",this.status=e,this.code=r}};function il(n){return S(n)&&n.name==="AuthApiError"}var _e=class extends nt{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}},Ne=class extends nt{constructor(t,e,r,i){super(t,r,i),this.name=e,this.status=r}},se=class extends Ne{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function sl(n){return S(n)&&n.name==="AuthSessionMissingError"}var qe=class extends Ne{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Rt=class extends Ne{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},At=class extends Ne{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function ol(n){return S(n)&&n.name==="AuthImplicitGrantRedirectError"}var pn=class extends Ne{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},fr=class extends Ne{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}};function Bi(n){return S(n)&&n.name==="AuthRetryableFetchError"}var gn=class extends Ne{constructor(t,e,r){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=r}};var Tt=class extends Ne{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};var zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),al=` 	
\r=`.split(""),ip=(()=>{let n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<al.length;t+=1)n[al[t].charCodeAt(0)]=-2;for(let t=0;t<zi.length;t+=1)n[zi[t].charCodeAt(0)]=t;return n})();function ul(n,t,e){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){let r=t.queue>>t.queuedBits-6&63;e(zi[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){let r=t.queue>>t.queuedBits-6&63;e(zi[r]),t.queuedBits-=6}}function cl(n,t,e){let r=ip[n];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Ho(n){let t=[],e=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{ap(o,r,e)};for(let o=0;o<n.length;o+=1)cl(n.charCodeAt(o),i,s);return t.join("")}function sp(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function op(n,t){for(let e=0;e<n.length;e+=1){let r=n.charCodeAt(e);if(r>55295&&r<=56319){let i=(r-55296)*1024&65535;r=(n.charCodeAt(e+1)-56320&65535|i)+65536,e+=1}sp(r,t)}}function ap(n,t,e){if(t.utf8seq===0){if(n<=127){e(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function it(n){let t=[],e={queue:0,queuedBits:0},r=i=>{t.push(i)};for(let i=0;i<n.length;i+=1)cl(n.charCodeAt(i),e,r);return new Uint8Array(t)}function ll(n){let t=[];return op(n,e=>t.push(e)),new Uint8Array(t)}function Ge(n){let t=[],e={queue:0,queuedBits:0},r=i=>{t.push(i)};return n.forEach(i=>ul(i,e,r)),ul(null,e,r),t.join("")}function dl(n){return Math.round(Date.now()/1e3)+n}function hl(){return Symbol("auth-callback")}var Y=()=>typeof window<"u"&&typeof document<"u",Ot={tested:!1,writable:!1},Hi=()=>{if(!Y())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ot.tested)return Ot.writable;let n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ot.tested=!0,Ot.writable=!0}catch{Ot.tested=!0,Ot.writable=!1}return Ot.writable};function fl(n){let t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return e.searchParams.forEach((r,i)=>{t[i]=r}),t}var Vi=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),pl=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",It=(n,t,e)=>h(null,null,function*(){yield n.setItem(t,JSON.stringify(e))}),st=(n,t)=>h(null,null,function*(){let e=yield n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),We=(n,t)=>h(null,null,function*(){yield n.removeItem(t)}),mn=class n{constructor(){this.promise=new n.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}};mn.promiseConstructor=Promise;function qi(n){let t=n.split(".");if(t.length!==3)throw new Tt("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!rl.test(t[r]))throw new Tt("JWT not in base64url format");return{header:JSON.parse(Ho(t[0])),payload:JSON.parse(Ho(t[1])),signature:it(t[2]),raw:{header:t[0],payload:t[1]}}}function gl(n){return h(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),n)})})}function ml(n,t){return new Promise((r,i)=>{h(null,null,function*(){for(let s=0;s<1/0;s++)try{let o=yield n(s);if(!t(s,null,o)){r(o);return}}catch(o){if(!t(s,o)){i(o);return}}})})}function up(n){return("0"+n.toString(16)).substr(-2)}function cp(){let t=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length,i="";for(let s=0;s<56;s++)i+=e.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,up).join("")}function lp(n){return h(this,null,function*(){let e=new TextEncoder().encode(n),r=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")})}function dp(n){return h(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;let e=yield lp(n);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function kt(n,t,e=!1){return h(this,null,function*(){let r=cp(),i=r;e&&(i+="/PASSWORD_RECOVERY"),yield It(n,`${t}-code-verifier`,i);let s=yield dp(r);return[s,r===s?"plain":"s256"]})}var hp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function vl(n){let t=n.headers.get(fn);if(!t||!t.match(hp))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function yl(n){if(!n)throw new Error("Missing exp claim");let t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function wl(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var fp=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pt(n){if(!fp.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gi(){let n={};return new Proxy(n,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){let r=e.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _l(n,t){return new Proxy(n,{get:(e,r,i)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){let s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,r,i)}return!t.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,r,i)}})}function Vo(n){return JSON.parse(JSON.stringify(n))}var xt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),pp=[502,503,504];function bl(n){return h(this,null,function*(){var t;if(!pl(n))throw new fr(xt(n),0);if(pp.includes(n.status))throw new fr(xt(n),n.status);let e;try{e=yield n.json()}catch(s){throw new _e(xt(s),s)}let r,i=vl(n);if(i&&i.getTime()>=zo["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?r=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(r=e.error_code),r){if(r==="weak_password")throw new gn(xt(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new se}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new gn(xt(e),n.status,e.weak_password.reasons);throw new $i(xt(e),n.status||500,r)})}var gp=(n,t,e,r)=>{let i={method:n,headers:t?.headers||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function R(n,t,e,r){return h(this,null,function*(){var i;let s=Object.assign({},r?.headers);s[fn]||(s[fn]=zo["2024-01-01"].name),r?.jwt&&(s.Authorization=`Bearer ${r.jwt}`);let o=(i=r?.query)!==null&&i!==void 0?i:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=yield mp(n,t,e+a,{headers:s,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(u):{data:Object.assign({},u),error:null}})}function mp(n,t,e,r,i,s){return h(this,null,function*(){let o=gp(t,r,i,s),a;try{a=yield n(e,Object.assign({},o))}catch(u){throw console.error(u),new fr(xt(u),0)}if(a.ok||(yield bl(a)),r?.noResolveJson)return a;try{return yield a.json()}catch(u){yield bl(u)}})}function be(n){var t;let e=null;vp(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=dl(n.expires_in)));let r=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:r},error:null}}function qo(n){let t=be(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,r)=>e&&typeof r=="string",!0)&&(t.data.weak_password=n.weak_password),t}function Le(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function Sl(n){return{data:n,error:null}}function Dl(n){let{action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s}=n,o=at(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s},u=Object.assign({},o);return{data:{properties:a,user:u},error:null}}function Go(n){return n}function vp(n){return n.access_token&&n.refresh_token&&n.expires_in}var Wi=["global","local","others"];var pr=class{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=Vi(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}signOut(r){return h(this,arguments,function*(t,e=Wi[0]){if(Wi.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wi.join(", ")}`);try{return yield R(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(S(i))return{data:null,error:i};throw i}})}inviteUserByEmail(r){return h(this,arguments,function*(t,e={}){try{return yield R(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Le})}catch(i){if(S(i))return{data:{user:null},error:i};throw i}})}generateLink(t){return h(this,null,function*(){try{let{options:e}=t,r=at(t,["options"]),i=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(i.new_email=r?.newEmail,delete i.newEmail),yield R(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Dl,redirectTo:e?.redirectTo})}catch(e){if(S(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return h(this,null,function*(){try{return yield R(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Le})}catch(e){if(S(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return h(this,null,function*(){var e,r,i,s,o,a,u;try{let c={nextPage:null,lastPage:0,total:0},l=yield R(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Go});if(l.error)throw l.error;let d=yield l.json(),p=(o=l.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(u=(a=l.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(g=>{let v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=v}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(S(c))return{data:{users:[]},error:c};throw c}})}getUserById(t){return h(this,null,function*(){Pt(t);try{return yield R(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Le})}catch(e){if(S(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return h(this,null,function*(){Pt(t);try{return yield R(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Le})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return h(this,null,function*(){Pt(t);try{return yield R(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Le})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return h(this,null,function*(){Pt(t.userId);try{let{data:e,error:r}=yield R(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:r}}catch(e){if(S(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return h(this,null,function*(){Pt(t.userId),Pt(t.id);try{return{data:yield R(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}_listOAuthClients(t){return h(this,null,function*(){var e,r,i,s,o,a,u;try{let c={nextPage:null,lastPage:0,total:0},l=yield R(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Go});if(l.error)throw l.error;let d=yield l.json(),p=(o=l.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(u=(a=l.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(g=>{let v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=v}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(S(c))return{data:{clients:[]},error:c};throw c}})}_createOAuthClient(t){return h(this,null,function*(){try{return yield R(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(S(e))return{data:null,error:e};throw e}})}_getOAuthClient(t){return h(this,null,function*(){try{return yield R(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(S(e))return{data:null,error:e};throw e}})}_updateOAuthClient(t,e){return h(this,null,function*(){try{return yield R(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(S(r))return{data:null,error:r};throw r}})}_deleteOAuthClient(t){return h(this,null,function*(){try{return yield R(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}_regenerateOAuthClientSecret(t){return h(this,null,function*(){try{return yield R(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(S(e))return{data:null,error:e};throw e}})}};function Wo(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}var Mt={debug:!!(globalThis&&Hi()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},vn=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},Ki=class extends vn{};function Ko(n,t,e){return h(this,null,function*(){Mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Mt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},i=>h(null,null,function*(){if(i){Mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return yield e()}finally{Mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(t===0)throw Mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Ki(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Mt.debug)try{let s=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}function El(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Jo(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function Cl(n){return parseInt(n,16)}function Rl(n){let t=new TextEncoder().encode(n);return"0x"+Array.from(t,r=>r.toString(16).padStart(2,"0")).join("")}function Al(n){var t;let{chainId:e,domain:r,expirationTime:i,issuedAt:s=new Date,nonce:o,notBefore:a,requestId:u,resources:c,scheme:l,uri:d,version:p}=n;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=n.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}let f=Jo(n.address),g=l?`${l}://${r}`:r,v=n.statement?`${n.statement}
`:"",m=`${g} wants you to sign in with your Ethereum account:
${f}

${v}`,b=`URI: ${d}
Version: ${p}
Chain ID: ${e}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(i&&(b+=`
Expiration Time: ${i.toISOString()}`),a&&(b+=`
Not Before: ${a.toISOString()}`),u&&(b+=`
Request ID: ${u}`),c){let T=`
Resources:`;for(let _ of c){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);T+=`
- ${_}`}b+=T}return`${m}
${b}`}H();var z=class extends Error{constructor({message:t,code:e,cause:r,name:i}){var s;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=(s=i??(r instanceof Error?r.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=e}},Nt=class extends z{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}};function Tl({error:n,options:t}){var e,r,i;let{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new z({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((e=s.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new z({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(t.mediation==="conditional"&&((r=s.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new z({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new z({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new z({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new z({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return s.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new z({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new z({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){let o=window.location.hostname;if(Yo(o)){if(s.rp.id!==o)return new z({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new z({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new z({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new z({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new z({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function Ol({error:n,options:t}){let{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new z({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new z({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){let r=window.location.hostname;if(Yo(r)){if(e.rpId!==r)return new z({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new z({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new z({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new z({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}var Zo=class{createNewAbortSignal(){if(this.controller){let e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){let t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}},yp=new Zo;function kl(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);let{challenge:t,user:e,excludeCredentials:r}=n,i=at(n,["challenge","user","excludeCredentials"]),s=it(t).buffer,o=Object.assign(Object.assign({},e),{id:it(e.id).buffer}),a=Object.assign(Object.assign({},i),{challenge:s,user:o});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let u=0;u<r.length;u++){let c=r[u];a.excludeCredentials[u]=Object.assign(Object.assign({},c),{id:it(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function Pl(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);let{challenge:t,allowCredentials:e}=n,r=at(n,["challenge","allowCredentials"]),i=it(t).buffer,s=Object.assign(Object.assign({},r),{challenge:i});if(e&&e.length>0){s.allowCredentials=new Array(e.length);for(let o=0;o<e.length;o++){let a=e[o];s.allowCredentials[o]=Object.assign(Object.assign({},a),{id:it(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return s}function xl(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();let e=n;return{id:n.id,rawId:n.id,response:{attestationObject:Ge(new Uint8Array(n.response.attestationObject)),clientDataJSON:Ge(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ml(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();let e=n,r=n.getClientExtensionResults(),i=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Ge(new Uint8Array(i.authenticatorData)),clientDataJSON:Ge(new Uint8Array(i.clientDataJSON)),signature:Ge(new Uint8Array(i.signature)),userHandle:i.userHandle?Ge(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Yo(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Il(){var n,t;return!!(Y()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}function wp(n){return h(this,null,function*(){try{let t=yield navigator.credentials.create(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nt("Browser returned unexpected credential type",t)}:{data:null,error:new Nt("Empty credential response",t)}}catch(t){return{data:null,error:Tl({error:t,options:n})}}})}function _p(n){return h(this,null,function*(){try{let t=yield navigator.credentials.get(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nt("Browser returned unexpected credential type",t)}:{data:null,error:new Nt("Empty credential response",t)}}catch(t){return{data:null,error:Ol({error:t,options:n})}}})}var bp={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Sp={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ji(...n){let t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),e=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),r={};for(let i of n)if(i)for(let s in i){let o=i[s];if(o!==void 0)if(Array.isArray(o))r[s]=o;else if(e(o))r[s]=o;else if(t(o)){let a=r[s];t(a)?r[s]=Ji(a,o):r[s]=Ji(o)}else r[s]=o}return r}function Dp(n,t){return Ji(bp,n,t||{})}function Ep(n,t){return Ji(Sp,n,t||{})}var Yi=class{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}_enroll(t){return h(this,null,function*(){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))})}_challenge(o,a){return h(this,arguments,function*({factorId:t,webauthn:e,friendlyName:r,signal:i},s){try{let{data:u,error:c}=yield this.client.mfa.challenge({factorId:t,webauthn:e});if(!u)return{data:null,error:c};let l=i??yp.createNewAbortSignal();if(u.webauthn.type==="create"){let{user:d}=u.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(u.webauthn.type){case"create":{let d=Dp(u.webauthn.credential_options.publicKey,s?.create),{data:p,error:f}=yield wp({publicKey:d,signal:l});return p?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:p}},error:null}:{data:null,error:f}}case"request":{let d=Ep(u.webauthn.credential_options.publicKey,s?.request),{data:p,error:f}=yield _p(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:d,signal:l}));return p?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:p}},error:null}:{data:null,error:f}}}}catch(u){return S(u)?{data:null,error:u}:{data:null,error:new _e("Unexpected error in challenge",u)}}})}_verify(i){return h(this,arguments,function*({challengeId:t,factorId:e,webauthn:r}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:r})})}_authenticate(o,a){return h(this,arguments,function*({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!e)return{data:null,error:new nt("rpId is required for WebAuthn authentication")};try{if(!Il())return{data:null,error:new _e("Browser does not support WebAuthn",null)};let{data:u,error:c}=yield this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:r},signal:i},{request:s});if(!u)return{data:null,error:c};let{webauthn:l}=u;return this._verify({factorId:t,challengeId:u.challengeId,webauthn:{type:l.type,rpId:e,rpOrigins:r,credential_response:l.credential_response}})}catch(u){return S(u)?{data:null,error:u}:{data:null,error:new _e("Unexpected error in authenticate",u)}}})}_register(o,a){return h(this,arguments,function*({friendlyName:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!e)return{data:null,error:new nt("rpId is required for WebAuthn registration")};try{if(!Il())return{data:null,error:new _e("Browser does not support WebAuthn",null)};let{data:u,error:c}=yield this._enroll({friendlyName:t});if(!u)return yield this.client.mfa.listFactors().then(p=>{var f;return(f=p.data)===null||f===void 0?void 0:f.all.find(g=>g.factor_type==="webauthn"&&g.friendly_name===t&&g.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:c};let{data:l,error:d}=yield this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:e,rpOrigins:r},signal:i},{create:s});return l?this._verify({factorId:u.id,challengeId:l.challengeId,webauthn:{rpId:e,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:d}}catch(u){return S(u)?{data:null,error:u}:{data:null,error:new _e("Unexpected error in register",u)}}})}};El();var Cp={url:Qc,storageKey:el,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tl,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};function Nl(n,t,e){return h(this,null,function*(){return yield e()})}var gr={},Rp=(()=>{class n{get jwks(){var e,r;return(r=(e=gr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){gr[this.storageKey]=Object.assign(Object.assign({},gr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=gr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){gr[this.storageKey]=Object.assign(Object.assign({},gr[this.storageKey]),{cachedAt:e})}constructor(e){var r,i,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let o=Object.assign(Object.assign({},Cp),e);if(this.storageKey=o.storageKey,this.instanceID=(r=n.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,n.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&Y()){let a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new pr({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Vi(o.fetch),this.lock=o.lock||Nl,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:Y()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=Ko:this.lock=Nl,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Yi(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Hi()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Wo(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Wo(this.memoryStorage)),Y()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",a=>h(this,null,function*(){this._debug("received broadcast notification from other tab or client",a),yield this._notifyAllSubscribers(a.data.event,a.data.session,!1)}))}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fi}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}initialize(){return h(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=h(this,null,function*(){return yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return h(this,null,function*(){var e;try{let r={},i="none";if(Y()&&(r=fl(window.location.href),this._isImplicitGrantCallback(r)?i="implicit":(yield this._isPKCECallback(r))&&(i="pkce")),Y()&&this.detectSessionInUrl&&i!=="none"){let{data:s,error:o}=yield this._getSessionFromURL(r,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),ol(o)){let c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return yield this._removeSession(),{error:o}}let{session:a,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",u),yield this._saveSession(a),setTimeout(()=>h(this,null,function*(){u==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",a):yield this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return S(r)?this._returnResult({error:r}):this._returnResult({error:new _e("Unexpected error during initialization",r)})}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return h(this,null,function*(){var r,i,s;try{let o=yield R(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:be}),{data:a,error:u}=o;if(u||!a)return this._returnResult({data:{user:null,session:null},error:u});let c=a.session,l=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(o){if(S(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}signUp(e){return h(this,null,function*(){var r,i,s;try{let o;if("email"in e){let{email:d,password:p,options:f}=e,g=null,v=null;this.flowType==="pkce"&&([g,v]=yield kt(this.storage,this.storageKey)),o=yield R(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:p,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:g,code_challenge_method:v},xform:be})}else if("phone"in e){let{phone:d,password:p,options:f}=e;o=yield R(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(i=f?.data)!==null&&i!==void 0?i:{},channel:(s=f?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:be})}else throw new Rt("You must provide either an email or phone number and a password");let{data:a,error:u}=o;if(u||!a)return this._returnResult({data:{user:null,session:null},error:u});let c=a.session,l=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(o){if(S(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}signInWithPassword(e){return h(this,null,function*(){try{let r;if("email"in e){let{email:o,password:a,options:u}=e;r=yield R(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:qo})}else if("phone"in e){let{phone:o,password:a,options:u}=e;r=yield R(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:qo})}else throw new Rt("You must provide either an email or phone number and a password");let{data:i,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!i||!i.session||!i.user){let o=new qe;return this._returnResult({data:{user:null,session:null},error:o})}return i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:s})}catch(r){if(S(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}signInWithOAuth(e){return h(this,null,function*(){var r,i,s,o;return yield this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return h(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return this._exchangeCodeForSession(e)}))})}signInWithWeb3(e){return h(this,null,function*(){let{chain:r}=e;switch(r){case"ethereum":return yield this.signInWithEthereum(e);case"solana":return yield this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}})}signInWithEthereum(e){return h(this,null,function*(){var r,i,s,o,a,u,c,l,d,p,f;let g,v;if("message"in e)g=e.message,v=e.signature;else{let{chain:m,wallet:b,statement:T,options:_}=e,w;if(Y())if(typeof b=="object")w=b;else{let Fe=window;if("ethereum"in Fe&&typeof Fe.ethereum=="object"&&"request"in Fe.ethereum&&typeof Fe.ethereum.request=="function")w=Fe.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=b}let P=new URL((r=_?.url)!==null&&r!==void 0?r:window.location.href),Ae=yield w.request({method:"eth_requestAccounts"}).then(Fe=>Fe).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!Ae||Ae.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let F=Jo(Ae[0]),G=(i=_?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!G){let Fe=yield w.request({method:"eth_chainId"});G=Cl(Fe)}let Ke={domain:P.host,address:F,statement:T,uri:P.href,version:"1",chainId:G,nonce:(s=_?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(o=_?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(u=_?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(c=_?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(l=_?.signInWithEthereum)===null||l===void 0?void 0:l.requestId,resources:(d=_?.signInWithEthereum)===null||d===void 0?void 0:d.resources};g=Al(Ke),v=yield w.request({method:"personal_sign",params:[Rl(g),F]})}try{let{data:m,error:b}=yield R(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:v},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:be});if(b)throw b;if(!m||!m.session||!m.user){let T=new qe;return this._returnResult({data:{user:null,session:null},error:T})}return m.session&&(yield this._saveSession(m.session),yield this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:b})}catch(m){if(S(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}})}signInWithSolana(e){return h(this,null,function*(){var r,i,s,o,a,u,c,l,d,p,f,g;let v,m;if("message"in e)v=e.message,m=e.signature;else{let{chain:b,wallet:T,statement:_,options:w}=e,P;if(Y())if(typeof T=="object")P=T;else{let F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))P=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=T}let Ae=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in P&&P.signIn){let F=yield P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:Ae.host,uri:Ae.href}),_?{statement:_}:null)),G;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")G=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)G=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in G&&"signature"in G&&(typeof G.signedMessage=="string"||G.signedMessage instanceof Uint8Array)&&G.signature instanceof Uint8Array)v=typeof G.signedMessage=="string"?G.signedMessage:new TextDecoder().decode(G.signedMessage),m=G.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${Ae.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${Ae.href}`,`Issued At: ${(s=(i=w?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=w?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((u=w?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((p=(d=w?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||p===void 0)&&p.length?["Resources",...w.signInWithSolana.resources.map(G=>`- ${G}`)]:[]].join(`
`);let F=yield P.signMessage(new TextEncoder().encode(v),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=F}}try{let{data:b,error:T}=yield R(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Ge(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:be});if(T)throw T;if(!b||!b.session||!b.user){let _=new qe;return this._returnResult({data:{user:null,session:null},error:_})}return b.session&&(yield this._saveSession(b.session),yield this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:T})}catch(b){if(S(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}})}_exchangeCodeForSession(e){return h(this,null,function*(){let r=yield st(this.storage,`${this.storageKey}-code-verifier`),[i,s]=(r??"").split("/");try{let{data:o,error:a}=yield R(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:be});if(yield We(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!o||!o.session||!o.user){let u=new qe;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:a})}catch(o){if(S(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}})}signInWithIdToken(e){return h(this,null,function*(){try{let{options:r,provider:i,token:s,access_token:o,nonce:a}=e,u=yield R(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:s,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:be}),{data:c,error:l}=u;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!c||!c.session||!c.user){let d=new qe;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:l})}catch(r){if(S(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}signInWithOtp(e){return h(this,null,function*(){var r,i,s,o,a;try{if("email"in e){let{email:u,options:c}=e,l=null,d=null;this.flowType==="pkce"&&([l,d]=yield kt(this.storage,this.storageKey));let{error:p}=yield R(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:l,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){let{phone:u,options:c}=e,{data:l,error:d}=yield R(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:d})}throw new Rt("You must provide either an email or phone number.")}catch(u){if(S(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}verifyOtp(e){return h(this,null,function*(){var r,i;try{let s,o;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);let{data:a,error:u}=yield R(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:be});if(u)throw u;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,l=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(s){if(S(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}signInWithSSO(e){return h(this,null,function*(){var r,i,s,o,a;try{let u=null,c=null;this.flowType==="pkce"&&([u,c]=yield kt(this.storage,this.storageKey));let l=yield R(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&i!==void 0?i:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:c}),headers:this.headers,xform:Sl});return!((o=l.data)===null||o===void 0)&&o.url&&Y()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(u){if(S(u))return this._returnResult({data:null,error:u});throw u}})}reauthenticate(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return h(this,null,function*(){try{return yield this._useSession(e=>h(this,null,function*(){let{data:{session:r},error:i}=e;if(i)throw i;if(!r)throw new se;let{error:s}=yield R(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})}))}catch(e){if(S(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}resend(e){return h(this,null,function*(){try{let r=`${this.url}/resend`;if("email"in e){let{email:i,type:s,options:o}=e,{error:a}=yield R(this.fetch,"POST",r,{headers:this.headers,body:{email:i,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){let{phone:i,type:s,options:o}=e,{data:a,error:u}=yield R(this.fetch,"POST",r,{headers:this.headers,body:{phone:i,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:u})}throw new Rt("You must provide either an email or phone number and a type")}catch(r){if(S(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}getSession(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return this._useSession(r=>h(this,null,function*(){return r}))}))})}_acquireLock(e,r){return h(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=h(this,null,function*(){return yield i,yield r()});return this.pendingInLock.push(h(this,null,function*(){try{yield s}catch{}})),s}return yield this.lock(`lock:${this.storageKey}`,e,()=>h(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let i=r();for(this.pendingInLock.push(h(this,null,function*(){try{yield i}catch{}})),yield i;this.pendingInLock.length;){let s=[...this.pendingInLock];yield Promise.all(s),this.pendingInLock.splice(0,s.length)}return yield i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return h(this,null,function*(){this._debug("#_useSession","begin");try{let r=yield this.__loadSession();return yield e(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return h(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,r=yield st(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let i=e.expires_at?e.expires_at*1e3-Date.now()<ji:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){let a=yield st(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=Gi()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){let a={value:this.suppressGetSessionWarning};e.user=_l(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}let{data:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}})}getUser(e){return h(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return h(this,null,function*(){try{return e?yield R(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Le}):yield this._useSession(r=>h(this,null,function*(){var i,s,o;let{data:a,error:u}=r;if(u)throw u;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new se}:yield R(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Le})}))}catch(r){if(S(r))return sl(r)&&(yield this._removeSession(),yield We(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}})}updateUser(i){return h(this,arguments,function*(e,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._updateUser(e,r)}))})}_updateUser(i){return h(this,arguments,function*(e,r={}){try{return yield this._useSession(s=>h(this,null,function*(){let{data:o,error:a}=s;if(a)throw a;if(!o.session)throw new se;let u=o.session,c=null,l=null;this.flowType==="pkce"&&e.email!=null&&([c,l]=yield kt(this.storage,this.storageKey));let{data:d,error:p}=yield R(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:l}),jwt:u.access_token,xform:Le});if(p)throw p;return u.user=d.user,yield this._saveSession(u),yield this._notifyAllSubscribers("USER_UPDATED",u),this._returnResult({data:{user:u.user},error:null})}))}catch(s){if(S(s))return this._returnResult({data:{user:null},error:s});throw s}})}setSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return h(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new se;let r=Date.now()/1e3,i=r,s=!0,o=null,{payload:a}=qi(e.access_token);if(a.exp&&(i=a.exp,s=i<=r),s){let{data:u,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!u)return{data:{user:null,session:null},error:null};o=u}else{let{data:u,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:i-r,expires_at:i},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(S(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}})}refreshSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i;if(!e){let{data:a,error:u}=r;if(u)throw u;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new se;let{data:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})}))}catch(r){if(S(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}_getSessionFromURL(e,r){return h(this,null,function*(){try{if(!Y())throw new At("No browser detected.");if(e.error||e.error_description||e.error_code)throw new At(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new pn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new At("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new pn("No code detected.");let{data:_,error:w}=yield this._exchangeCodeForSession(e.code);if(w)throw w;let P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:_.session,redirectType:null},error:null}}let{provider_token:i,provider_refresh_token:s,access_token:o,refresh_token:a,expires_in:u,expires_at:c,token_type:l}=e;if(!o||!u||!a||!l)throw new At("No session defined in URL");let d=Math.round(Date.now()/1e3),p=parseInt(u),f=d+p;c&&(f=parseInt(c));let g=f-d;g*1e3<=Ct&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${p}s`);let v=f-p;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);let{data:m,error:b}=yield this._getUser(o);if(b)throw b;let T={provider_token:i,provider_refresh_token:s,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:e.type},error:null})}catch(i){if(S(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return h(this,null,function*(){let r=yield st(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)})}signOut(){return h(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return h(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(r=>h(this,null,function*(){var i;let{data:s,error:o}=r;if(o)return this._returnResult({error:o});let a=(i=s.session)===null||i===void 0?void 0:i.access_token;if(a){let{error:u}=yield this.admin.signOut(a,e);if(u&&!(il(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return e!=="others"&&(yield this._removeSession(),yield We(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})}))})}onAuthStateChange(e){let r=hl(),i={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,i),h(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:i}}}_emitInitialSession(e){return h(this,null,function*(){return yield this._useSession(r=>h(this,null,function*(){var i,s;try{let{data:{session:o},error:a}=r;if(a)throw a;yield(i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(i){return h(this,arguments,function*(e,r={}){let s=null,o=null;this.flowType==="pkce"&&([s,o]=yield kt(this.storage,this.storageKey,!0));try{return yield R(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(S(a))return this._returnResult({data:null,error:a});throw a}})}getUserIdentities(){return h(this,null,function*(){var e;try{let{data:r,error:i}=yield this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}})}linkIdentity(e){return h(this,null,function*(){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)})}linkIdentityOAuth(e){return h(this,null,function*(){var r;try{let{data:i,error:s}=yield this._useSession(o=>h(this,null,function*(){var a,u,c,l,d;let{data:p,error:f}=o;if(f)throw f;let g=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield R(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(l=p.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0})}));if(s)throw s;return Y()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(S(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}})}linkIdentityIdToken(e){return h(this,null,function*(){return yield this._useSession(r=>h(this,null,function*(){var i;try{let{error:s,data:{session:o}}=r;if(s)throw s;let{options:a,provider:u,token:c,access_token:l,nonce:d}=e,p=yield R(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=o?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:u,id_token:c,access_token:l,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:be}),{data:f,error:g}=p;return g?this._returnResult({data:{user:null,session:null},error:g}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new qe}):(f.session&&(yield this._saveSession(f.session),yield this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:g}))}catch(s){if(S(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}))})}unlinkIdentity(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i,s;let{data:o,error:a}=r;if(a)throw a;return yield R(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0})}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}})}_refreshAccessToken(e){return h(this,null,function*(){let r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{let i=Date.now();return yield ml(s=>h(this,null,function*(){return s>0&&(yield gl(200*Math.pow(2,s-1))),this._debug(r,"refreshing attempt",s),yield R(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:be})}),(s,o)=>{let a=200*Math.pow(2,s);return o&&Bi(o)&&Date.now()+a-i<Ct})}catch(i){if(this._debug(r,"error",i),S(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(r,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,r){return h(this,null,function*(){let i=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",i),Y()&&!r.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}})}_recoverAndRefresh(){return h(this,null,function*(){var e,r;let i="#_recoverAndRefresh()";this._debug(i,"begin");try{let s=yield st(this.storage,this.storageKey);if(s&&this.userStorage){let a=yield st(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},yield It(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a?.user)!==null&&e!==void 0?e:Gi()}else if(s&&!s.user&&!s.user){let a=yield st(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,yield We(this.storage,this.storageKey+"-user"),yield It(this.storage,this.storageKey,s)):s.user=Gi()}if(this._debug(i,"session from storage",s),!this._isValidSession(s)){this._debug(i,"session is not valid"),s!==null&&(yield this._removeSession());return}let o=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ji;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${ji}s`),o){if(this.autoRefreshToken&&s.refresh_token){let{error:a}=yield this._callRefreshToken(s.refresh_token);a&&(console.error(a),Bi(a)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",a),yield this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{let{data:a,error:u}=yield this._getUser(s.access_token);!u&&a?.user?(s.user=a.user,yield this._saveSession(s),yield this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(i,"error getting user data, skipping SIGNED_IN notification",a)}else yield this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(i,"error",s),console.error(s);return}finally{this._debug(i,"end")}})}_callRefreshToken(e){return h(this,null,function*(){var r,i;if(!e)throw new se;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new mn;let{data:o,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new se;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(s,"error",o),S(o)){let a={data:null,error:o};return Bi(o)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}})}_notifyAllSubscribers(e,r,i=!0){return h(this,null,function*(){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:r});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(u=>h(this,null,function*(){try{yield u.callback(e,r)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(s,"end")}})}_saveSession(e){return h(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let r=Object.assign({},e),i=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&r.user&&(yield It(this.userStorage,this.storageKey+"-user",{user:r.user}));let s=Object.assign({},r);delete s.user;let o=Vo(s);yield It(this.storage,this.storageKey,o)}else{let s=Vo(r);yield It(this.storage,this.storageKey,s)}})}_removeSession(){return h(this,null,function*(){this._debug("#_removeSession()"),yield We(this.storage,this.storageKey),yield We(this.storage,this.storageKey+"-code-verifier"),yield We(this.storage,this.storageKey+"-user"),this.userStorage&&(yield We(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Y()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return h(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),Ct);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>h(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return h(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return h(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>h(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(r=>h(this,null,function*(){let{data:{session:i}}=r;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let s=Math.floor((i.expires_at*1e3-e)/Ct);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ct}ms, refresh threshold is ${Ui} ticks`),s<=Ui&&(yield this._callRefreshToken(i.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof vn)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return h(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!Y()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>h(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return h(this,null,function*(){let r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,r,i){return h(this,null,function*(){let s=[`provider=${encodeURIComponent(r)}`];if(i?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&s.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){let[o,a]=yield kt(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(u.toString())}if(i?.queryParams){let o=new URLSearchParams(i.queryParams);s.push(o.toString())}return i?.skipBrowserRedirect&&s.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${s.join("&")}`})}_unenroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i;let{data:s,error:o}=r;return o?this._returnResult({data:null,error:o}):yield R(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token})}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}})}_enroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i,s;let{data:o,error:a}=r;if(a)return this._returnResult({data:null,error:a});let u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:l}=yield R(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return l?this._returnResult({data:null,error:l}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}})}_verify(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i;let{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});let a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?xl(e.webauthn.credential_response):Ml(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:c}=yield R(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});return c?this._returnResult({data:null,error:c}):(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:c}))}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}}))})}_challenge(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var i;let{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});let a=yield R(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});if(a.error)return a;let{data:u}=a;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:kl(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:Pl(u.webauthn.credential_options.publicKey)})})}),error:null}}}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}}))})}_challengeAndVerify(e){return h(this,null,function*(){let{data:r,error:i}=yield this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):yield this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})})}_listFactors(){return h(this,null,function*(){var e;let{data:{user:r},error:i}=yield this.getUser();if(i)return{data:null,error:i};let s={all:[],phone:[],totp:[],webauthn:[]};for(let o of(e=r?.factors)!==null&&e!==void 0?e:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}})}_getAuthenticatorAssuranceLevel(){return h(this,null,function*(){var e,r;let{data:{session:i},error:s}=yield this.getSession();if(s)return this._returnResult({data:null,error:s});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:o}=qi(i.access_token),a=null;o.aal&&(a=o.aal);let u=a;((r=(e=i.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");let l=o.amr||[];return{data:{currentLevel:a,nextLevel:u,currentAuthenticationMethods:l},error:null}})}_getAuthorizationDetails(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){let{data:{session:i},error:s}=r;return s?this._returnResult({data:null,error:s}):i?yield R(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new se})}))}catch(r){if(S(r))return this._returnResult({data:null,error:r});throw r}})}_approveAuthorization(e,r){return h(this,null,function*(){try{return yield this._useSession(i=>h(this,null,function*(){let{data:{session:s},error:o}=i;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new se});let a=yield R(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return a.data&&a.data.redirect_url&&Y()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a}))}catch(i){if(S(i))return this._returnResult({data:null,error:i});throw i}})}_denyAuthorization(e,r){return h(this,null,function*(){try{return yield this._useSession(i=>h(this,null,function*(){let{data:{session:s},error:o}=i;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new se});let a=yield R(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return a.data&&a.data.redirect_url&&Y()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a}))}catch(i){if(S(i))return this._returnResult({data:null,error:i});throw i}})}fetchJwk(i){return h(this,arguments,function*(e,r={keys:[]}){let s=r.keys.find(c=>c.kid===e);if(s)return s;let o=Date.now();if(s=this.jwks.keys.find(c=>c.kid===e),s&&this.jwks_cached_at+nl>o)return s;let{data:a,error:u}=yield R(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=o,s=a.keys.find(c=>c.kid===e),!s)?null:s})}getClaims(i){return h(this,arguments,function*(e,r={}){try{let s=e;if(!s){let{data:v,error:m}=yield this.getSession();if(m||!v.session)return this._returnResult({data:null,error:m});s=v.session.access_token}let{header:o,payload:a,signature:u,raw:{header:c,payload:l}}=qi(s);r?.allowExpired||yl(a.exp);let d=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){let{error:v}=yield this.getUser(s);if(v)throw v;return{data:{claims:a,header:o,signature:u},error:null}}let p=wl(o.alg),f=yield crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!(yield crypto.subtle.verify(p,f,u,ll(`${c}.${l}`))))throw new Tt("Invalid JWT signature");return{data:{claims:a,header:o,signature:u},error:null}}catch(s){if(S(s))return this._returnResult({data:null,error:s});throw s}})}}return n.nextInstanceID={},n})(),Xo=Rp;var Ap=Xo,Qo=Ap;var Zi=class extends Qo{constructor(t){super(t)}};var Xi=class{constructor(t,e,r){var i,s,o;this.supabaseUrl=t,this.supabaseKey=e;let a=Xc(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);let u=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:Wc,realtime:Jc,auth:Object.assign(Object.assign({},Kc),{storageKey:u}),global:Gc},l=Zc(r??{},c);this.storageKey=(i=l.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=l.global.headers)!==null&&s!==void 0?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=l.auth)!==null&&o!==void 0?o:{},this.headers,l.global.fetch),this.fetch=Yc(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Ic(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new dn(this.storageUrl.href,this.headers,this.fetch,r?.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new en(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return h(this,null,function*(){var t,e;if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,userStorage:s,storageKey:o,flowType:a,lock:u,debug:c,throwOnError:l},d,p){let f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Zi({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,userStorage:s,flowType:a,lock:u,debug:c,throwOnError:l,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new an(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Ll=(n,t,e)=>new Xi(n,t,e);function Tp(){if(typeof window<"u"||typeof process>"u")return!1;let n=process.version;if(n==null)return!1;let t=n.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Tp()&&console.warn("\u26A0\uFE0F  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var Fl=class n{supabase;constructor(){this.supabase=Ll(fo.supabaseUrl,fo.supabaseKey)}signUp(t){return h(this,null,function*(){try{console.log("\u{1F504} Starting signUp process for:",t.email);let{data:e,error:r}=yield this.supabase.auth.signUp({email:t.email,password:t.password,options:{data:{first_name:t.user_data.first_name,last_name:t.user_data.last_name,phone:t.user_data.phone,role:t.user_data.role}}});if(r)return console.error("\u274C Auth error:",r),{user:null,restaurant:null,supplier:null,error:r.message};let i=e.user;if(!i)return{user:null,restaurant:null,supplier:null,error:"No user returned from signUp"};console.log("\u2705 Auth user created:",i.id),yield this.delay(1e3);let s={id:i.id,email:t.email,first_name:this.truncateString(t.user_data.first_name,20),last_name:this.truncateString(t.user_data.last_name,20),phone:this.truncateString(t.user_data.phone||"",20),role:this.truncateString(t.user_data.role,20),email_verified:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("\u{1F4DD} Inserting user into users table:",s);let{error:o}=yield this.supabase.from("users").insert(s);if(o)if(console.error("\u274C Error creating user in users table:",o),o.code==="23505")console.log("\u26A0\uFE0F User might already exist in users table");else return{user:null,restaurant:null,supplier:null,error:`User table error: ${o.message}`};else console.log("\u2705 User successfully inserted into users table");let a=null,u=null;if(t.user_data.role==="restaurant_owner"&&t.restaurant_data){console.log("\u{1F3EA} Creating restaurant for owner:",i.id);let{data:c,error:l}=yield this.supabase.from("users").select("id").eq("id",i.id).single();if(l||!c)return console.error("\u274C User not found in users table, cannot create restaurant"),{user:i,restaurant:null,supplier:null,error:"User account not ready yet. Please try logging in first."};console.log("\u2705 User verified in users table, proceeding with restaurant creation");let d={owner_id:i.id,name:this.truncateString(t.restaurant_data.name,100),address:this.truncateString(t.restaurant_data.address||"",200),phone:this.truncateString(t.restaurant_data.phone||"",20),email:this.truncateString(t.restaurant_data.email||"",100),description:this.truncateString(t.restaurant_data.description||"",500),cuisine_type:this.truncateString(t.restaurant_data.cuisine_type||"",50),allow_table_selection:!!t.restaurant_data.allow_table_selection,accepts_delivery:!!t.restaurant_data.accepts_delivery,accepts_takeaway:!!t.restaurant_data.accepts_takeaway,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("\u{1F3EA} Restaurant payload:",d);let{data:p,error:f}=yield this.supabase.from("restaurants").insert(d).select().single();if(f)return console.error("\u274C Error creating restaurant:",f),f.code==="23503"?{user:i,restaurant:null,supplier:null,error:"User account is being prepared. Please log in to complete restaurant setup."}:{user:i,restaurant:null,supplier:null,error:`Restaurant creation failed: ${f.message}`};a=p,console.log("\u2705 Restaurant created successfully:",a)}if(t.user_data.role==="supplier"&&t.supplier_data){console.log("\u{1F3ED} Creating supplier for user:",i.id);let{data:c,error:l}=yield this.supabase.from("users").select("id").eq("id",i.id).single();if(l||!c)return console.error("\u274C User not found in users table, cannot create supplier"),{user:i,restaurant:null,supplier:null,error:"User account not ready yet. Please try logging in first."};console.log("\u2705 User verified in users table, proceeding with supplier creation");let d={user_id:i.id,company_name:this.truncateString(t.supplier_data.company_name,100),contact_name:this.truncateString(t.supplier_data.contact_name||`${t.user_data.first_name} ${t.user_data.last_name}`,100),email:this.truncateString(t.supplier_data.email||t.email,100),phone:this.truncateString(t.supplier_data.phone||t.user_data.phone||"",20),address:this.truncateString(t.supplier_data.address||"",200),description:this.truncateString(t.supplier_data.description||"",500),is_platform_supplier:!1,is_approved:!1,created_at:new Date().toISOString()};console.log("\u{1F3ED} Supplier payload:",d);let{data:p,error:f}=yield this.supabase.from("suppliers").insert(d).select().single();if(f)return console.error("\u274C Error creating supplier:",f),{user:i,restaurant:null,supplier:null,error:`Supplier creation failed: ${f.message}`};u=p,console.log("\u2705 Supplier created successfully:",u)}return{user:i,restaurant:a,supplier:u,error:void 0}}catch(e){return console.error("\u{1F4A5} Unexpected error in signUp:",e),{user:null,restaurant:null,supplier:null,error:e?.message||"Errore sconosciuto"}}})}truncateString(t,e){return t?t.length>e?t.substring(0,e):t:""}delay(t){return new Promise(e=>setTimeout(e,t))}signIn(t,e){return h(this,null,function*(){return yield this.supabase.auth.signInWithPassword({email:t,password:e})})}signOut(){return h(this,null,function*(){return yield this.supabase.auth.signOut()})}getCurrentUser(){return this.supabase.auth.getUser()}getSession(){return this.supabase.auth.getSession()}getCurrentUserRestaurant(){return h(this,null,function*(){try{let{data:{user:t},error:e}=yield this.supabase.auth.getUser();if(e)return console.error("Error getting current user:",e),null;if(!t)return console.log("No authenticated user found"),null;console.log("\u{1F50D} Searching restaurant for user:",t.id);let{data:r,error:i}=yield this.supabase.from("restaurants").select("*").eq("owner_id",t.id).maybeSingle();if(i)return console.error("Error fetching restaurant:",i),null;if(!r){console.log("\u274C No restaurant found for user:",t.id);let{data:s,error:o}=yield this.supabase.from("restaurants").select("*").eq("owner_id",t.id);return!o&&s&&s.length>0?(console.log("\u26A0\uFE0F Found restaurants but maybeSingle failed:",s),s[0]):null}return console.log("\u2705 Restaurant found:",r.id,r.name),r}catch(t){return console.error("Error in getCurrentUserRestaurant:",t),null}})}getCurrentUserSupplier(){return h(this,null,function*(){try{let{data:{user:t},error:e}=yield this.supabase.auth.getUser();if(e)return console.error("Error getting current user:",e),null;if(!t)return console.log("No authenticated user found"),null;console.log("\u{1F50D} Searching supplier for user:",t.id);let{data:r,error:i}=yield this.supabase.from("suppliers").select("*").eq("user_id",t.id).maybeSingle();return i?(console.error("Error fetching supplier:",i),null):r?(console.log("\u2705 Supplier found:",r.id,r.company_name),r):(console.log("\u274C No supplier found for user:",t.id),null)}catch(t){return console.error("Error in getCurrentUserSupplier:",t),null}})}getSupabaseClient(){return this.supabase}static \u0275fac=function(e){return new(e||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})};export{Be as a,Ye as b,ud as c,au as d,cd as e,ld as f,dd as g,fd as h,pd as i,vd as j,lu as k,Hg as l,xd as m,Me as n,ro as o,Re as p,mi as q,mf as r,wf as s,_f as t,bf as u,fo as v,Fl as w};
