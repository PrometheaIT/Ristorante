import{a as re}from"./chunk-JA4P7KVP.js";import{a as oe}from"./chunk-3IY4UHOG.js";import{a as ne}from"./chunk-THMILZHX.js";import{a as le}from"./chunk-UCL3U7HJ.js";import"./chunk-5BFIQ7BP.js";import{b as L,d as Q,e as G,g as H,h as Y,i as J,j as K,p as X,q as Z,r as $,s as ee,t as te,u as ae,w as ie}from"./chunk-77SKEQNN.js";import{a as B}from"./chunk-KNL3CWA3.js";import{d as q,e as N,k as W,r as U,t as j}from"./chunk-DCWKKS33.js";import{Db as g,Eb as c,Ia as T,Ib as R,Jb as V,Kb as E,La as s,Lb as O,Mb as D,Nb as S,Ob as I,Pb as z,Qb as n,Rb as _,Sb as b,Tb as F,Ub as A,Vb as x,Wb as h,Xb as y,ab as k,ea as w,f,fb as v,g as P,ja as p,ka as u,qb as d,rb as t,sb as i,tb as M,zb as C}from"./chunk-K5RDB55Y.js";var ce=["floorPlanCanvas"];function de(r,a){if(r&1&&(t(0,"div",32),M(1,"img",33),i()),r&2){let e=c(2);s(),d("src",e.restaurant.cover_image_url,T)("alt",e.restaurant.name)}}function me(r,a){if(r&1&&(t(0,"div",34),M(1,"img",33),i()),r&2){let e=c(2);s(),d("src",e.restaurant.logo_url,T)("alt",e.restaurant.name)}}function pe(r,a){if(r&1&&(t(0,"p",35),n(1),i()),r&2){let e=c(2);s(),_(e.restaurant.cuisine_type)}}function ue(r,a){if(r&1&&(t(0,"p",36),n(1),i()),r&2){let e=c(2);s(),_(e.restaurant.description)}}function ve(r,a){if(r&1&&(t(0,"span",37)(1,"span",38),n(2,"place"),i(),n(3),i()),r&2){let e=c(2);s(3),b(" ",e.restaurant.address," ")}}function ge(r,a){if(r&1&&(t(0,"span",37)(1,"span",38),n(2,"phone"),i(),n(3),i()),r&2){let e=c(2);s(3),b(" ",e.restaurant.phone," ")}}function _e(r,a){if(r&1&&(t(0,"div",21)(1,"div",22),v(2,de,2,2,"div",23),t(3,"div",24),v(4,me,2,2,"div",25),t(5,"div",26)(6,"h1",27),n(7),i(),v(8,pe,2,1,"p",28)(9,ue,2,1,"p",29),t(10,"div",30),v(11,ve,4,1,"span",31)(12,ge,4,1,"span",31),i()()()()()),r&2){let e=c();s(2),d("ngIf",e.restaurant.cover_image_url),s(2),d("ngIf",e.restaurant.logo_url),s(3),_(e.restaurant.name),s(),d("ngIf",e.restaurant.cuisine_type),s(),d("ngIf",e.restaurant.description),s(2),d("ngIf",e.restaurant.address),s(),d("ngIf",e.restaurant.phone)}}function fe(r,a){if(r&1){let e=C();t(0,"div",43),g("click",function(){let l=p(e).$implicit,m=c(2);return u(m.selectFloorPlan(l))}),t(1,"span",38),n(2,"map"),i(),t(3,"span",44),n(4),i()()}if(r&2){let e=a.$implicit,o=c(2);S("selected",(o.currentFloorPlan==null?null:o.currentFloorPlan.id)===e.id),s(4),_(e.name)}}function be(r,a){if(r&1&&(t(0,"div",39)(1,"div",6)(2,"div",14)(3,"h3",40),n(4,"Seleziona Area"),i(),t(5,"div",41),v(6,fe,5,3,"div",42),i()()()()),r&2){let e=c();s(6),d("ngForOf",e.floorPlans)}}function xe(r,a){r&1&&(t(0,"div",50)(1,"span",38),n(2,"event_busy"),i()())}function he(r,a){if(r&1){let e=C();t(0,"div",45),g("click",function(){let l=p(e).$implicit,m=c();return u(m.onTableClick(l))}),t(1,"div",46)(2,"div",47),n(3),i(),t(4,"div",48),n(5),i(),v(6,xe,3,0,"div",49),i()()}if(r&2){let e=a.$implicit,o=c();I(o.getTableStyle(e)),z(o.getTableClass(e)),d("title",o.getTableTooltip(e)),s(3),_(e.table_number),s(2),b("",e.capacity," p"),s(),d("ngIf",o.isTableReserved(e))}}function ye(r,a){r&1&&(t(0,"div",51)(1,"div",52)(2,"span",38),n(3,"table_restaurant"),i(),t(4,"h4"),n(5,"Nessun tavolo configurato"),i(),t(6,"p"),n(7,"Il ristorante non ha ancora configurato i tavoli per questa area"),i()()())}function we(r,a){r&1&&(t(0,"div",71)(1,"span",72),n(2,"event_busy"),i(),t(3,"span",73),n(4," Questo tavolo \xE8 gi\xE0 prenotato per l'orario selezionato "),i()())}function Me(r,a){r&1&&(t(0,"div",74)(1,"span",75),n(2,"event_available"),i(),t(3,"span",73),n(4," Tavolo disponibile per la prenotazione "),i()())}function Ce(r,a){r&1&&(t(0,"div",76)(1,"span",77),n(2,"block"),i(),t(3,"span",73),n(4," Questo tavolo non \xE8 prenotabile online "),i()())}function Te(r,a){if(r&1){let e=C();t(0,"div",53),g("click",function(){p(e);let l=c();return u(l.deselectTable())}),t(1,"div",54),g("click",function(l){return p(e),u(l.stopPropagation())}),t(2,"div",55)(3,"div",56)(4,"span",38),n(5,"table_restaurant"),i(),t(6,"h3"),n(7),i()(),t(8,"button",57),g("click",function(){p(e);let l=c();return u(l.deselectTable())}),t(9,"span",38),n(10,"close"),i()()(),t(11,"div",58)(12,"div",59)(13,"div",60)(14,"span",61),n(15,"Capacit\xE0:"),i(),t(16,"span",62),n(17),i()(),t(18,"div",60)(19,"span",61),n(20,"Nome:"),i(),t(21,"span",63),n(22),i()(),t(23,"div",60)(24,"span",61),n(25,"Forma:"),i(),t(26,"span",64),n(27),i()()(),v(28,we,5,0,"div",65)(29,Me,5,0,"div",66)(30,Ce,5,0,"div",67),i(),t(31,"div",68)(32,"button",69),g("click",function(){p(e);let l=c();return u(l.deselectTable())}),t(33,"span",38),n(34,"close"),i(),n(35," Chiudi "),i(),t(36,"button",70),g("click",function(){p(e);let l=c();return u(l.openReservationModal())}),t(37,"span",38),n(38,"event_available"),i(),n(39," Prenota Questo Tavolo "),i()()()()}if(r&2){let e=c();s(7),b("Tavolo ",e.selectedTable.table_number),s(10),b(" ",e.selectedTable.capacity," persone "),s(5),_(e.selectedTable.table_name||"N/D"),s(5),_(e.selectedTable.shape),s(),d("ngIf",e.isTableReserved(e.selectedTable)),s(),d("ngIf",!e.isTableReserved(e.selectedTable)&&e.selectedTable.is_online_bookable),s(),d("ngIf",!e.selectedTable.is_online_bookable),s(6),d("disabled",e.isTableReserved(e.selectedTable)||!e.selectedTable.is_online_bookable)}}function Se(r,a){if(r&1){let e=C();t(0,"div",81)(1,"h4",82),n(2,"Informazioni Personali"),i(),t(3,"div",83)(4,"div",84)(5,"label",101),n(6,"Nome"),i(),t(7,"input",102),y("ngModelChange",function(l){p(e);let m=c(2);return h(m.reservationData.customer_info.first_name,l)||(m.reservationData.customer_info.first_name=l),u(l)}),i()(),t(8,"div",84)(9,"label",103),n(10,"Cognome"),i(),t(11,"input",104),y("ngModelChange",function(l){p(e);let m=c(2);return h(m.reservationData.customer_info.last_name,l)||(m.reservationData.customer_info.last_name=l),u(l)}),i()()(),t(12,"div",83)(13,"div",84)(14,"label",105),n(15,"Email"),i(),t(16,"input",106),y("ngModelChange",function(l){p(e);let m=c(2);return h(m.reservationData.customer_info.email,l)||(m.reservationData.customer_info.email=l),u(l)}),i()(),t(17,"div",84)(18,"label",107),n(19,"Telefono"),i(),t(20,"input",108),y("ngModelChange",function(l){p(e);let m=c(2);return h(m.reservationData.customer_info.phone,l)||(m.reservationData.customer_info.phone=l),u(l)}),i()()()()}if(r&2){let e=c(2);s(7),x("ngModel",e.reservationData.customer_info.first_name),s(4),x("ngModel",e.reservationData.customer_info.last_name),s(5),x("ngModel",e.reservationData.customer_info.email),s(4),x("ngModel",e.reservationData.customer_info.phone)}}function Pe(r,a){if(r&1&&(t(0,"option",109),n(1),i()),r&2){let e=a.$implicit;d("value",e),s(),b(" ",e," ")}}function ke(r,a){if(r&1&&(t(0,"small",110),n(1),i()),r&2){let e=c(2);s(),b(" Capacit\xE0 massima: ",e.selectedTable.capacity," persone ")}}function Re(r,a){if(r&1&&(t(0,"div",111)(1,"div",112)(2,"span",38),n(3),i(),t(4,"span"),n(5),i()()()),r&2){let e=c(2);s(),S("available",e.isTableAvailable)("unavailable",!e.isTableAvailable),s(2),_(e.isTableAvailable?"check_circle":"cancel"),s(2),_(e.isTableAvailable?"Tavolo disponibile":"Tavolo non disponibile per questo orario")}}function Ve(r,a){if(r&1&&(t(0,"div",113)(1,"h4",82),n(2,"Riepilogo Prenotazione"),i(),t(3,"div",114)(4,"div",115)(5,"span",116),n(6,"Tavolo:"),i(),t(7,"span",117),n(8),i()(),t(9,"div",115)(10,"span",116),n(11,"Data:"),i(),t(12,"span",117),n(13),i()(),t(14,"div",115)(15,"span",116),n(16,"Orario:"),i(),t(17,"span",117),n(18),i()(),t(19,"div",115)(20,"span",116),n(21,"Persone:"),i(),t(22,"span",117),n(23),i()()()()),r&2){let e=c(2);s(8),F("",e.selectedTable.table_number," - ",e.selectedTable.table_name),s(5),_(e.formatDate(e.reservationData.reservation_date)),s(5),_(e.reservationData.reservation_time),s(5),_(e.reservationData.party_size)}}function Ee(r,a){r&1&&(t(0,"span",38),n(1,"event_available"),i())}function Oe(r,a){r&1&&(t(0,"span",38),n(1,"hourglass_empty"),i())}function De(r,a){if(r&1){let e=C();t(0,"div",53),g("click",function(){p(e);let l=c();return u(l.closeReservationModal())}),t(1,"div",78),g("click",function(l){return p(e),u(l.stopPropagation())}),t(2,"div",55)(3,"div",56)(4,"span",38),n(5,"event_available"),i(),t(6,"h3"),n(7),i()(),t(8,"button",57),g("click",function(){p(e);let l=c();return u(l.closeReservationModal())}),t(9,"span",38),n(10,"close"),i()()(),t(11,"div",58)(12,"form",79,1),v(14,Se,21,4,"div",80),t(15,"div",81)(16,"h4",82),n(17,"Dettagli Prenotazione"),i(),t(18,"div",83)(19,"div",84)(20,"label",85),n(21,"Data"),i(),t(22,"input",86),y("ngModelChange",function(l){p(e);let m=c();return h(m.reservationData.reservation_date,l)||(m.reservationData.reservation_date=l),u(l)}),g("change",function(){p(e);let l=c();return u(l.onDateChange())}),i()(),t(23,"div",84)(24,"label",87),n(25,"Orario"),i(),t(26,"select",88),y("ngModelChange",function(l){p(e);let m=c();return h(m.reservationData.reservation_time,l)||(m.reservationData.reservation_time=l),u(l)}),g("change",function(){p(e);let l=c();return u(l.onTimeChange())}),t(27,"option",89),n(28,"Seleziona orario"),i(),v(29,Pe,2,2,"option",90),i()()(),t(30,"div",84)(31,"label",91),n(32,"Numero di Persone"),i(),t(33,"input",92),y("ngModelChange",function(l){p(e);let m=c();return h(m.reservationData.party_size,l)||(m.reservationData.party_size=l),u(l)}),i(),v(34,ke,2,1,"small",93),i(),v(35,Re,6,6,"div",94),i(),t(36,"div",81)(37,"h4",82),n(38,"Richieste Speciali (Opzionale)"),i(),t(39,"div",84)(40,"textarea",95),y("ngModelChange",function(l){p(e);let m=c();return h(m.reservationData.special_requests,l)||(m.reservationData.special_requests=l),u(l)}),i()()(),v(41,Ve,24,5,"div",96),i()(),t(42,"div",97)(43,"button",98),g("click",function(){p(e);let l=c();return u(l.closeReservationModal())}),n(44," Annulla "),i(),t(45,"button",99),g("click",function(){p(e);let l=c();return u(l.createReservation())}),v(46,Ee,2,0,"span",100)(47,Oe,2,0,"span",100),n(48),i()()()()}if(r&2){let e=O(13),o=c();s(7),b("Prenota Tavolo ",o.selectedTable==null?null:o.selectedTable.table_number),s(7),d("ngIf",!o.currentUser),s(8),x("ngModel",o.reservationData.reservation_date),d("min",o.minDate),s(4),x("ngModel",o.reservationData.reservation_time),s(3),d("ngForOf",o.availableTimes),s(4),x("ngModel",o.reservationData.party_size),d("max",(o.selectedTable==null?null:o.selectedTable.capacity)||10),s(),d("ngIf",o.selectedTable),s(),d("ngIf",o.availabilityChecked),s(5),x("ngModel",o.reservationData.special_requests),s(),d("ngIf",o.selectedTable),s(4),d("disabled",!e.form.valid||!o.isTableAvailable||o.creatingReservation),s(),d("ngIf",!o.creatingReservation),s(),d("ngIf",o.creatingReservation),s(),b(" ",o.creatingReservation?"Creando prenotazione...":"Conferma Prenotazione"," ")}}function Ie(r,a){if(r&1){let e=C();t(0,"div",53),g("click",function(){p(e);let l=c();return u(l.closeConfirmationModal())}),t(1,"div",54),g("click",function(l){return p(e),u(l.stopPropagation())}),t(2,"div",118)(3,"div",119)(4,"span",120),n(5,"check_circle"),i()(),t(6,"h3",121),n(7,"Prenotazione Confermata!"),i(),t(8,"p",122),n(9),i(),t(10,"div",123)(11,"div",124)(12,"strong"),n(13,"Numero prenotazione:"),i(),n(14),i(),t(15,"div",125)(16,"strong"),n(17,"Stato:"),i(),t(18,"span",126),n(19),i()()()(),t(20,"div",97)(21,"button",127),g("click",function(){p(e);let l=c();return u(l.closeConfirmationModal())}),t(22,"span",38),n(23,"done"),i(),n(24," Ok, Grazie "),i()()()()}if(r&2){let e=c();s(9),A(" La tua prenotazione per il tavolo ",e.lastReservation==null||e.lastReservation.tables==null?null:e.lastReservation.tables.table_number," \xE8 stata confermata per il ",e.formatDate(e.lastReservation==null?null:e.lastReservation.reservation_date)," alle ",e.lastReservation==null?null:e.lastReservation.reservation_time,". "),s(5),b(" ",e.lastReservation==null?null:e.lastReservation.id.slice(-8).toUpperCase()," "),s(5),_(e.lastReservation==null?null:e.lastReservation.status)}}var se=class r{route=w(U);router=w(j);floorPlanService=w(re);tableService=w(oe);reservationService=w(le);restaurantPublicService=w(ne);authService=w(B);canvasRef;restaurant=null;floorPlans=[];currentFloorPlan=null;tables=[];reservations=[];selectedTable=null;showReservationModal=!1;showConfirmationModal=!1;creatingReservation=!1;reservationData={restaurant_id:"",table_id:"",reservation_date:"",reservation_time:"",party_size:1,special_requests:"",customer_info:{first_name:"",last_name:"",email:"",phone:""}};availableTimes=[];isTableAvailable=!1;availabilityChecked=!1;currentUser=null;lastReservation=null;minDate;subscriptions=new P;restaurantId="";constructor(){let a=new Date;this.minDate=a.toISOString().split("T")[0],this.reservationData.reservation_date=this.minDate}ngOnInit(){return f(this,null,function*(){console.log("\u{1F504} RestaurantMapViewer initialized"),this.route.params.subscribe(a=>{console.log("\u{1F4CB} Route params:",a),this.restaurantId=a.restaurantId,console.log("\u{1F3EA} Restaurant ID from route:",this.restaurantId),this.restaurantId?this.loadRestaurantData():console.error("\u274C No restaurantId found in route params")}),this.subscriptions.add(this.authService.currentUser$.subscribe(a=>{this.currentUser=a,a&&(this.reservationData.customer_info={first_name:a.user_metadata?.first_name||"",last_name:a.user_metadata?.last_name||"",email:a.email||"",phone:a.user_metadata?.phone||""})}))})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadRestaurantData(){return f(this,null,function*(){if(console.log("\u{1F4E5} Loading restaurant data for ID:",this.restaurantId),this.restaurant=yield this.restaurantPublicService.loadRestaurant(this.restaurantId),console.log("\u{1F3EA} Restaurant loaded:",this.restaurant),!this.restaurant){console.error("\u274C Restaurant not found");return}this.reservationData.restaurant_id=this.restaurantId,yield this.loadFloorPlans(),yield this.loadTables(),yield this.loadExistingReservations()})}loadFloorPlans(){return f(this,null,function*(){try{let{data:a,error:e}=yield this.floorPlanService.supabaseService.getSupabaseClient().from("restaurant_floor_plans").select("*").eq("restaurant_id",this.restaurantId).eq("is_active",!0).order("created_at",{ascending:!0});if(e)throw e;this.floorPlans=a||[],this.floorPlans.length>0&&(this.currentFloorPlan=this.floorPlans[0],this.loadTablesForFloorPlan())}catch(a){console.error("\u274C Error loading floor plans:",a)}})}loadTables(){return f(this,null,function*(){try{let{data:a,error:e}=yield this.tableService.supabaseService.getSupabaseClient().from("tables").select("*").eq("restaurant_id",this.restaurantId).eq("is_active",!0).eq("is_online_bookable",!0);if(e)throw e;this.tables=a||[],console.log("\u2705 Online bookable tables loaded:",this.tables.length)}catch(a){console.error("\u274C Error loading tables:",a)}})}loadExistingReservations(){return f(this,null,function*(){try{let a=new Date().toISOString().split("T")[0],{data:e,error:o}=yield this.reservationService.supabaseService.getSupabaseClient().from("reservations").select("*").eq("restaurant_id",this.restaurantId).eq("reservation_date",a).in("status",["pending","confirmed"]);if(o)throw o;this.reservations=e||[]}catch(a){console.error("\u274C Error loading reservations:",a)}})}loadTablesForFloorPlan(){if(!this.currentFloorPlan){this.tables=[];return}this.tables=this.tables.filter(a=>a.floor_plan_id===this.currentFloorPlan?.id&&(!a.is_merged||a.parent_table_id===null)),console.log("\u2705 Filtered tables for floor plan:",this.tables.length)}isTableAvailableForBooking(a){return a.is_online_bookable&&!this.isTableReserved(a)&&(!a.is_merged||a.parent_table_id===null)}selectFloorPlan(a){this.currentFloorPlan=a,this.loadTablesForFloorPlan(),this.deselectTable()}onTableClick(a){if(!this.isTableAvailableForBooking(a)){console.log("\u274C Table not available for online booking:",a.table_number);return}this.selectedTable=a,this.reservationData.table_id=a.id,this.reservationData.party_size=Math.min(1,a.capacity),this.loadAvailableTimes()}deselectTable(){this.selectedTable=null,this.reservationData.table_id="",this.availabilityChecked=!1,this.isTableAvailable=!1}isTableReserved(a){return!this.reservationData.reservation_date||!this.reservationData.reservation_time?!1:this.reservations.some(e=>e.table_id===a.id&&e.reservation_date===this.reservationData.reservation_date&&e.reservation_time===this.reservationData.reservation_time)}getTableClass(a){let e=["table-element",`shape-${a.shape}`];return this.selectedTable?.id===a.id?e.push("selected"):this.isTableAvailableForBooking(a)?e.push("available"):e.push("unavailable"),e.join(" ")}getTableStyle(a){let e=a.shape==="rectangle"||a.shape==="square"?"8px":"50%";return{left:a.position_x+"px",top:a.position_y+"px",width:a.width+"px",height:a.height+"px","border-radius":e,transform:`rotate(${a.rotation}deg)`}}getTableTooltip(a){let e=`Tavolo ${a.table_number} - ${a.capacity} persone`;return a.is_online_bookable?this.isTableReserved(a)?e+=" (Prenotato)":a.is_merged&&a.parent_table_id!==null?e+=" (Unit\u014D con altri tavoli)":e+=" (Disponibile)":e+=" (Non prenotabile online)",e}openReservationModal(){if(!this.selectedTable||!this.isTableAvailableForBooking(this.selectedTable)){console.log("\u274C Cannot open reservation modal - table not available");return}this.showReservationModal=!0,this.loadAvailableTimes()}getOnlineBookableTables(){return this.tables.filter(a=>a.is_online_bookable&&a.is_active&&(!a.is_merged||a.parent_table_id===null))}closeReservationModal(){this.showReservationModal=!1,this.availabilityChecked=!1}onDateChange(){return f(this,null,function*(){this.availabilityChecked=!1,yield this.loadAvailableTimes()})}onTimeChange(){return f(this,null,function*(){this.reservationData.reservation_time&&(yield this.checkAvailability())})}loadAvailableTimes(){return f(this,null,function*(){!this.selectedTable||!this.reservationData.reservation_date||(this.availableTimes=yield this.reservationService.getAvailableTimes(this.selectedTable.id,this.reservationData.reservation_date),this.reservationData.reservation_time&&(yield this.checkAvailability()))})}checkAvailability(){return f(this,null,function*(){!this.selectedTable||!this.reservationData.reservation_date||!this.reservationData.reservation_time||(this.isTableAvailable=yield this.reservationService.checkTableAvailability(this.selectedTable.id,this.reservationData.reservation_date,this.reservationData.reservation_time),this.availabilityChecked=!0)})}createReservation(){return f(this,null,function*(){if(!(!this.selectedTable||!this.isTableAvailable||this.creatingReservation)){this.creatingReservation=!0;try{if(!this.currentUser&&(!this.reservationData.customer_info.first_name||!this.reservationData.customer_info.email)){alert("Per favore compila tutti i campi obbligatori"),this.creatingReservation=!1;return}let a={restaurant_id:this.reservationData.restaurant_id,table_id:this.reservationData.table_id,reservation_date:this.reservationData.reservation_date,reservation_time:this.reservationData.reservation_time,party_size:this.reservationData.party_size,special_requests:this.reservationData.special_requests,customer_info:this.currentUser?void 0:this.reservationData.customer_info},e=yield this.reservationService.createReservation(a);e?(this.lastReservation=e,this.showReservationModal=!1,this.showConfirmationModal=!0,yield this.loadExistingReservations(),this.deselectTable()):alert("Errore durante la creazione della prenotazione. Riprova.")}catch(a){console.error("\u274C Error creating reservation:",a),alert("Errore durante la creazione della prenotazione.")}finally{this.creatingReservation=!1}}})}closeConfirmationModal(){this.showConfirmationModal=!1,this.reservationData={restaurant_id:this.restaurantId,table_id:"",reservation_date:this.minDate,reservation_time:"",party_size:1,special_requests:"",customer_info:{first_name:this.currentUser?.user_metadata?.first_name||"",last_name:this.currentUser?.user_metadata?.last_name||"",email:this.currentUser?.email||"",phone:this.currentUser?.user_metadata?.phone||""}}}formatDate(a){return a?new Date(a).toLocaleDateString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}goToRestaurantList(){this.router.navigate(["/restaurants"])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-restaurant-map-viewer"]],viewQuery:function(e,o){if(e&1&&R(ce,5),e&2){let l;V(l=E())&&(o.canvasRef=l.first)}},decls:31,vars:11,consts:[["floorPlanCanvas",""],["reservationForm","ngForm"],[1,"restaurant-map-viewer"],["class","restaurant-header",4,"ngIf"],["class","map-selector-section",4,"ngIf"],[1,"map-section"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"map-legend"],[1,"legend-item"],[1,"legend-color","available"],[1,"legend-color","reserved"],[1,"legend-color","selected"],[1,"card-content"],[1,"canvas-container"],[1,"floor-plan-canvas"],[1,"grid-overlay"],["class","table-element",3,"class","style","title","click",4,"ngFor","ngForOf"],["class","canvas-instructions",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"restaurant-header"],[1,"restaurant-hero"],["class","restaurant-cover",4,"ngIf"],[1,"restaurant-info"],["class","restaurant-logo",4,"ngIf"],[1,"restaurant-details"],[1,"restaurant-name"],["class","restaurant-cuisine",4,"ngIf"],["class","restaurant-description",4,"ngIf"],[1,"restaurant-meta"],["class","meta-item",4,"ngIf"],[1,"restaurant-cover"],[3,"src","alt"],[1,"restaurant-logo"],[1,"restaurant-cuisine"],[1,"restaurant-description"],[1,"meta-item"],[1,"material-icons"],[1,"map-selector-section"],[1,"section-title"],[1,"floor-plan-selector"],["class","floor-plan-option",3,"selected","click",4,"ngFor","ngForOf"],[1,"floor-plan-option",3,"click"],[1,"plan-name"],[1,"table-element",3,"click","title"],[1,"table-content"],[1,"table-number"],[1,"table-capacity"],["class","table-status",4,"ngIf"],[1,"table-status"],[1,"canvas-instructions"],[1,"instruction-card"],[1,"modal-overlay",3,"click"],[1,"modal-container","modal-sm",3,"click"],[1,"modal-header"],[1,"modal-title"],["title","Chiudi",1,"modal-close",3,"click"],[1,"modal-body"],[1,"info-grid",2,"display","grid","gap","var(--gutter-md)","margin-bottom","var(--gutter-lg)"],[1,"info-item",2,"display","flex","justify-content","space-between","align-items","center","padding","var(--gutter-sm)","background","color-mix(in srgb, var(--background) 95%, transparent)","border-radius","12px"],[2,"font-weight","600","color","var(--text-color)"],[1,"chip","active",2,"background","color-mix(in srgb, var(--primary) 20%, transparent)","color","var(--primary)"],[2,"color","var(--text-color)"],[2,"color","var(--text-color)","text-transform","capitalize"],["class","reservation-status","style","display: flex; align-items: center; gap: var(--gutter-sm); padding: var(--gutter-md); background: color-mix(in srgb, #f59e0b 10%, transparent); border: 1px solid color-mix(in srgb, #f59e0b 30%, transparent); border-radius: 12px; margin-bottom: var(--gutter-lg);",4,"ngIf"],["class","reservation-status","style","display: flex; align-items: center; gap: var(--gutter-sm); padding: var(--gutter-md); background: color-mix(in srgb, #10b981 10%, transparent); border: 1px solid color-mix(in srgb, #10b981 30%, transparent); border-radius: 12px; margin-bottom: var(--gutter-lg);",4,"ngIf"],["class","reservation-status","style","display: flex; align-items: center; gap: var(--gutter-sm); padding: var(--gutter-md); background: color-mix(in srgb, #ef4444 10%, transparent); border: 1px solid color-mix(in srgb, #ef4444 30%, transparent); border-radius: 12px; margin-bottom: var(--gutter-lg);",4,"ngIf"],[1,"modal-footer",2,"display","flex","gap","var(--gutter-sm)","justify-content","stretch"],[1,"promethea-button","secondary",2,"flex","1",3,"click"],[1,"promethea-button","primary",2,"flex","2",3,"click","disabled"],[1,"reservation-status",2,"display","flex","align-items","center","gap","var(--gutter-sm)","padding","var(--gutter-md)","background","color-mix(in srgb, #f59e0b 10%, transparent)","border","1px solid color-mix(in srgb, #f59e0b 30%, transparent)","border-radius","12px","margin-bottom","var(--gutter-lg)"],[1,"material-icons",2,"color","#f59e0b","flex-shrink","0"],[2,"color","var(--text-color)","font-size","var(--fs-sm)"],[1,"reservation-status",2,"display","flex","align-items","center","gap","var(--gutter-sm)","padding","var(--gutter-md)","background","color-mix(in srgb, #10b981 10%, transparent)","border","1px solid color-mix(in srgb, #10b981 30%, transparent)","border-radius","12px","margin-bottom","var(--gutter-lg)"],[1,"material-icons",2,"color","#10b981","flex-shrink","0"],[1,"reservation-status",2,"display","flex","align-items","center","gap","var(--gutter-sm)","padding","var(--gutter-md)","background","color-mix(in srgb, #ef4444 10%, transparent)","border","1px solid color-mix(in srgb, #ef4444 30%, transparent)","border-radius","12px","margin-bottom","var(--gutter-lg)"],[1,"material-icons",2,"color","#ef4444","flex-shrink","0"],[1,"modal-container","modal-lg",3,"click"],[1,"generic-form"],["class","form-section",4,"ngIf"],[1,"form-section"],[1,"subsection-title"],[1,"form-row"],[1,"form-group"],["for","reservationDate",1,"form-label"],["id","reservationDate","type","date","name","reservationDate","required","",1,"form-input",3,"ngModelChange","change","ngModel","min"],["for","reservationTime",1,"form-label"],["id","reservationTime","name","reservationTime","required","",1,"form-input",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","partySize",1,"form-label"],["id","partySize","type","number","name","partySize","min","1","required","",1,"form-input",3,"ngModelChange","ngModel","max"],["class","text-muted",4,"ngIf"],["class","availability-status",4,"ngIf"],["name","specialRequests","placeholder","Allergie, celebrazioni speciali, richieste particolari...","rows","4",1,"form-input",3,"ngModelChange","ngModel"],["class","reservation-summary",4,"ngIf"],[1,"modal-footer"],["type","button",1,"promethea-button","secondary",3,"click"],["type","button",1,"promethea-button","primary",3,"click","disabled"],["class","material-icons",4,"ngIf"],["for","firstName",1,"form-label"],["id","firstName","type","text","name","firstName","placeholder","Il tuo nome","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","lastName",1,"form-label"],["id","lastName","type","text","name","lastName","placeholder","Il tuo cognome","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","email",1,"form-label"],["id","email","type","email","name","email","placeholder","tua.email@example.com","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","phone",1,"form-label"],["id","phone","type","tel","name","phone","placeholder","Il tuo numero di telefono","required","",1,"form-input",3,"ngModelChange","ngModel"],[3,"value"],[1,"text-muted"],[1,"availability-status"],[1,"status-message"],[1,"reservation-summary"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"modal-body","text-center"],[1,"confirmation-icon"],[1,"material-icons","success",2,"font-size","48px","color","#10b981"],[1,"confirmation-title",2,"margin-bottom","var(--gutter-sm)","color","var(--text-color)"],[1,"confirmation-message",2,"margin-bottom","var(--gutter-md)","color","var(--text-color)","opacity","0.8"],[1,"confirmation-details",2,"text-align","left","background","color-mix(in srgb, var(--background) 95%, transparent)","padding","var(--gutter-md)","border-radius","12px","margin-bottom","var(--gutter-lg)"],[1,"detail-item",2,"margin-bottom","var(--gutter-sm)"],[1,"detail-item"],[1,"chip","active",2,"margin-left","var(--gutter-sm)"],[1,"promethea-button","primary",3,"click"]],template:function(e,o){e&1&&(t(0,"div",2),v(1,_e,13,7,"div",3)(2,be,7,1,"div",4),t(3,"div",5)(4,"div",6)(5,"div",7)(6,"h2",8),n(7,"Seleziona un Tavolo"),i(),t(8,"div",9)(9,"div",10),M(10,"div",11),t(11,"span"),n(12,"Disponibile"),i()(),t(13,"div",10),M(14,"div",12),t(15,"span"),n(16,"Prenotato"),i()(),t(17,"div",10),M(18,"div",13),t(19,"span"),n(20,"Selezionato"),i()()()(),t(21,"div",14)(22,"div",15)(23,"div",16,0),M(25,"div",17),v(26,he,7,8,"div",18)(27,ye,8,0,"div",19),i()(),v(28,Te,40,8,"div",20),i()()(),v(29,De,49,16,"div",20)(30,Ie,25,5,"div",20),i()),e&2&&(s(),d("ngIf",o.restaurant),s(),d("ngIf",o.floorPlans.length>1),s(21),D("width",(o.currentFloorPlan==null?null:o.currentFloorPlan.width)||1e3,"px")("height",(o.currentFloorPlan==null?null:o.currentFloorPlan.height)||800,"px"),s(3),d("ngForOf",o.tables),s(),d("ngIf",o.tables.length===0),s(),d("ngIf",o.selectedTable),s(),d("ngIf",o.showReservationModal),s(),d("ngIf",o.showConfirmationModal))},dependencies:[W,q,N,ie,J,Z,$,L,K,X,Q,G,ae,te,ee,Y,H],styles:[".restaurant-map-viewer[_ngcontent-%COMP%]{min-height:100vh;background:var(--background)}.restaurant-header[_ngcontent-%COMP%]{margin-bottom:var(--gutter-lg)}.restaurant-hero[_ngcontent-%COMP%]{position:relative;border-radius:0 0 16px 16px;overflow:hidden;background:linear-gradient(135deg,var(--primary),var(--secondary))}.restaurant-cover[_ngcontent-%COMP%]{height:200px;overflow:hidden}.restaurant-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;opacity:.7}.restaurant-info[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);padding:var(--gutter-lg);background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.restaurant-logo[_ngcontent-%COMP%]{flex-shrink:0}.restaurant-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:12px;object-fit:cover;border:3px solid var(--primary)}.restaurant-details[_ngcontent-%COMP%]{flex:1}.restaurant-name[_ngcontent-%COMP%]{font-size:var(--fs-lg);color:var(--text-color);margin:0 0 var(--gutter-sm) 0}.restaurant-cuisine[_ngcontent-%COMP%]{font-size:var(--fs-md);color:var(--primary);font-weight:600;margin:0 0 var(--gutter-sm) 0}.restaurant-description[_ngcontent-%COMP%]{color:var(--text-muted);margin:0 0 var(--gutter-md) 0;line-height:1.5}.restaurant-meta[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);flex-wrap:wrap}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);color:var(--text-color);font-size:var(--fs-sm)}.meta-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:var(--primary)}.map-selector-section[_ngcontent-%COMP%]{margin-bottom:var(--gutter-lg)}.floor-plan-selector[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);flex-wrap:wrap}.floor-plan-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-md);border:2px solid var(--smoke-color-1);border-radius:12px;cursor:pointer;transition:all .3s ease;min-width:160px}.floor-plan-option[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translateY(-2px)}.floor-plan-option.selected[_ngcontent-%COMP%]{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 8%,transparent)}.floor-plan-option[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--primary)}.plan-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-color)}.map-section[_ngcontent-%COMP%]{margin-bottom:var(--gutter-xl)}.map-legend[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);align-items:center}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);font-size:var(--fs-sm);color:var(--text-muted)}.legend-color[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px;border:2px solid transparent}.legend-color.available[_ngcontent-%COMP%]{background:color-mix(in srgb,#10b981 60%,transparent);border-color:#10b981}.legend-color.reserved[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 60%,transparent);border-color:#ef4444}.legend-color.selected[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 60%,transparent);border-color:var(--primary)}.canvas-container[_ngcontent-%COMP%]{border:2px solid var(--smoke-color-1);border-radius:12px;overflow:auto;background:#f8f9fa;position:relative;display:flex;align-items:center;justify-content:center;min-height:500px;margin-bottom:var(--gutter-lg)}.floor-plan-canvas[_ngcontent-%COMP%]{position:relative;background:#fff;border-radius:8px;box-shadow:var(--shadow-md);cursor:default;margin:auto;min-width:min(100%,1000px);min-height:min(100%,800px)}.grid-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:linear-gradient(var(--smoke-color-1) 1px,transparent 1px),linear-gradient(90deg,var(--smoke-color-1) 1px,transparent 1px);background-size:20px 20px;pointer-events:none;opacity:.3;z-index:1}.table-element[_ngcontent-%COMP%]{position:absolute;border:3px solid;background:var(--background);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;-webkit-user-select:none;user-select:none;box-shadow:var(--shadow-sm);z-index:10;border-radius:8px}.table-element.available[_ngcontent-%COMP%]{border-color:#10b981;background:color-mix(in srgb,#10b981 15%,transparent)}.table-element.available[_ngcontent-%COMP%]:hover{border-color:#059669;background:color-mix(in srgb,#10b981 25%,transparent);transform:scale(1.05);z-index:20;box-shadow:var(--shadow-md)}.table-element.reserved[_ngcontent-%COMP%]{border-color:#ef4444;background:color-mix(in srgb,#ef4444 15%,transparent);cursor:not-allowed;opacity:.7}.table-element.selected[_ngcontent-%COMP%]{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 20%,transparent);transform:scale(1.08);z-index:30;box-shadow:var(--shadow-lg)}.table-element.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.table-content[_ngcontent-%COMP%]{text-align:center;pointer-events:none;padding:8px;position:relative}.table-number[_ngcontent-%COMP%]{font-weight:700;font-size:14px;color:var(--text-color);margin-bottom:2px}.table-capacity[_ngcontent-%COMP%]{font-size:12px;color:var(--text-muted)}.table-status[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#ef4444;color:#fff;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center}.table-status[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.selected-table-info[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 5%,transparent);border:1px solid color-mix(in srgb,var(--primary) 20%,transparent);border-radius:12px;padding:var(--gutter-lg);margin-top:var(--gutter-lg)}.selected-table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--gutter-md)}.selected-table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-color)}.table-capacity-badge[_ngcontent-%COMP%]{background:var(--primary);color:#fff;padding:4px 12px;border-radius:20px;font-size:var(--fs-sm);font-weight:600}.selected-table-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-md);margin-bottom:var(--gutter-md)}.reservation-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm);background:color-mix(in srgb,#f59e0b 10%,transparent);border:1px solid color-mix(in srgb,#f59e0b 30%,transparent);border-radius:8px;color:#f59e0b}.reservation-status[_ngcontent-%COMP%]   .material-icons.warning[_ngcontent-%COMP%]{color:#f59e0b}.availability-status[_ngcontent-%COMP%]{margin:var(--gutter-md) 0}.status-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-md);border-radius:8px;font-weight:600}.status-message.available[_ngcontent-%COMP%]{background:color-mix(in srgb,#10b981 10%,transparent);border:1px solid color-mix(in srgb,#10b981 30%,transparent);color:#10b981}.status-message.unavailable[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 10%,transparent);border:1px solid color-mix(in srgb,#ef4444 30%,transparent);color:#ef4444}.reservation-summary[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:8px;padding:var(--gutter-lg);margin:var(--gutter-lg) 0}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--gutter-md)}.summary-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.summary-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-muted);font-weight:600}.summary-value[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-color);font-weight:500}.confirmation-content[_ngcontent-%COMP%]{text-align:center;padding:var(--gutter-xl)}.confirmation-icon[_ngcontent-%COMP%]{margin-bottom:var(--gutter-lg)}.confirmation-icon[_ngcontent-%COMP%]   .material-icons.success[_ngcontent-%COMP%]{font-size:64px;color:#10b981}.confirmation-title[_ngcontent-%COMP%]{font-size:var(--fs-md);color:var(--text-color);margin:0 0 var(--gutter-md) 0}.confirmation-message[_ngcontent-%COMP%]{color:var(--text-muted);margin:0 0 var(--gutter-lg) 0;line-height:1.6}.confirmation-details[_ngcontent-%COMP%]{background:var(--smoke-color-1);border-radius:8px;padding:var(--gutter-lg);margin:var(--gutter-lg) 0;text-align:left}.detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--gutter-sm) 0;border-bottom:1px solid var(--smoke-color-1)}.detail-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:var(--fs-sm);font-weight:600;text-transform:capitalize}.status-badge.pending[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 20%,transparent);color:#f59e0b}.confirmation-actions[_ngcontent-%COMP%]{margin-top:var(--gutter-lg)}.canvas-instructions[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;z-index:5}.instruction-card[_ngcontent-%COMP%]{background:#fffffff2;padding:var(--gutter-lg);border-radius:16px;border:2px dashed var(--primary);text-align:center;box-shadow:var(--shadow-lg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);max-width:300px}@media (max-width: 768px){.restaurant-info[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:var(--gutter-md)}.restaurant-meta[_ngcontent-%COMP%]{justify-content:center}.floor-plan-selector[_ngcontent-%COMP%]{flex-direction:column}.floor-plan-option[_ngcontent-%COMP%]{min-width:auto;justify-content:center}.map-legend[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gutter-sm)}.selected-table-actions[_ngcontent-%COMP%]{flex-direction:column}.canvas-container[_ngcontent-%COMP%]{min-height:400px}.floor-plan-canvas[_ngcontent-%COMP%]{min-width:100%!important;min-height:400px!important}.summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 480px){.restaurant-hero[_ngcontent-%COMP%]{border-radius:0}.restaurant-info[_ngcontent-%COMP%]{padding:var(--gutter-md)}.confirmation-content[_ngcontent-%COMP%]{padding:var(--gutter-lg)}}"]})};export{se as RestaurantMapViewer};
