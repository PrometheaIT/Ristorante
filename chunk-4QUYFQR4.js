import{a as Q}from"./chunk-5AKKD5AM.js";import{b as T,d as V,h as z,x as F}from"./chunk-TFECNMTR.js";import"./chunk-QGVET3VN.js";import{c as S,d as k,l as I,q as L}from"./chunk-WD7KEMNY.js";import{Aa as C,Cb as r,Da as o,Db as x,Eb as f,Ib as O,Jb as w,Kb as R,Ta as y,Ub as E,Ya as u,ba as h,eb as l,fb as a,ga as g,gb as i,ha as _,nb as v,qb as m,sb as c,xb as P,zb as M}from"./chunk-25TB2OJR.js";import{j as b}from"./chunk-4ZZIO3ZI.js";function N(e,n){if(e&1){let t=v();a(0,"button",23),m("click",function(){let p=g(t).$implicit,d=c();return _(d.onCuisineFilter(p))}),r(1),i()}if(e&2){let t=n.$implicit,s=c();M("active",s.selectedCuisine===t),o(),f(" ",t," ")}}function D(e,n){if(e&1){let t=v();a(0,"button",24),m("click",function(){g(t);let p=c();return _(p.clearFilters())}),a(1,"span",25),r(2,"clear"),i(),a(3,"span"),r(4,"Reset"),i()()}}function B(e,n){e&1&&(a(0,"p"),r(1," Prova a modificare i filtri di ricerca "),i())}function W(e,n){e&1&&(a(0,"p"),r(1," Al momento non ci sono ristoranti disponibili "),i())}function A(e,n){if(e&1){let t=v();a(0,"button",29),m("click",function(){g(t);let p=c(2);return _(p.clearFilters())}),a(1,"span",25),r(2,"refresh"),i(),r(3," Mostra tutti i ristoranti "),i()}}function H(e,n){if(e&1&&(a(0,"div",26)(1,"span",25),r(2,"restaurant"),i(),a(3,"h3"),r(4,"Nessun ristorante trovato"),i(),u(5,B,2,0,"p",27)(6,W,2,0,"p",27)(7,A,4,0,"button",28),i()),e&2){let t=c();o(5),l("ngIf",t.searchQuery||t.selectedCuisine),o(),l("ngIf",!t.searchQuery&&!t.selectedCuisine),o(),l("ngIf",t.searchQuery||t.selectedCuisine)}}function U(e,n){if(e&1){let t=v();a(0,"img",48),m("error",function(p){g(t);let d=c(3);return _(d.onImageError(p))}),i()}if(e&2){let t=c().$implicit;l("src",t.cover_image_url,C)("alt",t.name)}}function Y(e,n){e&1&&(a(0,"div",49)(1,"span",25),r(2,"restaurant"),i(),a(3,"p"),r(4,"Immagine non disponibile"),i()())}function q(e,n){if(e&1){let t=v();a(0,"div",50)(1,"img",48),m("error",function(p){g(t);let d=c(3);return _(d.onLogoError(p))}),i()()}if(e&2){let t=c().$implicit;o(),l("src",t.logo_url,C)("alt",t.name)}}function G(e,n){if(e&1&&(a(0,"p",51),r(1),i()),e&2){let t=c().$implicit;o(),f(" ",t.cuisine_type," ")}}function J(e,n){if(e&1&&(a(0,"p",52),r(1),i()),e&2){let t=c().$implicit,s=c(2);o(),f(" ",s.truncateText(t.description,120)," ")}}function K(e,n){if(e&1&&(a(0,"div",53)(1,"span",25),r(2,"place"),i(),a(3,"span",54),r(4),i()()),e&2){let t=c().$implicit,s=c(2);o(4),x(s.truncateText(t.address,30))}}function X(e,n){if(e&1&&(a(0,"div",53)(1,"span",25),r(2,"phone"),i(),a(3,"span",54),r(4),i()()),e&2){let t=c().$implicit;o(4),x(t.phone)}}function Z(e,n){e&1&&(a(0,"span",55)(1,"span",25),r(2,"event_available"),i(),r(3," Prenotazioni "),i())}function tt(e,n){e&1&&(a(0,"span",55)(1,"span",25),r(2,"table_restaurant"),i(),r(3," Selezione Tavolo "),i())}function et(e,n){e&1&&(a(0,"span",55)(1,"span",25),r(2,"delivery_dining"),i(),r(3," Delivery "),i())}function nt(e,n){e&1&&(a(0,"span",55)(1,"span",25),r(2,"takeout_dining"),i(),r(3," Takeaway "),i())}function it(e,n){if(e&1){let t=v();a(0,"div",32),m("click",function(){let p=g(t).$implicit,d=c(2);return _(d.viewRestaurantDetails(p.id))}),a(1,"div",33),u(2,U,1,2,"img",34)(3,Y,5,0,"ng-template",null,0,E),a(5,"div",35)(6,"button",36),m("click",function(p){let d=g(t).$implicit,j=c(2);return _(j.viewRestaurantMap(d.id,p))}),a(7,"span",25),r(8,"map"),i(),r(9," Visualizza Mappa "),i()()(),a(10,"div",37)(11,"div",38),u(12,q,2,2,"div",39),a(13,"div",40)(14,"h3",41),r(15),i(),u(16,G,2,1,"p",42),i()(),u(17,J,2,1,"p",43),a(18,"div",44),u(19,K,5,1,"div",45)(20,X,5,1,"div",45),i(),a(21,"div",46),u(22,Z,4,0,"span",47)(23,tt,4,0,"span",47)(24,et,4,0,"span",47)(25,nt,4,0,"span",47),i()()()}if(e&2){let t=n.$implicit,s=P(4);o(2),l("ngIf",t.cover_image_url)("ngIfElse",s),o(10),l("ngIf",t.logo_url),o(3),x(t.name),o(),l("ngIf",t.cuisine_type),o(),l("ngIf",t.description),o(2),l("ngIf",t.address),o(),l("ngIf",t.phone),o(2),l("ngIf",t.allow_table_selection),o(),l("ngIf",t.allow_table_selection),o(),l("ngIf",t.accepts_delivery),o(),l("ngIf",t.accepts_takeaway)}}function at(e,n){if(e&1&&(a(0,"div",30),u(1,it,26,12,"div",31),i()),e&2){let t=c();o(),l("ngForOf",t.paginatedRestaurants)}}function rt(e,n){if(e&1){let t=v();a(0,"div",56)(1,"button",57),m("click",function(){g(t);let p=c();return _(p.previousPage())}),a(2,"span",25),r(3,"chevron_left"),i(),r(4," Precedente "),i(),a(5,"span",58),r(6),i(),a(7,"button",57),m("click",function(){g(t);let p=c();return _(p.nextPage())}),r(8," Successivo "),a(9,"span",25),r(10,"chevron_right"),i()()()}if(e&2){let t=c();o(),l("disabled",t.currentPage===1),o(5),f(" Pagina ",t.currentPage," "),o(),l("disabled",t.currentPage*t.pageSize>=t.filteredRestaurants.length)}}var $=class e{restaurantPublicService=h(Q);router=h(L);restaurants=[];filteredRestaurants=[];loading=!0;imageErrorCount=0;maxRetries=2;searchQuery="";selectedCuisine="";cuisineTypes=[];currentPage=1;pageSize=9;ngOnInit(){return b(this,null,function*(){this.restaurants=yield this.restaurantPublicService.loadRestaurantsByCuisine(),this.filteredRestaurants=[...this.restaurants],this.loading=!1,this.cuisineTypes=[...new Set(this.restaurants.map(n=>n.cuisine_type).filter(Boolean))]})}filterRestaurants(){let n=this.restaurants;if(this.searchQuery){let t=this.searchQuery.toLowerCase();n=n.filter(s=>s.name?.toLowerCase().includes(t)||s.cuisine_type?.toLowerCase().includes(t)||s.address?.toLowerCase().includes(t)||s.description?.toLowerCase().includes(t))}this.selectedCuisine&&(n=n.filter(t=>t.cuisine_type===this.selectedCuisine)),this.filteredRestaurants=n,this.currentPage=1}onSearchChange(){this.filterRestaurants()}onCuisineFilter(n){this.selectedCuisine=n===this.selectedCuisine?"":n,this.filterRestaurants()}clearFilters(){this.searchQuery="",this.selectedCuisine="",this.filterRestaurants()}nextPage(){this.currentPage*this.pageSize<this.filteredRestaurants.length&&this.currentPage++}previousPage(){this.currentPage>1&&this.currentPage--}get paginatedRestaurants(){let n=(this.currentPage-1)*this.pageSize;return this.filteredRestaurants.slice(n,n+this.pageSize)}viewRestaurantMap(n,t){t&&t.stopPropagation(),console.log("Navigating to restaurant map:",n),this.router.navigate(["/customer/restaurant",n,"map"])}truncateText(n,t){return n?n.length<=t?n:n.substring(0,t)+"...":""}onImageError(n){let t=n.target;if(this.imageErrorCount++,this.imageErrorCount>this.maxRetries||t.src.includes("placeholder")){t.style.display="none";return}t.src="assets/images/restaurant-placeholder.jpg"}onLogoError(n){let t=n.target;t.style.display="none"}viewRestaurantDetails(n){this.router.navigate(["/customer/restaurant",n])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=y({type:e,selectors:[["app-restaurant-list"]],decls:32,vars:6,consts:[["placeholderImage",""],[1,"restaurant-list-page"],[1,"page-container"],[1,"header-card"],[1,"section-header","ricercaristoranti"],[1,"flex","gap-sm"],[1,"avatartondo","bg-gradient"],[1,"material-icons","text-md"],[1,"section-title"],[1,"header-subtitle"],[1,"form-row"],[1,"form-group"],[1,"standard-label"],[1,"flex","items-center","gap-sm"],[1,"material-icons","text-md","text-primary"],["type","text","placeholder","Cerca ristorante, cucina, zona...",1,"search-input",3,"ngModelChange","input","ngModel"],[1,"filter-container"],[1,"flex","flex-wrap","gap-sm"],["class","filter-chip chip",3,"active","click",4,"ngFor","ngForOf"],["class","promethea-button ghost",3,"click",4,"ngIf"],["class","text-center p-xl opacity-70",4,"ngIf"],["class","restaurants-grid",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"filter-chip","chip",3,"click"],[1,"promethea-button","ghost",3,"click"],[1,"material-icons"],[1,"text-center","p-xl","opacity-70"],[4,"ngIf"],["class","promethea-button primary",3,"click",4,"ngIf"],[1,"promethea-button","primary",3,"click"],[1,"restaurants-grid"],["class","restaurant-card",3,"click",4,"ngFor","ngForOf"],[1,"restaurant-card",3,"click"],[1,"restaurant-image"],[3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"restaurant-overlay"],[1,"view-map-button",3,"click"],[1,"restaurant-info"],[1,"restaurant-header-inner"],["class","restaurant-logo",4,"ngIf"],[1,"restaurant-details"],[1,"card-title"],["class","restaurant-cuisine",4,"ngIf"],["class","restaurant-description",4,"ngIf"],[1,"restaurant-meta"],["class","meta-item",4,"ngIf"],[1,"restaurant-features"],["class","feature-tag",4,"ngIf"],[3,"error","src","alt"],[1,"image-placeholder"],[1,"restaurant-logo"],[1,"restaurant-cuisine"],[1,"restaurant-description"],[1,"meta-item"],[1,"meta-text"],[1,"feature-tag"],[1,"pagination"],[1,"pagination-button",3,"click","disabled"],[1,"pagination-info"]],template:function(t,s){t&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"span",7),r(7,"restaurant"),i()(),a(8,"div")(9,"h1",8),r(10,"Scopri i Ristoranti"),i(),a(11,"p",9),r(12,"Trova il ristorante perfetto per la tua serata"),i()()()()(),a(13,"div",10)(14,"div",11)(15,"div",12),r(16,"Ricerca Ristoranti:"),i(),a(17,"div",13)(18,"span",14),r(19,"search"),i(),a(20,"input",15),R("ngModelChange",function(d){return w(s.searchQuery,d)||(s.searchQuery=d),d}),m("input",function(){return s.onSearchChange()}),i()()(),a(21,"div",11)(22,"div",16)(23,"div",12),r(24,"Filtra per cucina:"),i(),a(25,"div",17),u(26,N,2,3,"button",18)(27,D,5,0,"button",19),i()()()()(),a(28,"div",2),u(29,H,8,3,"div",20)(30,at,2,1,"div",21)(31,rt,11,3,"div",22),i()()),t&2&&(o(20),O("ngModel",s.searchQuery),o(6),l("ngForOf",s.cuisineTypes),o(),l("ngIf",s.selectedCuisine),o(2),l("ngIf",!s.loading&&s.filteredRestaurants.length===0),o(),l("ngIf",!s.loading&&s.filteredRestaurants.length>0),o(),l("ngIf",s.filteredRestaurants.length>0))},dependencies:[I,S,k,F,T,V,z],styles:[".restaurant-list-page[_ngcontent-%COMP%]{min-height:100vh;background:var(--background)}.restaurant-header[_ngcontent-%COMP%]{margin-bottom:var(--gap-lg)}.ricercaristoranti[_ngcontent-%COMP%]{background:var(--smoke-1)}.restaurants-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:var(--gap-lg);margin-bottom:var(--gap-lg)}.restaurant-card[_ngcontent-%COMP%]{background:var(--background);border-radius:16px;overflow:hidden;box-shadow:0 4px 12px var(--smoke-1);transition:all .3s cubic-bezier(.2,.9,.2,1);cursor:pointer;border:1px solid var(--smoke-1);position:relative}.restaurant-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 8px 24px var(--shadow-2);border-color:var(--primary)}.restaurant-image[_ngcontent-%COMP%]{position:relative;height:200px;overflow:hidden;border-radius:16px 16px 0 0}.restaurant-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.restaurant-card[_ngcontent-%COMP%]:hover   .restaurant-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.restaurant-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease;border-radius:16px 16px 0 0}.restaurant-card[_ngcontent-%COMP%]:hover   .restaurant-overlay[_ngcontent-%COMP%]{opacity:1}.view-map-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);padding:var(--gap-md) var(--gap-lg);background:var(--primary);color:#fff;border:none;border-radius:50px;font-weight:600;cursor:pointer;transition:all .3s ease}.view-map-button[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary) 80%,black);transform:scale(1.05)}.restaurant-info[_ngcontent-%COMP%]{padding:var(--gap-lg)}.restaurant-header-inner[_ngcontent-%COMP%]{display:flex;gap:var(--gap-md);margin-bottom:var(--gap-md)}.restaurant-logo[_ngcontent-%COMP%]{flex-shrink:0}.restaurant-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:8px;object-fit:cover;border:2px solid var(--smoke-1)}.restaurant-details[_ngcontent-%COMP%]{flex:1;min-width:0}.restaurant-cuisine[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--primary);font-weight:600;margin:0}.restaurant-description[_ngcontent-%COMP%]{color:var(--text-muted);margin:0 0 var(--gap-md) 0;line-height:1.5}.restaurant-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm);margin-bottom:var(--gap-md)}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);font-size:var(--fs-sm)}.meta-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;color:var(--text-muted);flex-shrink:0}.meta-text[_ngcontent-%COMP%]{color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.restaurant-features[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--gap-sm)}.feature-tag[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--smoke-1);border-radius:6px;font-size:.75rem;color:var(--text-color)}.feature-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:var(--gap-xl);color:var(--text-muted)}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:40px;height:40px;border:3px solid color-mix(in srgb,var(--primary) 15%,transparent);border-radius:50%;border-top-color:var(--primary);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite;margin-bottom:var(--gap-md)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--gap-xl);color:var(--text-muted)}.empty-state[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:64px;margin-bottom:var(--gap-md);opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 var(--gap-sm) 0;color:var(--text-color)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 var(--gap-lg) 0}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:var(--gap-lg);padding:var(--gap-lg) 0}.pagination-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);background:var(--background);border:1px solid var(--smoke-1);border-radius:8px;color:var(--text-color);cursor:pointer;transition:all .3s cubic-bezier(.2,.9,.2,1)}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){border-color:var(--primary);color:var(--primary);transform:translateY(-2px)}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination-info[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--fs-sm)}.image-placeholder[_ngcontent-%COMP%]{width:100%;height:200px;background:var(--smoke-1);display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--text-muted);border-radius:16px 16px 0 0}.image-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;margin-bottom:8px;color:var(--text-muted)}.image-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.filter-chip[_ngcontent-%COMP%]{background:var(--gradiente)}@media (max-width: 768px){.restaurants-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.restaurant-header-inner[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:var(--gap-sm)}.restaurant-logo[_ngcontent-%COMP%]{align-self:center}.pagination[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gap-md)}}@media (max-width: 480px){.restaurant-info[_ngcontent-%COMP%]{padding:var(--gap-md)}.restaurant-features[_ngcontent-%COMP%]{justify-content:center}.empty-state[_ngcontent-%COMP%]{padding:var(--gap-lg)}}"]})};export{$ as RestaurantList};
