import{ya as q,za as V}from"./chunk-KZMQ65O4.js";import{a as M,b as I,c as p,d as k,e as x,i as F,j as O,m as T,p as A,w as z,y as L}from"./chunk-PZ6IGEMS.js";import{d as E}from"./chunk-HOOEJZZY.js";import{c as P,e as R,f as S}from"./chunk-37GYPR4T.js";import{k as N,s as C}from"./chunk-PWZZTUE6.js";import{$a as u,Eb as c,Ga as o,Hb as s,Ib as v,Jb as _,Wa as w,ba as g,hb as l,ib as n,jb as r,kb as m,tb as h,vb as f}from"./chunk-DU5L5MFQ.js";import{j as b}from"./chunk-4ZZIO3ZI.js";function j(a,t){a&1&&(n(0,"div",38),s(1," Il nome \xE8 obbligatorio "),r())}function G(a,t){a&1&&(n(0,"div",38),s(1," Il cognome \xE8 obbligatorio "),r())}function Y(a,t){a&1&&(n(0,"span"),s(1,"Email obbligatoria"),r())}function U(a,t){a&1&&(n(0,"span"),s(1,"Email non valida"),r())}function B(a,t){if(a&1&&(n(0,"div",38),u(1,Y,2,0,"span",37)(2,U,2,0,"span",37),r()),a&2){let i=f();o(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.required),o(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.email)}}function H(a,t){a&1&&(n(0,"div",38),s(1," Il nome del ristorante \xE8 obbligatorio "),r())}function J(a,t){if(a&1&&(n(0,"div",8)(1,"h2",9),m(2,"lucide-icon",39),s(3," Informazioni Ristorante "),r(),n(4,"div",12)(5,"label",13),s(6,"Nome Ristorante *"),r(),m(7,"input",40),u(8,H,2,0,"div",15),r()()),a&2){let i=f();o(7),c("error",(i.restaurantName==null?null:i.restaurantName.invalid)&&(i.restaurantName==null?null:i.restaurantName.touched)),o(),l("ngIf",(i.restaurantName==null?null:i.restaurantName.invalid)&&(i.restaurantName==null?null:i.restaurantName.touched))}}function K(a,t){a&1&&(n(0,"div",38),s(1," Password obbligatoria (min. 6 caratteri) "),r())}function Q(a,t){a&1&&(n(0,"div",38),s(1," Le password non coincidono "),r())}function W(a,t){if(a&1&&(n(0,"div",41),s(1),r()),a&2){let i=f();o(),_(" ",i.errorMessage," ")}}function X(a,t){a&1&&m(0,"span",42)}function Z(a,t){if(a&1&&(n(0,"span"),s(1),r()),a&2){let i=f();o(),v(i.isRestaurant?"Registra Ristorante":"Crea Account")}}var D=class a{fb=g(z);authService=g(E);router=g(R);route=g(P);registerForm;isLoading=!1;errorMessage="";isRestaurant=!1;isSupplier=!1;showPassword=!1;showConfirmPassword=!1;ngOnInit(){let t=this.route.snapshot.paramMap.get("role");this.isRestaurant=t==="restaurant",this.isSupplier=t==="supplier",this.initializeForm()}initializeForm(){this.registerForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]],confirmPassword:["",[p.required]],firstName:["",[p.required]],lastName:["",[p.required]],phone:[""],policy:[!1,[p.requiredTrue]],restaurantName:[(this.isRestaurant,""),this.isRestaurant?p.required:[]],companyName:[(this.isSupplier,""),this.isSupplier?p.required:[]],contactName:[(this.isSupplier,""),this.isSupplier?p.required:[]],supplierAddress:[(this.isSupplier,"")],supplierDescription:[(this.isSupplier,"")]},{validators:this.passwordMatchValidator})}get rememberMe(){return this.registerForm.get("policy")}passwordMatchValidator(t){let i=t.get("password")?.value,e=t.get("confirmPassword")?.value;return i===e?null:{passwordMismatch:!0}}onSubmit(){return b(this,null,function*(){if(this.registerForm.invalid||this.isLoading)return;this.isLoading=!0,this.errorMessage="";let t=this.registerForm.value;try{let i=this.determineUserRole(),e={email:t.email.toLowerCase().trim(),password:t.password,user_data:{first_name:t.firstName,last_name:t.lastName,phone:t.phone,role:i},restaurant_data:this.isRestaurant?{name:t.restaurantName,address:"",phone:t.phone||"",email:t.email,description:"",cuisine_type:"",allow_table_selection:!1,accepts_delivery:!1,accepts_takeaway:!1}:void 0,supplier_data:this.isSupplier?{company_name:t.companyName,contact_name:t.contactName,email:t.email,phone:t.phone||"",address:t.supplierAddress,description:t.supplierDescription}:void 0},d=yield this.authService.register(e);if(d.error){if(typeof d.error=="string")this.errorMessage=d.error;else if(d.error&&typeof d.error=="object"){let y=d.error;this.errorMessage=y.message||y.toString()}else this.errorMessage="Errore durante la registrazione";console.error("Registration error details:",d.error)}else d.user&&(console.log("\u2705 Registration successful, user:",d.user.id),this.errorMessage="Registrazione completata! Reindirizzamento...",this.redirectAfterRegistration(d))}catch(i){i instanceof Error?this.errorMessage="Errore durante la registrazione: "+i.message:typeof i=="string"?this.errorMessage="Errore durante la registrazione: "+i:this.errorMessage="Errore sconosciuto durante la registrazione",console.error("Registration exception:",i)}finally{this.isLoading=!1}})}determineUserRole(){return this.isRestaurant?"restaurant_owner":this.isSupplier?"supplier":"customer"}redirectAfterRegistration(t){setTimeout(()=>{this.isRestaurant&&t.restaurant?this.router.navigate(["/restaurant/dashboard"]):this.isSupplier?this.router.navigate(["/supplier/dashboard"]):this.router.navigate(["/customer/menu-display"])},2e3)}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}get firstName(){return this.registerForm.get("firstName")}get lastName(){return this.registerForm.get("lastName")}get restaurantName(){return this.registerForm.get("restaurantName")}get companyName(){return this.registerForm.get("companyName")}get contactName(){return this.registerForm.get("contactName")}get supplierAddress(){return this.registerForm.get("supplierAddress")}get supplierDescription(){return this.registerForm.get("supplierDescription")}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=w({type:a,selectors:[["app-register"]],decls:71,vars:30,consts:[[1,"gradient-container"],[1,"form-card","modal-md"],[1,"section-header"],[1,"flex","gap-sm"],[1,"fs-lg",3,"name"],[1,"section-title"],[1,"text-muted"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-card"],[1,"text-md","font-semibold","mb-md"],["name","user",1,"nav-icon",3,"size"],[1,"form-row","mb-md"],[1,"form-group"],[1,"standard-label"],["formControlName","firstName","placeholder","Il tuo nome","type","text"],["class","error-message",4,"ngIf"],["formControlName","lastName","placeholder","Il tuo cognome","type","text"],["formControlName","email","type","email","placeholder","tua.email@esempio.com"],["formControlName","phone","placeholder","+39 123 456 7890","type","number"],["class","form-card",4,"ngIf"],["name","lock",1,"nav-icon",3,"size"],[1,"form-row"],[1,"flex","gap-sm","items-center"],["formControlName","password","placeholder","Almeno 6 caratteri",1,"pr-[50px]","w-full",3,"type"],["type","button",1,"icon-button","absolute","right-sm","top-1/2","-translate-y-1/2","bg-transparent","border-none","text-[var(--text-muted)]","hover:text-[var(--primary)]",3,"click"],[3,"name"],["formControlName","confirmPassword","placeholder","Ripeti la password",1,"pr-[50px]","w-full",3,"type"],[1,"flex","justify-between","items-center","my-md"],[1,"checkbox-label","hover:bg-[var(--smoke-1)]"],["type","checkbox","formControlName","policy"],[1,"checkbox-content"],["href","#/policy",1,"link"],["class","error-message","style","margin: 1rem 0; padding: 1rem; background: #fee;",4,"ngIf"],[1,"flex","justify-between","items-center","gap-md","mt-lg","pt-md"],["routerLink","/login",1,"link"],["type","submit",1,"promethea-button",3,"disabled"],["class","loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"error-message"],["name","building-2"],["formControlName","restaurantName","placeholder","Il nome del tuo ristorante","type","text"],[1,"error-message",2,"margin","1rem 0","padding","1rem","background","#fee"],[1,"loading-spinner"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m(4,"lucide-icon",4),n(5,"h1",5),s(6),r()(),n(7,"p",6),s(8),r()(),n(9,"form",7),h("ngSubmit",function(){return e.onSubmit()}),n(10,"div",8)(11,"h2",9),m(12,"lucide-icon",10),s(13," Informazioni Personali "),r(),n(14,"div",11)(15,"div",12)(16,"label",13),s(17,"Nome *"),r(),m(18,"input",14),u(19,j,2,0,"div",15),r(),n(20,"div",12)(21,"label",13),s(22,"Cognome *"),r(),m(23,"input",16),u(24,G,2,0,"div",15),r()(),n(25,"div",11)(26,"div",12)(27,"label",13),s(28,"Email *"),r(),m(29,"input",17),u(30,B,3,2,"div",15),r(),n(31,"div",12)(32,"label",13),s(33,"Telefono"),r(),m(34,"input",18),r()()(),u(35,J,9,3,"div",19),n(36,"div",8)(37,"h2",9),m(38,"lucide-icon",20),s(39," Password "),r(),n(40,"div",21)(41,"div",12)(42,"label",13),s(43,"Password *"),r(),n(44,"div",22),m(45,"input",23),n(46,"button",24),h("click",function(){return e.togglePasswordVisibility()}),m(47,"lucide-icon",25),r()(),u(48,K,2,0,"div",15),r(),n(49,"div",12)(50,"label",13),s(51,"Conferma Password *"),r(),n(52,"div",22),m(53,"input",26),n(54,"button",24),h("click",function(){return e.toggleConfirmPasswordVisibility()}),m(55,"lucide-icon",25),r()(),u(56,Q,2,0,"div",15),r()()(),n(57,"div",27)(58,"label",28),m(59,"input",29),n(60,"div",30),s(61," Dichiaro di aver letto, compreso e accettato la "),n(62,"a",31),s(63,"Privacy Policy e i Termini e Condizioni"),r()()()(),u(64,W,2,1,"div",32),n(65,"div",33)(66,"a",34),s(67," \u2190 Hai gi\xE0 un account? Accedi "),r(),n(68,"button",35),u(69,X,1,0,"span",36)(70,Z,2,1,"span",37),r()()()()()),i&2&&(o(4),l("name",e.isRestaurant?"utensils-crossed":"user"),o(2),v(e.isRestaurant?"Registra il tuo Ristorante":"Crea Account"),o(2),_(" ",e.isRestaurant?"Crea il tuo account business":"Crea il tuo account personale"," "),o(),l("formGroup",e.registerForm),o(3),l("size",20),o(6),c("error",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),o(),l("ngIf",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),o(4),c("error",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),o(),l("ngIf",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),o(5),c("error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),o(),l("ngIf",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),o(5),l("ngIf",e.isRestaurant),o(3),l("size",20),o(7),c("error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),l("type",e.showPassword?"text":"password"),o(2),l("name",e.showPassword?"eye-off":"eye"),o(),l("ngIf",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),o(5),c("error",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),l("type",e.showConfirmPassword?"text":"password"),o(2),l("name",e.showConfirmPassword?"eye-off":"eye"),o(),l("ngIf",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),o(8),l("ngIf",e.errorMessage),o(4),l("disabled",e.registerForm.invalid||e.isLoading),o(),l("ngIf",e.isLoading),o(),l("ngIf",!e.isLoading))},dependencies:[C,N,L,F,I,O,M,k,x,T,A,S,V,q],styles:['.gradient-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--background);padding:var(--gutter-sm);position:relative;overflow:hidden}.gradient-container[_ngcontent-%COMP%]:before, .gradient-container[_ngcontent-%COMP%]:after, .gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{content:"";position:absolute;border-radius:50%;filter:blur(90px);opacity:.22;pointer-events:none;animation:vapor 28s ease-in-out infinite}.gradient-container[_ngcontent-%COMP%]:before{width:700px;height:700px;background:radial-gradient(circle at 30%,var(--primary) 0%,transparent 65%);top:-20%;left:-15%;animation-delay:0s}.gradient-container[_ngcontent-%COMP%]:after{width:600px;height:600px;background:radial-gradient(circle at 40%,var(--secondary) 0%,transparent 70%);bottom:-10%;right:-10%;animation-delay:-9s}.gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{width:700px;height:700px;background:radial-gradient(circle at 30% 40%,var(--tertiary) 0%,transparent 70%);top:50%;left:50%;transform:translate(-50%,-50%);animation-delay:-14s;opacity:.15;filter:blur(100px)}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0) translate(0) rotate(0)}33%{transform:translateY(-40px) translate(30px) rotate(120deg)}66%{transform:translateY(30px) translate(-40px) rotate(240deg)}}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]{position:absolute;width:4px;height:4px;background:var(--secondary);border-radius:50%;opacity:0;animation:_ngcontent-%COMP%_sparkle 8s linear infinite}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(1){top:20%;left:15%;animation-delay:1s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(2){top:70%;right:20%;animation-delay:3s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(3){bottom:30%;left:30%;animation-delay:5s}@keyframes _ngcontent-%COMP%_sparkle{0%,to{opacity:0;transform:scale(0)}50%{opacity:.8;transform:scale(1)}}.gradient-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{border-radius:var(--fs-md)}']})};export{D as Register};
