import{a as me}from"./chunk-XTSRDJPX.js";import{a as ue}from"./chunk-2GRPEXHI.js";import{a as le}from"./chunk-DFE35UP3.js";import{a as ce}from"./chunk-QU72IQ5W.js";import{a as de}from"./chunk-FZMDL6LW.js";import"./chunk-522RPWXK.js";import"./chunk-QUTFIOET.js";import"./chunk-SVYAZSVR.js";import{qb as oe,rb as se}from"./chunk-7ARAJ5DM.js";import{A as re,a as Q,b as X,d as Z,i as ee,s as te,t as ie,u as ne,x as ae}from"./chunk-YO2SNT5L.js";import"./chunk-MEEOFM4U.js";import"./chunk-RD7WPZ3N.js";import"./chunk-JDHQCX3C.js";import{k as Y,l as H,v as J}from"./chunk-RJWLMJIA.js";import{G,Hb as K,I as q,Ib as l,J as L,Jb as S,Kb as h,La as s,Lb as D,Mb as k,Ob as f,Pb as b,Qb as x,Sb as U,Va as j,_a as u,a as A,ca as R,f as B,gb as d,ib as F,la as _,ma as g,qb as n,rb as r,s as N,sb as O,tb as T,ub as E,vb as w,xa as $,yb as p,zb as m}from"./chunk-KIAVC6JW.js";import{a as z,b as W,g as M}from"./chunk-RA2WU32H.js";var ge=()=>[1,2,3,4,5,6,7,8,9,10];function pe(a,t){if(a&1&&(n(0,"option",41),l(1),r()),a&2){let e=t.$implicit;d("value",e.name),s(),k(" ",e.name," (",e.start_time.substring(0,5)," - ",e.end_time.substring(0,5),") ")}}function ve(a,t){if(a&1&&(n(0,"span",42),l(1),r()),a&2){let e=m();s(),h(" ",e.getActiveFiltersInfo().text," ")}}function he(a,t){if(a&1){let e=w();n(0,"div",43)(1,"span",29),l(2,"error"),r(),l(3),n(4,"button",44),p("click",function(){_(e);let o=m();return g(o.error=null)}),n(5,"span",29),l(6,"close"),r()()()}if(a&2){let e=m();s(3),h(" ",e.error," ")}}function fe(a,t){if(a&1&&(n(0,"div",61),l(1),r()),a&2){let e=m().$implicit;s(),h(" ",e.customer_email," ")}}function be(a,t){a&1&&(n(0,"div",29),l(1,"restaurant_menu"),r())}function xe(a,t){if(a&1&&(n(0,"span",62),l(1),r()),a&2){let e=m().$implicit,i=m();s(),h(" ",i.getReservationMenuInfo(e)," ")}}function Me(a,t){if(a&1&&(n(0,"option",71),l(1),r()),a&2){let e=t.$implicit,i=m(6).$implicit;d("value",e.id)("title","Capacit\xE0: "+e.capacity+" posti"),s(),k(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ",e.capacity===i.party_size?"\u2B50":""," ")}}function ye(a,t){if(a&1&&(n(0,"optgroup",69),u(1,Me,2,5,"option",70),r()),a&2){let e=m().$implicit;d("label",e.floorPlan.name),s(),d("ngForOf",e.tables)}}function we(a,t){if(a&1&&(T(0),u(1,ye,2,2,"optgroup",68),E()),a&2){let e=t.$implicit;s(),d("ngIf",e.tables&&e.tables.length>0)}}function Se(a,t){if(a&1&&(T(0),u(1,we,2,1,"ng-container",38),E()),a&2){let e=m(3).$implicit,i=m();s(),d("ngForOf",i.getFilteredTableGroups(e.party_size))}}function Ce(a,t){if(a&1&&(n(0,"option",41),l(1),r()),a&2){let e=t.$implicit,i=m(4).$implicit;d("value",e.id),s(),k(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ",e.capacity===i.party_size?"\u2B50":""," ")}}function Re(a,t){if(a&1&&(T(0),u(1,Ce,2,4,"option",22),E()),a&2){let e=m(3).$implicit,i=m();s(),d("ngForOf",i.getFilteredTables(e.party_size))}}function Te(a,t){a&1&&(n(0,"option",72),l(1," Nessun tavolo disponibile "),r())}function Ee(a,t){if(a&1){let e=w();n(0,"select",64,0),p("change",function(){_(e);let o=K(1),c=m(2).$implicit,v=m();return g(v.assignTable(c.id,o.value))}),n(2,"option",65),l(3,"Assegna tavolo..."),r(),u(4,Se,2,1,"ng-container",66)(5,Re,2,1,"ng-container",66)(6,Te,2,0,"option",67),r()}if(a&2){let e=m(3);s(4),d("ngIf",e.tableGroups&&e.tableGroups.length>0),s(),d("ngIf",(!e.tableGroups||e.tableGroups.length===0)&&e.tables.length>0),s(),d("ngIf",e.tables.length===0&&e.tableGroups.length===0)}}function Ie(a,t){if(a&1&&(n(0,"div",27),u(1,Ee,7,3,"select",63),r()),a&2){let e=m().$implicit;s(),d("ngIf",!e.table_id)}}function Pe(a,t){a&1&&(n(0,"span",61),l(1," Nessun tavolo "),r())}function Fe(a,t){if(a&1){let e=w();n(0,"button",73),p("click",function(){_(e);let o=m().$implicit,c=m();return g(c.unassignTable(o.id))}),n(1,"span",29),l(2,"close"),r()()}}function Oe(a,t){if(a&1){let e=w();n(0,"button",74),p("click",function(){_(e);let o=m().$implicit,c=m();return g(c.updateStatus(o.id,"confirmed"))}),n(1,"span",29),l(2,"check"),r()()}}function De(a,t){if(a&1){let e=w();n(0,"button",75),p("click",function(){_(e);let o=m().$implicit,c=m();return g(c.updateStatus(o.id,"pending"))}),n(1,"span",29),l(2,"schedule"),r()()}}function ke(a,t){if(a&1){let e=w();n(0,"tr")(1,"td"),l(2),r(),n(3,"td"),l(4),r(),n(5,"td")(6,"div",45)(7,"strong"),l(8),r(),u(9,fe,2,1,"div",46),n(10,"span",47),l(11),r()()(),n(12,"td"),l(13),r(),n(14,"td"),l(15),r(),n(16,"td")(17,"div",48)(18,"div",49),u(19,be,2,0,"div",50)(20,xe,2,1,"span",51),r(),n(21,"div",52)(22,"span"),l(23),r(),u(24,Ie,2,1,"div",53)(25,Pe,2,0,"span",46)(26,Fe,3,0,"button",54),r()()(),n(27,"td")(28,"span",55),l(29),r()(),n(30,"td")(31,"span",55),l(32),r()(),n(33,"td")(34,"div",27),u(35,Oe,3,0,"button",56)(36,De,3,0,"button",57),n(37,"button",58),p("click",function(){let o=_(e).$implicit,c=m();return g(c.openEditModal(o))}),n(38,"span",29),l(39,"edit"),r()(),n(40,"button",59),p("click",function(){let o=_(e).$implicit,c=m();return g(c.deleteReservation(o.id))}),O(41,"lucide-angular",60),r()()()()}if(a&2){let e=t.$implicit,i=m();s(2),S(i.formatDate(e.reservation_date)),s(2),S(i.formatTime(e.reservation_time)),s(4),S(i.getCustomerFullName(e)),s(),d("ngIf",e.customer_email),s(),F("active",e.customer_id),s(),h(" ",e.customer_id?"Cliente Registrato":"Nuovo Cliente"," "),s(2),S(i.getCustomerContact(e)),s(2),S(e.party_size),s(4),d("ngIf",i.getReservationMenuInfo(e)),s(),d("ngIf",i.getReservationMenuInfo(e)),s(3),S(i.getTableName(e)),s(),d("ngIf",i.tables.length>0||i.tableGroups.length>0),s(),d("ngIf",i.tables.length===0&&i.tableGroups.length===0),s(),d("ngIf",e.table_id),s(2),F("active",i.getStatusColor(e.status)),s(),h(" ",i.getStatusText(e.status)," "),s(2),F("active",i.getReservationShift(e)!=="N/D"),s(),h(" ",i.getReservationShift(e)," "),s(3),d("ngIf",e.status!=="confirmed"),s(),d("ngIf",e.status!=="pending"),s(5),d("size",20)}}function Ve(a,t){a&1&&(n(0,"div",76)(1,"span",29),l(2,"event_busy"),r(),n(3,"p",77),l(4,"Nessuna prenotazione trovata con i filtri selezionati"),r()())}function ze(a,t){a&1&&(n(0,"div",110)(1,"span",111),l(2,"refresh"),r(),l(3," Caricamento orari... "),r())}function We(a,t){a&1&&(n(0,"div",112)(1,"span",29),l(2,"warning"),r(),l(3," Nessun turno disponibile per questa data "),r())}function Ae(a,t){a&1&&(n(0,"span",77),l(1," - Non disponibile"),r())}function Be(a,t){if(a&1&&(n(0,"option",116),l(1),u(2,Ae,2,0,"span",105),r()),a&2){let e=t.$implicit;d("value",e.value)("disabled",e.disabled)("title",e.disabled?e.disabledReason:""),s(),h(" ",e.display," "),s(),d("ngIf",e.disabled)}}function Ne(a,t){if(a&1&&(n(0,"optgroup",69),u(1,Be,3,5,"option",115),r()),a&2){let e=m().$implicit,i=m(3);d("label",i.getShiftLabel(e.shift)),s(),d("ngForOf",e.times)}}function Ge(a,t){a&1&&(n(0,"span",77),l(1," - Non disponibile"),r())}function qe(a,t){if(a&1&&(n(0,"option",116),l(1),u(2,Ge,2,0,"span",105),r()),a&2){let e=t.$implicit;d("value",e.value)("disabled",e.disabled)("title",e.disabled?e.disabledReason:""),s(),h(" ",e.display," "),s(),d("ngIf",e.disabled)}}function Le(a,t){if(a&1&&(T(0),u(1,qe,3,5,"option",115),E()),a&2){let e=m().$implicit;s(),d("ngForOf",e.times)}}function $e(a,t){if(a&1&&(T(0),u(1,Ne,2,2,"optgroup",68)(2,Le,2,1,"ng-container",66),E()),a&2){let e=m(3);s(),d("ngIf",e.getAvailableTimesByShift().length>1),s(),d("ngIf",e.getAvailableTimesByShift().length===1)}}function je(a,t){if(a&1){let e=w();n(0,"select",113),x("ngModelChange",function(o){_(e);let c=m(2);return b(c.newReservation.reservation_time,o)||(c.newReservation.reservation_time=o),g(o)}),n(1,"option",114),l(2),r(),u(3,$e,3,2,"ng-container",38),r()}if(a&2){let e=m(2);f("ngModel",e.newReservation.reservation_time),d("disabled",e.loadingTimes),s(2),h(" ",e.getAvailableTimesByShift().length>1?"Seleziona un orario":"Seleziona"," "),s(),d("ngForOf",e.getAvailableTimesByShift())}}function Ke(a,t){if(a&1&&(n(0,"div",99)(1,"small")(2,"span",100),l(3,"info"),r(),l(4),r()()),a&2){let e=m(2);s(4),h(" ",e.getAvailableTimesSummary()," ")}}function Ue(a,t){if(a&1&&(n(0,"option",41),l(1),r()),a&2){let e=t.$implicit;d("value",e),s(),D(" ",e," ",e===1?"persona":"persone"," ")}}function Ye(a,t){a&1&&(n(0,"span"),l(1,"\u2B50"),r())}function He(a,t){if(a&1&&(n(0,"option",96),l(1),u(2,Ye,2,0,"span",66),r()),a&2){let e=t.$implicit;d("ngValue",e.id),s(),h(" ",e.name," "),s(),d("ngIf",e.is_default)}}function Je(a,t){if(a&1&&(n(0,"optgroup",117),u(1,He,3,3,"option",118),r()),a&2){let e=m(2);s(),d("ngForOf",e.globalMenus)}}function Qe(a,t){if(a&1&&(n(0,"option",96),l(1),n(2,"span",77),l(3,"(dedicato)"),r()()),a&2){let e=t.$implicit;d("ngValue",e.id),s(),h(" ",e.name," ")}}function Xe(a,t){if(a&1&&(n(0,"optgroup",119),u(1,Qe,4,2,"option",118),r()),a&2){let e=m(2);s(),d("ngForOf",e.dedicatedMenus)}}function Ze(a,t){if(a&1&&(n(0,"div",120)(1,"div",121)(2,"span",100),l(3,"restaurant_menu"),r(),n(4,"span",122),l(5),r(),n(6,"span",123),l(7),r()()()),a&2){let e=m(2);s(5),h(" Menu selezionato: ",e.getSelectedMenuName()," "),s(2),h(" ",e.getSelectedMenuType()==="global"?"Globale":"Dedicato"," ")}}function et(a,t){if(a&1){let e=w();n(0,"div",124)(1,"button",125),p("click",function(){_(e);let o=m(2);return g(o.createNewDedicatedMenu())}),n(2,"span",29),l(3,"add_circle"),r(),l(4," Crea nuovo menu dedicato per questa prenotazione "),r()()}}function tt(a,t){if(a&1&&(n(0,"option",128),l(1),r()),a&2){let e=t.$implicit,i=m(3);d("value",e.id)("selected",e.id===i.newReservation.table_id),s(),D(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ")}}function it(a,t){if(a&1&&(n(0,"optgroup",126),u(1,tt,2,4,"option",127),r()),a&2){let e=m(2);s(),d("ngForOf",e.getTablesByExactCapacity(e.newReservation.party_size))}}function nt(a,t){if(a&1&&(n(0,"option",128),l(1),r()),a&2){let e=t.$implicit,i=m(3);d("value",e.id)("selected",e.id===i.newReservation.table_id),s(),D(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ")}}function at(a,t){if(a&1&&(n(0,"optgroup",129),u(1,nt,2,4,"option",127),r()),a&2){let e=m(2);s(),d("ngForOf",e.getTablesByGreaterCapacity(e.newReservation.party_size))}}function rt(a,t){if(a&1&&(n(0,"option",72),l(1),r()),a&2){let e=m(2);s(),h(" Nessun tavolo disponibile per ",e.newReservation.party_size," persone ")}}function ot(a,t){if(a&1&&(n(0,"small",77),l(1),r()),a&2){let e=m(2);s(),h(" Capacit\xE0 tavolo: ",e.getSelectedTableCapacity()," posti ")}}function st(a,t){if(a&1&&(n(0,"small",77),l(1),r()),a&2){let e=m(2);s(),h(" \u2B50 Mostra tavoli con capacit\xE0 esatta per ",e.newReservation.party_size," persone ")}}function lt(a,t){a&1&&(n(0,"span",29),l(1,"refresh"),r())}function ct(a,t){if(a&1){let e=w();n(0,"div",78)(1,"div",79)(2,"div",80)(3,"h2",81)(4,"span",29),l(5),r(),l(6),r(),n(7,"button",44),p("click",function(){_(e);let o=m();return g(o.closeCreateModal())}),n(8,"span",29),l(9,"close"),r()()(),n(10,"div",82)(11,"div",43),O(12,"lucide-angular",83),n(13,"span"),l(14,"Stai creando una prenotazione per un cliente (registrato o nuovo)"),r()(),n(15,"div",84)(16,"div",3)(17,"label",4),l(18,"Nome *"),r(),n(19,"input",85),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.customer_name,o)||(c.newReservation.customer_name=o),g(o)}),r()(),n(20,"div",3)(21,"label",4),l(22,"Cognome *"),r(),n(23,"input",86),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.customer_surname,o)||(c.newReservation.customer_surname=o),g(o)}),r()()(),n(24,"div",84)(25,"div",3)(26,"label",4),l(27,"Telefono *"),r(),n(28,"input",87),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.customer_phone,o)||(c.newReservation.customer_phone=o),g(o)}),r()(),n(29,"div",3)(30,"label",4),l(31,"Email (opzionale)"),r(),n(32,"input",88),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.customer_email,o)||(c.newReservation.customer_email=o),g(o)}),r()()(),n(33,"div",84)(34,"div",3)(35,"label",4),l(36,"Data *"),r(),n(37,"input",89),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.reservation_date,o)||(c.newReservation.reservation_date=o),g(o)}),p("change",function(){_(e);let o=m();return g(o.onReservationDateChange())}),r()(),n(38,"div",3)(39,"label",4),l(40,"Ora *"),r(),u(41,ze,4,0,"div",90)(42,We,4,0,"div",91)(43,je,4,4,"select",92)(44,Ke,5,1,"div",93),r()(),n(45,"div",84)(46,"div",3)(47,"label",4),l(48,"Numero Persone *"),r(),n(49,"select",94),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.party_size,o)||(c.newReservation.party_size=o),g(o)}),u(50,Ue,2,3,"option",22),r()(),n(51,"div",3)(52,"label",4),l(53,"Stato"),r(),n(54,"select",95),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.status,o)||(c.newReservation.status=o),g(o)}),n(55,"option",19),l(56,"Confermata"),r(),n(57,"option",20),l(58,"In attesa"),r()()()(),n(59,"div",84)(60,"div",3)(61,"label",4),l(62,"Menu Dedicato (opzionale)"),r(),n(63,"select",95),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.menu_id,o)||(c.newReservation.menu_id=o),g(o)}),n(64,"option",96),l(65,"Nessun menu dedicato"),r(),u(66,Je,2,1,"optgroup",97)(67,Xe,2,1,"optgroup",98),r(),n(68,"small",99)(69,"span",100),l(70,"info"),r(),l(71," Se selezionato, questo menu sar\xE0 visibile solo per questa prenotazione "),r(),u(72,Ze,8,2,"div",101)(73,et,5,0,"div",102),r()(),n(74,"div",84)(75,"div",3)(76,"label",4),l(77,"Tavolo (opzionale)"),r(),n(78,"select",95),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.table_id,o)||(c.newReservation.table_id=o),g(o)}),n(79,"option",41),l(80,"Nessun tavolo assegnato"),r(),u(81,it,2,1,"optgroup",103)(82,at,2,1,"optgroup",104)(83,rt,2,1,"option",67),r(),u(84,ot,2,1,"small",105)(85,st,2,1,"small",105),r()(),n(86,"div",9)(87,"div",3)(88,"label",4),l(89,"Richieste Speciali"),r(),n(90,"textarea",106),x("ngModelChange",function(o){_(e);let c=m();return b(c.newReservation.special_requests,o)||(c.newReservation.special_requests=o),g(o)}),r()()()(),n(91,"div",107)(92,"button",108),p("click",function(){_(e);let o=m();return g(o.closeCreateModal())}),l(93," Annulla "),r(),n(94,"button",109),p("click",function(){_(e);let o=m();return g(o.createReservation())}),u(95,lt,2,0,"span",50),l(96),r()()()()}if(a&2){let e=m();s(5),S(e.isEditing?"edit":"add_circle"),s(),h(" ",e.isEditing?"Modifica Prenotazione":"Nuova Prenotazione Ristorante"," "),s(13),f("ngModel",e.newReservation.customer_name),d("required",!e.newReservation.customer_id),s(4),f("ngModel",e.newReservation.customer_surname),d("required",!e.newReservation.customer_id),s(5),f("ngModel",e.newReservation.customer_phone),d("required",!e.newReservation.customer_id),s(4),f("ngModel",e.newReservation.customer_email),s(5),f("ngModel",e.newReservation.reservation_date),d("min",e.getTodayDate()),s(4),d("ngIf",e.loadingTimes),s(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length===0),s(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length>0),s(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length>0),s(5),f("ngModel",e.newReservation.party_size),s(),d("ngForOf",U(35,ge)),s(4),f("ngModel",e.newReservation.status),s(9),f("ngModel",e.newReservation.menu_id),s(),d("ngValue",null),s(2),d("ngIf",e.hasGlobalMenus()),s(),d("ngIf",e.hasDedicatedMenus()),s(5),d("ngIf",e.newReservation.menu_id),s(),d("ngIf",e.isEditing),s(5),f("ngModel",e.newReservation.table_id),s(),d("value",void 0),s(2),d("ngIf",e.getTablesByExactCapacity(e.newReservation.party_size).length>0),s(),d("ngIf",e.getTablesByGreaterCapacity(e.newReservation.party_size).length>0),s(),d("ngIf",e.getTablesByExactCapacity(e.newReservation.party_size).length===0&&e.getTablesByGreaterCapacity(e.newReservation.party_size).length===0),s(),d("ngIf",e.newReservation.table_id),s(),d("ngIf",!e.newReservation.table_id),s(5),f("ngModel",e.newReservation.special_requests),s(4),d("disabled",!e.isFormValid()||e.loading),s(),d("ngIf",e.loading),s(),h(" ",e.isEditing?"Aggiorna Prenotazione":"Crea Prenotazione"," ")}}var _e=class a{reservationService=R(ce);tableService=R(le);menuService=R(de);floorManagementService=R(me);subscriptions=new A;allRestaurantReservations=[];filteredReservations=[];tables=[];tableGroups=[];loading=!1;error=null;showCreateModal=!1;newReservation={restaurant_id:"",customer_name:"",customer_surname:"",customer_phone:"",customer_email:"",reservation_date:"",reservation_time:"19:00",party_size:2,special_requests:"",table_id:void 0,status:"confirmed"};loadingTimes=!1;dateChangeSubject=new B;dateChangeSubscription;cachedTimes=$(new Map);selectedDate=null;startDate=null;endDate=null;statusFilter="all";viewMode="future";useDateFilter=!1;useDateRangeFilter=!1;shiftFilter="all";availableMenus=[];isEditing=!1;editingReservationId=null;shiftService=R(ue);shifts=[];ngOnInit(){this.loadData(),this.subscriptions.add(this.reservationService.restaurantReservations$.subscribe(t=>{this.allRestaurantReservations=t,this.filterReservations()})),this.subscriptions.add(this.shiftService.data$.subscribe(t=>{this.shifts=t,console.log("\u{1F504} Turni caricati:",t.length),this.cachedTimes.set(new Map)})),this.dateChangeSubscription=this.dateChangeSubject.pipe(G(300),L()).subscribe(()=>{this.updateAvailableTimes()}),this.subscriptions.add(this.tableService.data$.subscribe(t=>{this.tables=t,console.log("Tavoli caricati:",t.length)})),this.loadAvailableMenus()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.dateChangeSubscription?.unsubscribe()}loadData(){return M(this,null,function*(){this.loading=!0;try{yield this.reservationService.loadRestaurantReservations(),yield this.shiftService.loadData(),yield this.tableService.loadData(),yield this.loadTablesGroupedByFloorPlan()}catch(t){console.error("Error loading data:",t),this.error="Errore nel caricamento dei dati"}finally{this.loading=!1}})}onDateFilterToggle(){this.useDateFilter&&(this.useDateRangeFilter=!1),this.filterReservations()}onDateRangeFilterToggle(){this.useDateRangeFilter&&(this.useDateFilter=!1),this.filterReservations()}closeCreateModal(){this.showCreateModal=!1,this.isEditing=!1,this.editingReservationId=null}createReservation(){return M(this,null,function*(){if(this.isFormValid()){this.loading=!0;try{let t;this.isEditing&&this.editingReservationId?t=yield this.updateExistingReservation(this.editingReservationId,this.newReservation):t=yield this.reservationService.createRestaurantReservation(this.newReservation),t?(yield this.loadData(),this.closeCreateModal(),this.error=null,console.log("\u2705 Prenotazione salvata con successo")):this.error="Errore durante il salvataggio della prenotazione"}catch(t){console.error("Error saving reservation:",t),this.error=t.message||"Errore durante il salvataggio della prenotazione"}finally{this.loading=!1}}})}updateExistingReservation(t,e){return M(this,null,function*(){try{console.log("\u{1F50D} DEBUG menu_id:",{original:e.menu_id,type:typeof e.menu_id});let i={customer_name:e.customer_name,customer_surname:e.customer_surname,customer_phone:e.customer_phone,customer_email:e.customer_email,reservation_date:e.reservation_date,reservation_time:e.reservation_time,party_size:e.party_size,special_requests:e.special_requests,table_id:e.table_id,status:e.status};return e.customer_id&&(i.customer_id=e.customer_id),e.menu_id!==void 0&&(e.menu_id==="null"||e.menu_id===""?i.menu_id=null:i.menu_id=e.menu_id),console.log("\u{1F527} Dati di aggiornamento (con menu_id):",i),(yield this.reservationService.updateReservation(t,i))?yield this.reservationService.getReservationWithMenu(t):null}catch(i){throw console.error("Error updating reservation:",i),i}})}isFormValid(){return this.newReservation.customer_id?!!(this.newReservation.customer_id&&this.newReservation.reservation_date&&this.newReservation.reservation_time&&this.newReservation.party_size):!!(this.newReservation.customer_name&&this.newReservation.customer_surname&&this.newReservation.customer_phone&&this.newReservation.reservation_date&&this.newReservation.reservation_time&&this.newReservation.party_size)}assignTable(t,e){return M(this,null,function*(){if(e){this.loading=!0;try{(yield this.floorManagementService.assignTableToReservation(t,e))?(yield this.reservationService.loadRestaurantReservations(),console.log("\u2705 Tavolo assegnato e mappa aggiornata")):this.error="Errore nell'assegnazione del tavolo"}catch(i){console.error("Error assigning table:",i),this.error="Errore nell'assegnazione del tavolo"}finally{this.loading=!1}}})}unassignTable(t){return M(this,null,function*(){this.loading=!0;try{(yield this.floorManagementService.removeTableAssignment(t))?(yield this.reservationService.loadRestaurantReservations(),console.log("\u2705 Assegnazione rimossa e mappa aggiornata")):this.error="Errore nella rimozione del tavolo"}catch(e){console.error("Error unassigning table:",e),this.error="Errore nella rimozione del tavolo"}finally{this.loading=!1}})}updateStatus(t,e){return M(this,null,function*(){this.loading=!0;try{(yield this.reservationService.updateReservationStatus(t,e))||(this.error="Errore nell'aggiornamento dello stato")}catch(i){console.error("Error updating status:",i),this.error="Errore nell'aggiornamento dello stato"}finally{this.loading=!1}})}deleteReservation(t){return M(this,null,function*(){if(confirm("Sei sicuro di voler eliminare questa prenotazione?")){this.loading=!0;try{(yield this.reservationService.deleteReservation(t))||(this.error="Errore nell'eliminazione della prenotazione")}catch(e){console.error("Error deleting reservation:",e),this.error="Errore nell'eliminazione della prenotazione"}finally{this.loading=!1}}})}getSelectedTableCapacity(){if(!this.newReservation.table_id)return 0;for(let e of this.tableGroups){let i=e.tables.find(o=>o.id===this.newReservation.table_id);if(i)return i.capacity}let t=this.tables.find(e=>e.id===this.newReservation.table_id);return t?t.capacity:0}formatTime(t){return t.substring(0,5)}formatDate(t){if(!t)return"";let e=new Date(t),i=e.getDate().toString().padStart(2,"0"),o=(e.getMonth()+1).toString().padStart(2,"0"),c=e.getFullYear();return`${i}/${o}/${c}`}getCustomerName(t){return this.reservationService.getCustomerName(t)}getCustomerContact(t){return this.reservationService.getCustomerContact(t)}getTableName(t){return this.reservationService.getTableInfo(t)}getStatusColor(t){switch(t){case"confirmed":return"active";case"pending":return"";case"cancelled":return"";default:return""}}getStatusText(t){switch(t){case"confirmed":return"Confermata";case"pending":return"In attesa";case"cancelled":return"Cancellata";default:return t}}getAvailableTimes(){return["12:00","12:30","13:00","13:30","14:00","19:00","19:30","20:00","20:30","21:00","21:30"]}onDateChange(){this.filterReservations()}onStatusFilterChange(){this.filterReservations()}onViewModeChange(){this.filterReservations()}refreshData(){this.loadData()}loadTablesGroupedByFloorPlan(){return M(this,null,function*(){try{this.tableGroups=yield this.floorManagementService.getAllTablesGroupedByFloorPlan(),console.log("Table groups:",this.tableGroups),(!this.tableGroups||this.tableGroups.length===0)&&(yield this.groupTablesManually())}catch(t){console.error("Error loading tables grouped by floor plan:",t),yield this.groupTablesManually()}})}groupTablesManually(){return M(this,null,function*(){console.log("\u26A0\uFE0F Raggruppamento manuale dei tavoli...");let t={};this.tables.forEach(e=>{let i=e.floor_plan_id||"no-floor-plan";t[i]||(t[i]={floorPlan:{id:i,name:`Mappa ${i==="no-floor-plan"?"senza nome":i}`},tables:[]}),t[i].tables.push(e)}),this.tableGroups=Object.values(t),console.log("\u2705 Tavoli raggruppati manualmente:",this.tableGroups)})}getFilteredTables(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(i=>i.capacity>=t).sort((i,o)=>i.capacity===t&&o.capacity!==t?-1:i.capacity!==t&&o.capacity===t?1:i.capacity-o.capacity)}getFilteredTableGroups(t){return!this.tableGroups||this.tableGroups.length===0?[]:this.tableGroups.map(e=>{let i=e.tables.filter(o=>o.capacity>=t).sort((o,c)=>o.capacity===t&&c.capacity!==t?-1:o.capacity!==t&&c.capacity===t?1:o.capacity-c.capacity);return W(z({},e),{tables:i})}).filter(e=>e.tables.length>0)}getTablesByExactCapacity(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(e=>e.capacity===t)}getTablesByGreaterCapacity(t){if(!this.tables||this.tables.length===0)return[];let e=this.tables.filter(c=>c.capacity>=t).sort((c,v)=>c.capacity-v.capacity),i=this.getTablesByExactCapacity(t),o=new Set(i.map(c=>c.id));return e.filter(c=>!o.has(c.id))}getAllAvailableTables(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(e=>e.capacity>=t).sort((e,i)=>e.capacity===t&&i.capacity!==t?-1:e.capacity!==t&&i.capacity===t?1:e.capacity-i.capacity)}getCustomerFullName(t){return t.users?`${t.users.first_name||""} ${t.users.last_name||""}`.trim():t.customer_name||t.customer_surname?`${t.customer_name||""} ${t.customer_surname||""}`.trim():"Cliente"}formatTimeForInput(t){return t?t.length>5?t.substring(0,5):t:"19:00"}getReservationShift(t){if(!this.shifts||this.shifts.length===0)return"N/D";let i=new Date(t.reservation_date).getDay(),o=i===0?7:i,c=t.reservation_time.substring(0,5),v=this.timeToSeconds(c);for(let y of this.shifts)if(y.is_active&&y.days_of_week.includes(o)){let I=this.timeToSeconds(y.start_time.substring(0,5)),C=this.timeToSeconds(y.end_time.substring(0,5));if(v>=I&&v<=C)return y.name}return this.getClosestShift(c,o)||"N/D"}timeToSeconds(t){let[e,i]=t.split(":").map(Number);return e*3600+i*60}getClosestShift(t,e){let i=null,o=1/0,c=this.timeToSeconds(t);for(let v of this.shifts){if(!v.is_active||!v.days_of_week.includes(e))continue;let y=this.timeToSeconds(v.start_time.substring(0,5)),I=this.timeToSeconds(v.end_time.substring(0,5)),C=Math.abs(c-y),V=Math.abs(c-I),P=Math.min(C,V);P<o&&(o=P,i=v)}return i&&o<=3600?`${i.name} (\u2248)`:null}get activeShifts(){return this.shifts.filter(t=>t.is_active)}getReservationShiftName(t){return this.getReservationShift(t)}filterReservations(){let t=this.allRestaurantReservations,e=new Date().toISOString().split("T")[0];switch(this.viewMode){case"today":t=this.reservationService.getActiveReservations(t);break;case"future":t=this.reservationService.getFutureReservations(t);break;case"all":break}this.useDateFilter&&this.selectedDate&&(t=t.filter(i=>i.reservation_date===this.selectedDate)),this.useDateRangeFilter&&this.startDate&&this.endDate&&(t=t.filter(i=>i.reservation_date>=this.startDate&&i.reservation_date<=this.endDate)),this.statusFilter!=="all"&&(t=t.filter(i=>i.status===this.statusFilter)),this.shiftFilter!=="all"&&(t=t.filter(i=>this.getReservationShiftName(i)===this.shiftFilter)),this.filteredReservations=t}resetFilters(){this.viewMode="future",this.selectedDate=null,this.startDate=null,this.endDate=null,this.statusFilter="all",this.shiftFilter="all",this.useDateFilter=!1,this.useDateRangeFilter=!1,this.filterReservations()}getActiveFiltersInfo(){let t=this.getActiveFiltersCount();return t===1?{count:t,text:"1 filtro attivo"}:t>1?{count:t,text:`${t} filtri attivi`}:{count:0,text:""}}getActiveFiltersCount(){let t=0;return this.viewMode!=="future"&&t++,this.useDateFilter&&this.selectedDate&&t++,this.useDateRangeFilter&&this.startDate&&this.endDate&&t++,this.statusFilter!=="all"&&t++,this.shiftFilter!=="all"&&t++,t}loadAvailableMenus(){return M(this,null,function*(){try{yield this.menuService.loadData(),this.availableMenus=(yield this.menuService.data$.pipe(q(1),N(t=>t.filter(e=>e.is_active))).toPromise())||[],console.log("\u{1F4CB} Menu disponibili per assegnazione:",this.availableMenus.length)}catch(t){console.error("\u274C Errore caricamento menu:",t),this.availableMenus=[]}})}createDedicatedMenuForReservation(t,e){return M(this,null,function*(){try{console.log(`\u2795 Creazione menu dedicato per prenotazione ${t}`);let i=yield this.menuService.createDedicatedMenu(`${e} - Prenotazione ${t.slice(0,8)}`);return i?(console.log(`\u2705 Menu dedicato creato: ${i.id}`),i.id):(console.error("\u274C Errore creazione menu dedicato"),null)}catch(i){return console.error("\u274C Errore creazione menu dedicato:",i),null}})}getSelectedMenuName(){if(!this.newReservation.menu_id)return"Nessuno";let t=this.availableMenus.find(e=>e.id===this.newReservation.menu_id);return t?t.name:"Menu non trovato"}getReservationMenuInfo(t){if(!t.menu_id)return"";if(t.menus)return t.menus.name;let e=this.availableMenus.find(i=>i.id===t.menu_id);return e?e.name:"(menu dedicato)"}get globalMenus(){return!this.availableMenus||this.availableMenus.length===0?[]:this.availableMenus.filter(t=>t.type==="global")}get dedicatedMenus(){return!this.availableMenus||this.availableMenus.length===0?[]:this.availableMenus.filter(t=>t.type==="dedicated")}hasGlobalMenus(){return this.globalMenus.length>0}hasDedicatedMenus(){return this.dedicatedMenus.length>0}createNewDedicatedMenu(){return M(this,null,function*(){if(!this.editingReservationId){alert("Devi essere in modalit\xE0 modifica per creare un menu dedicato");return}let t=prompt("Nome del nuovo menu dedicato:");if(!(!t||t.trim()===""))try{let e=yield this.menuService.createDedicatedMenu(`${t} - Prenotazione ${this.editingReservationId.slice(0,8)}`,`Menu dedicato per la prenotazione ${this.editingReservationId.slice(0,8)}`);e?(yield this.loadAvailableMenus(),this.newReservation.menu_id=e.id,alert(`\u2705 Menu dedicato "${e.name}" creato e assegnato!`)):alert("\u274C Errore nella creazione del menu dedicato")}catch(e){console.error("Errore creazione menu dedicato:",e),alert("\u274C Errore nella creazione del menu dedicato")}})}getSelectedMenuType(){return this.newReservation.menu_id&&this.availableMenus.find(e=>e.id===this.newReservation.menu_id)?.type||null}onReservationDateChange(){this.dateChangeSubject.next()}updateAvailableTimes(){return M(this,null,function*(){if(!this.newReservation.reservation_date)return;let t=this.newReservation.reservation_date;if(this.cachedTimes().get(t)){console.log("\u26A1 Orari dalla cache per",t);return}this.loadingTimes=!0;try{let i=this.calculateAvailableTimesForDate(this.newReservation.reservation_date),o=new Map(this.cachedTimes());o.set(t,i),this.cachedTimes.set(o),this.validateAndResetSelectedTime(i),console.log("\u2705 Orari calcolati per",t,":",i)}catch(i){console.error("\u274C Errore calcolo orari:",i)}finally{this.loadingTimes=!1}})}calculateAvailableTimesForDate(t){if(!t||!this.shifts?.length)return[];let i=new Date(t).getDay(),o=i===0?7:i,c=this.shifts.filter(v=>v.is_active&&v.days_of_week.includes(o));return c.length===0?[]:c.map(v=>{let y=this.generateTimeSlotsForShift(v);return{shift:v,times:y}})}generateTimeSlotsForShift(t){let e=[],i=t.start_time.substring(0,5),o=t.end_time.substring(0,5),c=this.timeToMinutes(i),v=this.timeToMinutes(o),y=v<c?v+24*60:v,I=t.interval_minutes||30;for(let C=c;C<y;C+=I){let V=C%1440,P=this.minutesToTime(V);e.push({value:P,display:P,shiftId:t.id})}return e}getAvailableTimesByShift(){if(!this.newReservation.reservation_date)return[];let t=this.newReservation.reservation_date;return this.cachedTimes().get(t)||[]}validateAndResetSelectedTime(t){if(!this.newReservation.reservation_time)return;t.some(i=>i.times.some(o=>o.value===this.newReservation.reservation_time&&!o.disabled))||(this.newReservation.reservation_time="")}timeToMinutes(t){let[e,i]=t.split(":").map(Number);return e*60+i}minutesToTime(t){let e=Math.floor(t/60),i=t%60;return`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}getShiftLabel(t){let e=t.start_time.substring(0,5),i=t.end_time.substring(0,5);return`${t.name} (${e} - ${i})`}getAvailableTimesSummary(){let t=this.getAvailableTimesByShift();if(t.length===0)return"Nessun turno disponibile";if(t.length===1){let i=t[0].shift;return`Turno ${i.name}: ${i.start_time.substring(0,5)} - ${i.end_time.substring(0,5)}`}let e=t.map(i=>i.shift.name).join(", ");return`${t.length} turni disponibili: ${e}`}getTodayDate(){return new Date().toISOString().split("T")[0]}openCreateModal(){this.newReservation={restaurant_id:"",customer_name:"",customer_surname:"",customer_phone:"",customer_email:"",reservation_date:this.selectedDate||new Date().toISOString().split("T")[0],reservation_time:"",party_size:2,special_requests:"",table_id:void 0,status:"confirmed"},this.showCreateModal=!0,setTimeout(()=>{this.updateAvailableTimes()},100)}openEditModal(t){this.isEditing=!0,this.editingReservationId=t.id,this.newReservation={restaurant_id:t.restaurant_id||"",customer_name:t.customer_name||"",customer_surname:t.customer_surname||"",customer_phone:t.customer_phone||"",customer_email:t.customer_email||"",reservation_date:t.reservation_date,reservation_time:this.formatTimeForInput(t.reservation_time),party_size:t.party_size,special_requests:t.special_requests||"",table_id:t.table_id||void 0,status:t.status,customer_id:t.customer_id||void 0,menu_id:t.menu_id||void 0},this.showCreateModal=!0,setTimeout(()=>{this.updateAvailableTimes()},100)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=j({type:a,selectors:[["app-reservation-manager"]],decls:92,vars:18,consts:[["tableSelect",""],[1,"page-container"],["data-tutorial","reservation-filters",1,"form-card","mb-lg"],[1,"form-group"],[1,"standard-label"],[1,"p-sm",3,"ngModelChange","change","ngModel"],["value","today"],["value","future"],["value","all"],[1,"form-row"],[1,"flex","align-center","gap-sm"],["type","checkbox","id","dateFilter",3,"ngModelChange","change","ngModel"],["for","dateFilter",1,"standard-label"],["type","date",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["type","checkbox","id","dateRangeFilter",3,"ngModelChange","change","ngModel"],["for","dateRangeFilter",1,"standard-label"],[1,"flex","gap-sm","flex-wrap"],["type","date","placeholder","Da",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["type","date","placeholder","A",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["value","confirmed"],["value","pending"],["value","cancelled"],[3,"value",4,"ngFor","ngForOf"],["value","N/D"],[1,"w-100","flex",2,"justify-content","end"],["data-tutorial","reservation-add",1,"modal-footer",2,"max-width","max-content"],["class","filter-badge",4,"ngIf"],[1,"flex","gap-sm"],["title","Resetta filtri",1,"icon-button",3,"click"],[1,"material-icons"],["title","Aggiorna",1,"icon-button",3,"click"],[1,"promethea-button",3,"click"],["name","plus",3,"size"],["class","info-message mb-lg",4,"ngIf"],["data-tutorial","reservation-table",1,"table-section","p-sm"],[1,"crm-table","custom-widths"],[2,"text-align","center"],[1,"material-icons","text-md"],[4,"ngFor","ngForOf"],["class","empty-state p-lg",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[3,"value"],[1,"filter-badge"],[1,"info-message","mb-lg"],[1,"icon-button",3,"click"],[1,"flex","gap-sm","justify-between","flex-wrap","items-center"],["class","text-mini text-muted",4,"ngIf"],[1,"chip","text-mini",2,"max-width","fit-content"],[1,"flex","gap-sm","flex-col","items-center","flex-wrap"],[1,"flex","gap-sm","items-center"],["class","material-icons",4,"ngIf"],["class","flex",4,"ngIf"],[1,"flex","justify-between","items-center","gap-sm"],["class","flex gap-sm",4,"ngIf"],["class","icon-button","title","Rimuovi tavolo",3,"click",4,"ngIf"],[1,"chip"],["class","icon-button","title","Conferma",3,"click",4,"ngIf"],["class","icon-button","title","Metti in attesa",3,"click",4,"ngIf"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["name","trash-2",3,"size"],[1,"text-mini","text-muted"],[1,"flex"],["style","max-width: fit-content;","class","text-mini x-small custom-select",3,"change",4,"ngIf"],[1,"text-mini","x-small","custom-select",2,"max-width","fit-content",3,"change"],["value",""],[4,"ngIf"],["disabled","",4,"ngIf"],[3,"label",4,"ngIf"],[3,"label"],[3,"value","title",4,"ngFor","ngForOf"],[3,"value","title"],["disabled",""],["title","Rimuovi tavolo",1,"icon-button",3,"click"],["title","Conferma",1,"icon-button",3,"click"],["title","Metti in attesa",1,"icon-button",3,"click"],[1,"empty-state","p-lg"],[1,"text-muted"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"section-title"],[1,"form-card"],["name","info"],[1,"form-row","mb-md"],["type","text","placeholder","Inserisci nome",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","text","placeholder","Inserisci cognome",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","tel","placeholder","Inserisci telefono",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","email","placeholder","Inserisci email",1,"p-sm",3,"ngModelChange","ngModel"],["type","date","required","",1,"p-sm",3,"ngModelChange","change","ngModel","min"],["class","loading-indicator",4,"ngIf"],["class","alert warning",4,"ngIf"],["class","p-sm","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["class","text-muted mt-sm",4,"ngIf"],["required","",1,"p-sm",3,"ngModelChange","ngModel"],[1,"p-sm",3,"ngModelChange","ngModel"],[3,"ngValue"],["label","Menu globali (visibili a tutti)",4,"ngIf"],["label","Menu dedicati esistenti",4,"ngIf"],[1,"text-muted","mt-sm"],[1,"material-icons","text-mini"],["class","mt-sm p-sm bg-smoke rounded",4,"ngIf"],["class","mt-sm",4,"ngIf"],["label","Tavoli con capacit\xE0 esatta \u2B50",4,"ngIf"],["label","Tavoli con capacit\xE0 maggiore",4,"ngIf"],["class","text-muted",4,"ngIf"],["placeholder","Note o richieste speciali del cliente...","rows","3",1,"p-sm",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"promethea-button","ghost",3,"click"],[1,"promethea-button",3,"click","disabled"],[1,"loading-indicator"],[1,"material-icons","rotating"],[1,"alert","warning"],["required","",1,"p-sm",3,"ngModelChange","ngModel","disabled"],["value","","disabled","","selected",""],[3,"value","disabled","title",4,"ngFor","ngForOf"],[3,"value","disabled","title"],["label","Menu globali (visibili a tutti)"],[3,"ngValue",4,"ngFor","ngForOf"],["label","Menu dedicati esistenti"],[1,"mt-sm","p-sm","bg-smoke","rounded"],[1,"flex","items-center","gap-sm"],[1,"text-mini","font-semibold"],[1,"chip","bg-glass","ml-auto"],[1,"mt-sm"],["type","button",1,"promethea-button","ghost",3,"click"],["label","Tavoli con capacit\xE0 esatta \u2B50"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"],["label","Tavoli con capacit\xE0 maggiore"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"label",4),l(4,"Visualizza"),r(),n(5,"select",5),x("ngModelChange",function(c){return b(i.viewMode,c)||(i.viewMode=c),c}),p("change",function(){return i.filterReservations()}),n(6,"option",6),l(7,"Oggi"),r(),n(8,"option",7),l(9,"Prenotazioni Future"),r(),n(10,"option",8),l(11,"Tutte le Prenotazioni"),r()()(),n(12,"div",9)(13,"div",3)(14,"div",10)(15,"input",11),x("ngModelChange",function(c){return b(i.useDateFilter,c)||(i.useDateFilter=c),c}),p("change",function(){return i.onDateFilterToggle()}),r(),n(16,"label",12),l(17,"Data specifica"),r()(),n(18,"input",13),x("ngModelChange",function(c){return b(i.selectedDate,c)||(i.selectedDate=c),c}),p("change",function(){return i.filterReservations()}),r()(),n(19,"div",3)(20,"div",10)(21,"input",14),x("ngModelChange",function(c){return b(i.useDateRangeFilter,c)||(i.useDateRangeFilter=c),c}),p("change",function(){return i.onDateRangeFilterToggle()}),r(),n(22,"label",15),l(23,"Intervallo date"),r()(),n(24,"div",16)(25,"input",17),x("ngModelChange",function(c){return b(i.startDate,c)||(i.startDate=c),c}),p("change",function(){return i.filterReservations()}),r(),n(26,"input",18),x("ngModelChange",function(c){return b(i.endDate,c)||(i.endDate=c),c}),p("change",function(){return i.filterReservations()}),r()()()(),n(27,"div",9)(28,"div",3)(29,"label",4),l(30,"Stato"),r(),n(31,"select",5),x("ngModelChange",function(c){return b(i.statusFilter,c)||(i.statusFilter=c),c}),p("change",function(){return i.filterReservations()}),n(32,"option",8),l(33,"Tutti"),r(),n(34,"option",19),l(35,"Confermate"),r(),n(36,"option",20),l(37,"In attesa"),r(),n(38,"option",21),l(39,"Cancellate"),r()()(),n(40,"div",3)(41,"label",4),l(42,"Turno"),r(),n(43,"select",5),x("ngModelChange",function(c){return b(i.shiftFilter,c)||(i.shiftFilter=c),c}),p("change",function(){return i.filterReservations()}),n(44,"option",8),l(45,"Tutti i turni"),r(),u(46,pe,2,4,"option",22),n(47,"option",23),l(48,"Fuori orario"),r()()()()(),n(49,"div",24)(50,"div",25),u(51,ve,2,1,"span",26),n(52,"div",27)(53,"button",28),p("click",function(){return i.resetFilters()}),n(54,"span",29),l(55,"filter_alt_off"),r()(),n(56,"button",30),p("click",function(){return i.refreshData()}),n(57,"span",29),l(58,"refresh"),r()(),n(59,"button",31),p("click",function(){return i.openCreateModal()}),O(60,"lucide-angular",32),l(61," Nuova Prenotazione "),r()()()(),u(62,he,7,1,"div",33),n(63,"div",34)(64,"table",35)(65,"thead")(66,"tr")(67,"th"),l(68,"Data"),r(),n(69,"th"),l(70,"Ora"),r(),n(71,"th"),l(72,"Cliente"),r(),n(73,"th",36)(74,"span",37),l(75,"phone_enabled"),r()(),n(76,"th",36)(77,"span",37),l(78,"groups"),r()(),n(79,"th",36)(80,"span",37),l(81,"table_restaurant"),r()(),n(82,"th"),l(83,"Stato"),r(),n(84,"th"),l(85,"Turno"),r(),n(86,"th"),l(87,"Azioni"),r()()(),n(88,"tbody"),u(89,ke,42,24,"tr",38),r()(),u(90,Ve,5,0,"div",39),r(),u(91,ct,97,36,"div",40),r()),e&2&&(s(5),f("ngModel",i.viewMode),s(10),f("ngModel",i.useDateFilter),s(3),f("ngModel",i.selectedDate),d("disabled",!i.useDateFilter),s(3),f("ngModel",i.useDateRangeFilter),s(4),f("ngModel",i.startDate),d("disabled",!i.useDateRangeFilter),s(),f("ngModel",i.endDate),d("disabled",!i.useDateRangeFilter),s(5),f("ngModel",i.statusFilter),s(12),f("ngModel",i.shiftFilter),s(3),d("ngForOf",i.activeShifts),s(5),d("ngIf",i.getActiveFiltersInfo().count>0),s(9),d("size",20),s(2),d("ngIf",i.error),s(27),d("ngForOf",i.filteredReservations),s(),d("ngIf",i.filteredReservations.length===0),s(),d("ngIf",i.showCreateModal))},dependencies:[J,Y,H,re,ie,ne,X,Q,te,Z,ae,ee,se,oe],styles:["select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]{font-weight:600;background-color:var(--smoke-1);padding:var(--gap-sm);border-bottom:1px solid var(--smoke-2)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-weight:400;padding-left:var(--gap-sm);background-color:var(--background)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:hover{background-color:var(--smoke-1)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{font-style:italic;background-color:var(--smoke-1)}select[_ngcontent-%COMP%]:focus   optgroup[_ngcontent-%COMP%]{background-color:var(--smoke-1)}.filter-badge[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-weight:500;padding:var(--gap-sm);background:var(--smoke-1);border-radius:12px}.custom-select[_ngcontent-%COMP%]{max-width:fit-content!important;min-width:150px;overflow:hidden;text-overflow:ellipsis}.custom-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.custom-select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]{max-width:200px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){width:8%;min-width:90px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){width:6%;min-width:70px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){width:25%;min-width:250px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){width:8%;min-width:80px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){width:6%;min-width:70px;text-align:center}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(6){width:15%;min-width:150px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(7), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(7){width:12%;min-width:120px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(8), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(8){width:10%;min-width:100px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(9), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(9){width:10%;min-width:140px;text-align:center}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:var(--gap-sm) calc(var(--gap-sm) / 2)}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){padding:var(--gap-sm)}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3)   .flex-col[_ngcontent-%COMP%]{gap:4px}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3)   strong[_ngcontent-%COMP%]{white-space:normal;line-height:1.3;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}"]})};export{_e as ReservationManager};
