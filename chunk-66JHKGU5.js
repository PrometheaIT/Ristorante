import{a as d}from"./chunk-E4UBUULA.js";import{b as l}from"./chunk-HOOEJZZY.js";import{Y as c,ba as u,g as a}from"./chunk-DU5L5MFQ.js";import{a as p,b as n,j as i}from"./chunk-4ZZIO3ZI.js";var S=class o{supabaseService=u(l);supplierAuthService=u(d);productsSubject=new a([]);products$=this.productsSubject.asObservable();loadSupplierProducts(){return i(this,null,function*(){try{let e=this.supplierAuthService.getSupplierProfile();if(!e){console.error("No supplier profile found");return}let{data:r,error:t}=yield this.supabaseService.getSupabaseClient().from("supplier_products").select(`
          *,
          units (name, symbol),
          ingredients (name)
        `).eq("supplier_id",e.id).order("product_name");if(t){console.error("Error loading supplier products:",t);return}this.productsSubject.next(r||[])}catch(e){console.error("Error in loadSupplierProducts:",e)}})}createProduct(e){return i(this,null,function*(){try{let r=this.supplierAuthService.getSupplierProfile();if(!r)return console.error("No supplier profile found"),null;let t=n(p({},e),{supplier_id:r.id}),{data:f,error:s}=yield this.supabaseService.getSupabaseClient().from("supplier_products").insert(t).select().single();if(s)throw s;return yield this.loadSupplierProducts(),f}catch(r){return console.error("Error creating supplier product:",r),null}})}updateProduct(e,r){return i(this,null,function*(){try{let{error:t}=yield this.supabaseService.getSupabaseClient().from("supplier_products").update(r).eq("id",e);if(t)throw t;return yield this.loadSupplierProducts(),!0}catch(t){return console.error("Error updating supplier product:",t),!1}})}deleteProduct(e){return i(this,null,function*(){try{let{error:r}=yield this.supabaseService.getSupabaseClient().from("supplier_products").delete().eq("id",e);if(r)throw r;return yield this.loadSupplierProducts(),!0}catch(r){return console.error("Error deleting supplier product:",r),!1}})}getProducts(){return this.productsSubject.value}getAvailableProducts(){return this.productsSubject.value.filter(e=>e.is_available)}getProductById(e){return this.productsSubject.value.find(r=>r.id===e)}static \u0275fac=function(r){return new(r||o)};static \u0275prov=c({token:o,factory:o.\u0275fac,providedIn:"root"})};export{S as a};
