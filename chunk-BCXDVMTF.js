import{a as Z}from"./chunk-PPQZOHAT.js";import{a as X}from"./chunk-LTEPOHS3.js";import"./chunk-QUTFIOET.js";import"./chunk-SVYAZSVR.js";import{qb as J,rb as K}from"./chunk-7ARAJ5DM.js";import{A as H,b as A,d as N,e as L,g as z,i as B,j as R,k as j,l as $,s as U,t as q,u as Y,w as G,x as Q}from"./chunk-YO2SNT5L.js";import"./chunk-MEEOFM4U.js";import"./chunk-RD7WPZ3N.js";import"./chunk-JDHQCX3C.js";import{j as D,k as O,l as P,v as W}from"./chunk-RJWLMJIA.js";import{Ib as a,Jb as h,Kb as _,La as s,Ob as v,Pb as E,Qb as y,Tb as k,Va as V,_a as u,ca as F,fb as I,gb as m,ib as w,la as c,ma as g,qb as i,rb as t,sb as M,vb as S,yb as x,zb as d}from"./chunk-KIAVC6JW.js";import{a as b,b as C,g as f}from"./chunk-RA2WU32H.js";var te=(l,n)=>({"recurring-info":l,"non-recurring-info":n});function ne(l,n){if(l&1){let e=S();i(0,"div",11)(1,"label",12),a(2,"Mese"),t(),i(3,"button",21),x("click",function(){c(e);let o=d();return g(o.openMonthsModal())}),i(4,"span",22),a(5,"calendar_today"),t(),a(6),t()()}if(l&2){let e=d();s(6),_(" ",e.formatMonth(e.selectedMonth)," ")}}function ie(l,n){if(l&1){let e=S();i(0,"button",39),x("click",function(){c(e);let o=d(2);return g(o.showAllTemplates=!o.showAllTemplates)}),i(1,"span",22),a(2),t(),a(3),t()}if(l&2){let e=d(2);s(2),h(e.showAllTemplates?"expand_less":"expand_more"),s(),_(" ",e.showAllTemplates?"Mostra meno":"Mostra tutto"," ")}}function ae(l,n){if(l&1&&(i(0,"div"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_("A: ",r.formatMonthDisplay(e.end_month),"")}}function re(l,n){if(l&1){let e=S();i(0,"div",40)(1,"div",41)(2,"div")(3,"h4",42),a(4),t(),i(5,"div",43)(6,"span",44),a(7),t(),i(8,"span",45),a(9),t(),i(10,"span",46),a(11),t()()(),i(12,"button",47),x("click",function(){let o=c(e).$implicit,p=d(2);return g(p.deactivateRecurringTemplate(o.id))}),i(13,"span",22),a(14,"toggle_off"),t()()(),i(15,"div",48)(16,"div"),a(17),t(),u(18,ae,2,1,"div",29),t()()}if(l&2){let e=n.$implicit,r=n.index,o=d(2);w("hidden-card",!o.showAllTemplates&&r>=3),s(4),h(e.name),s(2),w("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(o.formatCurrency(e.amount)),s(2),h(e.category),s(6),_("Da: ",o.formatMonthDisplay(e.start_month),""),s(),m("ngIf",e.end_month)}}function oe(l,n){if(l&1&&(i(0,"div",49)(1,"p"),a(2),t()()),l&2){let e=d(2);s(2),_("+",e.recurringTemplates.length-3," altri template nascosti")}}function se(l,n){if(l&1&&(i(0,"div",8)(1,"div",33)(2,"div",34)(3,"span",4),a(4,"repeat"),t(),i(5,"h3",5),a(6),t()(),u(7,ie,4,2,"button",35),t(),i(8,"div",36),u(9,re,19,10,"div",37),t(),u(10,oe,3,1,"div",38),t()),l&2){let e=d();s(6),_("Spese Ricorrenti (",e.recurringTemplates.length,")"),s(),m("ngIf",e.recurringTemplates.length>3),s(),w("expanded",e.showAllTemplates)("collapsed",!e.showAllTemplates),s(),m("ngForOf",e.recurringTemplates),s(),m("ngIf",!e.showAllTemplates&&e.recurringTemplates.length>3)}}function le(l,n){l&1&&(i(0,"th"),a(1,"Mese"),t())}function pe(l,n){l&1&&(i(0,"span",60),a(1," repeat "),t())}function de(l,n){if(l&1&&(i(0,"span",61),a(1),t()),l&2){let e=d().$implicit,r=d();s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function me(l,n){l&1&&(i(0,"span",46),a(1,"-"),t())}function ce(l,n){if(l&1&&(i(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d();s(),h(r.formatMonth(e.month))}}function ge(l,n){if(l&1){let e=S();i(0,"tr",50)(1,"td")(2,"div",34)(3,"strong"),a(4),t(),u(5,pe,2,0,"span",51),t()(),i(6,"td")(7,"span",44),a(8),t()(),i(9,"td"),a(10),t(),i(11,"td")(12,"strong"),a(13),t()(),i(14,"td"),u(15,de,2,1,"span",52)(16,me,2,0,"span",53),t(),u(17,ce,2,1,"td",29),i(18,"td",54),a(19),t(),i(20,"td")(21,"div",55)(22,"button",56),x("click",function(){let o=c(e).$implicit,p=d();return g(p.toggleExpenseStatus(o))}),i(23,"span",22),a(24),t()(),i(25,"button",57),x("click",function(){let o=c(e).$implicit,p=d();return g(p.openEditExpenseModal(o))}),i(26,"span",22),a(27,"edit"),t()(),i(28,"button",58),x("click",function(){let o=c(e).$implicit,p=d();return g(p.deleteExpense(o))}),M(29,"lucide-angular",59),t()()()()}if(l&2){let e=n.$implicit,r=d();w("inactive-row",!e.is_active),s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),w("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(3),w("active-toggle",e.is_active),m("title",e.is_active?"Disattiva spesa":"Attiva spesa"),s(2),_(" ",e.is_active?"toggle_on":"toggle_off"," "),s(5),m("size",20)}}function xe(l,n){if(l&1&&(i(0,"p",46),a(1),t()),l&2){let e=d(2);s(),_('Nessuna spesa trovata per "',e.searchTerm,'"')}}function ue(l,n){l&1&&(i(0,"p",46),a(1,"Nessuna spesa registrata"),t())}function _e(l,n){if(l&1){let e=S();i(0,"tr")(1,"td",62)(2,"div",63)(3,"span",64),a(4,"receipt_long"),t(),u(5,xe,2,1,"p",53)(6,ue,2,0,"p",53),i(7,"button",39),x("click",function(){c(e);let o=d();return g(o.openAddExpenseModal())}),M(8,"lucide-angular",25),a(9," Aggiungi la prima spesa "),t()()()()}if(l&2){let e=d();s(),I("colspan",e.viewMode==="all"?8:7),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm),s(2),m("size",20)}}function he(l,n){l&1&&(i(0,"th"),a(1,"Mese"),t())}function fe(l,n){l&1&&(i(0,"span",60),a(1," repeat "),t())}function ve(l,n){if(l&1&&(i(0,"span",61),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function Ee(l,n){l&1&&(i(0,"span",46),a(1,"-"),t())}function ye(l,n){if(l&1&&(i(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),h(r.formatMonth(e.month))}}function Me(l,n){if(l&1){let e=S();i(0,"tr",79)(1,"td")(2,"div",34)(3,"strong"),a(4),t(),u(5,fe,2,0,"span",51),t()(),i(6,"td")(7,"span",44),a(8),t()(),i(9,"td"),a(10),t(),i(11,"td")(12,"strong"),a(13),t()(),i(14,"td"),u(15,ve,2,1,"span",52)(16,Ee,2,0,"span",53),t(),u(17,ye,2,1,"td",29),i(18,"td",54),a(19),t(),i(20,"td",80),a(21),t(),i(22,"td")(23,"div",55)(24,"button",81),x("click",function(){let o=c(e).$implicit,p=d(2);return g(p.toggleExpenseStatus(o))}),i(25,"span",22),a(26," toggle_off "),t()(),i(27,"button",82),x("click",function(){let o=c(e).$implicit,p=d(2);return g(p.openEditExpenseModal(o))}),i(28,"span",22),a(29,"visibility"),t()(),i(30,"button",83),x("click",function(){let o=c(e).$implicit,p=d(2);return g(p.permanentlyDeleteExpense(o))}),i(31,"span",22),a(32,"delete_forever"),t()()()()()}if(l&2){let e=n.$implicit,r=d(2);s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),w("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(2),_(" ",r.formatDeletedDate(e.deleted_at)," ")}}function Se(l,n){if(l&1&&(i(0,"p",46),a(1),t()),l&2){let e=d(3);s(),_('Nessuna spesa disattivata trovata per "',e.searchTerm,'"')}}function we(l,n){l&1&&(i(0,"p",46),a(1,"Nessuna spesa disattivata"),t())}function be(l,n){if(l&1&&(i(0,"tr")(1,"td",62)(2,"div",63)(3,"span",64),a(4,"archive"),t(),u(5,Se,2,1,"p",53)(6,we,2,0,"p",53),t()()()),l&2){let e=d(2);s(),I("colspan",e.viewMode==="all"?9:8),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm)}}function Ce(l,n){if(l&1&&(i(0,"div",65)(1,"div",66)(2,"div",55)(3,"span",67),a(4,"archive"),t(),i(5,"h1",68),a(6,"Spese Disattivate"),t()()(),i(7,"div",69)(8,"div",2)(9,"div",3)(10,"span",70),a(11,"money_off"),t(),i(12,"h3",5),a(13,"Totale Disattivate"),t()(),i(14,"div",6)(15,"div",71),a(16),t()()(),i(17,"div",2)(18,"div",3)(19,"span",72),a(20,"repeat"),t(),i(21,"h3",5),a(22,"Fisse Disattivate"),t()(),i(23,"div",6)(24,"div",73),a(25),t()()(),i(26,"div",2)(27,"div",3)(28,"span",74),a(29,"receipt"),t(),i(30,"h3",5),a(31,"Variabili Disattivate"),t()(),i(32,"div",6)(33,"div",75),a(34),t()()()(),i(35,"div",76)(36,"div",77)(37,"table",28)(38,"thead")(39,"tr")(40,"th"),a(41,"Nome"),t(),i(42,"th"),a(43,"Tipo"),t(),i(44,"th"),a(45,"Categoria"),t(),i(46,"th"),a(47,"Importo"),t(),i(48,"th"),a(49,"Fornitore"),t(),u(50,he,2,0,"th",29),i(51,"th"),a(52,"Note"),t(),i(53,"th"),a(54,"Data Disattivazione"),t(),i(55,"th"),a(56,"Azioni"),t()()(),i(57,"tbody"),u(58,Me,33,12,"tr",78)(59,be,7,3,"tr",29),t()()()()()),l&2){let e=d();s(16),_(" ",e.formatCurrency(e.deletedExpensesTotal)," "),s(9),_(" ",e.deletedFixedExpensesCount," "),s(9),_(" ",e.deletedVariableExpensesCount," "),s(16),m("ngIf",e.viewMode==="all"),s(8),m("ngForOf",e.filteredDeletedExpenses),s(),m("ngIf",e.filteredDeletedExpenses.length===0)}}function Te(l,n){l&1&&(i(0,"p",46)(1,"span",120),a(2,"info"),t(),a(3," Le spese fisse sono automaticamente ricorrenti "),t())}function Fe(l,n){l&1&&(i(0,"p",46)(1,"span",120),a(2,"info"),t(),a(3," Le spese variabili sono una tantum "),t())}function Ie(l,n){if(l&1&&(i(0,"option",107),a(1),t()),l&2){let e=n.$implicit;m("value",e),s(),_(" ",e," ")}}function Ve(l,n){if(l&1&&(i(0,"span"),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name,"")}}function ke(l,n){if(l&1&&(i(0,"option",107),a(1),u(2,Ve,2,1,"span",29),t()),l&2){let e=n.$implicit;m("value",e.id),s(),_(" ",e.company_name," "),s(),m("ngIf",e.contact_name)}}function De(l,n){l&1&&(i(0,"span",22),a(1,"repeat"),t())}function Oe(l,n){l&1&&(i(0,"span",22),a(1,"event"),t())}function Pe(l,n){l&1&&(i(0,"span"),a(1,"Spesa ricorrente"),t())}function We(l,n){l&1&&(i(0,"span"),a(1,"Spesa una tantum"),t())}function Ae(l,n){if(l&1){let e=S();i(0,"div",84)(1,"div",85)(2,"div",86)(3,"div",87)(4,"div",88)(5,"span",22),a(6),t()(),i(7,"div")(8,"h1",68),a(9),t(),u(10,Te,4,0,"p",53)(11,Fe,4,0,"p",53),t()(),i(12,"button",89),x("click",function(){c(e);let o=d();return g(o.closeExpenseModal())}),i(13,"span",22),a(14,"close"),t()()(),i(15,"form",90),x("submit",function(o){return c(e),d().saveExpense(),g(o.preventDefault())}),i(16,"div",91)(17,"div",92)(18,"div",18)(19,"label",93)(20,"span",22),a(21,"title"),t(),a(22," Nome Spesa * "),t(),i(23,"input",94),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.name,o)||(p.expenseForm.name=o),g(o)}),t()(),i(24,"div",18)(25,"label",95)(26,"span",22),a(27,"euro"),t(),a(28," Importo (\u20AC) * "),t(),i(29,"input",96),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.amount,o)||(p.expenseForm.amount=o),g(o)}),t()()(),i(30,"div",92)(31,"div",18)(32,"label",97)(33,"span",22),a(34,"category"),t(),a(35," Tipo * "),t(),i(36,"select",98),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.type,o)||(p.expenseForm.type=o),g(o)}),x("change",function(){c(e);let o=d();return g(o.onExpenseTypeChange())}),i(37,"option",99),a(38,"Spesa Fissa (ricorrente)"),t(),i(39,"option",100),a(40,"Spesa Variabile (una tantum)"),t()()(),i(41,"div",18)(42,"label",101)(43,"span",22),a(44,"label"),t(),a(45," Categoria * "),t(),i(46,"select",102),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.category,o)||(p.expenseForm.category=o),g(o)}),i(47,"option",103),a(48,"Seleziona categoria"),t(),u(49,Ie,2,2,"option",104),t()()(),i(50,"div",92)(51,"div",18)(52,"label",105),M(53,"lucide-angular",23),a(54," Fornitore "),t(),i(55,"select",106),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.supplier_id,o)||(p.expenseForm.supplier_id=o),g(o)}),i(56,"option",107),a(57,"Nessun fornitore"),t(),u(58,ke,3,3,"option",104),t()(),i(59,"div",108)(60,"button",109),x("click",function(){c(e);let o=d();return g(o.openSupplierModal())}),M(61,"lucide-angular",25),a(62," Nuovo "),t()()(),i(63,"div",92)(64,"div",18)(65,"label",110)(66,"span",22),a(67,"calendar_today"),t(),a(68," Mese * "),t(),i(69,"input",111),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.month,o)||(p.expenseForm.month=o),g(o)}),t()(),i(70,"div",112)(71,"div",113),u(72,De,2,0,"span",114)(73,Oe,2,0,"span",114)(74,Pe,2,0,"span",29)(75,We,2,0,"span",29),t()()(),i(76,"div",115)(77,"label",116)(78,"span",22),a(79,"notes"),t(),a(80," Note "),t(),i(81,"textarea",117),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.notes,o)||(p.expenseForm.notes=o),g(o)}),t()()(),i(82,"div",20)(83,"button",118),x("click",function(){c(e);let o=d();return g(o.closeExpenseModal())}),a(84," Annulla "),t(),i(85,"button",119),a(86),t()()()()()}if(l&2){let e=d();s(6),h(e.editingExpense?"edit":"add"),s(3),h(e.editingExpense?"Modifica Spesa":"Nuova Spesa"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(12),v("ngModel",e.expenseForm.name),s(6),v("ngModel",e.expenseForm.amount),s(7),v("ngModel",e.expenseForm.type),s(10),v("ngModel",e.expenseForm.category),s(3),m("ngForOf",e.getCategoriesByType(e.expenseForm.type)),s(4),m("size",20),s(2),v("ngModel",e.expenseForm.supplier_id),s(),m("value",null),s(2),m("ngForOf",e.suppliers),s(3),m("size",20),s(8),v("ngModel",e.expenseForm.month),s(2),m("ngClass",k(22,te,e.expenseForm.type==="fissa",e.expenseForm.type==="variabile")),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(6),v("ngModel",e.expenseForm.notes),s(5),_(" ",e.editingExpense?"Aggiorna":"Crea"," Spesa ")}}function Ne(l,n){if(l&1){let e=S();i(0,"button",123),x("click",function(){let o=c(e).$implicit,p=d(2);return g(p.changeMonth(o))}),a(1),t()}if(l&2){let e=n.$implicit,r=d(2);w("active",e===r.selectedMonth),s(),_(" ",r.formatMonth(e)," ")}}function Le(l,n){if(l&1){let e=S();i(0,"div",84)(1,"div",121)(2,"div",86)(3,"div",87)(4,"div",88)(5,"span",22),a(6,"calendar_today"),t()(),i(7,"div")(8,"h1",68),a(9,"Seleziona Mese"),t()()(),i(10,"button",89),x("click",function(){c(e);let o=d();return g(o.closeMonthsModal())}),i(11,"span",22),a(12,"close"),t()()(),i(13,"div",20),u(14,Ne,2,3,"button",122),t(),i(15,"div",20)(16,"button",118),x("click",function(){c(e);let o=d();return g(o.closeMonthsModal())}),a(17," Chiudi "),t()()()()}if(l&2){let e=d();s(14),m("ngForOf",e.availableMonths)}}function ze(l,n){if(l&1&&(i(0,"div",133)(1,"span",134),a(2),t(),i(3,"span",44),a(4),t()()),l&2){let e=n.$implicit;s(2),h(e.name),s(),w("active",e.type==="fissa")("warning",e.type==="variabile"),s(),_(" ",e.type==="entrambi"?"Entrambi":e.type==="fissa"?"Fisse":"Variabili"," ")}}function Be(l,n){l&1&&(i(0,"div",62)(1,"p"),a(2,"Nessuna categoria personalizzata creata"),t()())}function Re(l,n){if(l&1){let e=S();i(0,"div",84)(1,"div",121)(2,"div",86)(3,"div",87)(4,"div",88)(5,"span",22),a(6,"category"),t()(),i(7,"div")(8,"h1",68),a(9,"Gestione Categorie"),t()()(),i(10,"button",89),x("click",function(){c(e);let o=d();return g(o.closeCategoryModal())}),i(11,"span",22),a(12,"close"),t()()(),i(13,"div",91)(14,"div",124)(15,"h3",3),M(16,"lucide-angular",25),a(17," Nuova Categoria "),t(),i(18,"form",90),x("submit",function(o){return c(e),d().saveCategory(),g(o.preventDefault())}),i(19,"div",92)(20,"div",18)(21,"label",125)(22,"span",22),a(23,"title"),t(),a(24," Nome Categoria * "),t(),i(25,"input",126),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.name,o)||(p.categoryForm.name=o),g(o)}),t()(),i(26,"div",18)(27,"label",127)(28,"span",22),a(29,"filter_alt"),t(),a(30," Tipo "),t(),i(31,"select",128),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.type,o)||(p.categoryForm.type=o),g(o)}),i(32,"option",129),a(33,"Entrambi i tipi"),t(),i(34,"option",99),a(35,"Solo Spese Fisse"),t(),i(36,"option",100),a(37,"Solo Spese Variabili"),t()()()(),i(38,"div",10)(39,"div",20)(40,"button",118),x("click",function(){c(e);let o=d();return g(o.closeCategoryModal())}),a(41," Annulla "),t(),i(42,"button",119),a(43," Crea Categoria "),t()()()()(),i(44,"div")(45,"h3",3)(46,"span",22),a(47,"list"),t(),a(48," Categorie Esistenti "),t(),i(49,"div",130),u(50,ze,5,6,"div",131)(51,Be,3,0,"div",132),t()()()()()}if(l&2){let e=d();s(16),m("size",20),s(9),v("ngModel",e.categoryForm.name),s(6),v("ngModel",e.categoryForm.type),s(19),m("ngForOf",e.categories),s(),m("ngIf",e.categories.length===0)}}function je(l,n){if(l&1&&(i(0,"span",46),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name,"")}}function $e(l,n){if(l&1&&(i(0,"span",156),a(1),t()),l&2){let e=d().$implicit;s(),h(e.email)}}function Ue(l,n){if(l&1&&(i(0,"span",45),a(1),t()),l&2){let e=d().$implicit;s(),h(e.phone)}}function qe(l,n){if(l&1&&(i(0,"div",151)(1,"div",152)(2,"strong"),a(3),t(),u(4,je,2,1,"span",53),t(),i(5,"div",153),u(6,$e,2,1,"span",154)(7,Ue,2,1,"span",155),t()()),l&2){let e=n.$implicit;s(3),h(e.company_name),s(),m("ngIf",e.contact_name),s(2),m("ngIf",e.email),s(),m("ngIf",e.phone)}}function Ye(l,n){l&1&&(i(0,"div",62)(1,"p"),a(2,"Nessun fornitore creato"),t()())}function Ge(l,n){if(l&1){let e=S();i(0,"div",84)(1,"div",85)(2,"div",86)(3,"div",87)(4,"div",88)(5,"span",22),a(6,"local_shipping"),t()(),i(7,"div")(8,"h1",68),a(9,"Gestione Fornitori"),t()()(),i(10,"button",89),x("click",function(){c(e);let o=d();return g(o.closeSupplierModal())}),i(11,"span",22),a(12,"close"),t()()(),i(13,"div",91)(14,"div",124)(15,"h3",3),M(16,"lucide-angular",25),a(17," Nuovo Fornitore "),t(),i(18,"form",90),x("submit",function(o){return c(e),d().saveSupplier(),g(o.preventDefault())}),i(19,"div",92)(20,"div",18)(21,"label",135)(22,"span",22),a(23,"business"),t(),a(24," Nome Ditta * "),t(),i(25,"input",136),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.company_name,o)||(p.supplierForm.company_name=o),g(o)}),t()(),i(26,"div",18)(27,"label",137),M(28,"lucide-angular",138),a(29," Referente "),t(),i(30,"input",139),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.contact_name,o)||(p.supplierForm.contact_name=o),g(o)}),t()()(),i(31,"div",92)(32,"div",18)(33,"label",140),M(34,"lucide-angular",141),a(35," Email "),t(),i(36,"input",142),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.email,o)||(p.supplierForm.email=o),g(o)}),t()(),i(37,"div",18)(38,"label",143)(39,"span",22),a(40,"phone"),t(),a(41," Telefono "),t(),i(42,"input",144),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.phone,o)||(p.supplierForm.phone=o),g(o)}),t()()(),i(43,"div",115)(44,"label",145)(45,"span",22),a(46,"location_on"),t(),a(47," Indirizzo "),t(),i(48,"textarea",146),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.address,o)||(p.supplierForm.address=o),g(o)}),t()(),i(49,"div",115)(50,"label",147)(51,"span",22),a(52,"notes"),t(),a(53," Descrizione "),t(),i(54,"textarea",148),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.description,o)||(p.supplierForm.description=o),g(o)}),t()(),i(55,"div",20)(56,"button",118),x("click",function(){c(e);let o=d();return g(o.closeSupplierModal())}),a(57," Annulla "),t(),i(58,"button",119),a(59," Crea Fornitore "),t()()()(),i(60,"div")(61,"h3",3)(62,"span",22),a(63,"list"),t(),a(64," Fornitori Esistenti "),t(),i(65,"div",149),u(66,qe,8,4,"div",150)(67,Ye,3,0,"div",132),t()()()()()}if(l&2){let e=d();s(16),m("size",20),s(9),v("ngModel",e.supplierForm.company_name),s(3),m("size",20),s(2),v("ngModel",e.supplierForm.contact_name),s(4),m("size",20),s(2),v("ngModel",e.supplierForm.email),s(6),v("ngModel",e.supplierForm.phone),s(6),v("ngModel",e.supplierForm.address),s(6),v("ngModel",e.supplierForm.description),s(12),m("ngForOf",e.suppliers),s(),m("ngIf",e.suppliers.length===0)}}function Qe(l,n){if(l&1){let e=S();i(0,"div",84)(1,"div",157)(2,"div",86)(3,"div",87)(4,"div",88)(5,"span",22),a(6,"repeat"),t()(),i(7,"div")(8,"h1",68),a(9,"Modifica Spese Future"),t()()()(),i(10,"div",91)(11,"div",158)(12,"div",159)(13,"span",160),a(14,"info"),t()(),i(15,"h3",161),a(16,"La modifica \xE8 stata salvata"),t(),i(17,"p",162),a(18,' La spesa "'),i(19,"strong"),a(20),t(),a(21,'" \xE8 ricorrente.'),M(22,"br")(23,"br"),a(24," Vuoi applicare questa modifica anche a tutti i mesi futuri? "),t(),i(25,"div",163)(26,"div",164),x("click",function(){c(e);let o=d();return g(o.onlyCurrentMonth())}),i(27,"div",165)(28,"span",166),a(29,"today"),t(),i(30,"strong"),a(31,"Solo questo mese"),t()(),i(32,"p",46),a(33),t()(),i(34,"div",167),x("click",function(){c(e);let o=d();return g(o.applyToFutureMonths())}),i(35,"div",165)(36,"span",166),a(37,"date_range"),t(),i(38,"strong"),a(39,"Tutti i mesi futuri"),t()(),i(40,"p",46),a(41,"La modifica verr\xE0 applicata a partire dal mese successivo"),t()()()(),i(42,"div",20)(43,"button",118),x("click",function(){c(e);let o=d();return g(o.onlyCurrentMonth())}),i(44,"span",22),a(45,"today"),t(),a(46," Solo questo mese "),t(),i(47,"button",168),x("click",function(){c(e);let o=d();return g(o.applyToFutureMonths())}),i(48,"span",22),a(49,"date_range"),t(),a(50," Tutti i mesi futuri "),t()()()()()}if(l&2){let e=d();s(20),h(e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.name),s(13),_("La modifica verr\xE0 applicata solo a ",e.formatMonthDisplay((e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.month)||""),"")}}var ee=class l{expenseService=F(Z);supplierService=F(X);expenseSubscription;templatesSubscription;categoriesSubscription;suppliersSubscription;expenses=[];availableMonths=[];categories=[];suppliers=[];recurringTemplates=[];showDeletedExpenses=!1;selectedMonth=this.getCurrentMonth();viewMode="monthly";searchTerm="";showExpenseModal=!1;showMonthsModal=!1;showCategoryModal=!1;showSupplierModal=!1;editingExpense=null;showFutureMonthsConfirm=!1;pendingExpenseUpdate=null;recurringTemplateForm={name:"",amount:0,type:"fissa",category:"",notes:"",supplier_id:null,start_month:this.getCurrentMonth(),end_month:""};expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.getCurrentMonth(),notes:"",supplier_id:null,template_id:null};categoryForm={name:"",type:"entrambi"};supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""};showAllTemplates=!1;showDeletedSection=!1;deletedExpenses=[];loadingDeleted=!1;get monthlyStats(){return this.expenseService.calculateMonthlyTotal(this.filteredExpenses)}get filteredExpenses(){let n=this.expenses;if(this.viewMode==="monthly"&&(n=n.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();n=n.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return n}get allCategories(){let n=this.expenseService.getDefaultCategories(),e=this.categories.map(r=>r.name);return[...new Set([...n,...e])].sort()}getCategoriesByType(n){return this.allCategories.filter(e=>{let r=this.categories.find(o=>o.name===e);return r?r.type==="entrambi"||r.type===n:!0})}toggleDeletedSection(){return f(this,null,function*(){this.showDeletedSection=!this.showDeletedSection,this.showDeletedSection&&this.deletedExpenses.length===0&&(yield this.loadDeletedExpenses())})}loadDeletedExpenses(){return f(this,null,function*(){this.loadingDeleted=!0;try{this.viewMode==="monthly"?(console.log("\u{1F5D1}\uFE0F Loading deleted expenses for month:",this.selectedMonth),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForMonth(this.selectedMonth)):(console.log("\u{1F5D1}\uFE0F Loading ALL deleted expenses"),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForDateRange("2000-01-01","2030-12-01")),console.log("\u2705 Deleted expenses loaded:",this.deletedExpenses.length)}catch(n){console.error("\u274C Error loading deleted expenses:",n)}finally{this.loadingDeleted=!1}})}ngOnInit(){this.loadData()}ngOnDestroy(){this.expenseSubscription&&this.expenseSubscription.unsubscribe(),this.templatesSubscription&&this.templatesSubscription.unsubscribe(),this.categoriesSubscription&&this.categoriesSubscription.unsubscribe(),this.suppliersSubscription&&this.suppliersSubscription.unsubscribe()}loadData(){return f(this,null,function*(){try{console.log("\u{1F50D} Loading data for month:",this.selectedMonth),yield Promise.all([this.loadExpenses(),this.loadAvailableMonths(),this.loadCategories(),this.loadSuppliers(),this.loadRecurringTemplates()])}catch(n){console.error("\u274C Error loading data:",n)}})}loadRecurringTemplates(){return f(this,null,function*(){yield this.expenseService.loadRecurringTemplates(),this.templatesSubscription=this.expenseService.recurringTemplates$.subscribe(n=>{this.recurringTemplates=n,console.log("\u{1F4CB} Recurring templates loaded:",n.length)})})}loadSuppliers(){return f(this,null,function*(){yield this.supplierService.loadSuppliers(),this.suppliersSubscription=this.supplierService.suppliers$.subscribe(n=>{this.suppliers=n,console.log("\u{1F3E2} Suppliers loaded:",n.length)})})}loadExpenses(){return f(this,null,function*(){try{if(this.viewMode==="monthly")console.log("\u{1F4C5} Loading expenses for month:",this.selectedMonth),yield this.expenseService.loadExpensesForMonth(this.selectedMonth,!0),this.expenseSubscription=this.expenseService.data$.subscribe(n=>{this.expenses=n.filter(e=>!e.deleted_at),console.log("\u{1F4B0} Expenses loaded:",this.expenses.length)});else{console.log("\u{1F4CA} Loading ALL expenses");let n=yield this.expenseService.loadExpensesForDateRange("2000-01-01","2030-12-01");this.expenses=n.filter(e=>!e.deleted_at),console.log("\u{1F4CA} All expenses loaded:",this.expenses.length)}}catch(n){console.error("\u274C Error loading expenses:",n)}})}loadAvailableMonths(){return f(this,null,function*(){this.availableMonths=yield this.expenseService.getAvailableMonths(),console.log("\u{1F4C6} Available months:",this.availableMonths.length)})}loadCategories(){return f(this,null,function*(){yield this.expenseService.loadCategories(),this.categoriesSubscription=this.expenseService.categories$.subscribe(n=>{this.categories=n,console.log("\u{1F3F7}\uFE0F Categories loaded:",n.length)})})}getCurrentMonth(){let n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}formatMonthForInput(n){return n.match(/^\d{4}-\d{2}$/)?n:n.match(/^\d{4}-\d{2}-\d{2}$/)?n.substring(0,7):this.getCurrentMonth()}formatMonthForDatabase(n){if(n.match(/^\d{4}-\d{2}$/))return`${n}-01`;if(n.match(/^\d{4}-\d{2}-\d{2}$/))return n;let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-01`}formatMonthDisplay(n){try{return new Date(this.formatMonthForDatabase(n)).toLocaleDateString("it-IT",{month:"long",year:"numeric"})}catch{return n}}formatCurrency(n){return`\u20AC${n.toFixed(2).replace(".",",")}`}getSupplierName(n){if(!n)return"Nessun fornitore";let e=this.suppliers.find(r=>r.id===n);return e?e.company_name:"Fornitore sconosciuto"}openAddExpenseModal(){this.editingExpense=null,this.expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.formatMonthForInput(this.selectedMonth),notes:"",supplier_id:null,template_id:null},this.showExpenseModal=!0}openEditExpenseModal(n){console.log("\u{1F4DD} Opening edit modal for expense:",{id:n.id,name:n.name,template_id:n.template_id,month:n.month,amount:n.amount}),this.editingExpense=n,this.expenseForm={name:n.name,amount:n.amount,type:n.type,category:n.category,month:this.formatMonthForInput(n.month),notes:n.notes||"",supplier_id:n.supplier_id||null,template_id:n.template_id||null},this.showExpenseModal=!0}openCategoryModal(){this.categoryForm={name:"",type:"entrambi"},this.showCategoryModal=!0}openSupplierModal(){this.supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""},this.showSupplierModal=!0}closeExpenseModal(){this.showExpenseModal=!1,this.editingExpense=null}closeMonthsModal(){this.showMonthsModal=!1}closeCategoryModal(){this.showCategoryModal=!1}closeSupplierModal(){this.showSupplierModal=!1}saveExpense(){return f(this,null,function*(){if(console.log("\u{1F4BE} Starting saveExpense..."),console.log("\u{1F4CB} Form data:",this.expenseForm),console.log("\u270F\uFE0F Editing expense:",this.editingExpense),!this.expenseForm.name||!this.expenseForm.amount||!this.expenseForm.category){console.log("\u274C Validation failed: missing required fields"),alert("Compila tutti i campi obbligatori: Nome, Importo e Categoria");return}if(this.expenseForm.amount<=0){console.log("\u274C Validation failed: amount must be > 0"),alert("L'importo deve essere maggiore di 0");return}try{let n=C(b({},this.expenseForm),{month:this.formatMonthForDatabase(this.expenseForm.month),is_recurring:this.expenseForm.type==="fissa"});if(console.log("\u{1F4E4} Expense data to save:",n),console.log("\u{1F501} Is recurring (auto-determined):",n.is_recurring),this.editingExpense){if(console.log("\u{1F504} Updating existing expense:",this.editingExpense.id),!confirm(`Vuoi salvare le modifiche per la spesa "${this.editingExpense.name}"?`)){console.log("\u274C Save cancelled by user");return}let r=C(b({},n),{template_id:this.editingExpense.template_id||null});if(console.log("\u{1F4DD} Saving update for current month:",r),!(yield this.expenseService.update(this.editingExpense.id,r)))throw new Error("Update failed");if(console.log("\u2705 Expense updated successfully for current month"),this.editingExpense.type==="fissa"&&n.type==="fissa"){this.showFutureMonthsConfirm=!0,this.pendingExpenseUpdate={expenseId:this.editingExpense.id,expenseData:n,oldTemplateId:this.editingExpense.template_id||null};return}this.completeSaveOperation()}else{if(console.log("\u{1F195} Creating new expense"),!confirm(`Vuoi creare la nuova spesa "${n.name}"?`)){console.log("\u274C Save cancelled by user");return}if(n.type==="fissa"){let r={name:n.name,amount:n.amount,type:n.type,category:n.category,notes:n.notes||"",supplier_id:n.supplier_id,start_month:n.month};console.log("\u{1F4CB} Creating recurring template for fixed expense:",r);let o=yield this.expenseService.createRecurringTemplate(r);o&&(n.template_id=o.id,(yield this.expenseService.create(n))&&(console.log("\u2705 Fixed (recurring) expense created with template"),this.showSuccessAlert("Spesa fissa (ricorrente) creata con successo!")))}else n.is_recurring=!1,n.template_id=null,(yield this.expenseService.create(n))&&(console.log("\u2705 Variable (non-recurring) expense created"),this.showSuccessAlert("Spesa variabile creata con successo!"));this.completeSaveOperation()}}catch(n){console.error("\u274C Error saving expense:",n),this.showErrorAlert("Errore nel salvataggio della spesa: "+n.message)}})}applyToFutureMonths(){return f(this,null,function*(){if(this.pendingExpenseUpdate)try{let{expenseData:n,oldTemplateId:e}=this.pendingExpenseUpdate,r=this.getNextMonth(n.month),o={name:n.name,amount:n.amount,type:n.type,category:n.category,notes:n.notes||"",supplier_id:n.supplier_id,start_month:r};console.log("\u{1F4CB} Creating template for future months:",o);let p=yield this.expenseService.createRecurringTemplate(o);p&&(e&&(yield this.expenseService.updateRecurringTemplate(e,{is_active:!1,end_month:n.month})),yield this.expenseService.update(this.pendingExpenseUpdate.expenseId,{template_id:p.id}),console.log("\u2705 Created new template for future months"),this.showSuccessAlert("Modifica applicata a tutti i mesi futuri!"))}catch(n){console.error("\u274C Error applying to future months:",n),this.showErrorAlert("Errore nell'applicazione ai mesi futuri: "+n.message)}finally{this.completeSaveOperation()}})}onlyCurrentMonth(){return f(this,null,function*(){try{console.log("\u2705 Modification applied only to current month"),this.showSuccessAlert("Modifica applicata solo al mese corrente.")}finally{this.completeSaveOperation()}})}completeSaveOperation(){this.pendingExpenseUpdate=null,this.showFutureMonthsConfirm=!1,this.showExpenseModal=!1,this.editingExpense=null,this.loadExpenses()}showSuccessAlert(n){alert(n)}showErrorAlert(n){alert(n)}saveCategory(){return f(this,null,function*(){if(!this.categoryForm.name){alert("Inserisci un nome per la categoria");return}try{let n=C(b({},this.categoryForm),{is_active:!0});yield this.expenseService.createCategory(n),this.closeCategoryModal(),yield this.loadCategories(),alert("Categoria creata con successo!")}catch(n){console.error("Error saving category:",n),alert("Errore nella creazione della categoria")}})}saveSupplier(){return f(this,null,function*(){if(!this.supplierForm.company_name){alert("Inserisci il nome della ditta fornitrice");return}try{let n=C(b({},this.supplierForm),{user_id:null,is_platform_supplier:!1,is_approved:!0});yield this.supplierService.createSupplier(n),this.closeSupplierModal(),yield this.loadSuppliers(),alert("Fornitore creato con successo!")}catch(n){console.error("Error saving supplier:",n),alert("Errore nella creazione del fornitore")}})}openMonthsModal(){this.showMonthsModal=!0}formatMonth(n){return this.formatMonthDisplay(n)}deleteExpense(n){return f(this,null,function*(){if(confirm(`Sei sicuro di voler disattivare la spesa "${n.name}"?`))try{if(yield this.expenseService.update(n.id,{deleted_at:new Date().toISOString()}))yield this.loadExpenses(),alert("Spesa disattivata con successo!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("Error deleting expense:",e),alert("Errore nella disattivazione della spesa")}})}changeMonth(n){return f(this,null,function*(){console.log("\u{1F4C5} Changing month to:",n),this.selectedMonth=n,this.viewMode="monthly",yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses()),this.closeMonthsModal()})}changeViewMode(n){return f(this,null,function*(){this.viewMode=n,yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses())})}formatDeletedDate(n){if(!n)return"Non eliminata";try{return new Date(n).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return n}}onExpenseTypeChange(){this.expenseForm.category=""}deactivateRecurringTemplate(n){return f(this,null,function*(){if(confirm("Vuoi disattivare questo template ricorrente? Le spese gi\xE0 generate rimarranno ma non se ne genereranno di nuove."))try{(yield this.expenseService.updateRecurringTemplate(n,{is_active:!1}))&&(yield this.expenseService.loadRecurringTemplates(),alert("Template disattivato con successo"))}catch(e){console.error("Error deactivating template:",e),alert("Errore nella disattivazione del template")}})}debugExpenses(){console.log("\u{1F50D} DEBUG - Current expenses:",this.expenses),console.log("\u{1F50D} DEBUG - Selected month:",this.selectedMonth),console.log("\u{1F50D} DEBUG - Filtered expenses:",this.filteredExpenses)}getNextMonth(n){try{if(n.match(/^\d{4}-\d{2}-\d{2}$/)){let r=new Date(n);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}if(n.match(/^\d{4}-\d{2}$/)){let r=new Date(`${n}-01`);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}let e=new Date;return e.setMonth(e.getMonth()+1),e.toISOString().split("T")[0]}catch(e){console.error("\u274C Error calculating next month:",e);let r=new Date;return r.setMonth(r.getMonth()+1),`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-01`}}toggleExpenseStatus(n){return f(this,null,function*(){let e=n.is_active&&n.deleted_at===null,r=e?"disattivare":"attivare",o=e?"disattivata":"attivata";if(confirm(`Vuoi ${r} la spesa "${n.name}"?`))try{console.log(`\u{1F504} Cambiando stato della spesa "${n.name}" da attiva=${e} a attiva=${!e}`);let p=e?{deleted_at:new Date().toISOString(),is_active:!1}:{deleted_at:null,is_active:!0};if(yield this.expenseService.update(n.id,p))e?(this.deletedExpenses=[...this.deletedExpenses,b(b({},n),p)],this.expenses=this.expenses.filter(T=>T.id!==n.id)):(this.expenses=[...this.expenses,b(b({},n),p)],this.deletedExpenses=this.deletedExpenses.filter(T=>T.id!==n.id)),console.log(`\u2705 Spesa ${o}:`,n.name),alert(`Spesa ${o} con successo!`);else throw new Error("Operazione non riuscita")}catch(p){console.error("\u274C Errore nel cambiamento di stato:",p),alert("Errore nel cambiamento di stato della spesa")}})}toggleTemplatesView(){this.showAllTemplates=!this.showAllTemplates}get deletedExpensesTotal(){return this.deletedExpenses.reduce((n,e)=>n+e.amount,0)}get deletedFixedExpensesCount(){return this.deletedExpenses.filter(n=>n.type==="fissa").length}get deletedVariableExpensesCount(){return this.deletedExpenses.filter(n=>n.type==="variabile").length}get filteredDeletedExpenses(){let n=this.deletedExpenses;if(this.viewMode==="monthly"&&(n=n.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();n=n.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return n}permanentlyDeleteExpense(n){return f(this,null,function*(){if(confirm(`Sei sicuro di voler eliminare definitivamente la spesa "${n.name}"?
Questa azione \xE8 irreversibile e non potrai recuperare i dati!`))try{if(yield this.expenseService.hardDelete(n.id))this.deletedExpenses=this.deletedExpenses.filter(r=>r.id!==n.id),alert("Spesa eliminata definitivamente!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("\u274C Error permanently deleting expense:",e),alert("Errore nell'eliminazione definitiva della spesa")}})}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=V({type:l,selectors:[["app-expense-management"]],decls:95,vars:27,consts:[[1,"page-container"],["data-tutorial","expenses-cards",1,"grid-cards","p-sm"],[1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"flex","flex-col","gap-md"],[1,"text-md","font-bold","text-primary","text-amber-500","justify-center","flex"],[1,"form-card","mt-lg"],["data-tutorial","expenses-filters",1,"flex","justify-between","items-end","gap-sm","flex-wrap"],[1,"form-row"],[1,"flex","flex-col","mb-sm"],[1,"standard-label"],[1,"flex","gap-md","flex-wrap"],[1,"radio-label"],["type","radio","name","viewMode",3,"ngModelChange","change","value","ngModel"],[1,"radio-checkmark"],["class","flex flex-col mb-sm",4,"ngIf"],[1,"form-group"],["type","text","placeholder","Cerca per nome, categoria, fornitore...",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"promethea-button","ghost",3,"click"],[1,"material-icons"],["name","truck",1,"nav-icon",3,"size"],[1,"promethea-button",3,"click"],["name","plus",3,"size"],["class","form-card mt-lg",4,"ngIf"],["data-tutorial","expenses-table",1,"table-section","p-sm"],[1,"crm-table"],[4,"ngIf"],["class","hover-lift transition",3,"inactive-row",4,"ngFor","ngForOf"],["class","mt-lg",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"flex","justify-between","items-center","mb-md"],[1,"flex","items-center","gap-sm"],["class","promethea-button ghost small",3,"click",4,"ngIf"],[1,"templates-container"],["class","card template-card",3,"hidden-card",4,"ngFor","ngForOf"],["class","text-center mt-sm text-muted",4,"ngIf"],[1,"promethea-button","ghost","small",3,"click"],[1,"card","template-card"],[1,"flex","justify-between","items-start"],[1,"font-bold"],[1,"flex","gap-sm","mt-sm","flex-wrap"],[1,"chip"],[1,"chip","secondary"],[1,"text-muted"],["title","Disattiva",1,"icon-button","small",3,"click"],[1,"mt-sm","text-sm","text-muted"],[1,"text-center","mt-sm","text-muted"],[1,"hover-lift","transition"],["class","material-icons text-primary fs-sm","title","Spesa ricorrente",4,"ngIf"],["class","chip primary",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"notes-preview"],[1,"flex","gap-sm"],[1,"icon-button",3,"click","title"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["name","trash-2",3,"size"],["title","Spesa ricorrente",1,"material-icons","text-primary","fs-sm"],[1,"chip","primary"],[1,"text-center","p-xl","opacity-70"],[1,"flex","flex-col","items-center","gap-md"],[1,"material-icons","text-muted",2,"font-size","3rem"],[1,"mt-lg"],[1,"section-header"],[1,"material-icons","fs-lg","text-red-500"],[1,"section-title"],[1,"grid-cards"],[1,"material-icons","text-red-500","text-md"],[1,"text-md","font-bold","text-red-500","justify-center","flex"],[1,"material-icons","text-blue-500","text-md"],[1,"text-md","font-bold","text-blue-500","justify-center","flex"],[1,"material-icons","text-purple-500","text-md"],[1,"text-md","font-bold","text-purple-500","justify-center","flex"],[1,"table-section"],[1,"bg-body","border","rounded-lg","overflow-hidden","shadow-card","backdrop-blur"],["class","deleted-row hover-lift transition",4,"ngFor","ngForOf"],[1,"deleted-row","hover-lift","transition"],[1,"text-sm","text-muted"],["title","Riattiva spesa",1,"icon-button","success",3,"click"],["title","Visualizza",1,"icon-button",3,"click"],["title","Elimina definitivamente",1,"icon-button","danger",3,"click"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"flex"],[1,"header-icon"],[1,"icon-button","close-button",3,"click"],[1,"generic-form",3,"submit"],[1,"form-card"],[1,"form-row","mb-md"],["for","expense-name",1,"standard-label"],["type","text","id","expense-name","name","name","required","","placeholder","Es. Affitto locale",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-amount",1,"standard-label"],["type","number","id","expense-amount","name","amount","step","0.01","min","0","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-type",1,"standard-label"],["id","expense-type","name","type","required","",1,"form-input",3,"ngModelChange","change","ngModel"],["value","fissa"],["value","variabile"],["for","expense-category",1,"standard-label"],["id","expense-category","name","category","required","",1,"form-input",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","expense-supplier",1,"standard-label"],["id","expense-supplier","name","supplier_id",1,"form-input",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-group",2,"justify-content","flex-end"],["type","button",1,"promethea-button","secondary","small",3,"click"],["for","expense-month",1,"standard-label"],["type","month","id","expense-month","name","month","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-group",2,"justify-content","center"],[1,"info-box",3,"ngClass"],["class","material-icons",4,"ngIf"],[1,"form-group","mb-md"],["for","expense-notes",1,"standard-label"],["id","expense-notes","name","notes","rows","3","placeholder","Note aggiuntive...",1,"form-input",3,"ngModelChange","ngModel"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button"],[1,"material-icons","text-primary","fs-sm"],[1,"modal-container","modal-md"],["class","month-item promethea-button ghost",3,"active","click",4,"ngFor","ngForOf"],[1,"month-item","promethea-button","ghost",3,"click"],[1,"mb-lg"],["for","category-name",1,"standard-label"],["type","text","id","category-name","name","name","required","","placeholder","Es. Manutenzione impianti",1,"form-input",3,"ngModelChange","ngModel"],["for","category-type",1,"standard-label"],["id","category-type","name","type","required","",1,"form-input",3,"ngModelChange","ngModel"],["value","entrambi"],[1,"categories-list"],["class","category-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],["class","text-center p-xl opacity-70",4,"ngIf"],[1,"category-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"category-name","font-semibold"],["for","supplier-company",1,"standard-label"],["type","text","id","supplier-company","name","company_name","required","","placeholder","Nome della ditta fornitrice",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-contact",1,"standard-label"],["name","user",1,"nav-icon",3,"size"],["type","text","id","supplier-contact","name","contact_name","placeholder","Nome del referente",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-email",1,"standard-label"],["name","mail",1,"nav-icon",3,"size"],["type","email","id","supplier-email","name","email","placeholder","email@fornitore.com",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-phone",1,"standard-label"],["type","tel","id","supplier-phone","name","phone","placeholder","Numero di telefono",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-address",1,"standard-label"],["id","supplier-address","name","address","rows","2","placeholder","Indirizzo del fornitore",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-description",1,"standard-label"],["id","supplier-description","name","description","rows","3","placeholder","Note aggiuntive sul fornitore",1,"form-input",3,"ngModelChange","ngModel"],[1,"suppliers-list"],["class","supplier-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],[1,"supplier-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"supplier-info"],[1,"supplier-details","flex","gap-sm"],["class","chip active",4,"ngIf"],["class","chip secondary",4,"ngIf"],[1,"chip","active"],[1,"modal-container","modal-sm"],[1,"confirmation-message"],[1,"confirmation-icon","flex","justify-center","mb-md"],[1,"material-icons","text-primary","fs-lg"],[1,"text-center","mb-md"],[1,"text-center","mb-lg"],[1,"confirmation-options","mb-lg"],[1,"option-item","border","rounded","p-md","mb-md","cursor-pointer","hover:bg-smoke",3,"click"],[1,"flex","items-center","gap-sm","mb-sm"],[1,"material-icons","text-primary"],[1,"option-item","border","rounded","p-md","cursor-pointer","hover:bg-smoke",3,"click"],["type","button",1,"promethea-button",3,"click"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),a(5,"payments"),t(),i(6,"h3",5),a(7,"Spese Fisse"),t()(),i(8,"div",6)(9,"div",7),a(10),t()()(),i(11,"div",2)(12,"div",3)(13,"span",4),a(14,"receipt"),t(),i(15,"h3",5),a(16,"Spese Variabili"),t()(),i(17,"div",6)(18,"div",7),a(19),t()()(),i(20,"div",2)(21,"div",3)(22,"span",4),a(23,"account_balance"),t(),i(24,"h3",5),a(25,"Totale Mese"),t()(),i(26,"div",6)(27,"div",7),a(28),t()()()(),i(29,"div",8)(30,"div",9)(31,"div",10)(32,"div",11)(33,"label",12),a(34,"Periodo"),t(),i(35,"div",13)(36,"label",14)(37,"input",15),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),x("change",function(){return r.changeViewMode("monthly")}),t(),M(38,"span",16),i(39,"span"),a(40,"Mensile"),t()(),i(41,"label",14)(42,"input",15),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),x("change",function(){return r.changeViewMode("all")}),t(),M(43,"span",16),i(44,"span"),a(45,"Tutti"),t()()()(),u(46,ne,7,1,"div",17),t(),i(47,"div",18)(48,"label",12),a(49,"Cerca"),t(),i(50,"input",19),y("ngModelChange",function(p){return E(r.searchTerm,p)||(r.searchTerm=p),p}),t()()(),i(51,"div",20)(52,"button",21),x("click",function(){return r.toggleDeletedSection()}),i(53,"span",22),a(54),t(),a(55),t(),i(56,"button",21),x("click",function(){return r.openCategoryModal()}),i(57,"span",22),a(58,"category"),t(),a(59," Aggiungi Categorie "),t(),i(60,"button",21),x("click",function(){return r.openSupplierModal()}),M(61,"lucide-angular",23),a(62," Aggiungi Fornitori "),t(),i(63,"button",24),x("click",function(){return r.openAddExpenseModal()}),M(64,"lucide-angular",25),a(65," Nuova Spesa "),t()()(),u(66,se,11,8,"div",26),i(67,"div",27)(68,"table",28)(69,"thead")(70,"tr")(71,"th"),a(72,"Nome"),t(),i(73,"th"),a(74,"Tipo"),t(),i(75,"th"),a(76,"Categoria"),t(),i(77,"th"),a(78,"Importo"),t(),i(79,"th"),a(80,"Fornitore"),t(),u(81,le,2,0,"th",29),i(82,"th"),a(83,"Note"),t(),i(84,"th"),a(85,"Azioni"),t()()(),i(86,"tbody"),u(87,ge,30,18,"tr",30)(88,_e,10,4,"tr",29),t()()(),u(89,Ce,60,6,"div",31)(90,Ae,87,25,"div",32)(91,Le,18,1,"div",32)(92,Re,52,5,"div",32)(93,Ge,68,11,"div",32)(94,Qe,51,2,"div",32),t()),e&2&&(s(10),h(r.formatCurrency(r.monthlyStats.fisse)),s(9),h(r.formatCurrency(r.monthlyStats.variabili)),s(9),h(r.formatCurrency(r.monthlyStats.totale)),s(8),w("active",r.viewMode==="monthly"),s(),m("value","monthly"),v("ngModel",r.viewMode),s(4),w("active",r.viewMode==="all"),s(),m("value","all"),v("ngModel",r.viewMode),s(4),m("ngIf",r.viewMode==="monthly"),s(4),v("ngModel",r.searchTerm),s(4),h(r.showDeletedSection?"visibility_off":"archive"),s(),_(" ",r.showDeletedSection?"Nascondi Disattivate":"Mostra Disattivate"," "),s(6),m("size",20),s(3),m("size",20),s(2),m("ngIf",r.recurringTemplates.length>0),s(15),m("ngIf",r.viewMode==="all"),s(6),m("ngForOf",r.filteredExpenses),s(),m("ngIf",r.filteredExpenses.length===0),s(),m("ngIf",r.showDeletedSection),s(),m("ngIf",r.showExpenseModal),s(),m("ngIf",r.showMonthsModal),s(),m("ngIf",r.showCategoryModal),s(),m("ngIf",r.showSupplierModal),s(),m("ngIf",r.showFutureMonthsConfirm))},dependencies:[W,D,O,P,H,R,q,Y,A,j,U,$,N,L,Q,G,B,z,K,J],styles:['.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);border:1px solid var(--smoke-1);border-radius:12px;cursor:pointer;transition:all .3s ease;background:var(--background)}.radio-label[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translateY(-2px)}.radio-label.active[_ngcontent-%COMP%]{background:var(--smoke-2);border-color:var(--primary);color:var(--primary)}.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.radio-checkmark[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid var(--smoke-1);border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background:var(--primary)}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]:after{content:"";width:8px;height:8px;background:#fff;border-radius:50%}.table-section[_ngcontent-%COMP%]{margin-top:var(--gap-lg)}.chip.small[_ngcontent-%COMP%]{padding:.125rem .5rem;font-size:.75rem}.chip.primary[_ngcontent-%COMP%]{background:var(--smoke-2);color:var(--primary);border-color:var(--smoke-2)}.notes-preview[_ngcontent-%COMP%]{max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-muted)}.input-group[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);align-items:stretch}.input-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;min-width:0}.input-group[_ngcontent-%COMP%]   .promethea-button.small[_ngcontent-%COMP%]{padding:var(--gap-sm);white-space:nowrap;flex-shrink:0}.months-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:var(--gap-sm);margin-bottom:var(--gap-lg)}.categories-list[_ngcontent-%COMP%], .suppliers-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.category-item[_ngcontent-%COMP%], .supplier-item[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;padding:var(--gap-sm);border:1px solid var(--smoke-1);border-radius:12px;transition:all .3s ease}.category-item[_ngcontent-%COMP%]:hover, .supplier-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translate(4px)}.supplier-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);flex-wrap:wrap}@media (max-width: 768px){.flex.justify-between[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{align-self:stretch}.input-group[_ngcontent-%COMP%]{flex-direction:column}.supplier-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{align-self:stretch;justify-content:flex-start}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.recurring-templates-list[_ngcontent-%COMP%], .template-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.template-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);transform-origin:top}.template-card.hidden[_ngcontent-%COMP%]{transform:scaleY(0);opacity:0;height:0;margin:0;padding:0;border:none;overflow:hidden}.grid-cards[_ngcontent-%COMP%]{transition:all .3s ease}.additional-templates[_ngcontent-%COMP%]{margin-top:var(--gap-md);animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}.animate-expand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_expand{0%{opacity:0;transform:translateY(-10px);max-height:0}to{opacity:1;transform:translateY(0);max-height:1000px}}.templates-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:grid-template-rows .3s ease}.templates-container.collapsed[_ngcontent-%COMP%]{grid-template-rows:repeat(auto-fit,minmax(0,1fr));max-height:calc(3 * (var(--gap-md) + 150px));overflow:visible}.templates-container.expanded[_ngcontent-%COMP%]{grid-template-rows:auto;max-height:none;overflow:visible}.template-card.hidden-card[_ngcontent-%COMP%]{display:none!important;opacity:0;transform:scale(.8);height:0;margin:0;padding:0;border:none;pointer-events:none}.templates-container-alt[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:max-height .5s cubic-bezier(.4,0,.2,1)}.templates-container-alt.collapsed[_ngcontent-%COMP%]{max-height:540px;overflow:hidden;mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%);-webkit-mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%)}.templates-container-alt.expanded[_ngcontent-%COMP%]{max-height:5000px;mask-image:none;-webkit-mask-image:none}']})};export{ee as ExpenseManagement};
