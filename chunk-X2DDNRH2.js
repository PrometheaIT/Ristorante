import{a as ie,b as P}from"./chunk-IBXDNXCO.js";import"./chunk-NY2YDINH.js";import{Ab as ee,zb as Z}from"./chunk-N3VPFYDE.js";import{a as te}from"./chunk-H4E5DJY3.js";import{A as X,b as G,d as J,i as K}from"./chunk-45CSFDAZ.js";import{d as Y}from"./chunk-TB7INTC7.js";import{c as W,e as U,f as q}from"./chunk-Q3EITIAW.js";import"./chunk-RC3HHTXM.js";import{k as Q,l as B,p as N,v as H}from"./chunk-MPTEMNWF.js";import{Cb as V,Hb as z,Ia as w,Ib as l,Jb as b,Kb as f,La as s,Ob as $,Pb as F,Qb as L,Va as D,Vb as R,Wb as j,Zb as A,_a as u,ca as x,gb as d,hb as O,ib as y,la as m,ma as _,qb as o,rb as a,s as C,sb as M,t as I,tb as k,ub as T,vb as v,yb as g,zb as c}from"./chunk-5BU4UD4M.js";import{a as E,b as S,g as h}from"./chunk-RA2WU32H.js";function ae(t,i){if(t&1){let e=v();o(0,"button",11),g("click",function(){m(e);let r=c();return _(r.authService.toggleSidebar())}),l(1,"cccccccc "),M(2,"lucide-icon",12),a()}}function oe(t,i){if(t&1){let e=v();o(0,"img",13),g("error",function(r){m(e);let p=c();return _(p.onLogoError(r))}),a()}if(t&2){let e=c();d("src",e.restaurant==null?null:e.restaurant.logo_url,w)("alt",e.restaurant==null?null:e.restaurant.name)}}function se(t,i){t&1&&(o(0,"span",14),l(1,"restaurant"),a())}function le(t,i){t&1&&(o(0,"span",36),l(1,"star"),a())}function ce(t,i){if(t&1){let e=v();o(0,"button",24),g("click",function(){let r=m(e).$implicit,p=c(4);return _(p.selectMenu(r))}),l(1),u(2,le,2,0,"span",35),a()}if(t&2){let e=i.$implicit,n=c(4);y("active",(n.selectedMenu==null?null:n.selectedMenu.id)===e.id),s(),f(" ",e.name," "),s(),d("ngIf",e.is_default)}}function de(t,i){if(t&1&&(o(0,"p",37),l(1),a()),t&2){let e=c(4);s(),f(" ",e.selectedMenu==null?null:e.selectedMenu.description," ")}}function pe(t,i){if(t&1&&(o(0,"div",19)(1,"div",32)(2,"span",33),l(3,"Menu:"),a(),u(4,ce,3,4,"button",25),a(),u(5,de,2,1,"p",34),a()),t&2){let e=c(3);s(4),d("ngForOf",e.menus),s(),d("ngIf",e.selectedMenu==null?null:e.selectedMenu.description)}}function ue(t,i){if(t&1){let e=v();o(0,"button",24),g("click",function(){let r=m(e).$implicit,p=c(3);return _(p.selectCategory(r.id))}),l(1),a()}if(t&2){let e=i.$implicit,n=c(3);y("active",n.selectedCategory===e.id),s(),f(" ",e.name," ")}}function me(t,i){if(t&1){let e=v();o(0,"img",56),g("error",function(r){m(e);let p=c().$implicit,re=c(4);return _(re.onDishImageError(r,p))}),a()}if(t&2){let e=c().$implicit;d("src",e.image_url,w)("alt",e.name)}}function _e(t,i){t&1&&(o(0,"div",57),M(1,"lucide-angular",58),a()),t&2&&(s(),d("size",24))}function ge(t,i){if(t&1&&(k(0),l(1),T()),t&2){let e=c().$implicit,n=c(4);s(),f(" ",n.formatPrice(e.base_price)," ")}}function fe(t,i){if(t&1&&(o(0,"p",59),l(1),a()),t&2){let e=c().$implicit;s(),f(" ",e.description," ")}}function ve(t,i){if(t&1&&(o(0,"span",62)(1,"span",14),l(2,"delivery_dining"),a(),l(3),a()),t&2){let e=c(2).$implicit,n=c(4);s(3),f(" ",n.formatPrice(e.delivery_price)," ")}}function xe(t,i){if(t&1&&(o(0,"span",62)(1,"span",14),l(2,"takeout_dining"),a(),l(3),a()),t&2){let e=c(2).$implicit,n=c(4);s(3),f(" ",n.formatPrice(e.takeaway_price)," ")}}function he(t,i){if(t&1&&(o(0,"div",60),u(1,ve,4,1,"span",61)(2,xe,4,1,"span",61),a()),t&2){let e=c().$implicit;s(),d("ngIf",e.delivery_price),s(),d("ngIf",e.takeaway_price)}}function ye(t,i){if(t&1){let e=v();o(0,"div",44)(1,"div",45),u(2,me,1,2,"img",46)(3,_e,2,1,"div",47),a(),o(4,"div",48)(5,"div",49)(6,"h3",50),l(7),a(),o(8,"span",51),u(9,ge,2,1,"ng-container",52),a()(),u(10,fe,2,1,"p",53)(11,he,3,2,"div",54),o(12,"button",55),g("click",function(){let r=m(e).$implicit,p=c(4);return _(p.addToCart(r))}),o(13,"span",14),l(14,"add_shopping_cart"),a(),l(15," Aggiungi "),a()()()}if(t&2){let e=i.$implicit,n=c(4);s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(4),b(e.name),s(2),d("ngIf",!(n.selectedMenu!=null&&n.selectedMenu.fixed_price)),s(),d("ngIf",e.description),s(),d("ngIf",!(n.selectedMenu!=null&&n.selectedMenu.fixed_price))}}function Me(t,i){if(t&1&&(o(0,"div",38)(1,"div",39)(2,"h2",40),l(3),a(),o(4,"span",41),l(5),a()(),o(6,"div",42),u(7,ye,16,6,"div",43),a()()),t&2){let e=i.$implicit;s(3),b(e.name),s(2),f("",e.dishes.length," piatti"),s(2),d("ngForOf",e.dishes)}}function be(t,i){if(t&1){let e=v();o(0,"div",63)(1,"span",64),l(2,"search_off"),a(),o(3,"h3"),l(4,"Nessun piatto trovato"),a(),o(5,"p",9),l(6,"Prova a modificare la ricerca o i filtri"),a(),o(7,"button",65),g("click",function(){m(e);let r=c(3);return r.searchQuery="",_(r.selectedCategory=null)}),o(8,"span",14),l(9,"refresh"),a(),l(10," Mostra tutto il menu "),a()()}}function Ce(t,i){if(t&1&&(o(0,"div",66)(1,"div",67),M(2,"lucide-icon",68),o(3,"div")(4,"p",69),l(5,"Menu a prezzo fisso"),a(),o(6,"p",70),l(7,"Tutti i piatti inclusi al prezzo unico"),a()()(),o(8,"span",71),l(9),a()()),t&2){let e=c(3);s(2),d("size",24),s(7),f(" ",e.formatPrice(e.selectedMenu.fixed_price)," ")}}function we(t,i){if(t&1){let e=v();o(0,"div",17),u(1,pe,6,2,"div",18),o(2,"div",19)(3,"div",20)(4,"div",21)(5,"span",14),l(6,"search"),a(),o(7,"input",22),L("ngModelChange",function(r){m(e);let p=c(2);return F(p.searchQuery,r)||(p.searchQuery=r),_(r)}),g("input",function(){m(e);let r=c(2);return _(r.onSearchChange())}),a()(),o(8,"div",23)(9,"button",24),g("click",function(){m(e);let r=c(2);return _(r.selectCategory(null))}),l(10," Tutto "),a(),u(11,ue,2,3,"button",25),a()()(),o(12,"div",26),u(13,Me,8,3,"div",27)(14,be,11,0,"div",28),a(),u(15,Ce,10,2,"div",29),o(16,"div",30)(17,"button",31)(18,"span",14),l(19,"arrow_back"),a(),l(20," Torna al ristorante "),a()()()}if(t&2){let e=c(2);s(),d("ngIf",e.menus.length>1),s(6),$("ngModel",e.searchQuery),s(2),y("active",!e.selectedCategory),s(2),d("ngForOf",e.categories),s(2),d("ngForOf",e.filteredCategories),s(),d("ngIf",e.filteredCategories.length===0),s(),d("ngIf",e.selectedMenu==null?null:e.selectedMenu.fixed_price),s(2),V("routerLink","/customer/restaurant/",e.restaurant.id,"")}}function Pe(t,i){if(t&1&&(o(0,"div",15),u(1,we,21,10,"div",16),a()),t&2){let e=c();s(),d("ngIf",e.restaurant)}}function Ee(t,i){t&1&&(o(0,"div",15)(1,"div",72)(2,"span",73),l(3,"sync"),a(),o(4,"p"),l(5,"Caricamento menu..."),a()()())}var ne=class t{restaurantPublicService=x(te);router=x(U);route=x(W);breakpointObserver=x(ie);authService=x(Y);restaurant=null;menus=[];selectedMenu=null;categories=[];loading=!0;searchQuery="";selectedCategory=null;isMobile$=this.breakpointObserver.observe([P.Handset,P.TabletPortrait]).pipe(C(i=>i.matches));showToggle$=I([this.isMobile$,this.authService.sidebarCollapsed$]).pipe(C(([i,e])=>i&&e));ngOnInit(){return h(this,null,function*(){let i=this.route.snapshot.paramMap.get("id");i?yield this.loadMenuData(i):this.router.navigate(["/customer/search"])})}loadMenuData(i){return h(this,null,function*(){try{this.loading=!0;let[e,n,r]=yield Promise.all([this.restaurantPublicService.loadRestaurantById(i),this.restaurantPublicService.loadRestaurantMenus(i),this.restaurantPublicService.loadRestaurantCategories(i)]);if(this.restaurant=e,this.menus=n,!n.length){this.categories=[];return}this.selectedMenu=n.find(p=>p.is_default)??n[0],yield this.loadDishesForMenu(this.selectedMenu.id,r)}catch(e){console.error("Error loading menu data:",e)}finally{this.loading=!1}})}loadDishesForMenu(i,e){return h(this,null,function*(){let n=e??(yield this.restaurantPublicService.loadRestaurantCategories(this.restaurant.id)),r=yield this.restaurantPublicService.loadMenuDishes(i);this.groupDishesByCategory(r,n),this.searchQuery="",this.selectedCategory=null})}selectMenu(i){return h(this,null,function*(){this.selectedMenu?.id!==i.id&&(this.selectedMenu=i,this.loading=!0,yield this.loadDishesForMenu(i.id),this.loading=!1)})}groupDishesByCategory(i,e){let n=new Map;e.forEach(r=>{n.set(r.id,{id:r.id,name:r.name,description:r.description||"",dishes:[]})}),n.set("uncategorized",{id:"uncategorized",name:"Specialit\xE0",description:"Le nostre specialit\xE0",dishes:[]}),i.forEach(r=>{r.category_id&&n.has(r.category_id)?n.get(r.category_id).dishes.push(r):r.category_name&&!n.has(r.category_id||"unknown")?n.set(r.category_id||"unknown",{id:r.category_id||"unknown",name:r.category_name,description:"",dishes:[r]}):n.get("uncategorized").dishes.push(r)}),this.categories=Array.from(n.values()).filter(r=>r.dishes.length>0).sort((r,p)=>r.id==="uncategorized"?1:p.id==="uncategorized"?-1:r.name.localeCompare(p.name))}get filteredCategories(){return!this.searchQuery&&!this.selectedCategory?this.categories:this.categories.reduce((i,e)=>{if(this.selectedCategory&&e.id!==this.selectedCategory)return i;let n=this.searchQuery?e.dishes.filter(r=>{let p=this.searchQuery.toLowerCase();return r.name.toLowerCase().includes(p)||r.description?.toLowerCase().includes(p)||r.category_name?.toLowerCase().includes(p)}):[...e.dishes];return n.length>0&&i.push(S(E({},e),{dishes:n})),i},[])}selectCategory(i){this.selectedCategory=i===this.selectedCategory?null:i}onSearchChange(){}addToCart(i){console.log("Aggiunto al carrello:",i)}formatPrice(i){return`\u20AC${i.toFixed(2).replace(".",",")}`}onDishImageError(i,e){i.target.style.display="none"}onLogoError(i){i.target.style.display="none"}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=D({type:t,selectors:[["app-menu-display"]],decls:15,vars:10,consts:[["loadingTemplate",""],[1,"section-header"],[1,"flex","items-center","items-center","gap-lg",2,"overflow","hidden"],["class","icon-button mobile-toggle",3,"click",4,"ngIf"],[1,"header-icon"],["class","logo-image rounded-full",3,"src","alt","error",4,"ngIf"],["class","material-icons",4,"ngIf"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],["class","page-container",4,"ngIf","ngIfElse"],[1,"icon-button","mobile-toggle",3,"click"],["name","menu"],[1,"logo-image","rounded-full",3,"error","src","alt"],[1,"material-icons"],[1,"page-container"],["class","flex flex-col gap-lg mt-lg m-sm02",4,"ngIf"],[1,"flex","flex-col","gap-lg","mt-lg","m-sm02"],["class","card m-sm01 ",4,"ngIf"],[1,"card","m-sm01"],[1,"flex","flex-col","md:flex-row","gap-md","items-center","justify-between"],[1,"search-bar","flex-1"],["type","text","placeholder","Cerca nel menu...",3,"ngModelChange","input","ngModel"],[1,"filter-chips","flex","flex-wrap","gap-sm"],[1,"chip",3,"click"],["class","chip",3,"active","click",4,"ngFor","ngForOf"],[1,"flex","flex-col","gap-md","m-sm01"],["class","category-section",4,"ngFor","ngForOf"],["class","text-center p-xl",4,"ngIf"],["class","fixed-price-banner card flex items-center justify-between gap-md",4,"ngIf"],[1,"text-center","mt-xl"],[1,"promethea-button","ghost",3,"routerLink"],[1,"flex","flex-wrap","gap-sm","items-center"],[1,"text-muted",2,"font-size","var(--fs-sm)"],["class","text-muted mt-sm","style","font-size: var(--fs-sm)",4,"ngIf"],["class","material-icons","style","font-size: 14px",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[1,"text-muted","mt-sm",2,"font-size","var(--fs-sm)"],[1,"category-section"],[1,"flex","items-center","gap-sm","mb-lg"],[1,"text-md","font-bold"],[1,"chip"],[1,"dishes-grid"],["class","dish-card",4,"ngFor","ngForOf"],[1,"dish-card"],[1,"dish-image-container"],["class","dish-image",3,"src","alt","error",4,"ngIf"],["class","dish-image-placeholder",4,"ngIf"],[1,"dish-info"],[1,"dish-header"],[1,"dish-name"],[1,"dish-price"],[4,"ngIf"],["class","dish-description",4,"ngIf"],["class","dish-details",4,"ngIf"],[1,"add-to-cart-button",3,"click"],[1,"dish-image",3,"error","src","alt"],[1,"dish-image-placeholder"],["name","utensils",3,"size"],[1,"dish-description"],[1,"dish-details"],["class","detail-chip",4,"ngIf"],[1,"detail-chip"],[1,"text-center","p-xl"],[1,"material-icons","fs-lg"],[1,"promethea-button","ghost","mt-md",3,"click"],[1,"fixed-price-banner","card","flex","items-center","justify-between","gap-md"],[1,"flex","items-center","gap-md"],["name","tag",2,"color","var(--primary)",3,"size"],[1,"font-semibold","text-md"],[1,"text-muted","text-mini"],[1,"chip","bg-gradient","font-bold",2,"font-size","var(--fs-md)","padding","var(--gap-sm) var(--gap-md)"],[1,"flex","flex-col","items-center","justify-center","p-xl","gap-md"],[1,"material-icons","animate-spin"]],template:function(e,n){if(e&1&&(o(0,"div",1)(1,"div",2),u(2,ae,3,0,"button",3),R(3,"async"),o(4,"div",4),u(5,oe,1,2,"img",5)(6,se,2,0,"span",6),a(),o(7,"div",7)(8,"h1",8),l(9),a(),o(10,"p",9),l(11,"Menu completo"),a()()()(),u(12,Pe,2,1,"div",10)(13,Ee,6,0,"ng-template",null,0,A)),e&2){let r=z(14);O("background",n.restaurant!=null&&n.restaurant.cover_image_url?"url("+(n.restaurant==null?null:n.restaurant.cover_image_url)+")":"var(--vetro)"),s(2),d("ngIf",j(3,8,n.showToggle$)),s(3),d("ngIf",n.restaurant==null?null:n.restaurant.logo_url),s(),d("ngIf",!(n.restaurant!=null&&n.restaurant.logo_url)),s(3),b(n.restaurant==null?null:n.restaurant.name),s(3),d("ngIf",!n.loading)("ngIfElse",r)}},dependencies:[H,Q,B,N,X,G,J,K,q,ee,Z],styles:[".search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);background:var(--background);border:1px solid var(--smoke-1);border-radius:12px;padding:var(--gap-sm) var(--gap-md);width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;padding:0;width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.category-section[_ngcontent-%COMP%]{margin-bottom:var(--gap-xl)}.dishes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-lg)}.dish-card[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-1);border-radius:16px;overflow:hidden;transition:all .3s cubic-bezier(.2,.9,.2,1);display:flex;flex-direction:column}.dish-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--secondary);box-shadow:0 8px 24px var(--shadow-1)}.dish-image-container[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;overflow:hidden;background:var(--smoke-1)}.dish-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.dish-card[_ngcontent-%COMP%]:hover   .dish-image[_ngcontent-%COMP%]{transform:scale(1.05)}.dish-image-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:var(--text-muted)}.dish-image-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:3rem}.dish-info[_ngcontent-%COMP%]{padding:var(--gap-md);flex:1;display:flex;flex-direction:column;gap:var(--gap-sm)}.dish-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:var(--gap-sm)}.dish-name[_ngcontent-%COMP%]{line-height:1;font-weight:700;margin:0;flex:1}.dish-price[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);white-space:nowrap}.dish-description[_ngcontent-%COMP%]{color:var(--text-muted);line-height:1.4;margin:0;font-size:.95rem}.dish-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-sm)}.detail-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--smoke-1);border-radius:8px;font-size:.85rem;color:var(--text-muted)}.add-to-cart-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);background:var(--gradiente);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;margin-top:auto}.add-to-cart-button[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 4px 12px var(--shadow-1)}.filter-chips[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto;padding-bottom:4px}.filter-chips[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{white-space:nowrap}.logo-image[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:cover;border:3px solid var(--background)}@media (max-width: 768px){.dishes-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.dish-image-container[_ngcontent-%COMP%]{height:180px}.search-bar[_ngcontent-%COMP%]{width:100%}.logo-image[_ngcontent-%COMP%]{width:60px;height:60px}}.fixed-price-banner[_ngcontent-%COMP%]{position:sticky;bottom:var(--gap-md);z-index:10;backdrop-filter:blur(16px);box-shadow:0 8px 32px var(--shadow-1)}"]})};export{ne as MenuDisplay};
