import{a as Z}from"./chunk-MRE755L7.js";import{a as X}from"./chunk-T5EIU2UK.js";import"./chunk-RWHEAJGO.js";import"./chunk-MEGBB4Y7.js";import{ya as J,za as K}from"./chunk-UFRMGX42.js";import{b as A,d as N,e as L,g as z,h as B,i as R,j,k as $,q as U,r as q,s as Y,u as G,v as Q,x as H}from"./chunk-22BNR7AL.js";import"./chunk-NPMWXJE4.js";import"./chunk-6GCWWUP3.js";import{i as D,j as O,k as P,s as W}from"./chunk-N5RTTLWI.js";import{Fb as S,Ha as s,Ib as a,Jb as h,Kb as _,Ob as v,Pb as E,Qb as y,Ub as k,Xa as V,ab as u,ca as F,hb as I,ia as c,ib as m,ja as x,jb as n,kb as t,lb as b,rb as M,ub as g,wb as d}from"./chunk-R56C6QW6.js";import{a as w,b as C,j as f}from"./chunk-4ZZIO3ZI.js";var te=(l,i)=>({"recurring-info":l,"non-recurring-info":i});function ne(l,i){if(l&1){let e=M();n(0,"div",11)(1,"label",12),a(2,"Mese"),t(),n(3,"button",21),g("click",function(){c(e);let o=d();return x(o.openMonthsModal())}),n(4,"span",22),a(5,"calendar_today"),t(),a(6),t()()}if(l&2){let e=d();s(6),_(" ",e.formatMonth(e.selectedMonth)," ")}}function ie(l,i){if(l&1){let e=M();n(0,"button",38),g("click",function(){c(e);let o=d(2);return x(o.showAllTemplates=!o.showAllTemplates)}),n(1,"span",22),a(2),t(),a(3),t()}if(l&2){let e=d(2);s(2),h(e.showAllTemplates?"expand_less":"expand_more"),s(),_(" ",e.showAllTemplates?"Mostra meno":"Mostra tutto"," ")}}function ae(l,i){if(l&1&&(n(0,"div"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_("A: ",r.formatMonthDisplay(e.end_month))}}function re(l,i){if(l&1){let e=M();n(0,"div",39)(1,"div",40)(2,"div")(3,"h4",41),a(4),t(),n(5,"div",42)(6,"span",43),a(7),t(),n(8,"span",44),a(9),t(),n(10,"span",45),a(11),t()()(),n(12,"button",46),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.deactivateRecurringTemplate(o.id))}),n(13,"span",22),a(14,"toggle_off"),t()()(),n(15,"div",47)(16,"div"),a(17),t(),u(18,ae,2,1,"div",28),t()()}if(l&2){let e=i.$implicit,r=i.index,o=d(2);S("hidden-card",!o.showAllTemplates&&r>=3),s(4),h(e.name),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(o.formatCurrency(e.amount)),s(2),h(e.category),s(6),_("Da: ",o.formatMonthDisplay(e.start_month)),s(),m("ngIf",e.end_month)}}function oe(l,i){if(l&1&&(n(0,"div",48)(1,"p"),a(2),t()()),l&2){let e=d(2);s(2),_("+",e.recurringTemplates.length-3," altri template nascosti")}}function se(l,i){if(l&1&&(n(0,"div",8)(1,"div",32)(2,"div",33)(3,"span",4),a(4,"repeat"),t(),n(5,"h3",5),a(6),t()(),u(7,ie,4,2,"button",34),t(),n(8,"div",35),u(9,re,19,10,"div",36),t(),u(10,oe,3,1,"div",37),t()),l&2){let e=d();s(6),_("Spese Ricorrenti (",e.recurringTemplates.length,")"),s(),m("ngIf",e.recurringTemplates.length>3),s(),S("expanded",e.showAllTemplates)("collapsed",!e.showAllTemplates),s(),m("ngForOf",e.recurringTemplates),s(),m("ngIf",!e.showAllTemplates&&e.recurringTemplates.length>3)}}function le(l,i){l&1&&(n(0,"th"),a(1,"Mese"),t())}function pe(l,i){l&1&&(n(0,"span",58),a(1," repeat "),t())}function de(l,i){if(l&1&&(n(0,"span",59),a(1),t()),l&2){let e=d().$implicit,r=d();s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function me(l,i){l&1&&(n(0,"span",45),a(1,"-"),t())}function ce(l,i){if(l&1&&(n(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d();s(),h(r.formatMonth(e.month))}}function xe(l,i){if(l&1){let e=M();n(0,"tr",49)(1,"td")(2,"div",33)(3,"strong"),a(4),t(),u(5,pe,2,0,"span",50),t()(),n(6,"td")(7,"span",43),a(8),t()(),n(9,"td"),a(10),t(),n(11,"td")(12,"strong"),a(13),t()(),n(14,"td"),u(15,de,2,1,"span",51)(16,me,2,0,"span",52),t(),u(17,ce,2,1,"td",28),n(18,"td",53),a(19),t(),n(20,"td")(21,"div",54)(22,"button",55),g("click",function(){let o=c(e).$implicit,p=d();return x(p.toggleExpenseStatus(o))}),n(23,"span",22),a(24),t()(),n(25,"button",56),g("click",function(){let o=c(e).$implicit,p=d();return x(p.openEditExpenseModal(o))}),n(26,"span",22),a(27,"edit"),t()(),n(28,"button",57),g("click",function(){let o=c(e).$implicit,p=d();return x(p.deleteExpense(o))}),n(29,"span",22),a(30,"delete"),t()()()()()}if(l&2){let e=i.$implicit,r=d();S("inactive-row",!e.is_active),s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(3),S("active-toggle",e.is_active),m("title",e.is_active?"Disattiva spesa":"Attiva spesa"),s(2),_(" ",e.is_active?"toggle_on":"toggle_off"," ")}}function ge(l,i){if(l&1&&(n(0,"p",45),a(1),t()),l&2){let e=d(2);s(),_('Nessuna spesa trovata per "',e.searchTerm,'"')}}function ue(l,i){l&1&&(n(0,"p",45),a(1,"Nessuna spesa registrata"),t())}function _e(l,i){if(l&1){let e=M();n(0,"tr")(1,"td",60)(2,"div",61)(3,"span",62),a(4,"receipt_long"),t(),u(5,ge,2,1,"p",52)(6,ue,2,0,"p",52),n(7,"button",38),g("click",function(){c(e);let o=d();return x(o.openAddExpenseModal())}),n(8,"span",22),a(9,"add"),t(),a(10," Aggiungi la prima spesa "),t()()()()}if(l&2){let e=d();s(),I("colspan",e.viewMode==="all"?8:7),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm)}}function he(l,i){l&1&&(n(0,"th"),a(1,"Mese"),t())}function fe(l,i){l&1&&(n(0,"span",58),a(1," repeat "),t())}function ve(l,i){if(l&1&&(n(0,"span",59),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function Ee(l,i){l&1&&(n(0,"span",45),a(1,"-"),t())}function ye(l,i){if(l&1&&(n(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),h(r.formatMonth(e.month))}}function Me(l,i){if(l&1){let e=M();n(0,"tr",77)(1,"td")(2,"div",33)(3,"strong"),a(4),t(),u(5,fe,2,0,"span",50),t()(),n(6,"td")(7,"span",43),a(8),t()(),n(9,"td"),a(10),t(),n(11,"td")(12,"strong"),a(13),t()(),n(14,"td"),u(15,ve,2,1,"span",51)(16,Ee,2,0,"span",52),t(),u(17,ye,2,1,"td",28),n(18,"td",53),a(19),t(),n(20,"td",78),a(21),t(),n(22,"td")(23,"div",54)(24,"button",79),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.toggleExpenseStatus(o))}),n(25,"span",22),a(26," toggle_off "),t()(),n(27,"button",80),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.openEditExpenseModal(o))}),n(28,"span",22),a(29,"visibility"),t()(),n(30,"button",81),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.permanentlyDeleteExpense(o))}),n(31,"span",22),a(32,"delete_forever"),t()()()()()}if(l&2){let e=i.$implicit,r=d(2);s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(2),_(" ",r.formatDeletedDate(e.deleted_at)," ")}}function Se(l,i){if(l&1&&(n(0,"p",45),a(1),t()),l&2){let e=d(3);s(),_('Nessuna spesa disattivata trovata per "',e.searchTerm,'"')}}function we(l,i){l&1&&(n(0,"p",45),a(1,"Nessuna spesa disattivata"),t())}function be(l,i){if(l&1&&(n(0,"tr")(1,"td",60)(2,"div",61)(3,"span",62),a(4,"archive"),t(),u(5,Se,2,1,"p",52)(6,we,2,0,"p",52),t()()()),l&2){let e=d(2);s(),I("colspan",e.viewMode==="all"?9:8),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm)}}function Ce(l,i){if(l&1&&(n(0,"div",63)(1,"div",64)(2,"div",54)(3,"span",65),a(4,"archive"),t(),n(5,"h1",66),a(6,"Spese Disattivate"),t()()(),n(7,"div",67)(8,"div",2)(9,"div",3)(10,"span",68),a(11,"money_off"),t(),n(12,"h3",5),a(13,"Totale Disattivate"),t()(),n(14,"div",6)(15,"div",69),a(16),t()()(),n(17,"div",2)(18,"div",3)(19,"span",70),a(20,"repeat"),t(),n(21,"h3",5),a(22,"Fisse Disattivate"),t()(),n(23,"div",6)(24,"div",71),a(25),t()()(),n(26,"div",2)(27,"div",3)(28,"span",72),a(29,"receipt"),t(),n(30,"h3",5),a(31,"Variabili Disattivate"),t()(),n(32,"div",6)(33,"div",73),a(34),t()()()(),n(35,"div",74)(36,"div",75)(37,"table",27)(38,"thead")(39,"tr")(40,"th"),a(41,"Nome"),t(),n(42,"th"),a(43,"Tipo"),t(),n(44,"th"),a(45,"Categoria"),t(),n(46,"th"),a(47,"Importo"),t(),n(48,"th"),a(49,"Fornitore"),t(),u(50,he,2,0,"th",28),n(51,"th"),a(52,"Note"),t(),n(53,"th"),a(54,"Data Disattivazione"),t(),n(55,"th"),a(56,"Azioni"),t()()(),n(57,"tbody"),u(58,Me,33,12,"tr",76)(59,be,7,3,"tr",28),t()()()()()),l&2){let e=d();s(16),_(" ",e.formatCurrency(e.deletedExpensesTotal)," "),s(9),_(" ",e.deletedFixedExpensesCount," "),s(9),_(" ",e.deletedVariableExpensesCount," "),s(16),m("ngIf",e.viewMode==="all"),s(8),m("ngForOf",e.filteredDeletedExpenses),s(),m("ngIf",e.filteredDeletedExpenses.length===0)}}function Te(l,i){l&1&&(n(0,"p",45)(1,"span",118),a(2,"info"),t(),a(3," Le spese fisse sono automaticamente ricorrenti "),t())}function Fe(l,i){l&1&&(n(0,"p",45)(1,"span",118),a(2,"info"),t(),a(3," Le spese variabili sono una tantum "),t())}function Ie(l,i){if(l&1&&(n(0,"option",105),a(1),t()),l&2){let e=i.$implicit;m("value",e),s(),_(" ",e," ")}}function Ve(l,i){if(l&1&&(n(0,"span"),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name)}}function ke(l,i){if(l&1&&(n(0,"option",105),a(1),u(2,Ve,2,1,"span",28),t()),l&2){let e=i.$implicit;m("value",e.id),s(),_(" ",e.company_name," "),s(),m("ngIf",e.contact_name)}}function De(l,i){l&1&&(n(0,"span",22),a(1,"repeat"),t())}function Oe(l,i){l&1&&(n(0,"span",22),a(1,"event"),t())}function Pe(l,i){l&1&&(n(0,"span"),a(1,"Spesa ricorrente"),t())}function We(l,i){l&1&&(n(0,"span"),a(1,"Spesa una tantum"),t())}function Ae(l,i){if(l&1){let e=M();n(0,"div",82)(1,"div",83)(2,"div",84)(3,"div",85)(4,"div",86)(5,"span",22),a(6),t()(),n(7,"div")(8,"h1",66),a(9),t(),u(10,Te,4,0,"p",52)(11,Fe,4,0,"p",52),t()(),n(12,"button",87),g("click",function(){c(e);let o=d();return x(o.closeExpenseModal())}),n(13,"span",22),a(14,"close"),t()()(),n(15,"form",88),g("submit",function(o){return c(e),d().saveExpense(),x(o.preventDefault())}),n(16,"div",89)(17,"div",90)(18,"div",18)(19,"label",91)(20,"span",22),a(21,"title"),t(),a(22," Nome Spesa * "),t(),n(23,"input",92),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.name,o)||(p.expenseForm.name=o),x(o)}),t()(),n(24,"div",18)(25,"label",93)(26,"span",22),a(27,"euro"),t(),a(28," Importo (\u20AC) * "),t(),n(29,"input",94),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.amount,o)||(p.expenseForm.amount=o),x(o)}),t()()(),n(30,"div",90)(31,"div",18)(32,"label",95)(33,"span",22),a(34,"category"),t(),a(35," Tipo * "),t(),n(36,"select",96),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.type,o)||(p.expenseForm.type=o),x(o)}),g("change",function(){c(e);let o=d();return x(o.onExpenseTypeChange())}),n(37,"option",97),a(38,"Spesa Fissa (ricorrente)"),t(),n(39,"option",98),a(40,"Spesa Variabile (una tantum)"),t()()(),n(41,"div",18)(42,"label",99)(43,"span",22),a(44,"label"),t(),a(45," Categoria * "),t(),n(46,"select",100),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.category,o)||(p.expenseForm.category=o),x(o)}),n(47,"option",101),a(48,"Seleziona categoria"),t(),u(49,Ie,2,2,"option",102),t()()(),n(50,"div",90)(51,"div",18)(52,"label",103),b(53,"lucide-angular",23),a(54," Fornitore "),t(),n(55,"select",104),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.supplier_id,o)||(p.expenseForm.supplier_id=o),x(o)}),n(56,"option",105),a(57,"Nessun fornitore"),t(),u(58,ke,3,3,"option",102),t()(),n(59,"div",106)(60,"button",107),g("click",function(){c(e);let o=d();return x(o.openSupplierModal())}),n(61,"span",22),a(62,"add"),t(),a(63," Nuovo "),t()()(),n(64,"div",90)(65,"div",18)(66,"label",108)(67,"span",22),a(68,"calendar_today"),t(),a(69," Mese * "),t(),n(70,"input",109),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.month,o)||(p.expenseForm.month=o),x(o)}),t()(),n(71,"div",110)(72,"div",111),u(73,De,2,0,"span",112)(74,Oe,2,0,"span",112)(75,Pe,2,0,"span",28)(76,We,2,0,"span",28),t()()(),n(77,"div",113)(78,"label",114)(79,"span",22),a(80,"notes"),t(),a(81," Note "),t(),n(82,"textarea",115),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.notes,o)||(p.expenseForm.notes=o),x(o)}),t()()(),n(83,"div",20)(84,"button",116),g("click",function(){c(e);let o=d();return x(o.closeExpenseModal())}),a(85," Annulla "),t(),n(86,"button",117),a(87),t()()()()()}if(l&2){let e=d();s(6),h(e.editingExpense?"edit":"add"),s(3),h(e.editingExpense?"Modifica Spesa":"Nuova Spesa"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(12),v("ngModel",e.expenseForm.name),s(6),v("ngModel",e.expenseForm.amount),s(7),v("ngModel",e.expenseForm.type),s(10),v("ngModel",e.expenseForm.category),s(3),m("ngForOf",e.getCategoriesByType(e.expenseForm.type)),s(4),m("size",20),s(2),v("ngModel",e.expenseForm.supplier_id),s(),m("value",null),s(2),m("ngForOf",e.suppliers),s(12),v("ngModel",e.expenseForm.month),s(2),m("ngClass",k(21,te,e.expenseForm.type==="fissa",e.expenseForm.type==="variabile")),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(6),v("ngModel",e.expenseForm.notes),s(5),_(" ",e.editingExpense?"Aggiorna":"Crea"," Spesa ")}}function Ne(l,i){if(l&1){let e=M();n(0,"button",121),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.changeMonth(o))}),a(1),t()}if(l&2){let e=i.$implicit,r=d(2);S("active",e===r.selectedMonth),s(),_(" ",r.formatMonth(e)," ")}}function Le(l,i){if(l&1){let e=M();n(0,"div",82)(1,"div",119)(2,"div",84)(3,"div",85)(4,"div",86)(5,"span",22),a(6,"calendar_today"),t()(),n(7,"div")(8,"h1",66),a(9,"Seleziona Mese"),t()()(),n(10,"button",87),g("click",function(){c(e);let o=d();return x(o.closeMonthsModal())}),n(11,"span",22),a(12,"close"),t()()(),n(13,"div",20),u(14,Ne,2,3,"button",120),t(),n(15,"div",20)(16,"button",116),g("click",function(){c(e);let o=d();return x(o.closeMonthsModal())}),a(17," Chiudi "),t()()()()}if(l&2){let e=d();s(14),m("ngForOf",e.availableMonths)}}function ze(l,i){if(l&1&&(n(0,"div",131)(1,"span",132),a(2),t(),n(3,"span",43),a(4),t()()),l&2){let e=i.$implicit;s(2),h(e.name),s(),S("active",e.type==="fissa")("warning",e.type==="variabile"),s(),_(" ",e.type==="entrambi"?"Entrambi":e.type==="fissa"?"Fisse":"Variabili"," ")}}function Be(l,i){l&1&&(n(0,"div",60)(1,"p"),a(2,"Nessuna categoria personalizzata creata"),t()())}function Re(l,i){if(l&1){let e=M();n(0,"div",82)(1,"div",119)(2,"div",84)(3,"div",85)(4,"div",86)(5,"span",22),a(6,"category"),t()(),n(7,"div")(8,"h1",66),a(9,"Gestione Categorie"),t()()(),n(10,"button",87),g("click",function(){c(e);let o=d();return x(o.closeCategoryModal())}),n(11,"span",22),a(12,"close"),t()()(),n(13,"div",89)(14,"div",122)(15,"h3",3)(16,"span",22),a(17,"add"),t(),a(18," Nuova Categoria "),t(),n(19,"form",88),g("submit",function(o){return c(e),d().saveCategory(),x(o.preventDefault())}),n(20,"div",90)(21,"div",18)(22,"label",123)(23,"span",22),a(24,"title"),t(),a(25," Nome Categoria * "),t(),n(26,"input",124),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.name,o)||(p.categoryForm.name=o),x(o)}),t()(),n(27,"div",18)(28,"label",125)(29,"span",22),a(30,"filter_alt"),t(),a(31," Tipo "),t(),n(32,"select",126),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.type,o)||(p.categoryForm.type=o),x(o)}),n(33,"option",127),a(34,"Entrambi i tipi"),t(),n(35,"option",97),a(36,"Solo Spese Fisse"),t(),n(37,"option",98),a(38,"Solo Spese Variabili"),t()()()(),n(39,"div",10)(40,"div",20)(41,"button",116),g("click",function(){c(e);let o=d();return x(o.closeCategoryModal())}),a(42," Annulla "),t(),n(43,"button",117),a(44," Crea Categoria "),t()()()()(),n(45,"div")(46,"h3",3)(47,"span",22),a(48,"list"),t(),a(49," Categorie Esistenti "),t(),n(50,"div",128),u(51,ze,5,6,"div",129)(52,Be,3,0,"div",130),t()()()()()}if(l&2){let e=d();s(26),v("ngModel",e.categoryForm.name),s(6),v("ngModel",e.categoryForm.type),s(19),m("ngForOf",e.categories),s(),m("ngIf",e.categories.length===0)}}function je(l,i){if(l&1&&(n(0,"span",45),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name)}}function $e(l,i){if(l&1&&(n(0,"span",154),a(1),t()),l&2){let e=d().$implicit;s(),h(e.email)}}function Ue(l,i){if(l&1&&(n(0,"span",44),a(1),t()),l&2){let e=d().$implicit;s(),h(e.phone)}}function qe(l,i){if(l&1&&(n(0,"div",149)(1,"div",150)(2,"strong"),a(3),t(),u(4,je,2,1,"span",52),t(),n(5,"div",151),u(6,$e,2,1,"span",152)(7,Ue,2,1,"span",153),t()()),l&2){let e=i.$implicit;s(3),h(e.company_name),s(),m("ngIf",e.contact_name),s(2),m("ngIf",e.email),s(),m("ngIf",e.phone)}}function Ye(l,i){l&1&&(n(0,"div",60)(1,"p"),a(2,"Nessun fornitore creato"),t()())}function Ge(l,i){if(l&1){let e=M();n(0,"div",82)(1,"div",83)(2,"div",84)(3,"div",85)(4,"div",86)(5,"span",22),a(6,"local_shipping"),t()(),n(7,"div")(8,"h1",66),a(9,"Gestione Fornitori"),t()()(),n(10,"button",87),g("click",function(){c(e);let o=d();return x(o.closeSupplierModal())}),n(11,"span",22),a(12,"close"),t()()(),n(13,"div",89)(14,"div",122)(15,"h3",3)(16,"span",22),a(17,"add"),t(),a(18," Nuovo Fornitore "),t(),n(19,"form",88),g("submit",function(o){return c(e),d().saveSupplier(),x(o.preventDefault())}),n(20,"div",90)(21,"div",18)(22,"label",133)(23,"span",22),a(24,"business"),t(),a(25," Nome Ditta * "),t(),n(26,"input",134),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.company_name,o)||(p.supplierForm.company_name=o),x(o)}),t()(),n(27,"div",18)(28,"label",135),b(29,"lucide-angular",136),a(30," Referente "),t(),n(31,"input",137),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.contact_name,o)||(p.supplierForm.contact_name=o),x(o)}),t()()(),n(32,"div",90)(33,"div",18)(34,"label",138),b(35,"lucide-angular",139),a(36," Email "),t(),n(37,"input",140),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.email,o)||(p.supplierForm.email=o),x(o)}),t()(),n(38,"div",18)(39,"label",141)(40,"span",22),a(41,"phone"),t(),a(42," Telefono "),t(),n(43,"input",142),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.phone,o)||(p.supplierForm.phone=o),x(o)}),t()()(),n(44,"div",113)(45,"label",143)(46,"span",22),a(47,"location_on"),t(),a(48," Indirizzo "),t(),n(49,"textarea",144),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.address,o)||(p.supplierForm.address=o),x(o)}),t()(),n(50,"div",113)(51,"label",145)(52,"span",22),a(53,"notes"),t(),a(54," Descrizione "),t(),n(55,"textarea",146),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.description,o)||(p.supplierForm.description=o),x(o)}),t()(),n(56,"div",20)(57,"button",116),g("click",function(){c(e);let o=d();return x(o.closeSupplierModal())}),a(58," Annulla "),t(),n(59,"button",117),a(60," Crea Fornitore "),t()()()(),n(61,"div")(62,"h3",3)(63,"span",22),a(64,"list"),t(),a(65," Fornitori Esistenti "),t(),n(66,"div",147),u(67,qe,8,4,"div",148)(68,Ye,3,0,"div",130),t()()()()()}if(l&2){let e=d();s(26),v("ngModel",e.supplierForm.company_name),s(3),m("size",20),s(2),v("ngModel",e.supplierForm.contact_name),s(4),m("size",20),s(2),v("ngModel",e.supplierForm.email),s(6),v("ngModel",e.supplierForm.phone),s(6),v("ngModel",e.supplierForm.address),s(6),v("ngModel",e.supplierForm.description),s(12),m("ngForOf",e.suppliers),s(),m("ngIf",e.suppliers.length===0)}}function Qe(l,i){if(l&1){let e=M();n(0,"div",82)(1,"div",155)(2,"div",84)(3,"div",85)(4,"div",86)(5,"span",22),a(6,"repeat"),t()(),n(7,"div")(8,"h1",66),a(9,"Modifica Spese Future"),t()()()(),n(10,"div",89)(11,"div",156)(12,"div",157)(13,"span",158),a(14,"info"),t()(),n(15,"h3",159),a(16,"La modifica \xE8 stata salvata"),t(),n(17,"p",160),a(18,' La spesa "'),n(19,"strong"),a(20),t(),a(21,'" \xE8 ricorrente.'),b(22,"br")(23,"br"),a(24," Vuoi applicare questa modifica anche a tutti i mesi futuri? "),t(),n(25,"div",161)(26,"div",162),g("click",function(){c(e);let o=d();return x(o.onlyCurrentMonth())}),n(27,"div",163)(28,"span",164),a(29,"today"),t(),n(30,"strong"),a(31,"Solo questo mese"),t()(),n(32,"p",45),a(33),t()(),n(34,"div",165),g("click",function(){c(e);let o=d();return x(o.applyToFutureMonths())}),n(35,"div",163)(36,"span",164),a(37,"date_range"),t(),n(38,"strong"),a(39,"Tutti i mesi futuri"),t()(),n(40,"p",45),a(41,"La modifica verr\xE0 applicata a partire dal mese successivo"),t()()()(),n(42,"div",20)(43,"button",116),g("click",function(){c(e);let o=d();return x(o.onlyCurrentMonth())}),n(44,"span",22),a(45,"today"),t(),a(46," Solo questo mese "),t(),n(47,"button",166),g("click",function(){c(e);let o=d();return x(o.applyToFutureMonths())}),n(48,"span",22),a(49,"date_range"),t(),a(50," Tutti i mesi futuri "),t()()()()()}if(l&2){let e=d();s(20),h(e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.name),s(13),_("La modifica verr\xE0 applicata solo a ",e.formatMonthDisplay((e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.month)||""))}}var ee=class l{expenseService=F(Z);supplierService=F(X);expenseSubscription;templatesSubscription;categoriesSubscription;suppliersSubscription;expenses=[];availableMonths=[];categories=[];suppliers=[];recurringTemplates=[];showDeletedExpenses=!1;selectedMonth=this.getCurrentMonth();viewMode="monthly";searchTerm="";showExpenseModal=!1;showMonthsModal=!1;showCategoryModal=!1;showSupplierModal=!1;editingExpense=null;showFutureMonthsConfirm=!1;pendingExpenseUpdate=null;recurringTemplateForm={name:"",amount:0,type:"fissa",category:"",notes:"",supplier_id:null,start_month:this.getCurrentMonth(),end_month:""};expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.getCurrentMonth(),notes:"",supplier_id:null,template_id:null};categoryForm={name:"",type:"entrambi"};supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""};showAllTemplates=!1;showDeletedSection=!1;deletedExpenses=[];loadingDeleted=!1;get monthlyStats(){return this.expenseService.calculateMonthlyTotal(this.filteredExpenses)}get filteredExpenses(){let i=this.expenses;if(this.viewMode==="monthly"&&(i=i.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();i=i.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return i}get allCategories(){let i=this.expenseService.getDefaultCategories(),e=this.categories.map(r=>r.name);return[...new Set([...i,...e])].sort()}getCategoriesByType(i){return this.allCategories.filter(e=>{let r=this.categories.find(o=>o.name===e);return r?r.type==="entrambi"||r.type===i:!0})}toggleDeletedSection(){return f(this,null,function*(){this.showDeletedSection=!this.showDeletedSection,this.showDeletedSection&&this.deletedExpenses.length===0&&(yield this.loadDeletedExpenses())})}loadDeletedExpenses(){return f(this,null,function*(){this.loadingDeleted=!0;try{this.viewMode==="monthly"?(console.log("\u{1F5D1}\uFE0F Loading deleted expenses for month:",this.selectedMonth),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForMonth(this.selectedMonth)):(console.log("\u{1F5D1}\uFE0F Loading ALL deleted expenses"),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForDateRange("2000-01-01","2030-12-01")),console.log("\u2705 Deleted expenses loaded:",this.deletedExpenses.length)}catch(i){console.error("\u274C Error loading deleted expenses:",i)}finally{this.loadingDeleted=!1}})}ngOnInit(){this.loadData()}ngOnDestroy(){this.expenseSubscription&&this.expenseSubscription.unsubscribe(),this.templatesSubscription&&this.templatesSubscription.unsubscribe(),this.categoriesSubscription&&this.categoriesSubscription.unsubscribe(),this.suppliersSubscription&&this.suppliersSubscription.unsubscribe()}loadData(){return f(this,null,function*(){try{console.log("\u{1F50D} Loading data for month:",this.selectedMonth),yield Promise.all([this.loadExpenses(),this.loadAvailableMonths(),this.loadCategories(),this.loadSuppliers(),this.loadRecurringTemplates()])}catch(i){console.error("\u274C Error loading data:",i)}})}loadRecurringTemplates(){return f(this,null,function*(){yield this.expenseService.loadRecurringTemplates(),this.templatesSubscription=this.expenseService.recurringTemplates$.subscribe(i=>{this.recurringTemplates=i,console.log("\u{1F4CB} Recurring templates loaded:",i.length)})})}loadSuppliers(){return f(this,null,function*(){yield this.supplierService.loadSuppliers(),this.suppliersSubscription=this.supplierService.suppliers$.subscribe(i=>{this.suppliers=i,console.log("\u{1F3E2} Suppliers loaded:",i.length)})})}loadExpenses(){return f(this,null,function*(){try{if(this.viewMode==="monthly")console.log("\u{1F4C5} Loading expenses for month:",this.selectedMonth),yield this.expenseService.loadExpensesForMonth(this.selectedMonth,!0),this.expenseSubscription=this.expenseService.data$.subscribe(i=>{this.expenses=i.filter(e=>!e.deleted_at),console.log("\u{1F4B0} Expenses loaded:",this.expenses.length)});else{console.log("\u{1F4CA} Loading ALL expenses");let i=yield this.expenseService.loadExpensesForDateRange("2000-01-01","2030-12-01");this.expenses=i.filter(e=>!e.deleted_at),console.log("\u{1F4CA} All expenses loaded:",this.expenses.length)}}catch(i){console.error("\u274C Error loading expenses:",i)}})}loadAvailableMonths(){return f(this,null,function*(){this.availableMonths=yield this.expenseService.getAvailableMonths(),console.log("\u{1F4C6} Available months:",this.availableMonths.length)})}loadCategories(){return f(this,null,function*(){yield this.expenseService.loadCategories(),this.categoriesSubscription=this.expenseService.categories$.subscribe(i=>{this.categories=i,console.log("\u{1F3F7}\uFE0F Categories loaded:",i.length)})})}getCurrentMonth(){let i=new Date;return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`}formatMonthForInput(i){return i.match(/^\d{4}-\d{2}$/)?i:i.match(/^\d{4}-\d{2}-\d{2}$/)?i.substring(0,7):this.getCurrentMonth()}formatMonthForDatabase(i){if(i.match(/^\d{4}-\d{2}$/))return`${i}-01`;if(i.match(/^\d{4}-\d{2}-\d{2}$/))return i;let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-01`}formatMonthDisplay(i){try{return new Date(this.formatMonthForDatabase(i)).toLocaleDateString("it-IT",{month:"long",year:"numeric"})}catch{return i}}formatCurrency(i){return`\u20AC${i.toFixed(2).replace(".",",")}`}getSupplierName(i){if(!i)return"Nessun fornitore";let e=this.suppliers.find(r=>r.id===i);return e?e.company_name:"Fornitore sconosciuto"}openAddExpenseModal(){this.editingExpense=null,this.expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.formatMonthForInput(this.selectedMonth),notes:"",supplier_id:null,template_id:null},this.showExpenseModal=!0}openEditExpenseModal(i){console.log("\u{1F4DD} Opening edit modal for expense:",{id:i.id,name:i.name,template_id:i.template_id,month:i.month,amount:i.amount}),this.editingExpense=i,this.expenseForm={name:i.name,amount:i.amount,type:i.type,category:i.category,month:this.formatMonthForInput(i.month),notes:i.notes||"",supplier_id:i.supplier_id||null,template_id:i.template_id||null},this.showExpenseModal=!0}openCategoryModal(){this.categoryForm={name:"",type:"entrambi"},this.showCategoryModal=!0}openSupplierModal(){this.supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""},this.showSupplierModal=!0}closeExpenseModal(){this.showExpenseModal=!1,this.editingExpense=null}closeMonthsModal(){this.showMonthsModal=!1}closeCategoryModal(){this.showCategoryModal=!1}closeSupplierModal(){this.showSupplierModal=!1}saveExpense(){return f(this,null,function*(){if(console.log("\u{1F4BE} Starting saveExpense..."),console.log("\u{1F4CB} Form data:",this.expenseForm),console.log("\u270F\uFE0F Editing expense:",this.editingExpense),!this.expenseForm.name||!this.expenseForm.amount||!this.expenseForm.category){console.log("\u274C Validation failed: missing required fields"),alert("Compila tutti i campi obbligatori: Nome, Importo e Categoria");return}if(this.expenseForm.amount<=0){console.log("\u274C Validation failed: amount must be > 0"),alert("L'importo deve essere maggiore di 0");return}try{let i=C(w({},this.expenseForm),{month:this.formatMonthForDatabase(this.expenseForm.month),is_recurring:this.expenseForm.type==="fissa"});if(console.log("\u{1F4E4} Expense data to save:",i),console.log("\u{1F501} Is recurring (auto-determined):",i.is_recurring),this.editingExpense){if(console.log("\u{1F504} Updating existing expense:",this.editingExpense.id),!confirm(`Vuoi salvare le modifiche per la spesa "${this.editingExpense.name}"?`)){console.log("\u274C Save cancelled by user");return}let r=C(w({},i),{template_id:this.editingExpense.template_id||null});if(console.log("\u{1F4DD} Saving update for current month:",r),!(yield this.expenseService.update(this.editingExpense.id,r)))throw new Error("Update failed");if(console.log("\u2705 Expense updated successfully for current month"),this.editingExpense.type==="fissa"&&i.type==="fissa"){this.showFutureMonthsConfirm=!0,this.pendingExpenseUpdate={expenseId:this.editingExpense.id,expenseData:i,oldTemplateId:this.editingExpense.template_id||null};return}this.completeSaveOperation()}else{if(console.log("\u{1F195} Creating new expense"),!confirm(`Vuoi creare la nuova spesa "${i.name}"?`)){console.log("\u274C Save cancelled by user");return}if(i.type==="fissa"){let r={name:i.name,amount:i.amount,type:i.type,category:i.category,notes:i.notes||"",supplier_id:i.supplier_id,start_month:i.month};console.log("\u{1F4CB} Creating recurring template for fixed expense:",r);let o=yield this.expenseService.createRecurringTemplate(r);o&&(i.template_id=o.id,(yield this.expenseService.create(i))&&(console.log("\u2705 Fixed (recurring) expense created with template"),this.showSuccessAlert("Spesa fissa (ricorrente) creata con successo!")))}else i.is_recurring=!1,i.template_id=null,(yield this.expenseService.create(i))&&(console.log("\u2705 Variable (non-recurring) expense created"),this.showSuccessAlert("Spesa variabile creata con successo!"));this.completeSaveOperation()}}catch(i){console.error("\u274C Error saving expense:",i),this.showErrorAlert("Errore nel salvataggio della spesa: "+i.message)}})}applyToFutureMonths(){return f(this,null,function*(){if(this.pendingExpenseUpdate)try{let{expenseData:i,oldTemplateId:e}=this.pendingExpenseUpdate,r=this.getNextMonth(i.month),o={name:i.name,amount:i.amount,type:i.type,category:i.category,notes:i.notes||"",supplier_id:i.supplier_id,start_month:r};console.log("\u{1F4CB} Creating template for future months:",o);let p=yield this.expenseService.createRecurringTemplate(o);p&&(e&&(yield this.expenseService.updateRecurringTemplate(e,{is_active:!1,end_month:i.month})),yield this.expenseService.update(this.pendingExpenseUpdate.expenseId,{template_id:p.id}),console.log("\u2705 Created new template for future months"),this.showSuccessAlert("Modifica applicata a tutti i mesi futuri!"))}catch(i){console.error("\u274C Error applying to future months:",i),this.showErrorAlert("Errore nell'applicazione ai mesi futuri: "+i.message)}finally{this.completeSaveOperation()}})}onlyCurrentMonth(){return f(this,null,function*(){try{console.log("\u2705 Modification applied only to current month"),this.showSuccessAlert("Modifica applicata solo al mese corrente.")}finally{this.completeSaveOperation()}})}completeSaveOperation(){this.pendingExpenseUpdate=null,this.showFutureMonthsConfirm=!1,this.showExpenseModal=!1,this.editingExpense=null,this.loadExpenses()}showSuccessAlert(i){alert(i)}showErrorAlert(i){alert(i)}saveCategory(){return f(this,null,function*(){if(!this.categoryForm.name){alert("Inserisci un nome per la categoria");return}try{let i=C(w({},this.categoryForm),{is_active:!0});yield this.expenseService.createCategory(i),this.closeCategoryModal(),yield this.loadCategories(),alert("Categoria creata con successo!")}catch(i){console.error("Error saving category:",i),alert("Errore nella creazione della categoria")}})}saveSupplier(){return f(this,null,function*(){if(!this.supplierForm.company_name){alert("Inserisci il nome della ditta fornitrice");return}try{let i=C(w({},this.supplierForm),{user_id:null,is_platform_supplier:!1,is_approved:!0});yield this.supplierService.createSupplier(i),this.closeSupplierModal(),yield this.loadSuppliers(),alert("Fornitore creato con successo!")}catch(i){console.error("Error saving supplier:",i),alert("Errore nella creazione del fornitore")}})}openMonthsModal(){this.showMonthsModal=!0}formatMonth(i){return this.formatMonthDisplay(i)}deleteExpense(i){return f(this,null,function*(){if(confirm(`Sei sicuro di voler disattivare la spesa "${i.name}"?`))try{if(yield this.expenseService.update(i.id,{deleted_at:new Date().toISOString()}))yield this.loadExpenses(),alert("Spesa disattivata con successo!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("Error deleting expense:",e),alert("Errore nella disattivazione della spesa")}})}changeMonth(i){return f(this,null,function*(){console.log("\u{1F4C5} Changing month to:",i),this.selectedMonth=i,this.viewMode="monthly",yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses()),this.closeMonthsModal()})}changeViewMode(i){return f(this,null,function*(){this.viewMode=i,yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses())})}formatDeletedDate(i){if(!i)return"Non eliminata";try{return new Date(i).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return i}}onExpenseTypeChange(){this.expenseForm.category=""}deactivateRecurringTemplate(i){return f(this,null,function*(){if(confirm("Vuoi disattivare questo template ricorrente? Le spese gi\xE0 generate rimarranno ma non se ne genereranno di nuove."))try{(yield this.expenseService.updateRecurringTemplate(i,{is_active:!1}))&&(yield this.expenseService.loadRecurringTemplates(),alert("Template disattivato con successo"))}catch(e){console.error("Error deactivating template:",e),alert("Errore nella disattivazione del template")}})}debugExpenses(){console.log("\u{1F50D} DEBUG - Current expenses:",this.expenses),console.log("\u{1F50D} DEBUG - Selected month:",this.selectedMonth),console.log("\u{1F50D} DEBUG - Filtered expenses:",this.filteredExpenses)}getNextMonth(i){try{if(i.match(/^\d{4}-\d{2}-\d{2}$/)){let r=new Date(i);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}if(i.match(/^\d{4}-\d{2}$/)){let r=new Date(`${i}-01`);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}let e=new Date;return e.setMonth(e.getMonth()+1),e.toISOString().split("T")[0]}catch(e){console.error("\u274C Error calculating next month:",e);let r=new Date;return r.setMonth(r.getMonth()+1),`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-01`}}toggleExpenseStatus(i){return f(this,null,function*(){let e=i.is_active&&i.deleted_at===null,r=e?"disattivare":"attivare",o=e?"disattivata":"attivata";if(confirm(`Vuoi ${r} la spesa "${i.name}"?`))try{console.log(`\u{1F504} Cambiando stato della spesa "${i.name}" da attiva=${e} a attiva=${!e}`);let p=e?{deleted_at:new Date().toISOString(),is_active:!1}:{deleted_at:null,is_active:!0};if(yield this.expenseService.update(i.id,p))e?(this.deletedExpenses=[...this.deletedExpenses,w(w({},i),p)],this.expenses=this.expenses.filter(T=>T.id!==i.id)):(this.expenses=[...this.expenses,w(w({},i),p)],this.deletedExpenses=this.deletedExpenses.filter(T=>T.id!==i.id)),console.log(`\u2705 Spesa ${o}:`,i.name),alert(`Spesa ${o} con successo!`);else throw new Error("Operazione non riuscita")}catch(p){console.error("\u274C Errore nel cambiamento di stato:",p),alert("Errore nel cambiamento di stato della spesa")}})}toggleTemplatesView(){this.showAllTemplates=!this.showAllTemplates}get deletedExpensesTotal(){return this.deletedExpenses.reduce((i,e)=>i+e.amount,0)}get deletedFixedExpensesCount(){return this.deletedExpenses.filter(i=>i.type==="fissa").length}get deletedVariableExpensesCount(){return this.deletedExpenses.filter(i=>i.type==="variabile").length}get filteredDeletedExpenses(){let i=this.deletedExpenses;if(this.viewMode==="monthly"&&(i=i.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();i=i.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return i}permanentlyDeleteExpense(i){return f(this,null,function*(){if(confirm(`Sei sicuro di voler eliminare definitivamente la spesa "${i.name}"?
Questa azione \xE8 irreversibile e non potrai recuperare i dati!`))try{if(yield this.expenseService.hardDelete(i.id))this.deletedExpenses=this.deletedExpenses.filter(r=>r.id!==i.id),alert("Spesa eliminata definitivamente!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("\u274C Error permanently deleting expense:",e),alert("Errore nell'eliminazione definitiva della spesa")}})}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=V({type:l,selectors:[["app-expense-management"]],decls:96,vars:26,consts:[[1,"page-container"],[1,"grid-cards","p-sm"],[1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"flex","flex-col","gap-md"],[1,"text-md","font-bold","text-primary","text-amber-500","justify-center","flex"],[1,"form-card","mt-lg"],[1,"flex","justify-between","items-end","gap-sm","flex-wrap"],[1,"form-row"],[1,"flex","flex-col","mb-sm"],[1,"standard-label"],[1,"flex","gap-md","flex-wrap"],[1,"radio-label"],["type","radio","name","viewMode",3,"ngModelChange","change","value","ngModel"],[1,"radio-checkmark"],["class","flex flex-col mb-sm",4,"ngIf"],[1,"form-group"],["type","text","placeholder","Cerca per nome, categoria, fornitore...",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"promethea-button","ghost",3,"click"],[1,"material-icons"],["name","truck",1,"nav-icon",3,"size"],[1,"promethea-button",3,"click"],["class","form-card mt-lg",4,"ngIf"],[1,"table-section","p-sm"],[1,"crm-table"],[4,"ngIf"],["class","hover-lift transition",3,"inactive-row",4,"ngFor","ngForOf"],["class","mt-lg",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"flex","justify-between","items-center","mb-md"],[1,"flex","items-center","gap-sm"],["class","promethea-button ghost small",3,"click",4,"ngIf"],[1,"templates-container"],["class","card template-card",3,"hidden-card",4,"ngFor","ngForOf"],["class","text-center mt-sm text-muted",4,"ngIf"],[1,"promethea-button","ghost","small",3,"click"],[1,"card","template-card"],[1,"flex","justify-between","items-start"],[1,"font-bold"],[1,"flex","gap-sm","mt-sm","flex-wrap"],[1,"chip"],[1,"chip","secondary"],[1,"text-muted"],["title","Disattiva",1,"icon-button","small",3,"click"],[1,"mt-sm","text-sm","text-muted"],[1,"text-center","mt-sm","text-muted"],[1,"hover-lift","transition"],["class","material-icons text-primary fs-sm","title","Spesa ricorrente",4,"ngIf"],["class","chip primary",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"notes-preview"],[1,"flex","gap-sm"],[1,"icon-button",3,"click","title"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["title","Spesa ricorrente",1,"material-icons","text-primary","fs-sm"],[1,"chip","primary"],[1,"text-center","p-xl","opacity-70"],[1,"flex","flex-col","items-center","gap-md"],[1,"material-icons","text-muted",2,"font-size","3rem"],[1,"mt-lg"],[1,"section-header"],[1,"material-icons","fs-lg","text-red-500"],[1,"section-title"],[1,"grid-cards"],[1,"material-icons","text-red-500","text-md"],[1,"text-md","font-bold","text-red-500","justify-center","flex"],[1,"material-icons","text-blue-500","text-md"],[1,"text-md","font-bold","text-blue-500","justify-center","flex"],[1,"material-icons","text-purple-500","text-md"],[1,"text-md","font-bold","text-purple-500","justify-center","flex"],[1,"table-section"],[1,"bg-body","border","rounded-lg","overflow-hidden","shadow-card","backdrop-blur"],["class","deleted-row hover-lift transition",4,"ngFor","ngForOf"],[1,"deleted-row","hover-lift","transition"],[1,"text-sm","text-muted"],["title","Riattiva spesa",1,"icon-button","success",3,"click"],["title","Visualizza",1,"icon-button",3,"click"],["title","Elimina definitivamente",1,"icon-button","danger",3,"click"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"flex"],[1,"header-icon"],[1,"icon-button","close-button",3,"click"],[1,"generic-form",3,"submit"],[1,"form-card"],[1,"form-row","mb-md"],["for","expense-name",1,"standard-label"],["type","text","id","expense-name","name","name","required","","placeholder","Es. Affitto locale",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-amount",1,"standard-label"],["type","number","id","expense-amount","name","amount","step","0.01","min","0","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-type",1,"standard-label"],["id","expense-type","name","type","required","",1,"form-input",3,"ngModelChange","change","ngModel"],["value","fissa"],["value","variabile"],["for","expense-category",1,"standard-label"],["id","expense-category","name","category","required","",1,"form-input",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","expense-supplier",1,"standard-label"],["id","expense-supplier","name","supplier_id",1,"form-input",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-group",2,"justify-content","flex-end"],["type","button",1,"promethea-button","secondary","small",3,"click"],["for","expense-month",1,"standard-label"],["type","month","id","expense-month","name","month","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-group",2,"justify-content","center"],[1,"info-box",3,"ngClass"],["class","material-icons",4,"ngIf"],[1,"form-group","mb-md"],["for","expense-notes",1,"standard-label"],["id","expense-notes","name","notes","rows","3","placeholder","Note aggiuntive...",1,"form-input",3,"ngModelChange","ngModel"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button"],[1,"material-icons","text-primary","fs-sm"],[1,"modal-container","modal-md"],["class","month-item promethea-button ghost",3,"active","click",4,"ngFor","ngForOf"],[1,"month-item","promethea-button","ghost",3,"click"],[1,"mb-lg"],["for","category-name",1,"standard-label"],["type","text","id","category-name","name","name","required","","placeholder","Es. Manutenzione impianti",1,"form-input",3,"ngModelChange","ngModel"],["for","category-type",1,"standard-label"],["id","category-type","name","type","required","",1,"form-input",3,"ngModelChange","ngModel"],["value","entrambi"],[1,"categories-list"],["class","category-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],["class","text-center p-xl opacity-70",4,"ngIf"],[1,"category-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"category-name","font-semibold"],["for","supplier-company",1,"standard-label"],["type","text","id","supplier-company","name","company_name","required","","placeholder","Nome della ditta fornitrice",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-contact",1,"standard-label"],["name","user",1,"nav-icon",3,"size"],["type","text","id","supplier-contact","name","contact_name","placeholder","Nome del referente",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-email",1,"standard-label"],["name","mail",1,"nav-icon",3,"size"],["type","email","id","supplier-email","name","email","placeholder","email@fornitore.com",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-phone",1,"standard-label"],["type","tel","id","supplier-phone","name","phone","placeholder","Numero di telefono",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-address",1,"standard-label"],["id","supplier-address","name","address","rows","2","placeholder","Indirizzo del fornitore",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-description",1,"standard-label"],["id","supplier-description","name","description","rows","3","placeholder","Note aggiuntive sul fornitore",1,"form-input",3,"ngModelChange","ngModel"],[1,"suppliers-list"],["class","supplier-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],[1,"supplier-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"supplier-info"],[1,"supplier-details","flex","gap-sm"],["class","chip active",4,"ngIf"],["class","chip secondary",4,"ngIf"],[1,"chip","active"],[1,"modal-container","modal-sm"],[1,"confirmation-message"],[1,"confirmation-icon","flex","justify-center","mb-md"],[1,"material-icons","text-primary","fs-lg"],[1,"text-center","mb-md"],[1,"text-center","mb-lg"],[1,"confirmation-options","mb-lg"],[1,"option-item","border","rounded","p-md","mb-md","cursor-pointer","hover:bg-smoke",3,"click"],[1,"flex","items-center","gap-sm","mb-sm"],[1,"material-icons","text-primary"],[1,"option-item","border","rounded","p-md","cursor-pointer","hover:bg-smoke",3,"click"],["type","button",1,"promethea-button",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),a(5,"payments"),t(),n(6,"h3",5),a(7,"Spese Fisse"),t()(),n(8,"div",6)(9,"div",7),a(10),t()()(),n(11,"div",2)(12,"div",3)(13,"span",4),a(14,"receipt"),t(),n(15,"h3",5),a(16,"Spese Variabili"),t()(),n(17,"div",6)(18,"div",7),a(19),t()()(),n(20,"div",2)(21,"div",3)(22,"span",4),a(23,"account_balance"),t(),n(24,"h3",5),a(25,"Totale Mese"),t()(),n(26,"div",6)(27,"div",7),a(28),t()()()(),n(29,"div",8)(30,"div",9)(31,"div",10)(32,"div",11)(33,"label",12),a(34,"Periodo"),t(),n(35,"div",13)(36,"label",14)(37,"input",15),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),g("change",function(){return r.changeViewMode("monthly")}),t(),b(38,"span",16),n(39,"span"),a(40,"Mensile"),t()(),n(41,"label",14)(42,"input",15),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),g("change",function(){return r.changeViewMode("all")}),t(),b(43,"span",16),n(44,"span"),a(45,"Tutti"),t()()()(),u(46,ne,7,1,"div",17),t(),n(47,"div",18)(48,"label",12),a(49,"Cerca"),t(),n(50,"input",19),y("ngModelChange",function(p){return E(r.searchTerm,p)||(r.searchTerm=p),p}),t()()(),n(51,"div",20)(52,"button",21),g("click",function(){return r.toggleDeletedSection()}),n(53,"span",22),a(54),t(),a(55),t(),n(56,"button",21),g("click",function(){return r.openCategoryModal()}),n(57,"span",22),a(58,"category"),t(),a(59," Aggiungi Categorie "),t(),n(60,"button",21),g("click",function(){return r.openSupplierModal()}),b(61,"lucide-angular",23),a(62," Aggiungi Fornitori "),t(),n(63,"button",24),g("click",function(){return r.openAddExpenseModal()}),n(64,"span",22),a(65,"add"),t(),a(66," Nuova Spesa "),t()()(),u(67,se,11,8,"div",25),n(68,"div",26)(69,"table",27)(70,"thead")(71,"tr")(72,"th"),a(73,"Nome"),t(),n(74,"th"),a(75,"Tipo"),t(),n(76,"th"),a(77,"Categoria"),t(),n(78,"th"),a(79,"Importo"),t(),n(80,"th"),a(81,"Fornitore"),t(),u(82,le,2,0,"th",28),n(83,"th"),a(84,"Note"),t(),n(85,"th"),a(86,"Azioni"),t()()(),n(87,"tbody"),u(88,xe,31,17,"tr",29)(89,_e,11,3,"tr",28),t()()(),u(90,Ce,60,6,"div",30)(91,Ae,88,24,"div",31)(92,Le,18,1,"div",31)(93,Re,53,4,"div",31)(94,Ge,69,10,"div",31)(95,Qe,51,2,"div",31),t()),e&2&&(s(10),h(r.formatCurrency(r.monthlyStats.fisse)),s(9),h(r.formatCurrency(r.monthlyStats.variabili)),s(9),h(r.formatCurrency(r.monthlyStats.totale)),s(8),S("active",r.viewMode==="monthly"),s(),m("value","monthly"),v("ngModel",r.viewMode),s(4),S("active",r.viewMode==="all"),s(),m("value","all"),v("ngModel",r.viewMode),s(4),m("ngIf",r.viewMode==="monthly"),s(4),v("ngModel",r.searchTerm),s(4),h(r.showDeletedSection?"visibility_off":"archive"),s(),_(" ",r.showDeletedSection?"Nascondi Disattivate":"Mostra Disattivate"," "),s(6),m("size",20),s(6),m("ngIf",r.recurringTemplates.length>0),s(15),m("ngIf",r.viewMode==="all"),s(6),m("ngForOf",r.filteredExpenses),s(),m("ngIf",r.filteredExpenses.length===0),s(),m("ngIf",r.showDeletedSection),s(),m("ngIf",r.showExpenseModal),s(),m("ngIf",r.showMonthsModal),s(),m("ngIf",r.showCategoryModal),s(),m("ngIf",r.showSupplierModal),s(),m("ngIf",r.showFutureMonthsConfirm))},dependencies:[W,D,O,P,H,R,q,Y,A,j,U,$,N,L,Q,G,B,z,K,J],styles:['.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);border:1px solid var(--smoke-1);border-radius:12px;cursor:pointer;transition:all .3s ease;background:var(--background)}.radio-label[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translateY(-2px)}.radio-label.active[_ngcontent-%COMP%]{background:var(--smoke-2);border-color:var(--primary);color:var(--primary)}.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.radio-checkmark[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid var(--smoke-1);border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background:var(--primary)}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]:after{content:"";width:8px;height:8px;background:#fff;border-radius:50%}.table-section[_ngcontent-%COMP%]{margin-top:var(--gap-lg)}.chip.small[_ngcontent-%COMP%]{padding:.125rem .5rem;font-size:.75rem}.chip.primary[_ngcontent-%COMP%]{background:var(--smoke-2);color:var(--primary);border-color:var(--smoke-2)}.notes-preview[_ngcontent-%COMP%]{max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-muted)}.input-group[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);align-items:stretch}.input-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;min-width:0}.input-group[_ngcontent-%COMP%]   .promethea-button.small[_ngcontent-%COMP%]{padding:var(--gap-sm);white-space:nowrap;flex-shrink:0}.months-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:var(--gap-sm);margin-bottom:var(--gap-lg)}.categories-list[_ngcontent-%COMP%], .suppliers-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.category-item[_ngcontent-%COMP%], .supplier-item[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;padding:var(--gap-sm);border:1px solid var(--smoke-1);border-radius:12px;transition:all .3s ease}.category-item[_ngcontent-%COMP%]:hover, .supplier-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translate(4px)}.supplier-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);flex-wrap:wrap}@media (max-width: 768px){.flex.justify-between[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{align-self:stretch}.input-group[_ngcontent-%COMP%]{flex-direction:column}.supplier-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{align-self:stretch;justify-content:flex-start}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.recurring-templates-list[_ngcontent-%COMP%], .template-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.template-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);transform-origin:top}.template-card.hidden[_ngcontent-%COMP%]{transform:scaleY(0);opacity:0;height:0;margin:0;padding:0;border:none;overflow:hidden}.grid-cards[_ngcontent-%COMP%]{transition:all .3s ease}.additional-templates[_ngcontent-%COMP%]{margin-top:var(--gap-md);animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}.animate-expand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_expand{0%{opacity:0;transform:translateY(-10px);max-height:0}to{opacity:1;transform:translateY(0);max-height:1000px}}.templates-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:grid-template-rows .3s ease}.templates-container.collapsed[_ngcontent-%COMP%]{grid-template-rows:repeat(auto-fit,minmax(0,1fr));max-height:calc(3 * (var(--gap-md) + 150px));overflow:visible}.templates-container.expanded[_ngcontent-%COMP%]{grid-template-rows:auto;max-height:none;overflow:visible}.template-card.hidden-card[_ngcontent-%COMP%]{display:none!important;opacity:0;transform:scale(.8);height:0;margin:0;padding:0;border:none;pointer-events:none}.templates-container-alt[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:max-height .5s cubic-bezier(.4,0,.2,1)}.templates-container-alt.collapsed[_ngcontent-%COMP%]{max-height:540px;overflow:hidden;mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%);-webkit-mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%)}.templates-container-alt.expanded[_ngcontent-%COMP%]{max-height:5000px;mask-image:none;-webkit-mask-image:none}']})};export{ee as ExpenseManagement};
