import{a as K}from"./chunk-3OUASXDG.js";import{a as J}from"./chunk-VT7RUZBT.js";import"./chunk-JVDFXZVZ.js";import"./chunk-NREUF4AQ.js";import{b as N,d as A,e as L,g as z,h as B,i as R,j,k as $,q as U,r as q,s as Y,u as G,v as Q,x as H}from"./chunk-PZ6IGEMS.js";import"./chunk-F35UPSG6.js";import"./chunk-4GBXVLF4.js";import"./chunk-37GYPR4T.js";import{i as D,j as O,k as P,s as W}from"./chunk-PWZZTUE6.js";import{$a as u,Eb as S,Ga as s,Hb as a,Ib as h,Jb as _,Nb as v,Ob as E,Pb as y,Tb as k,Wa as V,ba as F,gb as I,ha as c,hb as m,ia as x,ib as n,jb as t,kb as C,qb as M,tb as g,vb as d}from"./chunk-DU5L5MFQ.js";import{a as w,b,j as f}from"./chunk-4ZZIO3ZI.js";var Z=(l,i)=>({"recurring-info":l,"non-recurring-info":i});function ee(l,i){if(l&1){let e=M();n(0,"div",16)(1,"label",17),a(2,"Mese"),t(),n(3,"button",25),g("click",function(){c(e);let o=d();return x(o.openMonthsModal())}),n(4,"span",26),a(5,"calendar_today"),t(),a(6),t()()}if(l&2){let e=d();s(6),_(" ",e.formatMonth(e.selectedMonth)," ")}}function te(l,i){if(l&1){let e=M();n(0,"button",42),g("click",function(){c(e);let o=d(2);return x(o.showAllTemplates=!o.showAllTemplates)}),n(1,"span",26),a(2),t(),a(3),t()}if(l&2){let e=d(2);s(2),h(e.showAllTemplates?"expand_less":"expand_more"),s(),_(" ",e.showAllTemplates?"Mostra meno":"Mostra tutto"," ")}}function ne(l,i){if(l&1&&(n(0,"div"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_("A: ",r.formatMonthDisplay(e.end_month))}}function ie(l,i){if(l&1){let e=M();n(0,"div",43)(1,"div",44)(2,"div")(3,"h4",45),a(4),t(),n(5,"div",46)(6,"span",47),a(7),t(),n(8,"span",48),a(9),t(),n(10,"span",5),a(11),t()()(),n(12,"button",49),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.deactivateRecurringTemplate(o.id))}),n(13,"span",26),a(14,"toggle_off"),t()()(),n(15,"div",50)(16,"div"),a(17),t(),u(18,ne,2,1,"div",32),t()()}if(l&2){let e=i.$implicit,r=i.index,o=d(2);S("hidden-card",!o.showAllTemplates&&r>=3),s(4),h(e.name),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(o.formatCurrency(e.amount)),s(2),h(e.category),s(6),_("Da: ",o.formatMonthDisplay(e.start_month)),s(),m("ngIf",e.end_month)}}function ae(l,i){if(l&1&&(n(0,"div",51)(1,"p"),a(2),t()()),l&2){let e=d(2);s(2),_("+",e.recurringTemplates.length-3," altri template nascosti")}}function re(l,i){if(l&1&&(n(0,"div",13)(1,"div",36)(2,"div",37)(3,"span",9),a(4,"repeat"),t(),n(5,"h3",10),a(6),t()(),u(7,te,4,2,"button",38),t(),n(8,"div",39),u(9,ie,19,10,"div",40),t(),u(10,ae,3,1,"div",41),t()),l&2){let e=d();s(6),_("Spese Ricorrenti (",e.recurringTemplates.length,")"),s(),m("ngIf",e.recurringTemplates.length>3),s(),S("expanded",e.showAllTemplates)("collapsed",!e.showAllTemplates),s(),m("ngForOf",e.recurringTemplates),s(),m("ngIf",!e.showAllTemplates&&e.recurringTemplates.length>3)}}function oe(l,i){l&1&&(n(0,"th"),a(1,"Mese"),t())}function se(l,i){l&1&&(n(0,"span",60),a(1," repeat "),t())}function le(l,i){if(l&1&&(n(0,"span",61),a(1),t()),l&2){let e=d().$implicit,r=d();s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function pe(l,i){l&1&&(n(0,"span",5),a(1,"-"),t())}function de(l,i){if(l&1&&(n(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d();s(),h(r.formatMonth(e.month))}}function me(l,i){if(l&1){let e=M();n(0,"tr",52)(1,"td")(2,"div",37)(3,"strong"),a(4),t(),u(5,se,2,0,"span",53),t()(),n(6,"td")(7,"span",47),a(8),t()(),n(9,"td"),a(10),t(),n(11,"td")(12,"strong"),a(13),t()(),n(14,"td"),u(15,le,2,1,"span",54)(16,pe,2,0,"span",55),t(),u(17,de,2,1,"td",32),n(18,"td",56),a(19),t(),n(20,"td")(21,"div",2)(22,"button",57),g("click",function(){let o=c(e).$implicit,p=d();return x(p.toggleExpenseStatus(o))}),n(23,"span",26),a(24),t()(),n(25,"button",58),g("click",function(){let o=c(e).$implicit,p=d();return x(p.openEditExpenseModal(o))}),n(26,"span",26),a(27,"edit"),t()(),n(28,"button",59),g("click",function(){let o=c(e).$implicit,p=d();return x(p.deleteExpense(o))}),n(29,"span",26),a(30,"delete"),t()()()()()}if(l&2){let e=i.$implicit,r=d();S("inactive-row",!e.is_active),s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(3),S("active-toggle",e.is_active),m("title",e.is_active?"Disattiva spesa":"Attiva spesa"),s(2),_(" ",e.is_active?"toggle_on":"toggle_off"," ")}}function ce(l,i){if(l&1&&(n(0,"p",5),a(1),t()),l&2){let e=d(2);s(),_('Nessuna spesa trovata per "',e.searchTerm,'"')}}function xe(l,i){l&1&&(n(0,"p",5),a(1,"Nessuna spesa registrata"),t())}function ge(l,i){if(l&1){let e=M();n(0,"tr")(1,"td",62)(2,"div",63)(3,"span",64),a(4,"receipt_long"),t(),u(5,ce,2,1,"p",55)(6,xe,2,0,"p",55),n(7,"button",42),g("click",function(){c(e);let o=d();return x(o.openAddExpenseModal())}),n(8,"span",26),a(9,"add"),t(),a(10," Aggiungi la prima spesa "),t()()()()}if(l&2){let e=d();s(),I("colspan",e.viewMode==="all"?8:7),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm)}}function ue(l,i){l&1&&(n(0,"th"),a(1,"Mese"),t())}function _e(l,i){l&1&&(n(0,"span",60),a(1," repeat "),t())}function he(l,i){if(l&1&&(n(0,"span",61),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),_(" ",r.getSupplierName(e.supplier_id)," ")}}function fe(l,i){l&1&&(n(0,"span",5),a(1,"-"),t())}function ve(l,i){if(l&1&&(n(0,"td"),a(1),t()),l&2){let e=d().$implicit,r=d(2);s(),h(r.formatMonth(e.month))}}function Ee(l,i){if(l&1){let e=M();n(0,"tr",74)(1,"td")(2,"div",37)(3,"strong"),a(4),t(),u(5,_e,2,0,"span",53),t()(),n(6,"td")(7,"span",47),a(8),t()(),n(9,"td"),a(10),t(),n(11,"td")(12,"strong"),a(13),t()(),n(14,"td"),u(15,he,2,1,"span",54)(16,fe,2,0,"span",55),t(),u(17,ve,2,1,"td",32),n(18,"td",56),a(19),t(),n(20,"td",75),a(21),t(),n(22,"td")(23,"div",2)(24,"button",76),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.toggleExpenseStatus(o))}),n(25,"span",26),a(26," toggle_off "),t()(),n(27,"button",77),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.openEditExpenseModal(o))}),n(28,"span",26),a(29,"visibility"),t()(),n(30,"button",78),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.permanentlyDeleteExpense(o))}),n(31,"span",26),a(32,"delete_forever"),t()()()()()}if(l&2){let e=i.$implicit,r=d(2);s(4),h(e.name),s(),m("ngIf",e.is_recurring),s(2),S("active",e.type==="fissa"),s(),_(" ",e.type==="fissa"?"Fissa":"Variabile"," "),s(2),h(e.category),s(3),h(r.formatCurrency(e.amount)),s(2),m("ngIf",e.supplier_id),s(),m("ngIf",!e.supplier_id),s(),m("ngIf",r.viewMode==="all"),s(2),h(e.notes||"-"),s(2),_(" ",r.formatDeletedDate(e.deleted_at)," ")}}function ye(l,i){if(l&1&&(n(0,"p",5),a(1),t()),l&2){let e=d(3);s(),_('Nessuna spesa disattivata trovata per "',e.searchTerm,'"')}}function Me(l,i){l&1&&(n(0,"p",5),a(1,"Nessuna spesa disattivata"),t())}function Se(l,i){if(l&1&&(n(0,"tr")(1,"td",62)(2,"div",63)(3,"span",64),a(4,"archive"),t(),u(5,ye,2,1,"p",55)(6,Me,2,0,"p",55),t()()()),l&2){let e=d(2);s(),I("colspan",e.viewMode==="all"?9:8),s(4),m("ngIf",e.searchTerm),s(),m("ngIf",!e.searchTerm)}}function we(l,i){if(l&1&&(n(0,"div",65)(1,"div",1)(2,"div",2)(3,"span",66),a(4,"archive"),t(),n(5,"h1",4),a(6,"Spese Disattivate"),t()(),n(7,"p",5),a(8,"Visualizza e gestisci le spese disattivate"),t()(),n(9,"div",6)(10,"div",7)(11,"div",8)(12,"span",67),a(13,"money_off"),t(),n(14,"h3",10),a(15,"Totale Disattivate"),t()(),n(16,"div",11)(17,"div",68),a(18),t()()(),n(19,"div",7)(20,"div",8)(21,"span",69),a(22,"repeat"),t(),n(23,"h3",10),a(24,"Fisse Disattivate"),t()(),n(25,"div",11)(26,"div",70),a(27),t()()(),n(28,"div",7)(29,"div",8)(30,"span",71),a(31,"receipt"),t(),n(32,"h3",10),a(33,"Variabili Disattivate"),t()(),n(34,"div",11)(35,"div",72),a(36),t()()()(),n(37,"div",29)(38,"div",30)(39,"table",31)(40,"thead")(41,"tr")(42,"th"),a(43,"Nome"),t(),n(44,"th"),a(45,"Tipo"),t(),n(46,"th"),a(47,"Categoria"),t(),n(48,"th"),a(49,"Importo"),t(),n(50,"th"),a(51,"Fornitore"),t(),u(52,ue,2,0,"th",32),n(53,"th"),a(54,"Note"),t(),n(55,"th"),a(56,"Data Disattivazione"),t(),n(57,"th"),a(58,"Azioni"),t()()(),n(59,"tbody"),u(60,Ee,33,12,"tr",73)(61,Se,7,3,"tr",32),t()()()()()),l&2){let e=d();s(18),_(" ",e.formatCurrency(e.deletedExpensesTotal)," "),s(9),_(" ",e.deletedFixedExpensesCount," "),s(9),_(" ",e.deletedVariableExpensesCount," "),s(16),m("ngIf",e.viewMode==="all"),s(8),m("ngForOf",e.filteredDeletedExpenses),s(),m("ngIf",e.filteredDeletedExpenses.length===0)}}function be(l,i){l&1&&(n(0,"p",5)(1,"span",114),a(2,"info"),t(),a(3," Le spese fisse sono automaticamente ricorrenti "),t())}function Ce(l,i){l&1&&(n(0,"p",5)(1,"span",114),a(2,"info"),t(),a(3," Le spese variabili sono una tantum "),t())}function Te(l,i){if(l&1&&(n(0,"option",101),a(1),t()),l&2){let e=i.$implicit;m("value",e),s(),_(" ",e," ")}}function Fe(l,i){if(l&1&&(n(0,"span"),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name)}}function Ie(l,i){if(l&1&&(n(0,"option",101),a(1),u(2,Fe,2,1,"span",32),t()),l&2){let e=i.$implicit;m("value",e.id),s(),_(" ",e.company_name," "),s(),m("ngIf",e.contact_name)}}function Ve(l,i){l&1&&(n(0,"span",26),a(1,"repeat"),t())}function ke(l,i){l&1&&(n(0,"span",26),a(1,"event"),t())}function De(l,i){l&1&&(n(0,"span"),a(1,"Spesa ricorrente"),t())}function Oe(l,i){l&1&&(n(0,"span"),a(1,"Spesa una tantum"),t())}function Pe(l,i){if(l&1){let e=M();n(0,"div",79)(1,"div",80)(2,"div",81)(3,"div",82)(4,"div",83)(5,"span",26),a(6),t()(),n(7,"div")(8,"h1",4),a(9),t(),u(10,be,4,0,"p",55)(11,Ce,4,0,"p",55),t()(),n(12,"button",84),g("click",function(){c(e);let o=d();return x(o.closeExpenseModal())}),n(13,"span",26),a(14,"close"),t()()(),n(15,"form",85),g("submit",function(o){return c(e),d().saveExpense(),x(o.preventDefault())}),n(16,"div",13)(17,"div",86)(18,"div",16)(19,"label",87)(20,"span",26),a(21,"title"),t(),a(22," Nome Spesa * "),t(),n(23,"input",88),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.name,o)||(p.expenseForm.name=o),x(o)}),t()(),n(24,"div",16)(25,"label",89)(26,"span",26),a(27,"euro"),t(),a(28," Importo (\u20AC) * "),t(),n(29,"input",90),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.amount,o)||(p.expenseForm.amount=o),x(o)}),t()()(),n(30,"div",86)(31,"div",16)(32,"label",91)(33,"span",26),a(34,"category"),t(),a(35," Tipo * "),t(),n(36,"select",92),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.type,o)||(p.expenseForm.type=o),x(o)}),g("change",function(){c(e);let o=d();return x(o.onExpenseTypeChange())}),n(37,"option",93),a(38,"Spesa Fissa (ricorrente)"),t(),n(39,"option",94),a(40,"Spesa Variabile (una tantum)"),t()()(),n(41,"div",16)(42,"label",95)(43,"span",26),a(44,"label"),t(),a(45," Categoria * "),t(),n(46,"select",96),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.category,o)||(p.expenseForm.category=o),x(o)}),n(47,"option",97),a(48,"Seleziona categoria"),t(),u(49,Te,2,2,"option",98),t()()(),n(50,"div",86)(51,"div",16)(52,"label",99)(53,"span",26),a(54,"local_shipping"),t(),a(55," Fornitore "),t(),n(56,"select",100),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.supplier_id,o)||(p.expenseForm.supplier_id=o),x(o)}),n(57,"option",101),a(58,"Nessun fornitore"),t(),u(59,Ie,3,3,"option",98),t()(),n(60,"div",102)(61,"button",103),g("click",function(){c(e);let o=d();return x(o.openSupplierModal())}),n(62,"span",26),a(63,"add"),t(),a(64," Nuovo "),t()()(),n(65,"div",86)(66,"div",16)(67,"label",104)(68,"span",26),a(69,"calendar_today"),t(),a(70," Mese * "),t(),n(71,"input",105),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.month,o)||(p.expenseForm.month=o),x(o)}),t()(),n(72,"div",106)(73,"div",107),u(74,Ve,2,0,"span",108)(75,ke,2,0,"span",108)(76,De,2,0,"span",32)(77,Oe,2,0,"span",32),t()()(),n(78,"div",109)(79,"label",110)(80,"span",26),a(81,"notes"),t(),a(82," Note "),t(),n(83,"textarea",111),y("ngModelChange",function(o){c(e);let p=d();return E(p.expenseForm.notes,o)||(p.expenseForm.notes=o),x(o)}),t()()(),n(84,"div",24)(85,"button",112),g("click",function(){c(e);let o=d();return x(o.closeExpenseModal())}),a(86," Annulla "),t(),n(87,"button",113),a(88),t()()()()()}if(l&2){let e=d();s(6),h(e.editingExpense?"edit":"add"),s(3),h(e.editingExpense?"Modifica Spesa":"Nuova Spesa"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(12),v("ngModel",e.expenseForm.name),s(6),v("ngModel",e.expenseForm.amount),s(7),v("ngModel",e.expenseForm.type),s(10),v("ngModel",e.expenseForm.category),s(3),m("ngForOf",e.getCategoriesByType(e.expenseForm.type)),s(7),v("ngModel",e.expenseForm.supplier_id),s(),m("value",null),s(2),m("ngForOf",e.suppliers),s(12),v("ngModel",e.expenseForm.month),s(2),m("ngClass",k(20,Z,e.expenseForm.type==="fissa",e.expenseForm.type==="variabile")),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(),m("ngIf",e.expenseForm.type==="fissa"),s(),m("ngIf",e.expenseForm.type==="variabile"),s(6),v("ngModel",e.expenseForm.notes),s(5),_(" ",e.editingExpense?"Aggiorna":"Crea"," Spesa ")}}function We(l,i){if(l&1){let e=M();n(0,"button",118),g("click",function(){let o=c(e).$implicit,p=d(2);return x(p.changeMonth(o))}),a(1),t()}if(l&2){let e=i.$implicit,r=d(2);S("active",e===r.selectedMonth),s(),_(" ",r.formatMonth(e)," ")}}function Ne(l,i){if(l&1){let e=M();n(0,"div",79)(1,"div",115)(2,"div",81)(3,"div",82)(4,"div",83)(5,"span",26),a(6,"calendar_today"),t()(),n(7,"div")(8,"h1",4),a(9,"Seleziona Mese"),t()()(),n(10,"button",84),g("click",function(){c(e);let o=d();return x(o.closeMonthsModal())}),n(11,"span",26),a(12,"close"),t()()(),n(13,"div",13)(14,"div",116),u(15,We,2,3,"button",117),t()(),n(16,"div",24)(17,"button",112),g("click",function(){c(e);let o=d();return x(o.closeMonthsModal())}),a(18," Chiudi "),t()()()()}if(l&2){let e=d();s(15),m("ngForOf",e.availableMonths)}}function Ae(l,i){if(l&1&&(n(0,"div",129)(1,"span",130),a(2),t(),n(3,"span",47),a(4),t()()),l&2){let e=i.$implicit;s(2),h(e.name),s(),S("active",e.type==="fissa")("warning",e.type==="variabile"),s(),_(" ",e.type==="entrambi"?"Entrambi":e.type==="fissa"?"Fisse":"Variabili"," ")}}function Le(l,i){l&1&&(n(0,"div",62)(1,"p"),a(2,"Nessuna categoria personalizzata creata"),t()())}function ze(l,i){if(l&1){let e=M();n(0,"div",79)(1,"div",119)(2,"div",81)(3,"div",82)(4,"div",83)(5,"span",26),a(6,"category"),t()(),n(7,"div")(8,"h1",4),a(9,"Gestione Categorie"),t()()(),n(10,"button",84),g("click",function(){c(e);let o=d();return x(o.closeCategoryModal())}),n(11,"span",26),a(12,"close"),t()()(),n(13,"div",13)(14,"div",120)(15,"h3",8)(16,"span",26),a(17,"add"),t(),a(18," Nuova Categoria "),t(),n(19,"form",85),g("submit",function(o){return c(e),d().saveCategory(),x(o.preventDefault())}),n(20,"div",86)(21,"div",16)(22,"label",121)(23,"span",26),a(24,"title"),t(),a(25," Nome Categoria * "),t(),n(26,"input",122),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.name,o)||(p.categoryForm.name=o),x(o)}),t()(),n(27,"div",16)(28,"label",123)(29,"span",26),a(30,"filter_alt"),t(),a(31," Tipo "),t(),n(32,"select",124),y("ngModelChange",function(o){c(e);let p=d();return E(p.categoryForm.type,o)||(p.categoryForm.type=o),x(o)}),n(33,"option",125),a(34,"Entrambi i tipi"),t(),n(35,"option",93),a(36,"Solo Spese Fisse"),t(),n(37,"option",94),a(38,"Solo Spese Variabili"),t()()()(),n(39,"div",15)(40,"div",24)(41,"button",112),g("click",function(){c(e);let o=d();return x(o.closeCategoryModal())}),a(42," Annulla "),t(),n(43,"button",113),a(44," Crea Categoria "),t()()()()(),n(45,"div")(46,"h3",8)(47,"span",26),a(48,"list"),t(),a(49," Categorie Esistenti "),t(),n(50,"div",126),u(51,Ae,5,6,"div",127)(52,Le,3,0,"div",128),t()()()()()}if(l&2){let e=d();s(26),v("ngModel",e.categoryForm.name),s(6),v("ngModel",e.categoryForm.type),s(19),m("ngForOf",e.categories),s(),m("ngIf",e.categories.length===0)}}function Be(l,i){if(l&1&&(n(0,"span",5),a(1),t()),l&2){let e=d().$implicit;s(),_("- ",e.contact_name)}}function Re(l,i){if(l&1&&(n(0,"span",150),a(1),t()),l&2){let e=d().$implicit;s(),h(e.email)}}function je(l,i){if(l&1&&(n(0,"span",48),a(1),t()),l&2){let e=d().$implicit;s(),h(e.phone)}}function $e(l,i){if(l&1&&(n(0,"div",145)(1,"div",146)(2,"strong"),a(3),t(),u(4,Be,2,1,"span",55),t(),n(5,"div",147),u(6,Re,2,1,"span",148)(7,je,2,1,"span",149),t()()),l&2){let e=i.$implicit;s(3),h(e.company_name),s(),m("ngIf",e.contact_name),s(2),m("ngIf",e.email),s(),m("ngIf",e.phone)}}function Ue(l,i){l&1&&(n(0,"div",62)(1,"p"),a(2,"Nessun fornitore creato"),t()())}function qe(l,i){if(l&1){let e=M();n(0,"div",79)(1,"div",80)(2,"div",81)(3,"div",82)(4,"div",83)(5,"span",26),a(6,"local_shipping"),t()(),n(7,"div")(8,"h1",4),a(9,"Gestione Fornitori"),t()()(),n(10,"button",84),g("click",function(){c(e);let o=d();return x(o.closeSupplierModal())}),n(11,"span",26),a(12,"close"),t()()(),n(13,"div",13)(14,"div",120)(15,"h3",8)(16,"span",26),a(17,"add"),t(),a(18," Nuovo Fornitore "),t(),n(19,"form",85),g("submit",function(o){return c(e),d().saveSupplier(),x(o.preventDefault())}),n(20,"div",86)(21,"div",16)(22,"label",131)(23,"span",26),a(24,"business"),t(),a(25," Nome Ditta * "),t(),n(26,"input",132),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.company_name,o)||(p.supplierForm.company_name=o),x(o)}),t()(),n(27,"div",16)(28,"label",133)(29,"span",26),a(30,"person"),t(),a(31," Referente "),t(),n(32,"input",134),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.contact_name,o)||(p.supplierForm.contact_name=o),x(o)}),t()()(),n(33,"div",86)(34,"div",16)(35,"label",135)(36,"span",26),a(37,"email"),t(),a(38," Email "),t(),n(39,"input",136),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.email,o)||(p.supplierForm.email=o),x(o)}),t()(),n(40,"div",16)(41,"label",137)(42,"span",26),a(43,"phone"),t(),a(44," Telefono "),t(),n(45,"input",138),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.phone,o)||(p.supplierForm.phone=o),x(o)}),t()()(),n(46,"div",109)(47,"label",139)(48,"span",26),a(49,"location_on"),t(),a(50," Indirizzo "),t(),n(51,"textarea",140),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.address,o)||(p.supplierForm.address=o),x(o)}),t()(),n(52,"div",109)(53,"label",141)(54,"span",26),a(55,"notes"),t(),a(56," Descrizione "),t(),n(57,"textarea",142),y("ngModelChange",function(o){c(e);let p=d();return E(p.supplierForm.description,o)||(p.supplierForm.description=o),x(o)}),t()(),n(58,"div",24)(59,"button",112),g("click",function(){c(e);let o=d();return x(o.closeSupplierModal())}),a(60," Annulla "),t(),n(61,"button",113),a(62," Crea Fornitore "),t()()()(),n(63,"div")(64,"h3",8)(65,"span",26),a(66,"list"),t(),a(67," Fornitori Esistenti "),t(),n(68,"div",143),u(69,$e,8,4,"div",144)(70,Ue,3,0,"div",128),t()()()()()}if(l&2){let e=d();s(26),v("ngModel",e.supplierForm.company_name),s(6),v("ngModel",e.supplierForm.contact_name),s(7),v("ngModel",e.supplierForm.email),s(6),v("ngModel",e.supplierForm.phone),s(6),v("ngModel",e.supplierForm.address),s(6),v("ngModel",e.supplierForm.description),s(12),m("ngForOf",e.suppliers),s(),m("ngIf",e.suppliers.length===0)}}function Ye(l,i){if(l&1){let e=M();n(0,"div",79)(1,"div",115)(2,"div",81)(3,"div",82)(4,"div",83)(5,"span",26),a(6,"repeat"),t()(),n(7,"div")(8,"h1",4),a(9,"Modifica Spese Future"),t()()()(),n(10,"div",13)(11,"div",151)(12,"div",152)(13,"span",153),a(14,"info"),t()(),n(15,"h3",154),a(16,"La modifica \xE8 stata salvata"),t(),n(17,"p",155),a(18,' La spesa "'),n(19,"strong"),a(20),t(),a(21,'" \xE8 ricorrente.'),C(22,"br")(23,"br"),a(24," Vuoi applicare questa modifica anche a tutti i mesi futuri? "),t(),n(25,"div",156)(26,"div",157),g("click",function(){c(e);let o=d();return x(o.onlyCurrentMonth())}),n(27,"div",158)(28,"span",159),a(29,"today"),t(),n(30,"strong"),a(31,"Solo questo mese"),t()(),n(32,"p",5),a(33),t()(),n(34,"div",160),g("click",function(){c(e);let o=d();return x(o.applyToFutureMonths())}),n(35,"div",158)(36,"span",159),a(37,"date_range"),t(),n(38,"strong"),a(39,"Tutti i mesi futuri"),t()(),n(40,"p",5),a(41,"La modifica verr\xE0 applicata a partire dal mese successivo"),t()()()(),n(42,"div",24)(43,"button",112),g("click",function(){c(e);let o=d();return x(o.onlyCurrentMonth())}),n(44,"span",26),a(45,"today"),t(),a(46," Solo questo mese "),t(),n(47,"button",161),g("click",function(){c(e);let o=d();return x(o.applyToFutureMonths())}),n(48,"span",26),a(49,"date_range"),t(),a(50," Tutti i mesi futuri "),t()()()()()}if(l&2){let e=d();s(20),h(e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.name),s(13),_("La modifica verr\xE0 applicata solo a ",e.formatMonthDisplay((e.pendingExpenseUpdate==null?null:e.pendingExpenseUpdate.expenseData.month)||""))}}var X=class l{expenseService=F(K);supplierService=F(J);expenseSubscription;templatesSubscription;categoriesSubscription;suppliersSubscription;expenses=[];availableMonths=[];categories=[];suppliers=[];recurringTemplates=[];showDeletedExpenses=!1;selectedMonth=this.getCurrentMonth();viewMode="monthly";searchTerm="";showExpenseModal=!1;showMonthsModal=!1;showCategoryModal=!1;showSupplierModal=!1;editingExpense=null;showFutureMonthsConfirm=!1;pendingExpenseUpdate=null;recurringTemplateForm={name:"",amount:0,type:"fissa",category:"",notes:"",supplier_id:null,start_month:this.getCurrentMonth(),end_month:""};expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.getCurrentMonth(),notes:"",supplier_id:null,template_id:null};categoryForm={name:"",type:"entrambi"};supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""};showAllTemplates=!1;showDeletedSection=!1;deletedExpenses=[];loadingDeleted=!1;get monthlyStats(){return this.expenseService.calculateMonthlyTotal(this.filteredExpenses)}get filteredExpenses(){let i=this.expenses;if(this.viewMode==="monthly"&&(i=i.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();i=i.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return i}get allCategories(){let i=this.expenseService.getDefaultCategories(),e=this.categories.map(r=>r.name);return[...new Set([...i,...e])].sort()}getCategoriesByType(i){return this.allCategories.filter(e=>{let r=this.categories.find(o=>o.name===e);return r?r.type==="entrambi"||r.type===i:!0})}toggleDeletedSection(){return f(this,null,function*(){this.showDeletedSection=!this.showDeletedSection,this.showDeletedSection&&this.deletedExpenses.length===0&&(yield this.loadDeletedExpenses())})}loadDeletedExpenses(){return f(this,null,function*(){this.loadingDeleted=!0;try{this.viewMode==="monthly"?(console.log("\u{1F5D1}\uFE0F Loading deleted expenses for month:",this.selectedMonth),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForMonth(this.selectedMonth)):(console.log("\u{1F5D1}\uFE0F Loading ALL deleted expenses"),this.deletedExpenses=yield this.expenseService.loadDeletedExpensesForDateRange("2000-01-01","2030-12-01")),console.log("\u2705 Deleted expenses loaded:",this.deletedExpenses.length)}catch(i){console.error("\u274C Error loading deleted expenses:",i)}finally{this.loadingDeleted=!1}})}ngOnInit(){this.loadData()}ngOnDestroy(){this.expenseSubscription&&this.expenseSubscription.unsubscribe(),this.templatesSubscription&&this.templatesSubscription.unsubscribe(),this.categoriesSubscription&&this.categoriesSubscription.unsubscribe(),this.suppliersSubscription&&this.suppliersSubscription.unsubscribe()}loadData(){return f(this,null,function*(){try{console.log("\u{1F50D} Loading data for month:",this.selectedMonth),yield Promise.all([this.loadExpenses(),this.loadAvailableMonths(),this.loadCategories(),this.loadSuppliers(),this.loadRecurringTemplates()])}catch(i){console.error("\u274C Error loading data:",i)}})}loadRecurringTemplates(){return f(this,null,function*(){yield this.expenseService.loadRecurringTemplates(),this.templatesSubscription=this.expenseService.recurringTemplates$.subscribe(i=>{this.recurringTemplates=i,console.log("\u{1F4CB} Recurring templates loaded:",i.length)})})}loadSuppliers(){return f(this,null,function*(){yield this.supplierService.loadSuppliers(),this.suppliersSubscription=this.supplierService.suppliers$.subscribe(i=>{this.suppliers=i,console.log("\u{1F3E2} Suppliers loaded:",i.length)})})}loadExpenses(){return f(this,null,function*(){try{if(this.viewMode==="monthly")console.log("\u{1F4C5} Loading expenses for month:",this.selectedMonth),yield this.expenseService.loadExpensesForMonth(this.selectedMonth,!0),this.expenseSubscription=this.expenseService.data$.subscribe(i=>{this.expenses=i.filter(e=>!e.deleted_at),console.log("\u{1F4B0} Expenses loaded:",this.expenses.length)});else{console.log("\u{1F4CA} Loading ALL expenses");let i=yield this.expenseService.loadExpensesForDateRange("2000-01-01","2030-12-01");this.expenses=i.filter(e=>!e.deleted_at),console.log("\u{1F4CA} All expenses loaded:",this.expenses.length)}}catch(i){console.error("\u274C Error loading expenses:",i)}})}loadAvailableMonths(){return f(this,null,function*(){this.availableMonths=yield this.expenseService.getAvailableMonths(),console.log("\u{1F4C6} Available months:",this.availableMonths.length)})}loadCategories(){return f(this,null,function*(){yield this.expenseService.loadCategories(),this.categoriesSubscription=this.expenseService.categories$.subscribe(i=>{this.categories=i,console.log("\u{1F3F7}\uFE0F Categories loaded:",i.length)})})}getCurrentMonth(){let i=new Date;return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`}formatMonthForInput(i){return i.match(/^\d{4}-\d{2}$/)?i:i.match(/^\d{4}-\d{2}-\d{2}$/)?i.substring(0,7):this.getCurrentMonth()}formatMonthForDatabase(i){if(i.match(/^\d{4}-\d{2}$/))return`${i}-01`;if(i.match(/^\d{4}-\d{2}-\d{2}$/))return i;let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-01`}formatMonthDisplay(i){try{return new Date(this.formatMonthForDatabase(i)).toLocaleDateString("it-IT",{month:"long",year:"numeric"})}catch{return i}}formatCurrency(i){return`\u20AC${i.toFixed(2).replace(".",",")}`}getSupplierName(i){if(!i)return"Nessun fornitore";let e=this.suppliers.find(r=>r.id===i);return e?e.company_name:"Fornitore sconosciuto"}openAddExpenseModal(){this.editingExpense=null,this.expenseForm={name:"",amount:0,type:"fissa",category:"",month:this.formatMonthForInput(this.selectedMonth),notes:"",supplier_id:null,template_id:null},this.showExpenseModal=!0}openEditExpenseModal(i){console.log("\u{1F4DD} Opening edit modal for expense:",{id:i.id,name:i.name,template_id:i.template_id,month:i.month,amount:i.amount}),this.editingExpense=i,this.expenseForm={name:i.name,amount:i.amount,type:i.type,category:i.category,month:this.formatMonthForInput(i.month),notes:i.notes||"",supplier_id:i.supplier_id||null,template_id:i.template_id||null},this.showExpenseModal=!0}openCategoryModal(){this.categoryForm={name:"",type:"entrambi"},this.showCategoryModal=!0}openSupplierModal(){this.supplierForm={company_name:"",contact_name:"",email:"",phone:"",address:"",description:""},this.showSupplierModal=!0}closeExpenseModal(){this.showExpenseModal=!1,this.editingExpense=null}closeMonthsModal(){this.showMonthsModal=!1}closeCategoryModal(){this.showCategoryModal=!1}closeSupplierModal(){this.showSupplierModal=!1}saveExpense(){return f(this,null,function*(){if(console.log("\u{1F4BE} Starting saveExpense..."),console.log("\u{1F4CB} Form data:",this.expenseForm),console.log("\u270F\uFE0F Editing expense:",this.editingExpense),!this.expenseForm.name||!this.expenseForm.amount||!this.expenseForm.category){console.log("\u274C Validation failed: missing required fields"),alert("Compila tutti i campi obbligatori: Nome, Importo e Categoria");return}if(this.expenseForm.amount<=0){console.log("\u274C Validation failed: amount must be > 0"),alert("L'importo deve essere maggiore di 0");return}try{let i=b(w({},this.expenseForm),{month:this.formatMonthForDatabase(this.expenseForm.month),is_recurring:this.expenseForm.type==="fissa"});if(console.log("\u{1F4E4} Expense data to save:",i),console.log("\u{1F501} Is recurring (auto-determined):",i.is_recurring),this.editingExpense){if(console.log("\u{1F504} Updating existing expense:",this.editingExpense.id),!confirm(`Vuoi salvare le modifiche per la spesa "${this.editingExpense.name}"?`)){console.log("\u274C Save cancelled by user");return}let r=b(w({},i),{template_id:this.editingExpense.template_id||null});if(console.log("\u{1F4DD} Saving update for current month:",r),!(yield this.expenseService.update(this.editingExpense.id,r)))throw new Error("Update failed");if(console.log("\u2705 Expense updated successfully for current month"),this.editingExpense.type==="fissa"&&i.type==="fissa"){this.showFutureMonthsConfirm=!0,this.pendingExpenseUpdate={expenseId:this.editingExpense.id,expenseData:i,oldTemplateId:this.editingExpense.template_id||null};return}this.completeSaveOperation()}else{if(console.log("\u{1F195} Creating new expense"),!confirm(`Vuoi creare la nuova spesa "${i.name}"?`)){console.log("\u274C Save cancelled by user");return}if(i.type==="fissa"){let r={name:i.name,amount:i.amount,type:i.type,category:i.category,notes:i.notes||"",supplier_id:i.supplier_id,start_month:i.month};console.log("\u{1F4CB} Creating recurring template for fixed expense:",r);let o=yield this.expenseService.createRecurringTemplate(r);o&&(i.template_id=o.id,(yield this.expenseService.create(i))&&(console.log("\u2705 Fixed (recurring) expense created with template"),this.showSuccessAlert("Spesa fissa (ricorrente) creata con successo!")))}else i.is_recurring=!1,i.template_id=null,(yield this.expenseService.create(i))&&(console.log("\u2705 Variable (non-recurring) expense created"),this.showSuccessAlert("Spesa variabile creata con successo!"));this.completeSaveOperation()}}catch(i){console.error("\u274C Error saving expense:",i),this.showErrorAlert("Errore nel salvataggio della spesa: "+i.message)}})}applyToFutureMonths(){return f(this,null,function*(){if(this.pendingExpenseUpdate)try{let{expenseData:i,oldTemplateId:e}=this.pendingExpenseUpdate,r=this.getNextMonth(i.month),o={name:i.name,amount:i.amount,type:i.type,category:i.category,notes:i.notes||"",supplier_id:i.supplier_id,start_month:r};console.log("\u{1F4CB} Creating template for future months:",o);let p=yield this.expenseService.createRecurringTemplate(o);p&&(e&&(yield this.expenseService.updateRecurringTemplate(e,{is_active:!1,end_month:i.month})),yield this.expenseService.update(this.pendingExpenseUpdate.expenseId,{template_id:p.id}),console.log("\u2705 Created new template for future months"),this.showSuccessAlert("Modifica applicata a tutti i mesi futuri!"))}catch(i){console.error("\u274C Error applying to future months:",i),this.showErrorAlert("Errore nell'applicazione ai mesi futuri: "+i.message)}finally{this.completeSaveOperation()}})}onlyCurrentMonth(){return f(this,null,function*(){try{console.log("\u2705 Modification applied only to current month"),this.showSuccessAlert("Modifica applicata solo al mese corrente.")}finally{this.completeSaveOperation()}})}completeSaveOperation(){this.pendingExpenseUpdate=null,this.showFutureMonthsConfirm=!1,this.showExpenseModal=!1,this.editingExpense=null,this.loadExpenses()}showSuccessAlert(i){alert(i)}showErrorAlert(i){alert(i)}saveCategory(){return f(this,null,function*(){if(!this.categoryForm.name){alert("Inserisci un nome per la categoria");return}try{let i=b(w({},this.categoryForm),{is_active:!0});yield this.expenseService.createCategory(i),this.closeCategoryModal(),yield this.loadCategories(),alert("Categoria creata con successo!")}catch(i){console.error("Error saving category:",i),alert("Errore nella creazione della categoria")}})}saveSupplier(){return f(this,null,function*(){if(!this.supplierForm.company_name){alert("Inserisci il nome della ditta fornitrice");return}try{let i=b(w({},this.supplierForm),{user_id:null,is_platform_supplier:!1,is_approved:!0});yield this.supplierService.createSupplier(i),this.closeSupplierModal(),yield this.loadSuppliers(),alert("Fornitore creato con successo!")}catch(i){console.error("Error saving supplier:",i),alert("Errore nella creazione del fornitore")}})}openMonthsModal(){this.showMonthsModal=!0}formatMonth(i){return this.formatMonthDisplay(i)}deleteExpense(i){return f(this,null,function*(){if(confirm(`Sei sicuro di voler disattivare la spesa "${i.name}"?`))try{if(yield this.expenseService.update(i.id,{deleted_at:new Date().toISOString()}))yield this.loadExpenses(),alert("Spesa disattivata con successo!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("Error deleting expense:",e),alert("Errore nella disattivazione della spesa")}})}changeMonth(i){return f(this,null,function*(){console.log("\u{1F4C5} Changing month to:",i),this.selectedMonth=i,this.viewMode="monthly",yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses()),this.closeMonthsModal()})}changeViewMode(i){return f(this,null,function*(){this.viewMode=i,yield this.loadExpenses(),this.showDeletedSection&&(yield this.loadDeletedExpenses())})}formatDeletedDate(i){if(!i)return"Non eliminata";try{return new Date(i).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return i}}onExpenseTypeChange(){this.expenseForm.category=""}deactivateRecurringTemplate(i){return f(this,null,function*(){if(confirm("Vuoi disattivare questo template ricorrente? Le spese gi\xE0 generate rimarranno ma non se ne genereranno di nuove."))try{(yield this.expenseService.updateRecurringTemplate(i,{is_active:!1}))&&(yield this.expenseService.loadRecurringTemplates(),alert("Template disattivato con successo"))}catch(e){console.error("Error deactivating template:",e),alert("Errore nella disattivazione del template")}})}debugExpenses(){console.log("\u{1F50D} DEBUG - Current expenses:",this.expenses),console.log("\u{1F50D} DEBUG - Selected month:",this.selectedMonth),console.log("\u{1F50D} DEBUG - Filtered expenses:",this.filteredExpenses)}getNextMonth(i){try{if(i.match(/^\d{4}-\d{2}-\d{2}$/)){let r=new Date(i);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}if(i.match(/^\d{4}-\d{2}$/)){let r=new Date(`${i}-01`);return r.setMonth(r.getMonth()+1),r.toISOString().split("T")[0]}let e=new Date;return e.setMonth(e.getMonth()+1),e.toISOString().split("T")[0]}catch(e){console.error("\u274C Error calculating next month:",e);let r=new Date;return r.setMonth(r.getMonth()+1),`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-01`}}toggleExpenseStatus(i){return f(this,null,function*(){let e=i.is_active&&i.deleted_at===null,r=e?"disattivare":"attivare",o=e?"disattivata":"attivata";if(confirm(`Vuoi ${r} la spesa "${i.name}"?`))try{console.log(`\u{1F504} Cambiando stato della spesa "${i.name}" da attiva=${e} a attiva=${!e}`);let p=e?{deleted_at:new Date().toISOString(),is_active:!1}:{deleted_at:null,is_active:!0};if(yield this.expenseService.update(i.id,p))e?(this.deletedExpenses=[...this.deletedExpenses,w(w({},i),p)],this.expenses=this.expenses.filter(T=>T.id!==i.id)):(this.expenses=[...this.expenses,w(w({},i),p)],this.deletedExpenses=this.deletedExpenses.filter(T=>T.id!==i.id)),console.log(`\u2705 Spesa ${o}:`,i.name),alert(`Spesa ${o} con successo!`);else throw new Error("Operazione non riuscita")}catch(p){console.error("\u274C Errore nel cambiamento di stato:",p),alert("Errore nel cambiamento di stato della spesa")}})}toggleTemplatesView(){this.showAllTemplates=!this.showAllTemplates}get deletedExpensesTotal(){return this.deletedExpenses.reduce((i,e)=>i+e.amount,0)}get deletedFixedExpensesCount(){return this.deletedExpenses.filter(i=>i.type==="fissa").length}get deletedVariableExpensesCount(){return this.deletedExpenses.filter(i=>i.type==="variabile").length}get filteredDeletedExpenses(){let i=this.deletedExpenses;if(this.viewMode==="monthly"&&(i=i.filter(e=>e.month.startsWith(this.selectedMonth.substring(0,7)))),this.searchTerm){let e=this.searchTerm.toLowerCase();i=i.filter(r=>r.name.toLowerCase().includes(e)||r.category.toLowerCase().includes(e)||r.notes&&r.notes.toLowerCase().includes(e))}return i}permanentlyDeleteExpense(i){return f(this,null,function*(){if(confirm(`Sei sicuro di voler eliminare definitivamente la spesa "${i.name}"?
Questa azione \xE8 irreversibile e non potrai recuperare i dati!`))try{if(yield this.expenseService.hardDelete(i.id))this.deletedExpenses=this.deletedExpenses.filter(r=>r.id!==i.id),alert("Spesa eliminata definitivamente!");else throw new Error("Eliminazione non riuscita")}catch(e){console.error("\u274C Error permanently deleting expense:",e),alert("Errore nell'eliminazione definitiva della spesa")}})}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=V({type:l,selectors:[["app-expense-management"]],decls:106,vars:25,consts:[[1,"page-container"],[1,"section-header"],[1,"flex","gap-sm"],[1,"material-icons","fs-lg"],[1,"section-title"],[1,"text-muted"],[1,"grid-cards"],[1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"flex","flex-col","gap-md"],[1,"text-md","font-bold","text-primary","text-amber-500","justify-center","flex"],[1,"form-card"],[1,"flex","justify-between","items-end","gap-sm","flex-wrap"],[1,"form-row"],[1,"form-group"],[1,"standard-label"],[1,"flex","gap-md","flex-wrap"],[1,"radio-label"],["type","radio","name","viewMode",3,"ngModelChange","change","value","ngModel"],[1,"radio-checkmark"],["class","form-group",4,"ngIf"],["type","text","placeholder","Cerca per nome, categoria, fornitore...",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"promethea-button","ghost",3,"click"],[1,"material-icons"],[1,"promethea-button",3,"click"],["class","form-card",4,"ngIf"],[1,"table-section"],[1,"bg-body","border","rounded-lg","overflow-hidden","shadow-card","backdrop-blur"],[1,"crm-table"],[4,"ngIf"],["class","hover-lift transition",3,"inactive-row",4,"ngFor","ngForOf"],["class","mt-lg",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"flex","justify-between","items-center","mb-md"],[1,"flex","items-center","gap-sm"],["class","promethea-button ghost small",3,"click",4,"ngIf"],[1,"templates-container"],["class","card template-card",3,"hidden-card",4,"ngFor","ngForOf"],["class","text-center mt-sm text-muted",4,"ngIf"],[1,"promethea-button","ghost","small",3,"click"],[1,"card","template-card"],[1,"flex","justify-between","items-start"],[1,"font-bold"],[1,"flex","gap-sm","mt-sm","flex-wrap"],[1,"chip"],[1,"chip","secondary"],["title","Disattiva",1,"icon-button","small",3,"click"],[1,"mt-sm","text-sm","text-muted"],[1,"text-center","mt-sm","text-muted"],[1,"hover-lift","transition"],["class","material-icons text-primary fs-sm","title","Spesa ricorrente",4,"ngIf"],["class","chip primary",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"notes-preview"],[1,"icon-button",3,"click","title"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],["title","Spesa ricorrente",1,"material-icons","text-primary","fs-sm"],[1,"chip","primary"],[1,"text-center","p-xl","opacity-70"],[1,"flex","flex-col","items-center","gap-md"],[1,"material-icons","text-muted",2,"font-size","3rem"],[1,"mt-lg"],[1,"material-icons","fs-lg","text-red-500"],[1,"material-icons","text-red-500","text-md"],[1,"text-md","font-bold","text-red-500","justify-center","flex"],[1,"material-icons","text-blue-500","text-md"],[1,"text-md","font-bold","text-blue-500","justify-center","flex"],[1,"material-icons","text-purple-500","text-md"],[1,"text-md","font-bold","text-purple-500","justify-center","flex"],["class","deleted-row hover-lift transition",4,"ngFor","ngForOf"],[1,"deleted-row","hover-lift","transition"],[1,"text-sm","text-muted"],["title","Riattiva spesa",1,"icon-button","success",3,"click"],["title","Visualizza",1,"icon-button",3,"click"],["title","Elimina definitivamente",1,"icon-button","danger",3,"click"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"flex"],[1,"header-icon"],[1,"icon-button","close-button",3,"click"],[1,"generic-form",3,"submit"],[1,"form-row","mb-md"],["for","expense-name",1,"standard-label"],["type","text","id","expense-name","name","name","required","","placeholder","Es. Affitto locale",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-amount",1,"standard-label"],["type","number","id","expense-amount","name","amount","step","0.01","min","0","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","expense-type",1,"standard-label"],["id","expense-type","name","type","required","",1,"form-input",3,"ngModelChange","change","ngModel"],["value","fissa"],["value","variabile"],["for","expense-category",1,"standard-label"],["id","expense-category","name","category","required","",1,"form-input",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","expense-supplier",1,"standard-label"],["id","expense-supplier","name","supplier_id",1,"form-input",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-group",2,"justify-content","flex-end"],["type","button",1,"promethea-button","secondary","small",3,"click"],["for","expense-month",1,"standard-label"],["type","month","id","expense-month","name","month","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-group",2,"justify-content","center"],[1,"info-box",3,"ngClass"],["class","material-icons",4,"ngIf"],[1,"form-group","mb-md"],["for","expense-notes",1,"standard-label"],["id","expense-notes","name","notes","rows","3","placeholder","Note aggiuntive...",1,"form-input",3,"ngModelChange","ngModel"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button"],[1,"material-icons","text-primary","fs-sm"],[1,"modal-container","modal-sm"],[1,"months-grid"],["class","month-item promethea-button ghost",3,"active","click",4,"ngFor","ngForOf"],[1,"month-item","promethea-button","ghost",3,"click"],[1,"modal-container","modal-md"],[1,"mb-lg"],["for","category-name",1,"standard-label"],["type","text","id","category-name","name","name","required","","placeholder","Es. Manutenzione impianti",1,"form-input",3,"ngModelChange","ngModel"],["for","category-type",1,"standard-label"],["id","category-type","name","type","required","",1,"form-input",3,"ngModelChange","ngModel"],["value","entrambi"],[1,"categories-list"],["class","category-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],["class","text-center p-xl opacity-70",4,"ngIf"],[1,"category-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"category-name","font-semibold"],["for","supplier-company",1,"standard-label"],["type","text","id","supplier-company","name","company_name","required","","placeholder","Nome della ditta fornitrice",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-contact",1,"standard-label"],["type","text","id","supplier-contact","name","contact_name","placeholder","Nome del referente",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-email",1,"standard-label"],["type","email","id","supplier-email","name","email","placeholder","email@fornitore.com",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-phone",1,"standard-label"],["type","tel","id","supplier-phone","name","phone","placeholder","Numero di telefono",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-address",1,"standard-label"],["id","supplier-address","name","address","rows","2","placeholder","Indirizzo del fornitore",1,"form-input",3,"ngModelChange","ngModel"],["for","supplier-description",1,"standard-label"],["id","supplier-description","name","description","rows","3","placeholder","Note aggiuntive sul fornitore",1,"form-input",3,"ngModelChange","ngModel"],[1,"suppliers-list"],["class","supplier-item flex justify-between items-center mb-sm p-sm border rounded",4,"ngFor","ngForOf"],[1,"supplier-item","flex","justify-between","items-center","mb-sm","p-sm","border","rounded"],[1,"supplier-info"],[1,"supplier-details","flex","gap-sm"],["class","chip active",4,"ngIf"],["class","chip secondary",4,"ngIf"],[1,"chip","active"],[1,"confirmation-message"],[1,"confirmation-icon","flex","justify-center","mb-md"],[1,"material-icons","text-primary","fs-lg"],[1,"text-center","mb-md"],[1,"text-center","mb-lg"],[1,"confirmation-options","mb-lg"],[1,"option-item","border","rounded","p-md","mb-md","cursor-pointer","hover:bg-smoke",3,"click"],[1,"flex","items-center","gap-sm","mb-sm"],[1,"material-icons","text-primary"],[1,"option-item","border","rounded","p-md","cursor-pointer","hover:bg-smoke",3,"click"],["type","button",1,"promethea-button",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),a(4,"account_balance"),t(),n(5,"h1",4),a(6,"Gestione Spese"),t()(),n(7,"p",5),a(8,"Gestisci le spese fisse e variabili del tuo ristorante"),t()(),n(9,"div",6)(10,"div",7)(11,"div",8)(12,"span",9),a(13,"payments"),t(),n(14,"h3",10),a(15,"Spese Fisse"),t()(),n(16,"div",11)(17,"div",12),a(18),t()()(),n(19,"div",7)(20,"div",8)(21,"span",9),a(22,"receipt"),t(),n(23,"h3",10),a(24,"Spese Variabili"),t()(),n(25,"div",11)(26,"div",12),a(27),t()()(),n(28,"div",7)(29,"div",8)(30,"span",9),a(31,"account_balance"),t(),n(32,"h3",10),a(33,"Totale Mese"),t()(),n(34,"div",11)(35,"div",12),a(36),t()()()(),n(37,"div",13)(38,"div",14)(39,"div",15)(40,"div",16)(41,"label",17),a(42,"Periodo"),t(),n(43,"div",18)(44,"label",19)(45,"input",20),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),g("change",function(){return r.changeViewMode("monthly")}),t(),C(46,"span",21),n(47,"span"),a(48,"Mensile"),t()(),n(49,"label",19)(50,"input",20),y("ngModelChange",function(p){return E(r.viewMode,p)||(r.viewMode=p),p}),g("change",function(){return r.changeViewMode("all")}),t(),C(51,"span",21),n(52,"span"),a(53,"Tutti i Mesi"),t()()()(),u(54,ee,7,1,"div",22),t(),n(55,"div",16)(56,"label",17),a(57,"Cerca"),t(),n(58,"input",23),y("ngModelChange",function(p){return E(r.searchTerm,p)||(r.searchTerm=p),p}),t()()(),n(59,"div",24)(60,"button",25),g("click",function(){return r.toggleDeletedSection()}),n(61,"span",26),a(62),t(),a(63),t(),n(64,"button",25),g("click",function(){return r.openCategoryModal()}),n(65,"span",26),a(66,"category"),t(),a(67," Aggiungi Categorie "),t(),n(68,"button",25),g("click",function(){return r.openSupplierModal()}),n(69,"span",26),a(70,"local_shipping"),t(),a(71," Aggiungi Fornitori "),t(),n(72,"button",27),g("click",function(){return r.openAddExpenseModal()}),n(73,"span",26),a(74,"add"),t(),a(75," Nuova Spesa "),t()()(),u(76,re,11,8,"div",28),n(77,"div",29)(78,"div",30)(79,"table",31)(80,"thead")(81,"tr")(82,"th"),a(83,"Nome"),t(),n(84,"th"),a(85,"Tipo"),t(),n(86,"th"),a(87,"Categoria"),t(),n(88,"th"),a(89,"Importo"),t(),n(90,"th"),a(91,"Fornitore"),t(),u(92,oe,2,0,"th",32),n(93,"th"),a(94,"Note"),t(),n(95,"th"),a(96,"Azioni"),t()()(),n(97,"tbody"),u(98,me,31,17,"tr",33)(99,ge,11,3,"tr",32),t()()()(),u(100,we,62,6,"div",34)(101,Pe,89,23,"div",35)(102,Ne,19,1,"div",35)(103,ze,53,4,"div",35)(104,qe,71,8,"div",35)(105,Ye,51,2,"div",35),t()),e&2&&(s(18),h(r.formatCurrency(r.monthlyStats.fisse)),s(9),h(r.formatCurrency(r.monthlyStats.variabili)),s(9),h(r.formatCurrency(r.monthlyStats.totale)),s(8),S("active",r.viewMode==="monthly"),s(),m("value","monthly"),v("ngModel",r.viewMode),s(4),S("active",r.viewMode==="all"),s(),m("value","all"),v("ngModel",r.viewMode),s(4),m("ngIf",r.viewMode==="monthly"),s(4),v("ngModel",r.searchTerm),s(4),h(r.showDeletedSection?"visibility_off":"archive"),s(),_(" ",r.showDeletedSection?"Nascondi Disattivate":"Mostra Disattivate"," "),s(13),m("ngIf",r.recurringTemplates.length>0),s(16),m("ngIf",r.viewMode==="all"),s(6),m("ngForOf",r.filteredExpenses),s(),m("ngIf",r.filteredExpenses.length===0),s(),m("ngIf",r.showDeletedSection),s(),m("ngIf",r.showExpenseModal),s(),m("ngIf",r.showMonthsModal),s(),m("ngIf",r.showCategoryModal),s(),m("ngIf",r.showSupplierModal),s(),m("ngIf",r.showFutureMonthsConfirm))},dependencies:[W,D,O,P,H,R,q,Y,N,j,U,$,A,L,Q,G,B,z],styles:['.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);border:1px solid var(--smoke-1);border-radius:12px;cursor:pointer;transition:all .3s ease;background:var(--background)}.radio-label[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translateY(-2px)}.radio-label.active[_ngcontent-%COMP%]{background:var(--smoke-2);border-color:var(--primary);color:var(--primary)}.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.radio-checkmark[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid var(--smoke-1);border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background:var(--primary)}.radio-label.active[_ngcontent-%COMP%]   .radio-checkmark[_ngcontent-%COMP%]:after{content:"";width:8px;height:8px;background:#fff;border-radius:50%}.table-section[_ngcontent-%COMP%]{margin-top:var(--gap-lg)}.chip.small[_ngcontent-%COMP%]{padding:.125rem .5rem;font-size:.75rem}.chip.primary[_ngcontent-%COMP%]{background:var(--smoke-2);color:var(--primary);border-color:var(--smoke-2)}.notes-preview[_ngcontent-%COMP%]{max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-muted)}.input-group[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);align-items:stretch}.input-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;min-width:0}.input-group[_ngcontent-%COMP%]   .promethea-button.small[_ngcontent-%COMP%]{padding:var(--gap-sm);white-space:nowrap;flex-shrink:0}.months-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:var(--gap-sm);margin-bottom:var(--gap-lg)}.categories-list[_ngcontent-%COMP%], .suppliers-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.category-item[_ngcontent-%COMP%], .supplier-item[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;padding:var(--gap-sm);border:1px solid var(--smoke-1);border-radius:12px;transition:all .3s ease}.category-item[_ngcontent-%COMP%]:hover, .supplier-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translate(4px)}.supplier-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm);flex-wrap:wrap}@media (max-width: 768px){.flex.justify-between[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{align-self:stretch}.input-group[_ngcontent-%COMP%]{flex-direction:column}.supplier-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gap-sm)}.supplier-details[_ngcontent-%COMP%]{align-self:stretch;justify-content:flex-start}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.recurring-templates-list[_ngcontent-%COMP%], .template-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm)}.template-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);transform-origin:top}.template-card.hidden[_ngcontent-%COMP%]{transform:scaleY(0);opacity:0;height:0;margin:0;padding:0;border:none;overflow:hidden}.grid-cards[_ngcontent-%COMP%]{transition:all .3s ease}.additional-templates[_ngcontent-%COMP%]{margin-top:var(--gap-md);animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}.animate-expand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_expand .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_expand{0%{opacity:0;transform:translateY(-10px);max-height:0}to{opacity:1;transform:translateY(0);max-height:1000px}}.templates-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:grid-template-rows .3s ease}.templates-container.collapsed[_ngcontent-%COMP%]{grid-template-rows:repeat(auto-fit,minmax(0,1fr));max-height:calc(3 * (var(--gap-md) + 150px));overflow:visible}.templates-container.expanded[_ngcontent-%COMP%]{grid-template-rows:auto;max-height:none;overflow:visible}.template-card.hidden-card[_ngcontent-%COMP%]{display:none!important;opacity:0;transform:scale(.8);height:0;margin:0;padding:0;border:none;pointer-events:none}.templates-container-alt[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-md);transition:max-height .5s cubic-bezier(.4,0,.2,1)}.templates-container-alt.collapsed[_ngcontent-%COMP%]{max-height:540px;overflow:hidden;mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%);-webkit-mask-image:linear-gradient(to bottom,var(--text-color) 70%,transparent 100%)}.templates-container-alt.expanded[_ngcontent-%COMP%]{max-height:5000px;mask-image:none;-webkit-mask-image:none}']})};export{X as ExpenseManagement};
