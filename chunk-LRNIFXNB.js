import{a as l}from"./chunk-5BFIQ7BP.js";import{$ as s,f as a,xa as n}from"./chunk-K5RDB55Y.js";var c=class o extends l{getTableName(){return"tables"}loadData(){return a(this,null,function*(){try{let e=yield this.getCurrentRestaurantId();if(!e)return;let{data:r,error:t}=yield this.supabaseService.getSupabaseClient().from(this.getTableName()).select("*").eq("restaurant_id",e).eq("is_active",!0).order("created_at",{ascending:!1});if(t)throw t;this.dataSubject.next(r||[])}catch(e){console.error(`Error loading ${this.getTableName()}:`,e)}})}getTables(){return this.dataSubject.value}getTablesByFloorPlan(e){return this.dataSubject.value.filter(r=>r.floor_plan_id===e)}createTable(e){return a(this,null,function*(){try{console.log("\u{1F4DD} Creating table with shape:",e.shape);let{data:r,error:t}=yield this.supabaseService.getSupabaseClient().from("tables").insert(e).select().single();if(t)throw console.error("\u274C Error creating table:",t),console.error("\u274C Error details:",t.details),t;return console.log("\u2705 Table created successfully"),yield this.loadData(),r}catch(r){return console.error("\u{1F4A5} Error in createTable:",r),null}})}updateTable(e,r){return a(this,null,function*(){try{let{error:t}=yield this.supabaseService.getSupabaseClient().from("tables").update(r).eq("id",e);if(t)throw t;return yield this.loadData(),!0}catch(t){return console.error("\u274C Error updating table:",t),!1}})}deleteTable(e){return a(this,null,function*(){try{let{error:r}=yield this.supabaseService.getSupabaseClient().from("tables").update({is_active:!1}).eq("id",e);if(r)throw r;return yield this.loadData(),!0}catch(r){return console.error("\u274C Error deleting table:",r),!1}})}checkTableOverlap(e,r){let t=this.getTablesByFloorPlan(e.floor_plan_id).filter(i=>i.id!==r);for(let i of t)if(this.doTablesOverlap(e,i))return!0;return!1}doTablesOverlap(e,r){return!(e.position_x+e.width<=r.position_x||e.position_x>=r.position_x+r.width||e.position_y+e.height<=r.position_y||e.position_y>=r.position_y+r.height)}static \u0275fac=(()=>{let e;return function(t){return(e||(e=n(o)))(t||o)}})();static \u0275prov=s({token:o,factory:o.\u0275fac,providedIn:"root"})};export{c as a};
