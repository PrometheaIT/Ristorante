import{a as j}from"./chunk-THMILZHX.js";import{b as T,d as z,h as V,w as F}from"./chunk-77SKEQNN.js";import{d as S,e as k,k as I,t as L}from"./chunk-DCWKKS33.js";import{Db as p,Eb as c,Ia as h,La as s,Lb as P,Nb as M,Qb as a,Rb as x,Sb as v,Vb as O,Wb as w,Xb as R,ab as y,ea as C,ec as E,f as b,fb as g,ja as m,ka as _,qb as l,rb as r,sb as i,zb as f}from"./chunk-K5RDB55Y.js";function $(e,n){if(e&1){let t=f();r(0,"button",16),p("click",function(){let u=m(t).$implicit,d=c();return _(d.onCuisineFilter(u))}),a(1),i()}if(e&2){let t=n.$implicit,o=c();M("active",o.selectedCuisine===t),s(),v(" ",t," ")}}function D(e,n){if(e&1){let t=f();r(0,"button",17),p("click",function(){m(t);let u=c();return _(u.clearFilters())}),r(1,"span",8),a(2,"clear"),i(),a(3," Cancella "),i()}}function B(e,n){e&1&&(r(0,"p"),a(1," Prova a modificare i filtri di ricerca "),i())}function W(e,n){e&1&&(r(0,"p"),a(1," Al momento non ci sono ristoranti disponibili "),i())}function Y(e,n){if(e&1){let t=f();r(0,"button",21),p("click",function(){m(t);let u=c(2);return _(u.clearFilters())}),r(1,"span",8),a(2,"refresh"),i(),a(3," Mostra tutti i ristoranti "),i()}}function A(e,n){if(e&1&&(r(0,"div",18)(1,"span",8),a(2,"restaurant"),i(),r(3,"h3"),a(4,"Nessun ristorante trovato"),i(),g(5,B,2,0,"p",19)(6,W,2,0,"p",19)(7,Y,4,0,"button",20),i()),e&2){let t=c();s(5),l("ngIf",t.searchQuery||t.selectedCuisine),s(),l("ngIf",!t.searchQuery&&!t.selectedCuisine),s(),l("ngIf",t.searchQuery||t.selectedCuisine)}}function H(e,n){if(e&1){let t=f();r(0,"img",40),p("error",function(u){m(t);let d=c(3);return _(d.onImageError(u))}),i()}if(e&2){let t=c().$implicit;l("src",t.cover_image_url,h)("alt",t.name)}}function U(e,n){e&1&&(r(0,"div",41)(1,"span",8),a(2,"restaurant"),i(),r(3,"p"),a(4,"Immagine non disponibile"),i()())}function q(e,n){if(e&1){let t=f();r(0,"div",42)(1,"img",40),p("error",function(u){m(t);let d=c(3);return _(d.onLogoError(u))}),i()()}if(e&2){let t=c().$implicit;s(),l("src",t.logo_url,h)("alt",t.name)}}function G(e,n){if(e&1&&(r(0,"p",43),a(1),i()),e&2){let t=c().$implicit;s(),v(" ",t.cuisine_type," ")}}function J(e,n){if(e&1&&(r(0,"p",44),a(1),i()),e&2){let t=c().$implicit,o=c(2);s(),v(" ",o.truncateText(t.description,120)," ")}}function K(e,n){if(e&1&&(r(0,"div",45)(1,"span",8),a(2,"place"),i(),r(3,"span",46),a(4),i()()),e&2){let t=c().$implicit,o=c(2);s(4),x(o.truncateText(t.address,30))}}function X(e,n){if(e&1&&(r(0,"div",45)(1,"span",8),a(2,"phone"),i(),r(3,"span",46),a(4),i()()),e&2){let t=c().$implicit;s(4),x(t.phone)}}function Z(e,n){e&1&&(r(0,"span",47)(1,"span",8),a(2,"event_available"),i(),a(3," Prenotazioni "),i())}function tt(e,n){e&1&&(r(0,"span",47)(1,"span",8),a(2,"table_restaurant"),i(),a(3," Selezione Tavolo "),i())}function et(e,n){e&1&&(r(0,"span",47)(1,"span",8),a(2,"delivery_dining"),i(),a(3," Delivery "),i())}function nt(e,n){e&1&&(r(0,"span",47)(1,"span",8),a(2,"takeout_dining"),i(),a(3," Takeaway "),i())}function it(e,n){if(e&1){let t=f();r(0,"div",24)(1,"div",25),g(2,H,1,2,"img",26)(3,U,5,0,"ng-template",null,0,E),r(5,"div",27)(6,"button",28),p("click",function(u){let d=m(t).$implicit,N=c(2);return _(N.viewRestaurantMap(d.id,u))}),r(7,"span",8),a(8,"map"),i(),a(9," Visualizza Mappa "),i()()(),r(10,"div",29)(11,"div",30),g(12,q,2,2,"div",31),r(13,"div",32)(14,"h3",33),a(15),i(),g(16,G,2,1,"p",34),i()(),g(17,J,2,1,"p",35),r(18,"div",36),g(19,K,5,1,"div",37)(20,X,5,1,"div",37),i(),r(21,"div",38),g(22,Z,4,0,"span",39)(23,tt,4,0,"span",39)(24,et,4,0,"span",39)(25,nt,4,0,"span",39),i()()()}if(e&2){let t=n.$implicit,o=P(4);s(2),l("ngIf",t.cover_image_url)("ngIfElse",o),s(10),l("ngIf",t.logo_url),s(3),x(t.name),s(),l("ngIf",t.cuisine_type),s(),l("ngIf",t.description),s(2),l("ngIf",t.address),s(),l("ngIf",t.phone),s(2),l("ngIf",t.accepts_reservations),s(),l("ngIf",t.allow_table_selection),s(),l("ngIf",t.accepts_delivery),s(),l("ngIf",t.accepts_takeaway)}}function rt(e,n){if(e&1&&(r(0,"div",22),g(1,it,26,12,"div",23),i()),e&2){let t=c();s(),l("ngForOf",t.paginatedRestaurants)}}function at(e,n){if(e&1){let t=f();r(0,"div",48)(1,"button",49),p("click",function(){m(t);let u=c();return _(u.previousPage())}),r(2,"span",8),a(3,"chevron_left"),i(),a(4," Precedente "),i(),r(5,"span",50),a(6),i(),r(7,"button",49),p("click",function(){m(t);let u=c();return _(u.nextPage())}),a(8," Successivo "),r(9,"span",8),a(10,"chevron_right"),i()()()}if(e&2){let t=c();s(),l("disabled",t.currentPage===1),s(5),v(" Pagina ",t.currentPage," "),s(),l("disabled",t.currentPage*t.pageSize>=t.filteredRestaurants.length)}}var Q=class e{restaurantPublicService=C(j);router=C(L);restaurants=[];filteredRestaurants=[];loading=!0;imageErrorCount=0;maxRetries=2;searchQuery="";selectedCuisine="";cuisineTypes=[];currentPage=1;pageSize=9;ngOnInit(){return b(this,null,function*(){this.restaurants=yield this.restaurantPublicService.loadRestaurantsByCuisine(),this.filteredRestaurants=[...this.restaurants],this.loading=!1,this.cuisineTypes=[...new Set(this.restaurants.map(n=>n.cuisine_type).filter(Boolean))]})}filterRestaurants(){let n=this.restaurants;if(this.searchQuery){let t=this.searchQuery.toLowerCase();n=n.filter(o=>o.name?.toLowerCase().includes(t)||o.cuisine_type?.toLowerCase().includes(t)||o.address?.toLowerCase().includes(t)||o.description?.toLowerCase().includes(t))}this.selectedCuisine&&(n=n.filter(t=>t.cuisine_type===this.selectedCuisine)),this.filteredRestaurants=n,this.currentPage=1}onSearchChange(){this.filterRestaurants()}onCuisineFilter(n){this.selectedCuisine=n===this.selectedCuisine?"":n,this.filterRestaurants()}clearFilters(){this.searchQuery="",this.selectedCuisine="",this.filterRestaurants()}nextPage(){this.currentPage*this.pageSize<this.filteredRestaurants.length&&this.currentPage++}previousPage(){this.currentPage>1&&this.currentPage--}get paginatedRestaurants(){let n=(this.currentPage-1)*this.pageSize;return this.filteredRestaurants.slice(n,n+this.pageSize)}viewRestaurantMap(n,t){t&&t.stopPropagation(),console.log("Navigating to restaurant map:",n),this.router.navigate(["/customer/restaurant",n,"map"])}truncateText(n,t){return n?n.length<=t?n:n.substring(0,t)+"...":""}onImageError(n){let t=n.target;if(this.imageErrorCount++,this.imageErrorCount>this.maxRetries||t.src.includes("placeholder")){t.style.display="none";return}t.src="assets/images/restaurant-placeholder.jpg"}onLogoError(n){let t=n.target;t.style.display="none"}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=y({type:e,selectors:[["app-restaurant-list"]],decls:19,vars:6,consts:[["placeholderImage",""],[1,"restaurant-list-page"],[1,"page-header"],[1,"container"],[1,"page-title"],[1,"page-subtitle"],[1,"filters-section"],[1,"search-bar"],[1,"material-icons"],["type","text","placeholder","Cerca per nome, cucina, luogo...",3,"ngModelChange","input","ngModel"],[1,"filter-buttons"],["class","filter-button",3,"active","click",4,"ngFor","ngForOf"],["class","filter-button clear",3,"click",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","restaurants-grid",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"filter-button",3,"click"],[1,"filter-button","clear",3,"click"],[1,"empty-state"],[4,"ngIf"],["class","promethea-button primary",3,"click",4,"ngIf"],[1,"promethea-button","primary",3,"click"],[1,"restaurants-grid"],["class","restaurant-card",4,"ngFor","ngForOf"],[1,"restaurant-card"],[1,"restaurant-image"],[3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"restaurant-overlay"],[1,"view-map-button",3,"click"],[1,"restaurant-info"],[1,"restaurant-header"],["class","restaurant-logo",4,"ngIf"],[1,"restaurant-details"],[1,"restaurant-name"],["class","restaurant-cuisine",4,"ngIf"],["class","restaurant-description",4,"ngIf"],[1,"restaurant-meta"],["class","meta-item",4,"ngIf"],[1,"restaurant-features"],["class","feature-tag",4,"ngIf"],[3,"error","src","alt"],[1,"image-placeholder"],[1,"restaurant-logo"],[1,"restaurant-cuisine"],[1,"restaurant-description"],[1,"meta-item"],[1,"meta-text"],[1,"feature-tag"],[1,"pagination"],[1,"pagination-button",3,"click","disabled"],[1,"pagination-info"]],template:function(t,o){t&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),a(4,"Scopri i Ristoranti"),i(),r(5,"p",5),a(6,"Trova il ristorante perfetto per la tua serata"),i(),r(7,"div",6)(8,"div",7)(9,"span",8),a(10,"search"),i(),r(11,"input",9),R("ngModelChange",function(d){return w(o.searchQuery,d)||(o.searchQuery=d),d}),p("input",function(){return o.onSearchChange()}),i()(),r(12,"div",10),g(13,$,2,3,"button",11)(14,D,4,0,"button",12),i()()()(),r(15,"div",3),g(16,A,8,3,"div",13)(17,rt,2,1,"div",14)(18,at,11,3,"div",15),i()()),t&2&&(s(11),O("ngModel",o.searchQuery),s(2),l("ngForOf",o.cuisineTypes),s(),l("ngIf",o.selectedCuisine),s(2),l("ngIf",!o.loading&&o.filteredRestaurants.length===0),s(),l("ngIf",!o.loading&&o.filteredRestaurants.length>0),s(),l("ngIf",o.filteredRestaurants.length>0))},dependencies:[I,S,k,F,T,z,V],styles:[".restaurant-list-page[_ngcontent-%COMP%]{min-height:100vh;background:var(--background)}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 var(--gutter-md)}.page-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;padding:var(--gutter-xl) 0;margin-bottom:var(--gutter-xl)}.page-title[_ngcontent-%COMP%]{font-size:var(--fs-lg);margin:0 0 var(--gutter-sm) 0;text-align:center}.page-subtitle[_ngcontent-%COMP%]{font-size:var(--fs-md);margin:0 0 var(--gutter-lg) 0;text-align:center;opacity:.9}.filters-section[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.search-bar[_ngcontent-%COMP%]{position:relative;margin-bottom:var(--gutter-lg)}.search-bar[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{position:absolute;left:var(--gutter-md);top:50%;transform:translateY(-50%);color:var(--text-muted)}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:var(--gutter-md) var(--gutter-md) var(--gutter-md) calc(var(--gutter-md) * 2 + 24px);border:none;border-radius:50px;font-size:var(--fs-sm);background:#fff;box-shadow:var(--shadow-md)}.filter-buttons[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);flex-wrap:wrap;justify-content:center}.filter-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm) var(--gutter-md);background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:50px;cursor:pointer;transition:all .3s ease;font-size:var(--fs-sm)}.filter-button[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:translateY(-2px)}.filter-button.active[_ngcontent-%COMP%]{background:#fff;color:var(--primary)}.filter-button.clear[_ngcontent-%COMP%]{background:#ef444433;border-color:#ef44444d}.filter-button.clear[_ngcontent-%COMP%]:hover{background:#ef44444d}.restaurants-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:var(--gutter-lg);margin-bottom:var(--gutter-xl)}.restaurant-card[_ngcontent-%COMP%]{background:var(--background);border-radius:16px;overflow:hidden;box-shadow:var(--shadow-md);transition:all .3s ease;cursor:pointer;border:1px solid var(--smoke-color-1)}.restaurant-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:var(--shadow-lg);border-color:var(--primary)}.restaurant-image[_ngcontent-%COMP%]{position:relative;height:200px;overflow:hidden}.restaurant-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.restaurant-card[_ngcontent-%COMP%]:hover   .restaurant-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.restaurant-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease}.restaurant-card[_ngcontent-%COMP%]:hover   .restaurant-overlay[_ngcontent-%COMP%]{opacity:1}.view-map-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-md) var(--gutter-lg);background:var(--primary);color:#fff;border:none;border-radius:50px;font-weight:600;cursor:pointer;transition:all .3s ease}.view-map-button[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary) 80%,black);transform:scale(1.05)}.restaurant-info[_ngcontent-%COMP%]{padding:var(--gutter-lg)}.restaurant-header[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-md);margin-bottom:var(--gutter-md)}.restaurant-logo[_ngcontent-%COMP%]{flex-shrink:0}.restaurant-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:8px;object-fit:cover;border:2px solid var(--smoke-color-1)}.restaurant-details[_ngcontent-%COMP%]{flex:1;min-width:0}.restaurant-name[_ngcontent-%COMP%]{font-size:var(--fs-md);color:var(--text-color);margin:0 0 4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.restaurant-cuisine[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--primary);font-weight:600;margin:0}.restaurant-description[_ngcontent-%COMP%]{color:var(--text-muted);margin:0 0 var(--gutter-md) 0;line-height:1.5}.restaurant-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm);margin-bottom:var(--gutter-md)}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);font-size:var(--fs-sm)}.meta-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;color:var(--text-muted);flex-shrink:0}.meta-text[_ngcontent-%COMP%]{color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.restaurant-features[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--gutter-sm)}.feature-tag[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--smoke-color-1);border-radius:6px;font-size:.75rem;color:var(--text-color)}.feature-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:var(--gutter-xl);color:var(--text-muted)}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:40px;height:40px;border:3px solid color-mix(in srgb,var(--primary) 15%,transparent);border-radius:50%;border-top-color:var(--primary);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite;margin-bottom:var(--gutter-md)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--gutter-xl);color:var(--text-muted)}.empty-state[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:64px;margin-bottom:var(--gutter-md);opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 var(--gutter-sm) 0;color:var(--text-color)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 var(--gutter-lg) 0}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:var(--gutter-lg);padding:var(--gutter-lg) 0}.pagination-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm) var(--gutter-md);background:var(--background);border:1px solid var(--smoke-color-1);border-radius:8px;color:var(--text-color);cursor:pointer;transition:all .3s ease}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){border-color:var(--primary);color:var(--primary)}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination-info[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--fs-sm)}@media (max-width: 768px){.restaurants-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.restaurant-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:var(--gutter-sm)}.restaurant-logo[_ngcontent-%COMP%]{align-self:center}.filter-buttons[_ngcontent-%COMP%]{justify-content:flex-start;overflow-x:auto;padding-bottom:var(--gutter-sm)}.pagination[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-md)}}@media (max-width: 480px){.page-header[_ngcontent-%COMP%]{padding:var(--gutter-lg) 0}.page-title[_ngcontent-%COMP%]{font-size:var(--fs-md)}.restaurant-info[_ngcontent-%COMP%]{padding:var(--gutter-md)}.restaurant-features[_ngcontent-%COMP%]{justify-content:center}}.image-placeholder[_ngcontent-%COMP%]{width:100%;height:200px;background:#f5f5f5;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#666;border-radius:8px 8px 0 0}.image-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;margin-bottom:8px;color:#ccc}.image-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}"]})};export{Q as RestaurantList};
