import{a as ee,b as P}from"./chunk-Y7MP75OT.js";import"./chunk-2GDINAXL.js";import{$a as X,_a as K}from"./chunk-GKVEDNPF.js";import{a as Z}from"./chunk-S3EHY5DL.js";import{b as q,d as Y,h as G,x as J}from"./chunk-QAJQXQTD.js";import{d as U}from"./chunk-Z644G36S.js";import{d as N,f as H,g as W}from"./chunk-XYJRESY4.js";import{j as A,k as B,o as j,u as Q}from"./chunk-6ELNIGGB.js";import{$b as z,Ab as c,Ea as b,Ha as s,Hb as k,Ib as I,Jb as w,Mb as l,Nb as x,Ob as f,Sb as T,Tb as V,Ub as L,Vb as F,Xa as O,_b as $,ab as m,ca as v,cc as R,ia as g,ja as u,mb as d,nb as o,ob as a,pb as M,u as C,v as D,vb as h,yb as _}from"./chunk-DE3VKQQR.js";import{a as E,b as S,j as y}from"./chunk-4ZZIO3ZI.js";function ne(r,i){if(r&1){let e=h();o(0,"button",11),_("click",function(){g(e);let t=c();return u(t.authService.toggleSidebar())}),M(1,"lucide-icon",12),a()}}function re(r,i){if(r&1){let e=h();o(0,"img",13),_("error",function(t){g(e);let p=c();return u(p.onLogoError(t))}),a()}if(r&2){let e=c();d("src",e.restaurant==null?null:e.restaurant.logo_url,b)("alt",e.restaurant==null?null:e.restaurant.name)}}function ae(r,i){r&1&&(o(0,"span",14),l(1,"restaurant"),a())}function oe(r,i){if(r&1){let e=h();o(0,"button",23),_("click",function(){let t=g(e).$implicit,p=c(3);return u(p.selectCategory(t.id))}),l(1),a()}if(r&2){let e=i.$implicit,n=c(3);w("active",n.selectedCategory===e.id),s(),f(" ",e.name," ")}}function se(r,i){if(r&1){let e=h();o(0,"img",48),_("error",function(t){g(e);let p=c().$implicit,ie=c(4);return u(ie.onDishImageError(t,p))}),a()}if(r&2){let e=c().$implicit;d("src",e.image_url,b)("alt",e.name)}}function le(r,i){r&1&&(o(0,"div",49),M(1,"lucide-angular",50),a()),r&2&&(s(),d("size",24))}function ce(r,i){if(r&1&&(o(0,"p",51),l(1),a()),r&2){let e=c().$implicit;s(),f(" ",e.description," ")}}function de(r,i){if(r&1&&(o(0,"span",52)(1,"span",14),l(2,"schedule"),a(),l(3),a()),r&2){let e=c().$implicit;s(3),f(" ",e.preparation_time," min ")}}function pe(r,i){if(r&1&&(o(0,"span",52)(1,"span",14),l(2,"delivery_dining"),a(),l(3),a()),r&2){let e=c().$implicit,n=c(4);s(3),f(" ",n.formatPrice(e.delivery_price)," ")}}function me(r,i){if(r&1&&(o(0,"span",52)(1,"span",14),l(2,"takeout_dining"),a(),l(3),a()),r&2){let e=c().$implicit,n=c(4);s(3),f(" ",n.formatPrice(e.takeaway_price)," ")}}function ge(r,i){if(r&1){let e=h();o(0,"div",36)(1,"div",37),m(2,se,1,2,"img",38)(3,le,2,1,"div",39),a(),o(4,"div",40)(5,"div",41)(6,"h3",42),l(7),a(),o(8,"span",43),l(9),a()(),m(10,ce,2,1,"p",44),o(11,"div",45),m(12,de,4,1,"span",46)(13,pe,4,1,"span",46)(14,me,4,1,"span",46),a(),o(15,"button",47),_("click",function(){let t=g(e).$implicit,p=c(4);return u(p.addToCart(t))}),o(16,"span",14),l(17,"add_shopping_cart"),a(),l(18," Aggiungi "),a()()()}if(r&2){let e=i.$implicit,n=c(4);s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(4),x(e.name),s(2),x(n.formatPrice(e.base_price)),s(),d("ngIf",e.description),s(2),d("ngIf",e.preparation_time),s(),d("ngIf",e.delivery_price),s(),d("ngIf",e.takeaway_price)}}function ue(r,i){if(r&1&&(o(0,"div",30)(1,"div",31)(2,"h2",32),l(3),a(),o(4,"span",33),l(5),a()(),o(6,"div",34),m(7,ge,19,8,"div",35),a()()),r&2){let e=i.$implicit;s(3),x(e.name),s(2),f("",e.dishes.length," piatti"),s(2),d("ngForOf",e.dishes)}}function _e(r,i){if(r&1){let e=h();o(0,"div",53)(1,"span",54),l(2,"search_off"),a(),o(3,"h3"),l(4,"Nessun piatto trovato"),a(),o(5,"p",9),l(6,"Prova a modificare la ricerca o i filtri"),a(),o(7,"button",55),_("click",function(){g(e);let t=c(3);return t.searchQuery="",u(t.selectedCategory=null)}),o(8,"span",14),l(9,"refresh"),a(),l(10," Mostra tutto il menu "),a()()}}function he(r,i){if(r&1){let e=h();o(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"span",14),l(5,"search"),a(),o(6,"input",21),L("ngModelChange",function(t){g(e);let p=c(2);return V(p.searchQuery,t)||(p.searchQuery=t),u(t)}),_("input",function(){g(e);let t=c(2);return u(t.onSearchChange())}),a()(),o(7,"div",22)(8,"button",23),_("click",function(){g(e);let t=c(2);return u(t.selectCategory(null))}),l(9," Tutto "),a(),m(10,oe,2,3,"button",24),a()()(),o(11,"div",25),m(12,ue,8,3,"div",26)(13,_e,11,0,"div",27),a(),o(14,"div",28)(15,"button",29)(16,"span",14),l(17,"arrow_back"),a(),l(18," Torna al ristorante "),a()()()}if(r&2){let e=c(2);s(6),T("ngModel",e.searchQuery),s(2),w("active",!e.selectedCategory),s(2),d("ngForOf",e.categories),s(2),d("ngForOf",e.filteredCategories),s(),d("ngIf",e.filteredCategories.length===0),s(2),d("routerLink",F("/customer/restaurant/",e.restaurant.id))}}function fe(r,i){if(r&1&&(o(0,"div",15),m(1,he,19,8,"div",16),a()),r&2){let e=c();s(),d("ngIf",e.restaurant)}}function ve(r,i){r&1&&(o(0,"div",15)(1,"div",56)(2,"span",57),l(3,"sync"),a(),o(4,"p"),l(5,"Caricamento menu..."),a()()())}var te=class r{restaurantPublicService=v(Z);router=v(H);route=v(N);breakpointObserver=v(ee);authService=v(U);restaurant=null;categories=[];allCategories=[];loading=!0;searchQuery="";selectedCategory=null;isMobile$=this.breakpointObserver.observe([P.Handset,P.TabletPortrait]).pipe(C(i=>i.matches));showToggle$=D([this.isMobile$,this.authService.sidebarCollapsed$]).pipe(C(([i,e])=>i&&e));ngOnInit(){return y(this,null,function*(){let i=this.route.snapshot.paramMap.get("id");i?yield this.loadMenuData(i):this.router.navigate(["/customer/search"])})}loadMenuData(i){return y(this,null,function*(){try{this.loading=!0;let[e,n,t]=yield Promise.all([this.restaurantPublicService.loadRestaurantById(i),this.restaurantPublicService.loadRestaurantDishes(i),this.restaurantPublicService.loadRestaurantCategories(i)]);console.log("Restaurant:",e),console.log("Dishes:",n),console.log("Categories:",t),this.restaurant=e,this.allCategories=t,this.groupDishesByCategory(n,t)}catch(e){console.error("Error loading menu data:",e),yield this.loadMenuDataFallback(i)}finally{this.loading=!1}})}loadMenuDataFallback(i){return y(this,null,function*(){try{let[e,n]=yield Promise.all([this.restaurantPublicService.loadRestaurantById(i),this.restaurantPublicService.loadRestaurantDishes(i)]);this.restaurant=e,this.groupDishesByCategory(n,[])}catch(e){console.error("Error in fallback loading:",e)}})}groupDishesByCategory(i,e){let n=new Map;e.forEach(t=>{n.set(t.id,{id:t.id,name:t.name,description:t.description||"",dishes:[]})}),n.set("uncategorized",{id:"uncategorized",name:"Specialit\xE0",description:"Le nostre specialit\xE0",dishes:[]}),i.forEach(t=>{t.category_id&&n.has(t.category_id)?n.get(t.category_id).dishes.push(t):t.category_name&&!n.has(t.category_id||"unknown")?n.set(t.category_id||"unknown",{id:t.category_id||"unknown",name:t.category_name,description:"",dishes:[t]}):n.get("uncategorized").dishes.push(t)}),this.categories=Array.from(n.values()).filter(t=>t.dishes.length>0).sort((t,p)=>t.id==="uncategorized"?1:p.id==="uncategorized"?-1:t.name.localeCompare(p.name))}get filteredCategories(){if(!this.searchQuery&&!this.selectedCategory)return this.categories;let i=[];for(let e of this.categories){if(this.selectedCategory&&e.id!==this.selectedCategory)continue;let n=[...e.dishes];if(this.searchQuery){let t=this.searchQuery.toLowerCase();n=e.dishes.filter(p=>p.name.toLowerCase().includes(t)||p.description?.toLowerCase().includes(t)||p.category_name?.toLowerCase().includes(t))}n.length>0&&i.push(S(E({},e),{dishes:n}))}return i}selectCategory(i){this.selectedCategory=i===this.selectedCategory?null:i}onSearchChange(){}addToCart(i){console.log("Aggiunto al carrello:",i)}formatPrice(i){return`\u20AC${i.toFixed(2).replace(".",",")}`}onDishImageError(i,e){let n=i.target;n.style.display="none"}onLogoError(i){let e=i.target;e.style.display="none"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=O({type:r,selectors:[["app-menu-display"]],decls:15,vars:10,consts:[["loadingTemplate",""],[1,"section-header"],[1,"flex","items-center","items-center","gap-lg",2,"overflow","hidden"],["class","icon-button mobile-toggle",3,"click",4,"ngIf"],[1,"header-icon"],["class","logo-image rounded-full",3,"src","alt","error",4,"ngIf"],["class","material-icons",4,"ngIf"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],["class","page-container",4,"ngIf","ngIfElse"],[1,"icon-button","mobile-toggle",3,"click"],["name","menu"],[1,"logo-image","rounded-full",3,"error","src","alt"],[1,"material-icons"],[1,"page-container"],["class","flex flex-col gap-lg mt-lg",4,"ngIf"],[1,"flex","flex-col","gap-lg","mt-lg"],[1,"card","mt-md"],[1,"flex","flex-col","md:flex-row","gap-md","items-center","justify-between"],[1,"search-bar","flex-1"],["type","text","placeholder","Cerca nel menu...",3,"ngModelChange","input","ngModel"],[1,"filter-chips","flex","flex-wrap","gap-sm"],[1,"chip",3,"click"],["class","chip",3,"active","click",4,"ngFor","ngForOf"],[1,"flex","flex-col","gap-xl"],["class","category-section",4,"ngFor","ngForOf"],["class","text-center p-xl",4,"ngIf"],[1,"text-center","mt-xl"],[1,"promethea-button","ghost",3,"routerLink"],[1,"category-section"],[1,"flex","items-center","gap-sm","mb-lg"],[1,"text-md","font-bold"],[1,"chip"],[1,"dishes-grid"],["class","dish-card",4,"ngFor","ngForOf"],[1,"dish-card"],[1,"dish-image-container"],["class","dish-image",3,"src","alt","error",4,"ngIf"],["class","dish-image-placeholder",4,"ngIf"],[1,"dish-info"],[1,"dish-header"],[1,"dish-name"],[1,"dish-price"],["class","dish-description",4,"ngIf"],[1,"dish-details"],["class","detail-chip",4,"ngIf"],[1,"add-to-cart-button",3,"click"],[1,"dish-image",3,"error","src","alt"],[1,"dish-image-placeholder"],["name","utensils",3,"size"],[1,"dish-description"],[1,"detail-chip"],[1,"text-center","p-xl"],[1,"material-icons","fs-lg"],[1,"promethea-button","ghost","mt-md",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-xl","gap-md"],[1,"material-icons","animate-spin"]],template:function(e,n){if(e&1&&(o(0,"div",1)(1,"div",2),m(2,ne,2,0,"button",3),$(3,"async"),o(4,"div",4),m(5,re,1,2,"img",5)(6,ae,2,0,"span",6),a(),o(7,"div",7)(8,"h1",8),l(9),a(),o(10,"p",9),l(11,"Menu completo"),a()()()(),m(12,fe,2,1,"div",10)(13,ve,6,0,"ng-template",null,0,R)),e&2){let t=k(14);I("background",n.restaurant!=null&&n.restaurant.cover_image_url?"url("+(n.restaurant==null?null:n.restaurant.cover_image_url)+")":"var(--vetro)"),s(2),d("ngIf",z(3,8,n.showToggle$)),s(3),d("ngIf",n.restaurant==null?null:n.restaurant.logo_url),s(),d("ngIf",!(n.restaurant!=null&&n.restaurant.logo_url)),s(3),x(n.restaurant==null?null:n.restaurant.name),s(3),d("ngIf",!n.loading)("ngIfElse",t)}},dependencies:[Q,A,B,J,q,Y,G,W,X,K,j],styles:[".search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gap-sm);background:var(--background);border:1px solid var(--smoke-1);border-radius:12px;padding:var(--gap-sm) var(--gap-md);width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;padding:0;width:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.category-section[_ngcontent-%COMP%]{margin-bottom:var(--gap-xl)}.dishes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap-lg)}.dish-card[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-1);border-radius:16px;overflow:hidden;transition:all .3s cubic-bezier(.2,.9,.2,1);display:flex;flex-direction:column}.dish-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--secondary);box-shadow:0 8px 24px var(--shadow-1)}.dish-image-container[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;overflow:hidden;background:var(--smoke-1)}.dish-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.dish-card[_ngcontent-%COMP%]:hover   .dish-image[_ngcontent-%COMP%]{transform:scale(1.05)}.dish-image-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:var(--text-muted)}.dish-image-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:3rem}.dish-info[_ngcontent-%COMP%]{padding:var(--gap-md);flex:1;display:flex;flex-direction:column;gap:var(--gap-sm)}.dish-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:var(--gap-sm)}.dish-name[_ngcontent-%COMP%]{line-height:1;font-weight:700;margin:0;flex:1}.dish-price[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);white-space:nowrap}.dish-description[_ngcontent-%COMP%]{color:var(--text-muted);line-height:1.4;margin:0;font-size:.95rem}.dish-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-sm)}.detail-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--smoke-1);border-radius:8px;font-size:.85rem;color:var(--text-muted)}.add-to-cart-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--gap-sm);padding:var(--gap-sm) var(--gap-md);background:var(--gradiente);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;margin-top:auto}.add-to-cart-button[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 4px 12px var(--shadow-1)}.filter-chips[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto;padding-bottom:4px}.filter-chips[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{white-space:nowrap}.logo-image[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:cover;border:3px solid var(--background)}@media (max-width: 768px){.dishes-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.dish-image-container[_ngcontent-%COMP%]{height:180px}.search-bar[_ngcontent-%COMP%]{width:100%}.logo-image[_ngcontent-%COMP%]{width:60px;height:60px}}"]})};export{te as MenuDisplay};
