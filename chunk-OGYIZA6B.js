import{a as me}from"./chunk-PVW5I7UX.js";import{a as de}from"./chunk-GB7WVUTD.js";import{a as ce}from"./chunk-5M5JQCWW.js";import"./chunk-RWHEAJGO.js";import"./chunk-MEGBB4Y7.js";import{ya as se,za as le}from"./chunk-UFRMGX42.js";import{b as G,d as U,e as J,g as K,h as Q,i as X,j as Z,q as ee,r as te,s as ne,t as ae,u as ie,v as re,x as oe}from"./chunk-22BNR7AL.js";import"./chunk-NPMWXJE4.js";import"./chunk-6GCWWUP3.js";import{j as q,k as B,o as j,s as Y}from"./chunk-N5RTTLWI.js";import{Db as W,Eb as I,Fb as D,Ha as s,Hb as $,Ib as o,Jb as x,Kb as f,Lb as V,Ob as E,Pb as k,Qb as R,Tb as A,Wb as P,Xa as H,Yb as O,_b as L,ab as g,ca as z,ia as u,ib as m,ja as v,jb as r,kb as a,lb as F,rb as M,ub as _,wb as c}from"./chunk-R56C6QW6.js";import{j as T}from"./chunk-4ZZIO3ZI.js";var xe=()=>["LUN","MAR","MER","GIO","VEN","SAB","DOM"];function fe(d,t){if(d&1&&(r(0,"div",33)(1,"span"),o(2),a(),r(3,"span",34),o(4),a()()),d&2){let e=t.$implicit;s(2),f("Tavoli da ",e.size,":"),s(2),x(e.count)}}function ye(d,t){if(d&1&&(r(0,"div",31),g(1,fe,5,2,"div",32),a()),d&2){let e=c();s(),m("ngForOf",e.getSimpleCapacityDistribution())}}function we(d,t){if(d&1&&(r(0,"span",35),o(1),a()),d&2){let e=c();s(),f(" (",e.getAvailableTablesToday()," tavoli liberi) ")}}function be(d,t){if(d&1&&(r(0,"div",13)(1,"div",14)(2,"span",36),o(3,"event"),a(),r(4,"h3",16),o(5),P(6,"date"),a()(),r(7,"div",37),o(8),a(),r(9,"div",18),o(10),a()()),d&2){let e=c();s(5),f("Disponibilit\xE0 ",O(6,4,e.selectedDate,"dd/MM")),s(3),f(" ",e.getAvailableTablesForSelectedDate()," tavoli "),s(2),V(" Posti: ",e.todayCapacity," / ",e.calculateMaxCapacitySimple()," ")}}function Ce(d,t){if(d&1&&(r(0,"div",43),o(1),a()),d&2){let e=t.$implicit;s(),f(" ",e," ")}}function Se(d,t){if(d&1&&(r(0,"span",49),o(1),a()),d&2){let e=c().$implicit,n=c(2);I("background",n.getEventColor(e.events[0].meta.partySize)),s(),f(" ",e.events.length," ")}}function Me(d,t){if(d&1){let e=M();r(0,"div",53),_("click",function(i){let l=u(e).$implicit,p=c(4);return i.stopPropagation(),v(p.onEventClick(l))}),r(1,"span",54),o(2),P(3,"date"),a(),r(4,"span",55),o(5),a()()}if(d&2){let e=t.$implicit,n=c(4);I("border-color",n.getEventColor(e.meta.partySize)),s(2),x(O(3,4,e.start,"HH:mm")),s(3),x(e.meta.customerName)}}function De(d,t){if(d&1){let e=M();r(0,"div",56),_("click",function(i){u(e);let l=c(2).$implicit,p=c(2);return i.stopPropagation(),v(p.onDayClick(l.date))}),o(1),a()}if(d&2){let e=c(2).$implicit,n=c(2);s(),f(" +",n.getEventsForDate(e.date).length-2," ")}}function Ee(d,t){if(d&1&&(r(0,"div",50),g(1,Me,6,7,"div",51)(2,De,2,1,"div",52),a()),d&2){let e=c().$implicit,n=c(2);s(),m("ngForOf",n.getLimitedEventsForDate(e.date,2)),s(),m("ngIf",n.hasMoreEvents(e.date,2))}}function ke(d,t){if(d&1){let e=M();r(0,"div",44),_("click",function(){let i=u(e).$implicit,l=c(2);return v(l.openDayDetails(i.date))}),r(1,"div",45)(2,"span",46),o(3),a(),g(4,Se,2,3,"span",47),a(),g(5,Ee,3,2,"div",48),a()}if(d&2){let e=t.$implicit,n=c(2);D("today",n.isToday(e.date))("current-month",e.isCurrentMonth)("other-month",!e.isCurrentMonth),s(2),D("today-number",n.isToday(e.date)),s(),f(" ",e.date.getDate()," "),s(),m("ngIf",e.events.length>0),s(),m("ngIf",e.events.length>0)}}function Re(d,t){if(d&1&&(r(0,"div",38)(1,"div",39),g(2,Ce,2,1,"div",40),a(),r(3,"div",41),g(4,ke,6,11,"div",42),a()()),d&2){let e=c();s(2),m("ngForOf",A(2,xe)),s(2),m("ngForOf",e.getMonthDays())}}function Pe(d,t){if(d&1&&(r(0,"div",64)(1,"div",65),o(2),P(3,"date"),a(),r(4,"div",66),o(5),a()()),d&2){let e=t.$implicit,n=c(2);D("today",n.isToday(e)),s(2),x(O(3,4,e,"EEE")),s(3),x(e.getDate())}}function Oe(d,t){if(d&1&&(r(0,"div",67),o(1),a()),d&2){let e=t.$implicit;s(),f(" ",e,":00 ")}}function Te(d,t){if(d&1){let e=M();r(0,"div",72),_("click",function(i){let l=u(e).$implicit,p=c(4);return i.stopPropagation(),v(p.onEventClick(l))}),r(1,"div",73),o(2),P(3,"date"),a(),r(4,"div",74),o(5),a(),r(6,"div",75),o(7),a()()}if(d&2){let e=t.$implicit,n=c(4);I("background",n.getEventColor(e.meta.partySize)),s(2),x(O(3,5,e.start,"HH:mm")),s(3),x(e.meta.customerName),s(2),f("",e.meta.partySize,"p")}}function Fe(d,t){if(d&1){let e=M();r(0,"div",70),_("click",function(){u(e);let i=c().$implicit,l=c(2);return v(l.openDayDetails(i))}),g(1,Te,8,8,"div",71),a()}if(d&2){let e=t.$implicit,n=c().$implicit,i=c(2);s(),m("ngForOf",i.getEventsForHour(n,e))}}function Ie(d,t){if(d&1&&(r(0,"div",68),g(1,Fe,2,1,"div",69),a()),d&2){let e=c(2);s(),m("ngForOf",e.getWeekViewHours())}}function ze(d,t){if(d&1&&(r(0,"div",57)(1,"div",58),F(2,"div",59),g(3,Pe,6,7,"div",60),a(),r(4,"div",61)(5,"div",59),g(6,Oe,2,1,"div",62),a(),g(7,Ie,2,1,"div",63),a()()),d&2){let e=c();s(3),m("ngForOf",e.getWeekDays()),s(3),m("ngForOf",e.getWeekViewHours()),s(),m("ngForOf",e.getWeekDays())}}function Ve(d,t){if(d&1){let e=M();r(0,"div",84),_("click",function(i){let l=u(e).$implicit,p=c(3);return i.stopPropagation(),v(p.onEventClick(l))}),r(1,"div",73),o(2),P(3,"date"),a(),r(4,"div",74),o(5),a(),r(6,"div",75),o(7),a()()}if(d&2){let e=t.$implicit,n=c(3);I("background",n.getEventColor(e.meta.partySize)),s(2),x(O(3,6,e.start,"HH:mm")),s(3),x(e.meta.customerName),s(2),V(" ",e.meta.partySize," persone \u2022 ",e.meta.tableInfo," ")}}function Ne(d,t){if(d&1){let e=M();r(0,"div",80)(1,"div",81),o(2),a(),r(3,"div",82),_("click",function(){u(e);let i=c(2);return v(i.openDayDetails(i.viewDate))}),g(4,Ve,8,9,"div",83),a()()}if(d&2){let e=t.$implicit,n=c(2);s(2),f("",e,":00"),s(2),m("ngForOf",n.getEventsForHour(n.viewDate,e))}}function He(d,t){if(d&1&&(r(0,"div",76)(1,"div",77)(2,"h2"),o(3),P(4,"date"),a()(),r(5,"div",78),g(6,Ne,5,2,"div",79),a()()),d&2){let e=c();s(3),x(O(4,2,e.viewDate,"fullDate")),s(3),m("ngForOf",e.getWeekViewHours())}}function We(d,t){if(d&1&&(r(0,"option",114),o(1),a()),d&2){let e=t.$implicit;m("value",e),s(),f(" ",e," ")}}function $e(d,t){if(d&1){let e=M();r(0,"div",85)(1,"div",86)(2,"div",87)(3,"h3",88)(4,"span",15),o(5,"event_available"),a(),o(6," Nuova Prenotazione "),a(),r(7,"button",8),_("click",function(){u(e);let i=c();return v(i.closeNewReservationModal())}),r(8,"span",9),o(9,"close"),a()()(),r(10,"div")(11,"form",89),_("ngSubmit",function(){u(e);let i=c();return v(i.createManualReservation())}),r(12,"div",90)(13,"div",91)(14,"div",92)(15,"label",93),F(16,"lucide-angular",94),o(17," Nome * "),a(),r(18,"input",95),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.customer_name,i)||(l.newReservation.customer_name=i),v(i)}),a()(),r(19,"div",92)(20,"label",96)(21,"span",9),o(22,"person_outline"),a(),o(23," Cognome * "),a(),r(24,"input",97),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.customer_surname,i)||(l.newReservation.customer_surname=i),v(i)}),a()()(),r(25,"div",91)(26,"div",92)(27,"label",98),F(28,"lucide-angular",99),o(29," Email "),a(),r(30,"input",100),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.customer_email,i)||(l.newReservation.customer_email=i),v(i)}),a()(),r(31,"div",92)(32,"label",101)(33,"span",9),o(34,"phone"),a(),o(35," Telefono * "),a(),r(36,"input",102),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.customer_phone,i)||(l.newReservation.customer_phone=i),v(i)}),a()()(),r(37,"div",91)(38,"div",92)(39,"label",103)(40,"span",9),o(41,"event"),a(),o(42," Data * "),a(),r(43,"input",104),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.reservation_date,i)||(l.newReservation.reservation_date=i),v(i)}),_("change",function(){u(e);let i=c();return v(i.onReservationDateChange())}),a()(),r(44,"div",92)(45,"label",105)(46,"span",9),o(47,"schedule"),a(),o(48," Ora * "),a(),r(49,"select",106),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.reservation_time,i)||(l.newReservation.reservation_time=i),v(i)}),r(50,"option",107),o(51,"Scegli un orario"),a(),g(52,We,2,2,"option",108),a()()(),r(53,"div",91)(54,"div",92)(55,"label",109)(56,"span",9),o(57,"group"),a(),o(58," Numero Persone * "),a(),r(59,"input",110),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.party_size,i)||(l.newReservation.party_size=i),v(i)}),a()(),r(60,"div",92)(61,"label",111),F(62,"lucide-angular",112),o(63," Stato "),a(),r(64,"select",113),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.status,i)||(l.newReservation.status=i),v(i)}),r(65,"option",114),o(66,"Confermata"),a(),r(67,"option",114),o(68,"In attesa"),a(),r(69,"option",114),o(70,"Cancellata"),a()()()(),r(71,"div",92)(72,"label",115)(73,"span",9),o(74,"notes"),a(),o(75," Richieste Speciali "),a(),r(76,"textarea",116),R("ngModelChange",function(i){u(e);let l=c();return k(l.newReservation.special_requests,i)||(l.newReservation.special_requests=i),v(i)}),a()()(),r(77,"div",117)(78,"button",118),_("click",function(){u(e);let i=c();return v(i.closeNewReservationModal())}),r(79,"span",9),o(80,"close"),a(),o(81," Annulla "),a(),r(82,"button",119)(83,"span",9),o(84,"add"),a(),o(85," Crea Prenotazione "),a()()()()()()}if(d&2){let e=c();s(16),m("size",20),s(2),E("ngModel",e.newReservation.customer_name),s(6),E("ngModel",e.newReservation.customer_surname),s(4),m("size",20),s(2),E("ngModel",e.newReservation.customer_email),s(6),E("ngModel",e.newReservation.customer_phone),s(7),E("ngModel",e.newReservation.reservation_date),m("min",e.minDate),s(6),E("ngModel",e.newReservation.reservation_time),s(3),m("ngForOf",e.getAvailableTimeSlotsForDate(e.selectedDate)),s(7),E("ngModel",e.newReservation.party_size),s(5),E("ngModel",e.newReservation.status),s(),m("value",e.ReservationStatus.Confirmed),s(2),m("value",e.ReservationStatus.Pending),s(2),m("value",e.ReservationStatus.Cancelled),s(7),E("ngModel",e.newReservation.special_requests)}}function Ae(d,t){if(d&1&&(r(0,"div",137)(1,"span",138),o(2,"email"),a(),r(3,"span",139),o(4),a()()),d&2){let e=c().$implicit;s(4),x(e.meta.customerEmail)}}function Le(d,t){if(d&1&&(r(0,"div",149)(1,"div",150)(2,"span",151),o(3,"notes"),a(),r(4,"strong",139),o(5,"Note"),a()(),r(6,"p",152),o(7),a()()),d&2){let e=c().$implicit;s(7),x(e.meta.reservation.special_requests)}}function qe(d,t){if(d&1){let e=M();r(0,"div",131)(1,"div",132)(2,"div",7)(3,"div",133)(4,"h4",134),o(5),a(),r(6,"span",135),o(7),a()(),r(8,"div",136)(9,"div",137)(10,"span",138),o(11,"phone"),a(),r(12,"span",139),o(13),a()(),g(14,Ae,5,1,"div",140),a()(),r(15,"div",7)(16,"button",141),_("click",function(){let i=u(e).$implicit,l=c(3);return v(l.editReservation(i))}),r(17,"span",9),o(18,"edit"),a()(),r(19,"button",142),_("click",function(){let i=u(e).$implicit,l=c(3);return v(l.deleteReservation(i.id))}),r(20,"span",9),o(21,"delete"),a()()()(),r(22,"div",143)(23,"div",144)(24,"span",145),o(25,"schedule"),a(),r(26,"div",146),o(27),P(28,"date"),a(),r(29,"div",147),o(30,"Orario"),a()(),r(31,"div",144)(32,"span",145),o(33,"group"),a(),r(34,"div",146),o(35),a(),r(36,"div",147),o(37,"Persone"),a()(),r(38,"div",144)(39,"span",145),o(40,"table_restaurant"),a(),r(41,"div",146),o(42),a(),r(43,"div",147),o(44,"Tavolo"),a()()(),g(45,Le,8,1,"div",148),a()}if(d&2){let e=t.$implicit,n=c(3);s(5),x(e.meta.customerName),s(),$(n.getReservationStatusClass(e.meta.status)),s(),f(" ",e.meta.status," "),s(6),x(e.meta.customerPhone),s(),m("ngIf",e.meta.customerEmail),s(13),x(O(28,10,e.start,"HH:mm")),s(8),x(e.meta.partySize),s(7),x(e.meta.tableInfo||"\u2014"),s(3),m("ngIf",e.meta.reservation.special_requests)}}function Be(d,t){if(d&1&&(r(0,"div",129),g(1,qe,46,13,"div",130),a()),d&2){let e=c(2);s(),m("ngForOf",e.selectedDayEvents)}}function je(d,t){d&1&&(r(0,"div",153)(1,"span",154),o(2,"event_busy"),a(),r(3,"h3",155),o(4,"Nessuna prenotazione per questa data"),a(),r(5,"p",156),o(6,'Clicca su "Nuova Prenotazione" per aggiungerne una'),a()())}function Ye(d,t){if(d&1){let e=M();r(0,"div",85)(1,"div",86)(2,"div",87)(3,"div",120)(4,"div",121)(5,"span",122),o(6,"calendar_today"),a()(),r(7,"div")(8,"h3",123),o(9,"Prenotazioni"),a(),r(10,"p",124),o(11),P(12,"date"),a()()(),r(13,"button",8),_("click",function(){u(e);let i=c();return v(i.closeDayDetailsModal())}),r(14,"span",9),o(15,"close"),a()()(),r(16,"div",125)(17,"div",126)(18,"span",9),o(19,"event_available"),a(),r(20,"div")(21,"strong"),o(22),a(),o(23),a()(),g(24,Be,2,1,"div",127)(25,je,7,0,"ng-template",null,0,L),r(27,"div",117)(28,"button",118),_("click",function(){u(e);let i=c();return v(i.closeDayDetailsModal())}),r(29,"span",9),o(30,"close"),a(),o(31," Chiudi "),a(),r(32,"button",128),_("click",function(){u(e);let i=c();return v(i.openNewReservationForSelectedDay())}),r(33,"span",9),o(34,"add"),a(),o(35," Nuova Prenotazione "),a()()()()()}if(d&2){let e=W(26),n=c();s(11),x(O(12,5,n.selectedDate,"EEEE d MMMM yyyy")),s(11),f("",n.selectedDayEvents.length," prenotazioni"),s(),f(" \xB7 ",n.calculateTotalGuests()," persone totali "),s(),m("ngIf",n.selectedDayEvents.length>0)("ngIfElse",e)}}var ue=(n=>(n.Month="month",n.Week="week",n.Day="day",n))(ue||{}),ve=(n=>(n.Pending="pending",n.Confirmed="confirmed",n.Cancelled="cancelled",n))(ve||{}),pe=class d{reservationService=z(ce);shiftService=z(me);tableService=z(de);view="month";CalendarView=ue;viewDate=new Date;minDate=new Date().toISOString().split("T")[0];events=[];ReservationStatus=ve;showNewReservationModal=!1;showDayDetailsModal=!1;showReservationModal=!1;saving=!1;tables=[];maxCapacity=0;tableStats=null;selectedDate=new Date;selectedDayEvents=[];newReservation={customer_name:"",customer_surname:"",customer_email:"",customer_phone:"",reservation_date:this.formatDateForInput(new Date),reservation_time:"20:00",party_size:2,special_requests:"",status:"confirmed"};mobileTooltipDay=null;mobileTooltipTimeout=null;todayCapacity=0;loading=!1;shifts=[];calendarStartHour=8;calendarEndHour=23;availableTimeSlots=[];ngOnInit(){return T(this,null,function*(){this.minDate=this.formatDateForInput(new Date),console.log("\u{1F504} Calendar component initialized"),this.setupSubscriptions(),yield this.loadShifts(),yield this.loadTables(),yield this.loadCalendarData()})}setupSubscriptions(){this.reservationService.restaurantReservations$.subscribe(t=>{console.log("\u{1F4C5} Reservations received:",t.length),this.events=this.mapReservationsToEvents(t),this.calculateTodayCapacity(),this.events.length>0&&console.log("\u{1F4CC} First event:",this.events[0])}),this.tableService.data$.subscribe(t=>{console.log("\u{1F4CA} Tables updated:",t?.length),this.tables=t||[],this.calculateMaxCapacity(),this.calculateTodayCapacity()})}loadShifts(){return T(this,null,function*(){try{this.shifts=this.shiftService.data,(!this.shifts||this.shifts.length===0)&&(yield this.shiftService.loadData(),this.shifts=this.shiftService.data),this.calculateCalendarHoursFromShifts(),this.calculateAvailableTimeSlots(),console.log("\u2705 Shifts loaded for calendar:",{startHour:this.calendarStartHour,endHour:this.calendarEndHour,weekViewHours:this.getWeekViewHours()})}catch(t){console.error("Error loading shifts:",t),this.calendarStartHour=8,this.calendarEndHour=23}})}loadCalendarData(){return T(this,null,function*(){this.loading=!0;try{console.log("\u{1F4C5} Loading calendar data..."),yield this.reservationService.loadRestaurantReservations(),console.log("\u2705 Calendar data loaded successfully"),console.log("\u{1F4CA} Events after load:",this.events.length)}catch(t){console.error("Error loading calendar data:",t)}finally{this.loading=!1}})}loadReservations(){this.reservationService.loadRestaurantReservations()}getEventColor(t){return t<=2?"var(--primary)":t<=4?"var(--secondary)":"var(--tertiary)"}mapReservationsToEvents(t){return t.map(e=>{try{let n=`${e.reservation_date} ${e.reservation_time}`,[i,l,p]=e.reservation_date.split("-").map(Number),[h,y,S=0]=e.reservation_time.split(":").map(Number),C=new Date(i,l-1,p,h,y,S);console.log("\u{1F4C5} Mapped reservation:",{id:e.id,dbDate:e.reservation_date,dbTime:e.reservation_time,jsDate:C,localString:C.toLocaleString("it-IT"),dayOfMonth:C.getDate()});let w="Cliente",b="";if(e.users)w=e.users.first_name||"",b=e.users.last_name||"";else if(e.customer_name)if(e.customer_name&&e.customer_surname)w=e.customer_name,b=e.customer_surname;else{let N=e.customer_name.trim().split(" ");w=N[0]||"",b=N.slice(1).join(" ")||""}let ge=e.users?.phone||e.customer_phone||"",_e=e.users?.email||e.customer_email||"",he=e.tables?`Tavolo ${e.tables.table_number}`:"Da assegnare";return{id:e.id,start:C,title:`${w} ${b} - ${e.party_size} persone`,color:{primary:this.getEventColor(e.party_size),secondary:"var(--background)"},meta:{reservation:e,customerName:`${w} ${b}`.trim(),customerSurname:b,customerEmail:_e,customerPhone:ge,partySize:e.party_size,tableInfo:he,status:e.status||"confirmed"}}}catch(n){console.error("\u274C Error mapping reservation:",e.id,n);let i=new Date;return{id:e.id,start:i,title:"Errore nella prenotazione",color:{primary:"var(--danger)",secondary:"var(--background)"},meta:{reservation:e,customerName:"Errore",customerSurname:"",customerEmail:"",customerPhone:"",partySize:e.party_size||0,tableInfo:"Errore",status:"error"}}}})}onDayClick(t){this.openDayDetails(t)}deleteReservation(t){return T(this,null,function*(){if(t&&confirm("Sei sicuro di voler eliminare questa prenotazione?"))try{yield this.reservationService.deleteReservation(t.toString()),this.events=this.events.filter(e=>e.id!==t),this.selectedDayEvents=this.selectedDayEvents.filter(e=>e.id!==t),this.calculateTodayCapacity(),this.reservationService.loadRestaurantReservations(),alert("Prenotazione eliminata con successo!"),this.selectedDayEvents.length===0&&setTimeout(()=>{this.closeDayDetailsModal()},1e3)}catch(e){console.error("Error deleting reservation:",e),alert("Errore durante l'eliminazione della prenotazione")}})}onEventClick(t){console.log("Event clicked:",t),alert(`${t.meta.customerName}
${t.start.toLocaleTimeString()}
${t.meta.partySize} persone`)}createManualReservation(){return T(this,null,function*(){if(this.validateReservation()){this.saving=!0;try{let t=`${this.newReservation.customer_name} ${this.newReservation.customer_surname}`.trim(),e=this.newReservation.reservation_time.length===5?`${this.newReservation.reservation_time}:00`:this.newReservation.reservation_time,n={customer_name:this.newReservation.customer_name,customer_surname:this.newReservation.customer_surname,customer_email:this.newReservation.customer_email,customer_phone:this.newReservation.customer_phone,reservation_date:this.newReservation.reservation_date,reservation_time:this.newReservation.reservation_time.length===5?`${this.newReservation.reservation_time}:00`:this.newReservation.reservation_time,party_size:this.newReservation.party_size,special_requests:this.newReservation.special_requests,status:this.newReservation.status};console.log("\u{1F4E4} Invio dati prenotazione:",n);let i=yield this.reservationService.createRestaurantReservation(n);i?(console.log("\u2705 Prenotazione creata con successo:",i),alert("Prenotazione creata con successo!"),yield this.reservationService.loadRestaurantReservations(),this.closeNewReservationModal()):alert("Errore durante la creazione della prenotazione")}catch(t){console.error("\u274C Errore creazione prenotazione:",t),alert(`Errore: ${t.message||"Impossibile creare la prenotazione"}`)}finally{this.saving=!1}}})}onReservationDateChange(){this.selectedDate=new Date(this.newReservation.reservation_date);let t=this.getAvailableTimeSlotsForDate(this.selectedDate);t.length>0&&!t.includes(this.newReservation.reservation_time)&&(this.newReservation.reservation_time=t[0])}validateReservation(){if(!this.newReservation.customer_name.trim())return alert("Inserisci il nome del cliente"),!1;if(!this.newReservation.customer_surname.trim())return alert("Inserisci il cognome del cliente"),!1;if(!this.newReservation.customer_phone.trim())return alert("Inserisci il telefono del cliente"),!1;if(this.newReservation.customer_email.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.newReservation.customer_email))return alert("Inserisci un'email valida (es: nome@dominio.com)"),!1;let t=new Date(this.newReservation.reservation_date),e=new Date;return e.setHours(0,0,0,0),t<e?(alert("Non puoi prenotare per una data passata"),!1):this.newReservation.party_size<1||this.newReservation.party_size>50?(alert("Il numero di persone deve essere tra 1 e 50"),!1):!0}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}closeReservationModal(){this.showReservationModal=!1,this.resetReservationForm()}resetReservationForm(){let t=new Date;this.newReservation={customer_name:"",customer_surname:"",customer_email:"",customer_phone:"",reservation_date:this.formatDateForInput(t),reservation_time:"20:00",party_size:2,special_requests:"",status:"confirmed"}}setView(t){this.view=t}previous(){this.view==="month"?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1):this.view==="week"?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),this.viewDate.getDate()-7):this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),this.viewDate.getDate()-1)}next(){this.view==="month"?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1):this.view==="week"?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),this.viewDate.getDate()+7):this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),this.viewDate.getDate()+1)}today(){this.viewDate=new Date}getWeekDays(){let t=[],e=new Date(this.viewDate),n=e.getDay(),i=e.getDate()-n+(n===0?-6:1),l=new Date(e.setDate(i));for(let p=0;p<7;p++){let h=new Date(l);h.setDate(l.getDate()+p),t.push(h)}return t}getEventsForDay(t){let e=t.toISOString().split("T")[0];return this.events.filter(n=>n.start.toISOString().split("T")[0]===e)}getEventsForHour(t,e){let n=new Date(t);n.setHours(e,0,0,0);let i=new Date(t);return i.setHours(e+1,0,0,0),this.events.filter(l=>l.start>=n&&l.start<i)}getMonthDays(){let t=this.viewDate.getFullYear(),e=this.viewDate.getMonth(),n=new Date(t,e,1),i=new Date(t,e+1,0),l=n.getDay(),p=l===0?6:l-1,h=[],y=p;for(let w=y;w>0;w--){let b=new Date(n);b.setDate(b.getDate()-w),h.push({date:b,isCurrentMonth:!1,events:this.getEventsForDate(b)})}for(let w=1;w<=i.getDate();w++){let b=new Date(t,e,w);h.push({date:b,isCurrentMonth:!0,events:this.getEventsForDate(b)})}let C=42-h.length;for(let w=1;w<=C;w++){let b=new Date(i);b.setDate(b.getDate()+w),h.push({date:b,isCurrentMonth:!1,events:this.getEventsForDate(b)})}return h}getEventCountForDate(t){return this.getEventsForDate(t).length}getLimitedEventsForDate(t,e=3){return this.getEventsForDate(t).slice(0,e)}hasMoreEvents(t,e=3){return this.getEventsForDate(t).length>e}isToday(t){let e=new Date;return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}isCurrentMonth(t){return t.getMonth()===this.viewDate.getMonth()}calculateCalendarHoursFromShifts(){if(!this.shifts||this.shifts.length===0){this.calendarStartHour=8,this.calendarEndHour=23;return}let t=24,e=0;this.shifts.forEach(n=>{if(n.is_active){let i=this.extractHourFromTime(n.start_time),l=this.extractHourFromTime(n.end_time);i<t&&(t=i),l>e&&(e=l)}}),this.calendarStartHour=t===24?8:t,this.calendarEndHour=e===0?23:e}extractHourFromTime(t){return t?parseInt(t.split(":")[0],10):0}extractMinutesFromTime(t){return t?parseInt(t.split(":")[1],10):0}calculateAvailableTimeSlots(){if(!this.shifts||this.shifts.length===0){this.availableTimeSlots=this.generateTimeSlots(12,23,30);return}let t=[],e=30;this.shifts.forEach(n=>{if(n.is_active){let i=this.extractHourFromTime(n.start_time),l=this.extractMinutesFromTime(n.start_time),p=this.extractHourFromTime(n.end_time),h=this.extractMinutesFromTime(n.end_time),y=this.generateTimeSlotsWithStartEnd(i,l,p,h,e);t.push(...y)}}),this.availableTimeSlots=[...new Set(t)].sort()}generateTimeSlotsWithStartEnd(t,e,n,i,l){let p=[],h=t,y=e,S=Math.floor(y/l)*l;for(S>y,y=S;h<n||h===n&&y<i;){let C=h.toString().padStart(2,"0"),w=y.toString().padStart(2,"0");p.push(`${C}:${w}`),y+=l,y>=60&&(y=0,h++)}return p}generateTimeSlots(t,e,n){let i=[];for(let l=t;l<=e;l++)for(let p=0;p<60;p+=n){let h=l.toString().padStart(2,"0"),y=p.toString().padStart(2,"0");i.push(`${h}:${y}`)}return i}getAvailableTimeSlotsForDate(t){return this.availableTimeSlots}getWeekViewHours(){console.log("\u{1F4C5} getWeekViewHours called:",{start:this.calendarStartHour,end:this.calendarEndHour,view:this.view});let t=[],e=Math.max(0,Math.min(this.calendarStartHour||8,23)),n=Math.max(e,Math.min(this.calendarEndHour||23,23));for(let i=e;i<=n;i++)t.push(i);return t}openNewReservationModal(){this.selectedDate=new Date,this.newReservation.reservation_date=this.formatDateForInput(this.selectedDate);let t=this.getAvailableTimeSlotsForDate(this.selectedDate);t.length>0&&(this.newReservation.reservation_time=t[0]),this.showNewReservationModal=!0,this.resetReservationForm()}openDayDetails(t){console.log("\u{1F4C5} Opening day details for:",t),console.log("\u{1F4CA} Current events count:",this.events.length),this.selectedDate=t,this.selectedDayEvents=this.getEventsForDate(t),console.log("\u{1F4CB} Events for selected day:",this.selectedDayEvents.length),console.log("\u{1F4CB} All events:"),this.events.forEach((e,n)=>{console.log(`Event ${n}:`,{date:e.start,customer:e.meta.customerName,localDate:e.start.toLocaleDateString("it-IT")})}),this.showDayDetailsModal=!0,setTimeout(()=>{console.log("\u{1F504} Modal state:",this.showDayDetailsModal)},100)}closeNewReservationModal(){this.showNewReservationModal=!1,this.resetReservationForm()}closeDayDetailsModal(){this.showDayDetailsModal=!1}openNewReservationForSelectedDay(){this.showDayDetailsModal=!1,this.newReservation.reservation_date=this.formatDateForInput(this.selectedDate);let t=this.getAvailableTimeSlotsForDate(this.selectedDate);t.length>0&&(this.newReservation.reservation_time=t[0]),this.showNewReservationModal=!0}editReservation(t){let e=t.meta.customerName.split(" "),n=e[0]||"",i=e.slice(1).join(" ")||"";t.meta.customerSurname&&(i=t.meta.customerSurname);let l,p=t.meta.status?.toLowerCase();p==="pending"?l="pending":p==="cancelled"||p==="cancellata"?l="cancelled":l="confirmed",this.newReservation={customer_name:n,customer_surname:i,customer_email:t.meta.customerEmail||"",customer_phone:t.meta.customerPhone||"",reservation_date:this.formatDateForInput(t.start),reservation_time:this.formatTime(t.start),party_size:t.meta.partySize,special_requests:t.meta.reservation.special_requests||"",status:l},this.showDayDetailsModal=!1,this.showNewReservationModal=!0}formatTime(t){let e=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0");return`${e}:${n}`}getReservationStatusClass(t){switch(t?.toLowerCase()){case"confirmed":case"confermata":return"status-confirmed";case"pending":case"in attesa":return"status-pending";case"cancelled":case"cancellata":return"status-cancelled";default:return"status-unknown"}}formatTimeForDisplay(t){if(!t)return"";let[e,n]=t.split(":");return`${e}:${n}`}formatDateForInput(t){let e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${e}-${n}-${i}`}formatDateForDB(t){let e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${e}-${n}-${i}`}loadTables(){return T(this,null,function*(){try{console.log("\u{1F504} Loading restaurant tables..."),yield this.tableService.loadData();let t=this.tableService.getTables();console.log("\u2705 Tables loaded from service:",t?.length),this.tables=t||[],this.calculateMaxCapacity()}catch(t){console.error("Error loading tables:",t)}})}calculateMaxCapacity(){if(this.tables.length===0){console.log("\u26A0\uFE0F No tables found, using default capacity"),this.maxCapacity=50,this.tableStats=null;return}this.maxCapacity=this.tableService.calculateMaxCapacity(this.tables),this.tableStats=this.tableService.getTableStats(this.tables),console.log("\u{1F4CA} Capacity calculated:",{maxCapacity:this.maxCapacity,tableCount:this.tables.length,stats:this.tableStats})}getCapacityDistribution(){if(!this.tables.length)return[];let t=this.tableService.getCapacityByTableType(this.tables);return Object.entries(t).map(([e,n])=>({capacity:parseInt(e),count:n})).sort((e,n)=>e.capacity-n.capacity)}getAvailableTablesForDate(t){let e=this.formatDateForInput(t),i=this.events.filter(l=>this.formatDateForInput(l.start)===e).map(l=>l.meta.reservation).filter(l=>l.table_id).map(l=>l.table_id);return this.tables.filter(l=>!i.includes(l.id))}getDateCapacityStats(t){let e=this.formatDateForInput(t),i=this.events.filter(S=>this.formatDateForInput(S.start)===e).reduce((S,C)=>S+(C.meta?.partySize||0),0),l=this.getAvailableTablesForDate(t),p=l.length,h=l.reduce((S,C)=>S+(C.capacity||0),0),y=this.maxCapacity>0?i/this.maxCapacity*100:0;return{totalCapacity:this.maxCapacity,usedCapacity:i,availableCapacity:h,availableTables:p,percentage:Math.round(y)}}calculateMaxCapacitySimple(){return this.tables.length===0?50:this.tables.reduce((t,e)=>t+(e.capacity||0),0)}getAvailableTablesToday(){if(this.tables.length===0)return 0;let t=new Date().toISOString().split("T")[0],e=this.events.filter(n=>new Date(n.start).toISOString().split("T")[0]===t&&n.meta.reservation.table_id).map(n=>n.meta.reservation.table_id).filter(n=>n);return this.tables.filter(n=>!e.includes(n.id)).length}getAvailableTablesForSelectedDate(){if(this.tables.length===0||!this.selectedDate)return 0;let t=this.formatDateForInput(this.selectedDate),e=this.events.filter(n=>this.formatDateForInput(n.start)===t&&n.meta.reservation.table_id).map(n=>n.meta.reservation.table_id).filter(n=>n);return this.tables.filter(n=>!e.includes(n.id)).length}getSimpleCapacityDistribution(){let t=[],e={};this.tables.forEach(n=>{let i=n.capacity||0;e[i]=(e[i]||0)+1});for(let[n,i]of Object.entries(e))t.push({size:parseInt(n),count:i});return t.sort((n,i)=>n.size-i.size)}isSameDate(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}getEventsForDate(t){let e=this.formatDateForInput(t);console.log("\u{1F50D} Looking for events on:",e);let n=this.events.filter(i=>{let l=this.formatDateForInput(i.start),p=l===e;return p&&console.log("\u2705 Found event:",{date:l,customer:i.meta.customerName,time:i.start.toLocaleTimeString()}),p});return console.log(`\u{1F4CA} Found ${n.length} events for ${e}`),n}getTodaysReservationCount(){let t=new Date;return this.events.filter(e=>this.isSameDate(e.start,t)).length}calculateTodayCapacity(){let t=new Date,e=this.events.filter(n=>this.isSameDate(n.start,t));this.todayCapacity=e.reduce((n,i)=>n+(i.meta?.partySize||0),0),console.log("\u{1F4C5} Today capacity (local):",{today:t.toLocaleDateString("it-IT"),events:e.length,capacity:this.todayCapacity})}calculateTotalGuests(){return this.selectedDayEvents.reduce((t,e)=>t+(e.meta?.partySize||0),0)}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=H({type:d,selectors:[["app-calendar-view"]],decls:68,vars:38,consts:[["noReservations",""],[1,"page-container"],[1,"calendar-controls"],[1,"modal-footer","w-100"],[1,"promethea-button",3,"click"],[1,"promethea-button","ghost",3,"click"],[1,"flex","gap-sm","justify-between","flex-wrap","w-100","p-sm"],[1,"flex","gap-sm"],[1,"icon-button",3,"click"],[1,"material-icons"],[1,"p-sm"],[1,"text-md"],[1,"grid-cards","p-sm","mb-lg"],[1,"card"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"text-md","font-semibold","m-0"],[1,"text-md","font-bold","text-primary","justify-center","flex"],[1,"text-muted","card-footer"],[1,"text-muted","card-footer","flex-col"],[1,"flex"],["class","mt-sm text-mini flex flex-col",4,"ngIf"],[1,"material-icons","text-md"],[1,"text-md","font-bold","justify-center","flex"],["class","ml-sm text-mini",4,"ngIf"],["class","card",4,"ngIf"],[1,"calendar-wrapper","p-sm"],["class","calendar-month-view",4,"ngIf"],["class","calendar-week-view",4,"ngIf"],["class","calendar-day-view",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"mt-sm","text-mini","flex","flex-col"],["class","flex justify-between",4,"ngFor","ngForOf"],[1,"flex","justify-between"],[1,"font-semibold"],[1,"ml-sm","text-mini"],[1,"material-icons","text-md","text-primary"],[1,"text-md","font-bold","text-info","justify-center","text-primary","flex"],[1,"calendar-month-view"],[1,"month-weekdays","flex"],["class","month-weekday",4,"ngFor","ngForOf"],[1,"month-grid"],["class","month-day",3,"today","current-month","other-month","click",4,"ngFor","ngForOf"],[1,"month-weekday"],[1,"month-day",3,"click"],[1,"day-number-wrapper"],[1,"day-number"],["class","day-events-indicator",3,"background",4,"ngIf"],["class","month-events-compact",4,"ngIf"],[1,"day-events-indicator"],[1,"month-events-compact"],["class","month-event-compact",3,"border-color","click",4,"ngFor","ngForOf"],["class","more-events-compact",3,"click",4,"ngIf"],[1,"month-event-compact",3,"click"],[1,"event-time-small"],[1,"event-customer-small"],[1,"more-events-compact",3,"click"],[1,"calendar-week-view"],[1,"week-header","flex"],[1,"week-time-column"],["class","week-day-header",3,"today",4,"ngFor","ngForOf"],[1,"week-body"],["class","week-hour",4,"ngFor","ngForOf"],["class","week-day-column",4,"ngFor","ngForOf"],[1,"week-day-header"],[1,"week-day-name"],[1,"week-day-number"],[1,"week-hour"],[1,"week-day-column"],["class","week-hour-slot",3,"click",4,"ngFor","ngForOf"],[1,"week-hour-slot",3,"click"],["class","week-event",3,"background","click",4,"ngFor","ngForOf"],[1,"week-event",3,"click"],[1,"event-time"],[1,"event-customer"],[1,"event-details"],[1,"calendar-day-view"],[1,"day-header"],[1,"day-body"],["class","day-hour",4,"ngFor","ngForOf"],[1,"day-hour"],[1,"hour-label"],[1,"hour-slot",3,"click"],["class","day-event",3,"background","click",4,"ngFor","ngForOf"],[1,"day-event",3,"click"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"section-title"],[3,"ngSubmit"],[1,"form-card"],[1,"form-row"],[1,"form-group"],["for","customerName",1,"standard-label"],["name","user",1,"nav-icon",3,"size"],["type","text","id","customerName","name","customerName","required","","placeholder","Inserisci nome",3,"ngModelChange","ngModel"],["for","customerSurname",1,"standard-label"],["type","text","id","customerSurname","name","customerSurname","required","","placeholder","Inserisci cognome",3,"ngModelChange","ngModel"],["for","customerEmail",1,"standard-label"],["name","mail",1,"nav-icon",3,"size"],["type","email","id","customerEmail","name","customerEmail","placeholder","Inserisci email (facoltativo)",3,"ngModelChange","ngModel"],["for","customerPhone",1,"standard-label"],["type","tel","id","customerPhone","name","customerPhone","required","","placeholder","Inserisci telefono",3,"ngModelChange","ngModel"],["for","reservationDate",1,"standard-label"],["type","date","id","reservationDate","name","reservationDate","required","",3,"ngModelChange","change","ngModel","min"],["for","reservationTime",1,"standard-label"],["id","reservationTime","name","reservationTime","required","",3,"ngModelChange","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","partySize",1,"standard-label"],["type","number","id","partySize","name","partySize","min","1","max","20","required","",3,"ngModelChange","ngModel"],["for","reservationStatus",1,"standard-label"],["name","info"],["id","reservationStatus","name","reservationStatus",3,"ngModelChange","ngModel"],[3,"value"],["for","specialRequests",1,"standard-label"],["id","specialRequests","name","specialRequests","rows","3","placeholder","Note o richieste particolari...",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button"],[1,"flex","items-center","gap-md"],[1,"header-icon"],[1,"material-icons","text-primary","text-lg"],[1,"section-title","m-0"],[1,"text-muted","m-0"],[1,"modal-content","p-md"],[1,"info-message","mb-lg"],["class","flex flex-col gap-md mb-sm",4,"ngIf","ngIfElse"],["type","button",1,"promethea-button",3,"click"],[1,"flex","flex-col","gap-md","mb-sm"],["class","card hover-lift",4,"ngFor","ngForOf"],[1,"card","hover-lift"],[1,"flex","justify-between","items-start","mb-md","flex-wrap"],[1,"flex","items-center","gap-sm","mb-sm","flex-wrap"],[1,"font-bold","text-md","m-0"],[1,"chip"],[1,"flex","items-center","gap-md","flex-wrap"],[1,"flex","items-center","gap-sm"],[1,"material-icons","text-mini"],[1,"text-mini"],["class","flex items-center gap-sm",4,"ngIf"],["title","Modifica",1,"icon-button","x-small",3,"click"],["title","Elimina",1,"icon-button","x-small",3,"click"],[1,"card-body"],[1,"flex","flex-col","items-center","text-center","p-sm","rounded","bg-smoke"],[1,"material-icons","text-primary","mb-xs"],[1,"font-bold","text-md"],[1,"text-mini","font-semibold"],["class","mt-md p-sm rounded bg-smoke",4,"ngIf"],[1,"mt-md","p-sm","rounded","bg-smoke"],[1,"flex","items-center","gap-sm","mb-xs"],[1,"material-icons","text-primary"],[1,"text-sm","m-0"],[1,"empty-state","text-center","py-xl"],[1,"material-icons","text-lg","text-muted","mb-md"],[1,"text-md","font-bold","mb-sm"],[1,"text-muted","mb-lg"]],template:function(e,n){e&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),_("click",function(){return n.setView(n.CalendarView.Month)}),o(4," Mese "),a(),r(5,"button",5),_("click",function(){return n.setView(n.CalendarView.Week)}),o(6," Settimana "),a(),r(7,"button",5),_("click",function(){return n.setView(n.CalendarView.Day)}),o(8," Giorno "),a()(),r(9,"div",6)(10,"div",7)(11,"button",8),_("click",function(){return n.previous()}),r(12,"span",9),o(13,"chevron_left"),a()(),r(14,"button",5),_("click",function(){return n.today()}),o(15," Oggi "),a(),r(16,"button",8),_("click",function(){return n.next()}),r(17,"span",9),o(18,"chevron_right"),a()()(),r(19,"button",4),_("click",function(){return n.openNewReservationModal()}),r(20,"span",9),o(21,"add"),a(),o(22," Nuova Prenotazione "),a()()(),r(23,"div",10)(24,"strong",11),o(25),P(26,"date"),a()(),r(27,"div",12)(28,"div",13)(29,"div",14)(30,"span",15),o(31,"event_available"),a(),r(32,"h3",16),o(33,"Prenotazioni Oggi"),a()(),r(34,"div",17),o(35),a(),r(36,"div",18),o(37,"Per oggi"),a()(),r(38,"div",13)(39,"div",14)(40,"span",15),o(41,"group"),a(),r(42,"h3",16),o(43,"Capienza Massima"),a()(),r(44,"div",17),o(45),a(),r(46,"div",19)(47,"div",20),o(48),a(),g(49,ye,2,1,"div",21),a()(),r(50,"div",13)(51,"div",14)(52,"span",22),o(53," table_restaurant "),a(),r(54,"h3",16),o(55,"Occupazione Oggi"),a()(),r(56,"div",23),o(57),a(),r(58,"div",18),o(59),g(60,we,2,1,"span",24),a()(),g(61,be,11,7,"div",25),a(),r(62,"div",26),g(63,Re,5,3,"div",27)(64,ze,8,3,"div",28)(65,He,7,5,"div",29),a(),g(66,$e,86,16,"div",30)(67,Ye,36,8,"div",30),a()),e&2&&(s(3),D("active",n.view===n.CalendarView.Month),s(2),D("active",n.view===n.CalendarView.Week),s(2),D("active",n.view===n.CalendarView.Day),s(18),x(O(26,35,n.viewDate,"MMMM yyyy")),s(10),f(" ",n.getTodaysReservationCount()," "),s(10),f(" ",n.calculateMaxCapacitySimple()," "),s(3),f("",n.tables.length," tavoli"),s(),m("ngIf",n.tables.length>0),s(3),D("text-primary",n.todayCapacity/n.calculateMaxCapacitySimple()<=.7)("text-warning",n.todayCapacity/n.calculateMaxCapacitySimple()>.7&&n.todayCapacity/n.calculateMaxCapacitySimple()<=.9)("text-danger",n.todayCapacity/n.calculateMaxCapacitySimple()>.9),s(4),D("text-primary",n.todayCapacity/n.calculateMaxCapacitySimple()<=.7)("text-warning",n.todayCapacity/n.calculateMaxCapacitySimple()>.7&&n.todayCapacity/n.calculateMaxCapacitySimple()<=.9)("text-danger",n.todayCapacity/n.calculateMaxCapacitySimple()>.9),s(),V(" ",n.todayCapacity," / ",n.calculateMaxCapacitySimple()," "),s(2),f(" ",(n.todayCapacity/n.calculateMaxCapacitySimple()*100||0).toFixed(0),"% "),s(),m("ngIf",n.getAvailableTablesToday()>0),s(),m("ngIf",n.selectedDate),s(),D("loading",n.loading),s(),m("ngIf",n.view===n.CalendarView.Month),s(),m("ngIf",n.view===n.CalendarView.Week),s(),m("ngIf",n.view===n.CalendarView.Day),s(),m("ngIf",n.showNewReservationModal),s(),m("ngIf",n.showDayDetailsModal))},dependencies:[Y,q,B,oe,X,te,ne,G,Z,ee,U,J,re,ie,ae,Q,K,le,se,j],styles:['.calendar-wrapper[_ngcontent-%COMP%]{border-radius:16px;min-height:600px;height:100%}.calendar-month-view[_ngcontent-%COMP%]{background:var(--background);border-radius:16px;overflow:hidden}.month-weekdays[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);background:var(--smoke-2);border-bottom:2px solid var(--primary)}.month-weekday[_ngcontent-%COMP%]{padding:var(--gap-sm);text-align:center;font-weight:700;font-size:var(--fs-sm);color:var(--text-color);text-transform:uppercase;border-right:1px solid var(--smoke-1)}.month-weekday[_ngcontent-%COMP%]:last-child{border-right:none}.month-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);grid-auto-rows:minmax(4rem,1fr);min-height:30rem}.month-day[_ngcontent-%COMP%]{border:1px solid var(--smoke-1);padding:0;display:flex;flex-direction:column;min-height:120px;background:var(--background);transition:all .2s ease;cursor:pointer;position:relative;overflow:hidden}.month-day[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--smoke-1) 20%,transparent);z-index:10}.month-day.today[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 8%,transparent);border-color:var(--primary)}.month-day.other-month[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--smoke-1) 10%,transparent);opacity:.6}.day-number-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;padding:var(--gap-sm)}.day-number[_ngcontent-%COMP%]{font-weight:800;font-size:var(--fs-sn);color:var(--text-color);transition:all .2s ease;line-height:1}.month-day.today[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{color:var(--primary);font-weight:900}.day-events-indicator[_ngcontent-%COMP%]{font-size:10px;font-weight:700;padding:2px 6px;border-radius:10px;color:#fff;min-width:16px;text-align:center;line-height:1}.month-events-compact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:3px;overflow:hidden;flex:1}.month-event-compact[_ngcontent-%COMP%]{background:var(--vetro);border-left:3px solid;padding:3px 5px;border-radius:4px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:4px;font-size:calc(var(--fs-sm) / 1.4);line-height:1.2;margin:0 var(--gap-sm)}.month-event-compact[_ngcontent-%COMP%]:hover{transform:translate(2px);box-shadow:0 2px 4px var(--shadow-2)}.event-time-small[_ngcontent-%COMP%]{font-weight:700;font-size:9px;color:var(--text-color);min-width:28px;background:var(--background);padding:1px 3px;border-radius:3px;text-align:center;flex-shrink:0}.event-customer-small[_ngcontent-%COMP%]{font-weight:600;font-size:9px;color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}.more-events-compact[_ngcontent-%COMP%]{font-size:9px;color:var(--primary);text-align:center;padding:2px;background:color-mix(in srgb,var(--primary) 8%,transparent);border-radius:3px;cursor:pointer;transition:all .2s ease;margin-top:2px}.more-events-compact[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary) 15%,transparent)}.calendar-week-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid var(--smoke-1);border-radius:12px;overflow:hidden}.week-header[_ngcontent-%COMP%]{display:flex;background:var(--smoke-2);border-bottom:2px solid var(--primary);flex-shrink:0}.week-time-column[_ngcontent-%COMP%]{width:80px;background:var(--smoke-1);border-right:2px solid var(--primary);flex-shrink:0}.week-day-header[_ngcontent-%COMP%]{padding:var(--gap-sm);text-align:center;font-weight:700;color:var(--text-color);border-right:1px solid var(--smoke-1);flex:1;display:flex;flex-direction:column;justify-content:center;min-height:60px}.week-day-header.today[_ngcontent-%COMP%]{background:var(--primary);color:#fff}.week-day-name[_ngcontent-%COMP%]{font-size:var(--fs-sm);text-transform:uppercase;margin-bottom:2px}.week-day-number[_ngcontent-%COMP%]{font-size:var(--fs-md);font-weight:800}.week-body[_ngcontent-%COMP%]{flex:1;display:flex;overflow-y:auto}.week-time-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.week-time-column[_ngcontent-%COMP%]   .week-hour[_ngcontent-%COMP%]{height:60px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:var(--fs-sm);font-weight:600;color:var(--text-color);border-bottom:1px solid var(--smoke-1);position:relative}.week-hour[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;right:0;bottom:-1px;height:1px;background:var(--smoke-1);z-index:1}.week-day-column[_ngcontent-%COMP%]{flex:1;border-right:1px solid var(--smoke-1);display:flex;flex-direction:column;overflow:hidden}.week-hour-slot[_ngcontent-%COMP%]{height:60px;flex-shrink:0;border-bottom:1px solid var(--smoke-1);position:relative;padding:2px;cursor:pointer;transition:background .2s ease;background:var(--background)}.week-hour-slot[_ngcontent-%COMP%]:nth-child(2n){background:color-mix(in srgb,var(--smoke-1) 5%,transparent)}.week-hour-slot[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--smoke-1) 15%,transparent)}.week-event[_ngcontent-%COMP%]{position:absolute;left:2px;right:2px;padding:6px 8px;border-radius:6px;color:#fff;font-size:11px;cursor:pointer;z-index:2;transition:all .2s ease;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-shadow:0 2px 4px #0000001a}.week-event[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px var(--shadow-2);z-index:100}.calendar-day-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:600px;border:1px solid var(--smoke-1);border-radius:12px;overflow:hidden}.day-header[_ngcontent-%COMP%]{padding:var(--gap-md);text-align:center;background:var(--smoke-2);border-bottom:2px solid var(--primary);border-radius:12px 12px 0 0;flex-shrink:0}.day-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.day-hour[_ngcontent-%COMP%]{display:flex;min-height:60px;border-bottom:1px solid var(--smoke-1);background:var(--background)}.day-hour[_ngcontent-%COMP%]:nth-child(2n){background:color-mix(in srgb,var(--smoke-1) 5%,transparent)}.hour-label[_ngcontent-%COMP%]{width:80px;background:var(--smoke-1);display:flex;align-items:center;justify-content:center;font-weight:600;flex-shrink:0;font-size:var(--fs-sm);border-right:2px solid var(--primary)}.hour-slot[_ngcontent-%COMP%]{flex:1;position:relative;padding:4px;cursor:pointer;transition:background .2s ease}.hour-slot[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--smoke-1) 10%,transparent)}.day-event[_ngcontent-%COMP%]{background:var(--gradiente);color:#fff;padding:8px 12px;border-radius:8px;margin:2px 0;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px #0000001a}.day-event[_ngcontent-%COMP%]:hover{transform:translate(4px);box-shadow:0 4px 12px var(--shadow-2)}.event-time[_ngcontent-%COMP%]{font-weight:600;font-size:10px;opacity:.9;margin-bottom:2px}.event-customer[_ngcontent-%COMP%]{font-weight:700;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.event-details[_ngcontent-%COMP%]{font-size:10px;opacity:.9;margin-top:2px}@media (max-width: 768px){.calendar-wrapper[_ngcontent-%COMP%]{margin:0;border-radius:12px}.calendar-controls[_ngcontent-%COMP%]{flex-wrap:wrap}.month-grid[_ngcontent-%COMP%]{min-height:350px}.month-day[_ngcontent-%COMP%]{min-height:70px;padding:6px}.day-number[_ngcontent-%COMP%]{font-size:var(--fs-sm)}.month-weekday[_ngcontent-%COMP%]{padding:8px 4px;font-size:10px}.month-event-compact[_ngcontent-%COMP%]{padding:2px 3px;font-size:8px}.event-time-small[_ngcontent-%COMP%]{font-size:7px;min-width:24px}.day-events-indicator[_ngcontent-%COMP%]{font-size:8px;padding:1px 4px}.calendar-week-view[_ngcontent-%COMP%], .calendar-day-view[_ngcontent-%COMP%]{height:fit-content}.week-time-column[_ngcontent-%COMP%], .hour-label[_ngcontent-%COMP%]{width:60px}.week-time-column[_ngcontent-%COMP%]   .week-hour[_ngcontent-%COMP%], .week-hour-slot[_ngcontent-%COMP%], .day-hour[_ngcontent-%COMP%]{height:40px}.week-event[_ngcontent-%COMP%]{font-size:9px;padding:4px}.week-day-header[_ngcontent-%COMP%]{padding:6px 3px;min-height:50px}.week-day-name[_ngcontent-%COMP%]{font-size:10px}.week-day-number[_ngcontent-%COMP%]{font-size:var(--fs-sm)}}@media (max-width: 480px){.month-day[_ngcontent-%COMP%]{min-height:60px;padding:4px}.month-event-compact[_ngcontent-%COMP%]{flex-direction:column;gap:1px}.event-customer-small[_ngcontent-%COMP%], .more-events-compact[_ngcontent-%COMP%]{font-size:7px}}.week-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.week-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--smoke-2);border-radius:4px}.week-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.month-day[_ngcontent-%COMP%]:has(.day-events-count-many)   .month-events-compact[_ngcontent-%COMP%]{display:none!important}.month-day[_ngcontent-%COMP%]:has(.day-events-count-many)   .day-events-indicator[_ngcontent-%COMP%]{position:absolute!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:24px!important;height:24px!important;font-size:12px!important;border-radius:50%!important;background:var(--primary)!important;color:#fff!important;border:2px solid white!important;box-shadow:0 2px 4px #0003!important;z-index:10!important;display:flex!important;align-items:center!important;justify-content:center!important}.month-day.small-cell[_ngcontent-%COMP%]   .month-events-compact[_ngcontent-%COMP%]{display:none!important}.month-day.small-cell[_ngcontent-%COMP%]   .day-events-indicator[_ngcontent-%COMP%]{position:relative!important;top:auto!important;left:auto!important;transform:none!important;margin-left:4px!important}.month-day.event-overflow[_ngcontent-%COMP%]   .month-events-compact[_ngcontent-%COMP%]{display:none!important}.month-day.event-overflow[_ngcontent-%COMP%]:after{content:"";position:absolute;top:2px;right:2px;width:8px;height:8px;background:var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.6}50%{opacity:1}to{opacity:.6}}@container (max-width: 768px){.calendar-month-view[_ngcontent-%COMP%]   .month-events-compact[_ngcontent-%COMP%]{display:none!important}.calendar-month-view[_ngcontent-%COMP%]   .day-events-indicator[_ngcontent-%COMP%]{position:absolute!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:28px!important;height:28px!important;font-size:13px!important;font-weight:700!important;border-radius:50%!important;background:var(--gradiente)!important;color:#fff!important;border:2px solid var(--background)!important;box-shadow:0 3px 6px #00000026!important;display:flex!important;align-items:center!important;justify-content:center!important;z-index:5!important;animation:_ngcontent-%COMP%_bounce .5s ease!important}.calendar-month-view[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{opacity:.7!important;font-size:13px!important}.calendar-month-view[_ngcontent-%COMP%]   .month-day[_ngcontent-%COMP%]{min-height:70px!important;padding:8px!important;position:relative!important}.calendar-month-view[_ngcontent-%COMP%]   .month-day.today[_ngcontent-%COMP%]   .day-events-indicator[_ngcontent-%COMP%]{border:2px solid var(--primary)!important;animation:_ngcontent-%COMP%_pulse-glow 2s infinite!important}}@keyframes _ngcontent-%COMP%_bounce{0%{transform:translate(-50%,-50%) scale(.8)}50%{transform:translate(-50%,-50%) scale(1.1)}to{transform:translate(-50%,-50%) scale(1)}}@keyframes _ngcontent-%COMP%_pulse-glow{0%{box-shadow:0 0 rgba(var(--primary-rgb),.7)}70%{box-shadow:0 0 0 6px rgba(var(--primary-rgb),0)}to{box-shadow:0 0 rgba(var(--primary-rgb),0)}}@media (max-width: 768px){.calendar-month-view[_ngcontent-%COMP%]   .month-events-compact[_ngcontent-%COMP%]{display:none!important}.calendar-month-view[_ngcontent-%COMP%]   .day-number-wrapper[_ngcontent-%COMP%]{padding:0}.calendar-month-view[_ngcontent-%COMP%]   .day-events-indicator[_ngcontent-%COMP%]{position:absolute!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:28px!important;height:28px!important;font-size:13px!important;font-weight:700!important;border-radius:50%!important;background:var(--gradiente)!important;color:#fff!important;border:2px solid var(--background)!important;box-shadow:0 3px 6px #00000026!important;display:flex!important;align-items:center!important;justify-content:center!important;z-index:5!important}}.reservation-details[_ngcontent-%COMP%], .hover-lift[_ngcontent-%COMP%]{overflow:hidden}.calendar-controls[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm)}']})};export{ue as CalendarView,ve as ReservationStatus,pe as RestaurantCalendar};
