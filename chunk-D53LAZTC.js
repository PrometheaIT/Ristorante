import{b as g}from"./chunk-HZAFCD3S.js";import{_ as u,da as l,g as i,n as c}from"./chunk-3SWAHN2Y.js";var p=class o{supabaseService=l(g);restaurantSubject=new c(null);restaurant$=this.restaurantSubject.asObservable();loadRestaurantById(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("restaurants").select("*").eq("id",a).eq("is_active",!0).single();if(e)throw e;return r}catch(r){return console.error("\u274C Error loading restaurant by ID:",r),null}})}loadRestaurantShifts(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("shifts").select("*").eq("restaurant_id",a).eq("is_active",!0).order("start_time");if(e)throw e;return r||[]}catch(r){return console.error("\u274C Error loading restaurant shifts:",r),[]}})}loadRestaurantDishes(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("dishes").select("*").eq("restaurant_id",a).eq("status","available").order("name");if(e)throw e;return r||[]}catch(r){return console.error("\u274C Error loading restaurant dishes:",r),[]}})}loadRestaurantDishesWithCategories(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("dishes").select(`
          id,
          name,
          description,
          base_price,
          delivery_price,
          takeaway_price,
          image_url,
          preparation_time,
          status,
          category_id,
          categories (
            id,
            name
          )
        `).eq("restaurant_id",a).eq("status","available").order("name");if(e)throw e;return(r||[]).map(t=>{let s=t.categories&&t.categories.length>0?t.categories[0]:null;return{id:t.id,name:t.name,description:t.description,base_price:t.base_price,delivery_price:t.delivery_price,takeaway_price:t.takeaway_price,image_url:t.image_url,preparation_time:t.preparation_time,status:t.status,category_id:t.category_id,category_name:s?s.name:void 0}})}catch(r){return console.error("\u274C Error loading restaurant dishes with categories:",r),this.loadRestaurantDishes(a)}})}loadRestaurantCategories(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("categories").select("*").eq("restaurant_id",a).order("order_index");if(e)throw e;return r||[]}catch(r){return console.error("\u274C Error loading restaurant categories:",r),[]}})}loadRestaurantsByCuisine(a){return i(this,null,function*(){try{let r=this.supabaseService.getSupabaseClient().from("restaurants").select("*").eq("is_active",!0).order("name");a&&(r=r.eq("cuisine_type",a));let{data:e,error:t}=yield r;if(t)throw t;return e||[]}catch(r){return console.error("\u274C Error loading restaurants:",r),[]}})}loadRestaurant(a){return i(this,null,function*(){try{let{data:r,error:e}=yield this.supabaseService.getSupabaseClient().from("restaurants").select("*").eq("id",a).eq("is_active",!0).single();if(e)throw e;return this.restaurantSubject.next(r),r}catch(r){return console.error("\u274C Error loading restaurant:",r),null}})}loadRestaurantPhotos(a){return i(this,null,function*(){try{let r=this.supabaseService.getSupabaseClient(),{data:e,error:t}=yield r.from("restaurant_photos").select("*").eq("restaurant_id",a).order("display_order",{ascending:!0});if(t)throw t;let s=(e||[]).map(n=>{if(n.file_path){let{data:{publicUrl:d}}=r.storage.from("restaurant-images").getPublicUrl(n.file_path);return d}return null}).filter(n=>n!==null);return console.log("\u{1F5BC}\uFE0F Foto caricate per slideshow:",s),s}catch(r){return console.error("\u274C Errore caricamento foto per ristorante pubblico:",r),[]}})}static \u0275fac=function(r){return new(r||o)};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};export{p as a};
