import{b as P}from"./chunk-6NWDY4DP.js";import{a as M,b as x,c as m,d as I,e as F,i as k,j as O,m as T,p as A,w as q,y as z}from"./chunk-2WQQ3H4M.js";import"./chunk-PJAEBTL6.js";import{d as w,l as C,p as R,r as S,s as E}from"./chunk-JA3GOP6I.js";import{Ab as c,Db as o,Ea as s,Eb as h,Fb as v,Ua as y,Za as p,ba as g,fb as l,gb as a,hb as t,ib as u,rb as N,tb as f}from"./chunk-HZF257L5.js";import{j as b}from"./chunk-4ZZIO3ZI.js";function D(n,r){n&1&&(a(0,"div",34),o(1," Il nome \xE8 obbligatorio "),t())}function V(n,r){n&1&&(a(0,"div",34),o(1," Il cognome \xE8 obbligatorio "),t())}function j(n,r){n&1&&(a(0,"span"),o(1,"Email obbligatoria"),t())}function G(n,r){n&1&&(a(0,"span"),o(1,"Email non valida"),t())}function Y(n,r){if(n&1&&(a(0,"div",34),p(1,j,2,0,"span",33)(2,G,2,0,"span",33),t()),n&2){let i=f();s(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.required),s(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.email)}}function U(n,r){n&1&&(a(0,"div",34),o(1," Il nome del ristorante \xE8 obbligatorio "),t())}function B(n,r){if(n&1&&(a(0,"div",8)(1,"h2",9)(2,"span",35),o(3,"business"),t(),o(4," Informazioni Ristorante "),t(),a(5,"div",12)(6,"label",13),o(7,"Nome Ristorante *"),t(),u(8,"input",36),p(9,U,2,0,"div",15),t()()),n&2){let i=f();s(8),c("error",(i.restaurantName==null?null:i.restaurantName.invalid)&&(i.restaurantName==null?null:i.restaurantName.touched)),s(),l("ngIf",(i.restaurantName==null?null:i.restaurantName.invalid)&&(i.restaurantName==null?null:i.restaurantName.touched))}}function H(n,r){n&1&&(a(0,"div",34),o(1," Password obbligatoria (min. 6 caratteri) "),t())}function J(n,r){n&1&&(a(0,"div",34),o(1," Le password non coincidono "),t())}function K(n,r){if(n&1&&(a(0,"div",37),o(1),t()),n&2){let i=f();s(),v(" ",i.errorMessage," ")}}function Q(n,r){n&1&&u(0,"span",38)}function W(n,r){if(n&1&&(a(0,"span"),o(1),t()),n&2){let i=f();s(),h(i.isRestaurant?"Registra Ristorante":"Crea Account")}}var L=class n{fb=g(q);authService=g(P);router=g(S);route=g(R);registerForm;isLoading=!1;errorMessage="";isRestaurant=!1;isSupplier=!1;ngOnInit(){let r=this.route.snapshot.paramMap.get("role");this.isRestaurant=r==="restaurant",this.isSupplier=r==="supplier",this.initializeForm()}initializeForm(){this.registerForm=this.fb.group({email:["",[m.required,m.email]],password:["",[m.required,m.minLength(6)]],confirmPassword:["",[m.required]],firstName:["",[m.required]],lastName:["",[m.required]],phone:[""],policy:[!1,[m.requiredTrue]],restaurantName:[(this.isRestaurant,""),this.isRestaurant?m.required:[]],companyName:[(this.isSupplier,""),this.isSupplier?m.required:[]],contactName:[(this.isSupplier,""),this.isSupplier?m.required:[]],supplierAddress:[(this.isSupplier,"")],supplierDescription:[(this.isSupplier,"")]},{validators:this.passwordMatchValidator})}get rememberMe(){return this.registerForm.get("policy")}passwordMatchValidator(r){let i=r.get("password")?.value,e=r.get("confirmPassword")?.value;return i===e?null:{passwordMismatch:!0}}onSubmit(){return b(this,null,function*(){if(this.registerForm.invalid||this.isLoading)return;this.isLoading=!0,this.errorMessage="";let r=this.registerForm.value;try{let i=this.determineUserRole(),e={email:r.email.toLowerCase().trim(),password:r.password,user_data:{first_name:r.firstName,last_name:r.lastName,phone:r.phone,role:i},restaurant_data:this.isRestaurant?{name:r.restaurantName,address:"",phone:r.phone||"",email:r.email,description:"",cuisine_type:"",allow_table_selection:!1,accepts_delivery:!1,accepts_takeaway:!1}:void 0,supplier_data:this.isSupplier?{company_name:r.companyName,contact_name:r.contactName,email:r.email,phone:r.phone||"",address:r.supplierAddress,description:r.supplierDescription}:void 0},d=yield this.authService.register(e);if(d.error){if(typeof d.error=="string")this.errorMessage=d.error;else if(d.error&&typeof d.error=="object"){let _=d.error;this.errorMessage=_.message||_.toString()}else this.errorMessage="Errore durante la registrazione";console.error("Registration error details:",d.error)}else d.user&&(console.log("\u2705 Registration successful, user:",d.user.id),this.errorMessage="Registrazione completata! Reindirizzamento...",this.redirectAfterRegistration(d))}catch(i){i instanceof Error?this.errorMessage="Errore durante la registrazione: "+i.message:typeof i=="string"?this.errorMessage="Errore durante la registrazione: "+i:this.errorMessage="Errore sconosciuto durante la registrazione",console.error("Registration exception:",i)}finally{this.isLoading=!1}})}determineUserRole(){return this.isRestaurant?"restaurant_owner":this.isSupplier?"supplier":"customer"}redirectAfterRegistration(r){setTimeout(()=>{this.isRestaurant&&r.restaurant?this.router.navigate(["/restaurant/dashboard"]):this.isSupplier?this.router.navigate(["/supplier/dashboard"]):this.router.navigate(["/customer/menu-display"])},2e3)}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}get firstName(){return this.registerForm.get("firstName")}get lastName(){return this.registerForm.get("lastName")}get restaurantName(){return this.registerForm.get("restaurantName")}get companyName(){return this.registerForm.get("companyName")}get contactName(){return this.registerForm.get("contactName")}get supplierAddress(){return this.registerForm.get("supplierAddress")}get supplierDescription(){return this.registerForm.get("supplierDescription")}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=y({type:n,selectors:[["app-register"]],decls:68,vars:24,consts:[[1,"gradient-container"],[1,"form-card","modal-md"],[1,"section-header"],[1,"flex","gap-sm"],[1,"material-icons","fs-lg"],[1,"section-title"],[1,"text-muted"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-card"],[1,"text-md","font-semibold","mb-md"],[1,"material-icons","text-md"],[1,"form-row","mb-md"],[1,"form-group"],[1,"standard-label"],["formControlName","firstName","placeholder","Il tuo nome","type","text"],["class","error-message",4,"ngIf"],["formControlName","lastName","placeholder","Il tuo cognome","type","text"],["formControlName","email","type","email","placeholder","tua.email@esempio.com"],["formControlName","phone","placeholder","+39 123 456 7890","type","number"],["class","form-card",4,"ngIf"],[1,"form-row"],["formControlName","password","type","password","placeholder","Almeno 6 caratteri"],["formControlName","confirmPassword","type","password","placeholder","Ripeti la password"],[1,"flex","justify-between","items-center","my-md"],[1,"checkbox-label","hover:bg-[var(--smoke-1)]"],["type","checkbox","formControlName","policy"],[1,"checkbox-content"],["href","#/policy",1,"link"],["class","error-message","style","margin: 1rem 0; padding: 1rem; background: #fee;",4,"ngIf"],[1,"flex","justify-between","items-center","gap-md","mt-lg","pt-md"],["routerLink","/login",1,"link"],["type","submit",1,"promethea-button",3,"disabled"],["class","loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"error-message"],[1,"material-icons"],["formControlName","restaurantName","placeholder","Il nome del tuo ristorante","type","text"],[1,"error-message",2,"margin","1rem 0","padding","1rem","background","#fee"],[1,"loading-spinner"]],template:function(i,e){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),o(5),t(),a(6,"h1",5),o(7),t()(),a(8,"p",6),o(9),t()(),a(10,"form",7),N("ngSubmit",function(){return e.onSubmit()}),a(11,"div",8)(12,"h2",9)(13,"span",10),o(14,"person"),t(),o(15," Informazioni Personali "),t(),a(16,"div",11)(17,"div",12)(18,"label",13),o(19,"Nome *"),t(),u(20,"input",14),p(21,D,2,0,"div",15),t(),a(22,"div",12)(23,"label",13),o(24,"Cognome *"),t(),u(25,"input",16),p(26,V,2,0,"div",15),t()(),a(27,"div",11)(28,"div",12)(29,"label",13),o(30,"Email *"),t(),u(31,"input",17),p(32,Y,3,2,"div",15),t(),a(33,"div",12)(34,"label",13),o(35,"Telefono"),t(),u(36,"input",18),t()()(),p(37,B,10,3,"div",19),a(38,"div",8)(39,"h2",9)(40,"span",10),o(41,"lock"),t(),o(42," Password "),t(),a(43,"div",20)(44,"div",12)(45,"label",13),o(46,"Password *"),t(),u(47,"input",21),p(48,H,2,0,"div",15),t(),a(49,"div",12)(50,"label",13),o(51,"Conferma Password *"),t(),u(52,"input",22),p(53,J,2,0,"div",15),t()()(),a(54,"div",23)(55,"label",24),u(56,"input",25),a(57,"div",26),o(58," Dichiaro di aver letto, compreso e accettato la "),a(59,"a",27),o(60,"Privacy Policy e i Termini e Condizioni"),t()()()(),p(61,K,2,1,"div",28),a(62,"div",29)(63,"a",30),o(64," \u2190 Hai gi\xE0 un account? Accedi "),t(),a(65,"button",31),p(66,Q,1,0,"span",32)(67,W,2,1,"span",33),t()()()()()),i&2&&(s(5),h(e.isRestaurant?"restaurant":"person"),s(2),h(e.isRestaurant?"Registra il tuo Ristorante":"Crea Account"),s(2),v(" ",e.isRestaurant?"Crea il tuo account business":"Crea il tuo account personale"," "),s(),l("formGroup",e.registerForm),s(10),c("error",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),s(),l("ngIf",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),s(4),c("error",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),s(),l("ngIf",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),s(5),c("error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),s(),l("ngIf",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),s(5),l("ngIf",e.isRestaurant),s(10),c("error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),s(),l("ngIf",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),s(4),c("error",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),s(),l("ngIf",(e.registerForm.errors==null?null:e.registerForm.errors.passwordMismatch)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),s(8),l("ngIf",e.errorMessage),s(4),l("disabled",e.registerForm.invalid||e.isLoading),s(),l("ngIf",e.isLoading),s(),l("ngIf",!e.isLoading))},dependencies:[C,w,z,k,x,O,M,I,F,T,A,E],styles:['.gradient-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--background);padding:var(--gutter-sm);position:relative;overflow:hidden}.gradient-container[_ngcontent-%COMP%]:before, .gradient-container[_ngcontent-%COMP%]:after, .gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{content:"";position:absolute;border-radius:50%;filter:blur(90px);opacity:.22;pointer-events:none;animation:vapor 28s ease-in-out infinite}.gradient-container[_ngcontent-%COMP%]:before{width:700px;height:700px;background:radial-gradient(circle at 30%,var(--primary) 0%,transparent 65%);top:-20%;left:-15%;animation-delay:0s}.gradient-container[_ngcontent-%COMP%]:after{width:600px;height:600px;background:radial-gradient(circle at 40%,var(--secondary) 0%,transparent 70%);bottom:-10%;right:-10%;animation-delay:-9s}.gradient-container[_ngcontent-%COMP%]   .floating-blob[_ngcontent-%COMP%]{width:700px;height:700px;background:radial-gradient(circle at 30% 40%,var(--tertiary) 0%,transparent 70%);top:50%;left:50%;transform:translate(-50%,-50%);animation-delay:-14s;opacity:.15;filter:blur(100px)}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0) translate(0) rotate(0)}33%{transform:translateY(-40px) translate(30px) rotate(120deg)}66%{transform:translateY(30px) translate(-40px) rotate(240deg)}}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]{position:absolute;width:4px;height:4px;background:var(--secondary);border-radius:50%;opacity:0;animation:_ngcontent-%COMP%_sparkle 8s linear infinite}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(1){top:20%;left:15%;animation-delay:1s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(2){top:70%;right:20%;animation-delay:3s}.gradient-container[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]:nth-child(3){bottom:30%;left:30%;animation-delay:5s}@keyframes _ngcontent-%COMP%_sparkle{0%,to{opacity:0;transform:scale(0)}50%{opacity:.8;transform:scale(1)}}.gradient-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{border-radius:var(--fs-md)}']})};export{L as Register};
