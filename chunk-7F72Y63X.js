import{a as Ae}from"./chunk-WYLNEMQW.js";import{a as ze}from"./chunk-KYOIGWSF.js";import{a as Pe}from"./chunk-4WAPVM25.js";import{a as Ve}from"./chunk-XL7SSZPR.js";import{a as Re}from"./chunk-MQHGUKSF.js";import{b as he,d as be,e as xe,g as fe,h as Te,i as Se,q as we,r as ye,s as Ce,v as Oe,x as Me}from"./chunk-7VSFVQGQ.js";import{b as De,c as He}from"./chunk-OYK37USI.js";import{a as ke}from"./chunk-QPLQGKZF.js";import{a as Fe}from"./chunk-SSJAIGRQ.js";import{a as Ie}from"./chunk-VOCUDH6H.js";import{a as Ee}from"./chunk-QMR2VPJU.js";import"./chunk-TAPIY3IR.js";import"./chunk-HZAFCD3S.js";import{b as de,c as ce,d as me,e as ue,i as pe,j as _e,l as ve,m as ge}from"./chunk-VYE6ILYG.js";import{$a as g,Ab as K,Bb as D,Ca as ne,Db as q,Eb as o,Fb as f,Ga as l,Gb as v,H as te,Hb as V,Ib as L,Jb as y,Kb as C,Lb as O,Ob as U,Qb as I,Sb as P,Tb as Q,Ub as Y,Wa as ae,_ as ie,a as B,b as j,da as R,g as h,h as ee,hb as m,ia as u,ib as i,ja as p,jb as n,kb as H,nb as W,ob as N,pb as x,sa as re,sb as _,ub as c,wb as oe,xb as le,yb as se,zb as z}from"./chunk-3SWAHN2Y.js";var Z=class s extends Ie{getTableName(){return"tables"}calculateTableStatus(t){return h(this,null,function*(){let e=t.filter(a=>!a.is_merged||a.parent_table_id===null),r=new Date().toISOString().split("T")[0];try{let{data:a,error:d}=yield this.supabaseService.getSupabaseClient().from("reservations").select(`
          *,
          tables:tables!table_id (
            table_name,
            table_number,
            capacity
          )
        `).eq("reservation_date",r).in("status",["pending","confirmed"]);if(d)throw d;let b=yield this.getCurrentRestaurantId();if(!b)return console.log("\u2139\uFE0F Nessun restaurantId trovato, restituisco tavoli liberi"),e.map(T=>({table:T,status:"free",tavolataId:null,currentReservation:null,currentOrders:[]}));let{data:S,error:w}=yield this.supabaseService.getSupabaseClient().from("orders").select("*, order_items(*, dishes(name, base_price, category_id))").eq("restaurant_id",b).not("status","in",'("completed", "cancelled")');if(w)throw w;return e.map(T=>{let M=a?.filter(F=>F.table_id===T.id)||[],E=S?.filter(F=>F.table_id===T.id)||[],k="free",A=null,$=null;return E.length>0?(k="occupied",$=E[0].tavolata_id,A=M[0]||null):M.length>0&&(k="reserved",A=M[0]),{table:T,status:k,tavolataId:$,currentReservation:A,currentOrders:E,allReservations:M}})}catch(a){return console.error("\u274C Error calculating table status:",a),e.map(d=>({table:d,status:"free",tavolataId:null,currentReservation:null,currentOrders:[]}))}})}areAllItemsServedOrOutOfStock(t){return!t||!t.order_items||t.order_items.length===0?!1:t.order_items.every(e=>e.status==="served"||e.status==="out_of_stock")}isOrderActive(t){return t?!["completed","cancelled"].includes(t.status):!1}isReservationActive(t){if(!t)return!1;try{let e=new Date(`${t.reservation_date}T${t.reservation_time}`),r=new Date,d=(e.getTime()-r.getTime())/(1e3*60*60);return d<=2&&d>=-4}catch{return!1}}getTableOverallStatus(t){return!t||t.length===0?"free":t.every(r=>this.areAllItemsServedOrOutOfStock(r))?"ready_for_bill":"occupied"}getActiveTavolata(t){return h(this,null,function*(){try{let e=yield this.getCurrentRestaurantId();if(!e)return null;let{data:r,error:a}=yield this.supabaseService.getSupabaseClient().from("orders").select("tavolata_id").eq("restaurant_id",e).eq("table_id",t).not("status","in",'("completed", "cancelled")').order("created_at",{ascending:!1}).limit(1).single();if(a&&a.code!=="PGRST116")throw a;return r?.tavolata_id||null}catch(e){return console.error("Error getting active tavolata:",e),null}})}areAllTableItemsServed(t){return!t||t.length===0?!1:t.every(e=>this.areAllItemsServedOrOutOfStock(e))}updateSingleTableStatus(t){return h(this,null,function*(){try{if(!(yield this.getCurrentRestaurantId()))return null;let{data:r}=yield this.supabaseService.getSupabaseClient().from("tables").select("*").eq("id",t).single();return r?(yield this.calculateTableStatus([r]))[0]:null}catch(e){return console.error("Error updating single table status:",e),null}})}refreshOrder(t){return h(this,null,function*(){try{let{data:e,error:r}=yield this.supabaseService.getSupabaseClient().from("orders").select("*, order_items(*, dishes(name, base_price, category_id))").eq("id",t).single();if(r)throw r;return e}catch(e){return console.error("Error refreshing order:",e),null}})}getTodaysReservationsWithTables(){return h(this,null,function*(){try{let t=yield this.getCurrentRestaurantId();if(!t)return{reservations:[],reservationsWithoutTable:[]};let e=new Date().toISOString().split("T")[0],{data:r,error:a}=yield this.supabaseService.getSupabaseClient().from("reservations").select(`
        *,
        tables:tables!table_id (
          id,
          table_number,
          table_name,
          capacity
        )
      `).eq("restaurant_id",t).eq("reservation_date",e).in("status",["confirmed","pending"]).order("reservation_time",{ascending:!0});if(a)throw a;let d=r?.filter(S=>S.table_id)||[],b=r?.filter(S=>!S.table_id)||[];return{reservations:d,reservationsWithoutTable:b}}catch(t){return console.error("\u274C Error getting today's reservations:",t),{reservations:[],reservationsWithoutTable:[]}}})}calculateTableStatusWithReservations(t){return h(this,null,function*(){let e=t.filter(a=>!a.is_merged||a.parent_table_id===null),r=new Date().toISOString().split("T")[0];try{let{data:a,error:d}=yield this.supabaseService.getSupabaseClient().from("reservations").select("*").eq("reservation_date",r).in("status",["confirmed","pending"]);if(d)throw d;let b=yield this.getCurrentRestaurantId();if(!b)return e.map(T=>({table:T,status:"free",tavolataId:null,currentReservation:null,currentOrders:[]}));let{data:S,error:w}=yield this.supabaseService.getSupabaseClient().from("orders").select("*, order_items(*, dishes(name, base_price, category_id))").eq("restaurant_id",b).not("status","in",'("completed", "cancelled")');if(w)throw w;return e.map(T=>{let M=a?.filter(F=>F.table_id===T.id)||[],E=S?.filter(F=>F.table_id===T.id)||[],k="free",A=null,$=null;if(E.length>0)k="occupied",$=E[0]?.tavolata_id;else if(M.length>0){let F=new Date,xi=F.toTimeString().substring(0,5),fi=F.toISOString().split("T")[0],X=M.find(G=>{let Ti=G.reservation_time.substring(0,5),J=(new Date(`${G.reservation_date}T${G.reservation_time}`).getTime()-F.getTime())/(1e3*60);return J>=-15&&J<=120});X?(k="reserved",A=X):k="free"}return{table:T,status:k,tavolataId:$,currentReservation:A,currentOrders:E}})}catch(a){return console.error("\u274C Error calculating table status with reservations:",a),e.map(d=>({table:d,status:"free",tavolataId:null,currentReservation:null,currentOrders:[]}))}})}getTableReservations(t){return h(this,null,function*(){try{let e=yield this.getCurrentRestaurantId();if(!e)return[];let r=new Date().toISOString().split("T")[0],{data:a,error:d}=yield this.supabaseService.getSupabaseClient().from("reservations").select(`
        *,
        tables:tables!table_id (
          table_name,
          table_number,
          capacity
        )
      `).eq("restaurant_id",e).eq("table_id",t).eq("reservation_date",r).in("status",["confirmed","pending"]).order("reservation_time",{ascending:!0});if(d)throw d;return a||[]}catch(e){return console.error("\u274C Error getting table reservations:",e),[]}})}static \u0275fac=(()=>{let t;return function(r){return(t||(t=re(s)))(r||s)}})();static \u0275prov=ie({token:s,factory:s.\u0275fac,providedIn:"root"})};var Ne=["mapCard"],Be=()=>[1,2,3,4,5,6,7,8,9,10];function qe(s,t){s&1&&H(0,"div",66)}function Le(s,t){if(s&1){let e=x();i(0,"div",67)(1,"div",68)(2,"div",9)(3,"span"),o(4,"Prenotazioni da assegnare"),n(),i(5,"span",69),o(6),n()(),i(7,"button",70),_("click",function(){u(e);let a=c();return p(a.openAssignReservationModal())}),i(8,"span",43),o(9,"arrow_forward"),n(),o(10," Assegna "),n()()()}if(s&2){let e=c();l(6),f(e.pendingAssignmentsCount)}}function je(s,t){if(s&1&&(i(0,"option",71),o(1),n()),s&2){let e=t.$implicit;m("ngValue",e),l(),f(e.name)}}function Qe(s,t){if(s&1&&(i(0,"option",71),o(1),n()),s&2){let e=t.$implicit;m("ngValue",e),l(),v(" ",e.name," ")}}function Ze(s,t){if(s&1){let e=x();i(0,"div",72)(1,"h2",73),o(2),n(),i(3,"div",22)(4,"button",42),_("click",function(){u(e);let a=c();return p(a.zoomOut())}),i(5,"span",43),o(6,"zoom_out"),n()(),i(7,"div",74)(8,"span",45),o(9,"search"),n(),i(10,"span",46),o(11),n()(),i(12,"button",42),_("click",function(){u(e);let a=c();return p(a.zoomIn())}),i(13,"span",43),o(14,"zoom_in"),n()(),i(15,"button",47),_("click",function(){u(e);let a=c();return p(a.resetZoom())}),i(16,"span",43),o(17,"history"),n()(),i(18,"select",75),O("ngModelChange",function(a){u(e);let d=c();return C(d.currentFloorPlan,a)||(d.currentFloorPlan=a),p(a)}),_("ngModelChange",function(a){u(e);let d=c();return p(d.onFloorPlanSelect(a))}),g(19,Qe,2,2,"option",33),n(),i(20,"button",47),_("click",function(){u(e);let a=c();return p(a.safeToggleFullscreen())}),i(21,"span",43),o(22,"fullscreen_exit"),n()()()()}if(s&2){let e=c();l(2),f((e.currentFloorPlan==null?null:e.currentFloorPlan.name)||"Mappa"),l(2),m("disabled",e.zoomLevel<=e.minZoom),l(7),v("",(e.zoomLevel*100).toFixed(0),"%"),l(),m("disabled",e.zoomLevel>=e.maxZoom),l(6),y("ngModel",e.currentFloorPlan),l(),m("ngForOf",e.floorPlans)}}function Ge(s,t){if(s&1&&(i(0,"div",82)(1,"small"),o(2),n()()),s&2){let e=c().$implicit;l(2),v("Pren: ",e.currentReservation.customer_name)}}function Ke(s,t){if(s&1&&(i(0,"div",82)(1,"small"),o(2),n()()),s&2){let e=c().$implicit,r=c();l(2),v("Ord: ",r.getTableOrderItemsCount(e)," piatti")}}function Ue(s,t){if(s&1){let e=x();i(0,"div",76),_("click",function(){let a=u(e).$implicit,d=c();return p(d.onTableClick(a))}),i(1,"div",77)(2,"div",78),o(3),n(),i(4,"div",79)(5,"div",80),o(6),i(7,"span",43),o(8,"person"),n()()(),g(9,Ge,3,1,"div",81)(10,Ke,3,1,"div",81),n()()}if(s&2){let e=t.$implicit,r=c();q(r.getTableClass(e)),m("ngStyle",r.getTableStyle(e.table)),l(),D("text-large",r.isLargeText),l(2),f(e.table.table_number),l(3),f(e.table.capacity),l(3),m("ngIf",e.currentReservation),l(),m("ngIf",e.currentOrders)}}function Ye(s,t){s&1&&(i(0,"div",83)(1,"span",43),o(2,"search_off"),n(),i(3,"h3"),o(4,"Nessun tavolo trovato"),n(),i(5,"p",12),o(6,"Modifica i filtri di ricerca"),n()())}function Xe(s,t){if(s&1){let e=x();i(0,"div",94)(1,"button",70),_("click",function(){u(e);let a=c(2);return p(a.openManualReservationModal())}),i(2,"span",43),o(3,"event"),n(),o(4," Crea Prenotazione "),n(),i(5,"button",95),_("click",function(a){u(e);let d=c(2);return p(d.createNewOrderInSameTavolata(a))}),i(6,"span",43),o(7),n(),o(8),n()()}if(s&2){let e=c(2);l(5),D("primary",e.orderingStatus.allowed)("ghost",!e.orderingStatus.allowed),m("disabled",e.isCreatingOrder||!e.orderingStatus.allowed)("title",e.orderingStatus.allowed?"Crea nuovo ordine":"Disabilitato: fuori orario dei turni"),l(2),f(e.orderingStatus.allowed?"restaurant":"schedule"),l(),v(" ",e.orderingStatus.allowed?"Crea Ordine (Comanda 1)":"Fuori Turno"," ")}}function Je(s,t){if(s&1){let e=x();i(0,"div",100)(1,"div",101)(2,"strong",55),o(3,"Assegnando:"),n(),i(4,"button",102),_("click",function(){u(e);let a=c(3);return p(a.assignmentReservation=null)}),i(5,"span",43),o(6,"close"),n()()(),i(7,"div",55)(8,"div"),o(9),n(),i(10,"div",12),o(11),n()()()}if(s&2){let e=c(3);l(9),f(e.assignmentReservation.customer_name),l(2),V("",e.assignmentReservation.party_size," pax - ",e.assignmentReservation.reservation_time==null?null:e.assignmentReservation.reservation_time.substring(0,5))}}function et(s,t){if(s&1){let e=x();i(0,"div",96)(1,"div",97)(2,"span",43),o(3,"event_available"),n(),o(4," Assegnazione "),n(),i(5,"button",98),_("click",function(){u(e);let a=c(2);return p(a.openAssignReservationModal())}),i(6,"span",43),o(7,"event"),n(),o(8," Assegna a prenotazione "),n(),g(9,Je,12,3,"div",99),n()}if(s&2){let e=c(2);l(9),m("ngIf",e.assignmentReservation)}}function tt(s,t){if(s&1){let e=x();i(0,"div",94)(1,"button",48),_("click",function(){u(e);let a=c(2);return p(a.openEditReservationModal())}),i(2,"span",43),o(3,"edit"),n(),o(4," Modifica Prenotazione "),n(),i(5,"button",103),_("click",function(){u(e);let a=c(2);return p(a.openCreateOrderModal())}),i(6,"span",43),o(7,"check"),n(),o(8," Conferma Arrivo "),n()()}}function it(s,t){if(s&1){let e=x();i(0,"div",94)(1,"button",106),_("click",function(){u(e);let a=c(3);return p(a.openCreateOrderModal())}),i(2,"span",43),o(3,"edit"),n(),o(4," Modifica Ordine "),n(),i(5,"button",107),_("click",function(){u(e);let a=c(3);return p(a.createNewOrderInSameTavolata())}),i(6,"span",43),o(7,"receipt_long"),n(),o(8," Nuovo Ordine "),n()()}if(s&2){let e=c(3);l(),D("button-shift-disabled",!e.orderingStatus.allowed),m("disabled",!e.orderingStatus.allowed),l(4),m("disabled",!e.currentTavolataId)}}function rt(s,t){if(s&1){let e=x();i(0,"div",94)(1,"button",48),_("click",function(){u(e);let a=c(3);return p(a.createNewOrderInSameTavolata())}),i(2,"span",43),o(3,"restaurant"),n(),o(4," Crea Primo Ordine "),n()()}}function nt(s,t){if(s&1){let e=x();i(0,"div",94),g(1,it,9,4,"div",91),i(2,"button",104),_("click",function(){u(e);let a=c(2);return p(a.viewBillPreview())}),i(3,"span",43),o(4,"visibility"),n(),o(5," Anteprima Conto "),n(),g(6,rt,5,0,"div",91),i(7,"div",9)(8,"button",105),_("click",function(){u(e);let a=c(2);return p(a.openOrderDetails())}),i(9,"span",43),o(10,"receipt"),n(),o(11," Dettagli Ordine "),n(),i(12,"button",105),_("click",function(){u(e);let a=c(2);return p(a.closeOrderAndCreateBill())}),i(13,"span",43),o(14,"receipt_long"),n(),o(15," Chiudi Conto "),n()()()}if(s&2){let e=c(2);l(),m("ngIf",e.hasOrders()),l(5),m("ngIf",!e.hasOrders())}}function at(s,t){if(s&1){let e=x();i(0,"div",108)(1,"button",109),_("click",function(){u(e);let a=c(2);return p(a.freeTableManually())}),i(2,"span",43),o(3,"lock_open"),n(),o(4," Libera Tavolo "),n()()}}function ot(s,t){if(s&1){let e=x();i(0,"div",84)(1,"div",85)(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"table_restaurant"),n()(),i(7,"div")(8,"h1",11),o(9),n()()(),i(10,"button",47),_("click",function(){u(e);let a=c();return p(a.deselectTable())}),i(11,"span",43),o(12,"close"),n()()(),i(13,"div",88)(14,"div",89)(15,"div",90)(16,"span",69),o(17),n()(),g(18,Xe,9,8,"div",91)(19,et,10,1,"div",92)(20,tt,9,0,"div",91)(21,nt,16,2,"div",91)(22,at,5,0,"div",93),n()()()()}if(s&2){let e=c();l(9),v("Tavolo ",e.selectedTable==null?null:e.selectedTable.table_number),l(7),q(e.getStatusColorClass((e.selectedTableStatus==null?null:e.selectedTableStatus.status)||"free")),l(),v(" ",e.getStatusText((e.selectedTableStatus==null?null:e.selectedTableStatus.status)||"free")," "),l(),m("ngIf",(e.selectedTableStatus==null?null:e.selectedTableStatus.status)==="free"),l(),m("ngIf",(e.selectedTableStatus==null?null:e.selectedTableStatus.status)==="free"),l(),m("ngIf",(e.selectedTableStatus==null?null:e.selectedTableStatus.status)==="reserved"),l(),m("ngIf",(e.selectedTableStatus==null?null:e.selectedTableStatus.status)==="occupied"),l(),m("ngIf",(e.selectedTableStatus==null?null:e.selectedTableStatus.status)!=="free")}}function lt(s,t){if(s&1&&(i(0,"option",123),o(1),n()),s&2){let e=t.$implicit,r=c(2);m("value",e)("disabled",r.selectedTable&&e>r.selectedTable.capacity),l(),L(" ",e," ",e===1?"persona":"persone"," ",r.selectedTable&&e>r.selectedTable.capacity?" (Troppe persone)":""," ")}}function st(s,t){if(s&1){let e=x();i(0,"div",84)(1,"div",110)(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"event"),n()(),i(7,"div")(8,"h2",46),o(9),n()()(),i(10,"button",47),_("click",function(){u(e);let a=c();return p(a.closeManualReservationModal())}),i(11,"span",43),o(12,"close"),n()()(),i(13,"div",88)(14,"form",111,2),_("ngSubmit",function(a){return u(e),c().createManualReservation(),p(a.preventDefault())}),i(16,"div",29)(17,"div",30)(18,"label",31),o(19,"Nome Cliente *"),n(),i(20,"input",112),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.customer_name,a)||(d.manualReservationData.customer_name=a),p(a)}),n()(),i(21,"div",30)(22,"label",31),o(23,"Telefono *"),n(),i(24,"input",113),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.customer_phone,a)||(d.manualReservationData.customer_phone=a),p(a)}),n()()(),i(25,"div",29)(26,"div",30)(27,"label",31),o(28,"Data *"),n(),i(29,"input",114),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.reservation_date,a)||(d.manualReservationData.reservation_date=a),p(a)}),n()(),i(30,"div",30)(31,"label",31),o(32,"Orario *"),n(),i(33,"input",115),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.reservation_time,a)||(d.manualReservationData.reservation_time=a),p(a)}),n()()(),i(34,"div",30)(35,"label",31),o(36,"Numero Persone *"),n(),i(37,"select",116),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.party_size,a)||(d.manualReservationData.party_size=a),p(a)}),g(38,lt,2,5,"option",117),n(),i(39,"div",118),o(40),n()(),i(41,"div",30)(42,"label",31),o(43,"Note Speciali"),n(),i(44,"textarea",119),O("ngModelChange",function(a){u(e);let d=c();return C(d.manualReservationData.special_requests,a)||(d.manualReservationData.special_requests=a),p(a)}),n()(),i(45,"div",120)(46,"button",121),_("click",function(){u(e);let a=c();return p(a.closeManualReservationModal())}),o(47," Annulla "),n(),i(48,"button",122)(49,"span",43),o(50,"add"),n(),o(51," Crea Prenotazione "),n()()()()()()}if(s&2){let e=z(15),r=c();l(9),v("Nuova Prenotazione - Tavolo ",r.selectedTable==null?null:r.selectedTable.table_number),l(11),y("ngModel",r.manualReservationData.customer_name),l(4),y("ngModel",r.manualReservationData.customer_phone),l(5),y("ngModel",r.manualReservationData.reservation_date),l(4),y("ngModel",r.manualReservationData.reservation_time),l(4),y("ngModel",r.manualReservationData.party_size),l(),m("ngForOf",U(10,Be)),l(2),v(" Capacit\xE0 massima tavolo: ",(r.selectedTable==null?null:r.selectedTable.capacity)||0," persone "),l(4),y("ngModel",r.manualReservationData.special_requests),l(4),m("disabled",!e.valid)}}function dt(s,t){if(s&1&&(i(0,"option",123),o(1),n()),s&2){let e=t.$implicit,r=c(2);m("value",e)("disabled",r.selectedTable&&e>r.selectedTable.capacity),l(),L(" ",e," ",e===1?"persona":"persone"," ",r.selectedTable&&e>r.selectedTable.capacity?" (Troppe persone)":""," ")}}function ct(s,t){if(s&1){let e=x();i(0,"button",126),_("click",function(){u(e);let a=c(2);return p(a.deleteReservation())}),i(1,"span",43),o(2,"delete"),n(),o(3," Elimina "),n()}}function mt(s,t){if(s&1){let e=x();i(0,"div",84)(1,"div",110)(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"edit"),n()(),i(7,"div")(8,"h1",11),o(9),n()()(),i(10,"button",47),_("click",function(){u(e);let a=c();return p(a.closeEditReservationModal())}),i(11,"span",43),o(12,"close"),n()()(),i(13,"div",88)(14,"form",111,2),_("ngSubmit",function(a){return u(e),c().updateReservation(),p(a.preventDefault())}),i(16,"div",29)(17,"div",30)(18,"label",31),o(19,"Nome Cliente *"),n(),i(20,"input",112),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.customer_name,a)||(d.editingReservation.customer_name=a),p(a)}),n()(),i(21,"div",30)(22,"label",31),o(23,"Telefono *"),n(),i(24,"input",113),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.customer_phone,a)||(d.editingReservation.customer_phone=a),p(a)}),n()()(),i(25,"div",29)(26,"div",30)(27,"label",31),o(28,"Data *"),n(),i(29,"input",114),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.reservation_date,a)||(d.editingReservation.reservation_date=a),p(a)}),n()(),i(30,"div",30)(31,"label",31),o(32,"Orario *"),n(),i(33,"input",115),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.reservation_time,a)||(d.editingReservation.reservation_time=a),p(a)}),n()()(),i(34,"div",30)(35,"label",31),o(36,"Numero Persone *"),n(),i(37,"select",116),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.party_size,a)||(d.editingReservation.party_size=a),p(a)}),g(38,dt,2,5,"option",117),n(),i(39,"div",118),o(40),n()(),i(41,"div",30)(42,"label",31),o(43,"Note Speciali"),n(),i(44,"textarea",119),O("ngModelChange",function(a){u(e);let d=c();return C(d.editingReservation.special_requests,a)||(d.editingReservation.special_requests=a),p(a)}),n()(),i(45,"div",120)(46,"div",124),g(47,ct,4,0,"button",125),i(48,"div",9)(49,"button",121),_("click",function(){u(e);let a=c();return p(a.closeEditReservationModal())}),o(50," Annulla "),n(),i(51,"button",122)(52,"span",43),o(53,"save"),n(),o(54," Salva "),n()()()()()()()()}if(s&2){let e=z(15),r=c();l(9),v("Modifica Prenotazione - Tavolo ",r.selectedTable==null?null:r.selectedTable.table_number),l(11),y("ngModel",r.editingReservation.customer_name),l(4),y("ngModel",r.editingReservation.customer_phone),l(5),y("ngModel",r.editingReservation.reservation_date),l(4),y("ngModel",r.editingReservation.reservation_time),l(4),y("ngModel",r.editingReservation.party_size),l(),m("ngForOf",U(11,Be)),l(2),v(" Capacit\xE0 massima tavolo: ",(r.selectedTable==null?null:r.selectedTable.capacity)||0," persone "),l(4),y("ngModel",r.editingReservation.special_requests),l(3),m("ngIf",r.isReservationDeletable(r.editingReservation)),l(4),m("disabled",!e.valid)}}function ut(s,t){if(s&1&&(i(0,"span",165),o(1),n()),s&2){let e=c(2);l(),v(" Comanda ",e.currentOrder.comanda_number," ")}}function pt(s,t){if(s&1&&(i(0,"option",71),o(1),n()),s&2){let e=t.$implicit,r=t.index,a=c(3);m("ngValue",e),l(),V(" ",a.getOrderHeaderDisplayName(e,r)," (",(e.orders==null?null:e.orders.length)||0," comande) ")}}function _t(s,t){if(s&1){let e=x();i(0,"select",34),O("ngModelChange",function(a){u(e);let d=c(2);return C(d.currentOrderHeader,a)||(d.currentOrderHeader=a),p(a)}),_("ngModelChange",function(a){u(e);let d=c(2);return p(d.onOrderHeaderChange(a))}),g(1,pt,2,3,"option",33),n()}if(s&2){let e=c(2);y("ngModel",e.currentOrderHeader),l(),m("ngForOf",e.orderHeaders)}}function vt(s,t){if(s&1&&(i(0,"option",71),o(1),n()),s&2){let e=t.$implicit;m("ngValue",e),l(),V(" Comanda ",e.comanda_number," (",(e.order_items==null?null:e.order_items.length)||0," piatti) ")}}function gt(s,t){if(s&1&&(i(0,"option",166),o(1),I(2,"slice"),n()),s&2){let e=t.$implicit;m("value",e.id),l(),V(" ",Q(2,3,e.name,0,10),"",e.name.length>10?"...":""," ")}}function ht(s,t){if(s&1){let e=x();i(0,"div",147),_("click",function(){let a=u(e).$implicit,d=c(2);return p(d.selectedCategory=a.id)}),i(1,"span",43),o(2,"category"),n(),i(3,"span",148),o(4),I(5,"slice"),n(),i(6,"span",134),o(7),n()()}if(s&2){let e=t.$implicit,r=c(2);D("active",r.selectedCategory===e.id),l(4),V("",Q(5,5,e.name,0,8),"",e.name.length>8?"...":""),l(3),f(r.getDishesCountByCategory(e.id))}}function bt(s,t){if(s&1&&(i(0,"small",134),o(1),I(2,"slice"),n()),s&2){let e=c().$implicit;l(),V(" ",Q(2,2,e.description,0,40),"",e.description.length>40?"...":""," ")}}function xt(s,t){s&1&&(i(0,"span",43),o(1," add "),n())}function ft(s,t){s&1&&(i(0,"span",182),o(1," hourglass_empty "),n())}function Tt(s,t){if(s&1){let e=x();i(0,"div",174)(1,"div",94)(2,"div",175)(3,"strong",176),o(4),n(),i(5,"span",177),o(6),I(7,"number"),n(),g(8,bt,3,6,"small",178),n(),i(9,"div",179)(10,"button",180),_("click",function(a){let d=u(e).$implicit,b=c(4);return p(b.handleAddDish(d,a))}),g(11,xt,2,0,"span",163)(12,ft,2,0,"span",181),n()()()()}if(s&2){let e=t.$implicit,r=c(4);l(4),f(e.name),l(2),v("\u20AC",P(7,6,e.base_price,"1.2-2")),l(2),m("ngIf",e.description),l(2),m("disabled",r.loadingItemOperations.has("add-dish-"+e.id+"-"+((r.currentOrder==null?null:r.currentOrder.id)||""))),l(),m("ngIf",!r.loadingItemOperations.has("add-dish-"+e.id+"-"+((r.currentOrder==null?null:r.currentOrder.id)||""))),l(),m("ngIf",r.loadingItemOperations.has("add-dish-"+e.id+"-"+((r.currentOrder==null?null:r.currentOrder.id)||"")))}}function St(s,t){if(s&1&&(W(0),i(1,"div",168)(2,"div",169)(3,"span",170),o(4,"category"),n(),o(5),n(),i(6,"div",171),o(7),n()(),i(8,"div",172),g(9,Tt,13,9,"div",173),n(),N()),s&2){let e=t.$implicit;l(5),v(" ",e.category.name," "),l(2),f(e.dishes.length),l(2),m("ngForOf",e.dishes)}}function wt(s,t){if(s&1&&(W(0),g(1,St,10,3,"ng-container",167),N()),s&2){let e=c(2);l(),m("ngForOf",e.getDishesGroupedByCategory())}}function yt(s,t){if(s&1){let e=x();i(0,"div",83)(1,"span",43),o(2,"search_off"),n(),i(3,"p",12),o(4,"Nessun piatto trovato"),n(),i(5,"button",183),_("click",function(){u(e);let a=c(2);return p(a.resetDishFilters())}),o(6," Reset filtri "),n()()}}function Ct(s,t){s&1&&(i(0,"span",43),o(1,"remove"),n())}function Ot(s,t){s&1&&(i(0,"span",182),o(1," hourglass_empty "),n())}function Mt(s,t){s&1&&(i(0,"span",43),o(1,"add"),n())}function Et(s,t){s&1&&(i(0,"span",182),o(1," hourglass_empty "),n())}function It(s,t){s&1&&(i(0,"span",43),o(1,"delete"),n())}function kt(s,t){s&1&&(i(0,"span",182),o(1," hourglass_empty "),n())}function Pt(s,t){if(s&1){let e=x();i(0,"button",198),_("click",function(a){u(e);let d=c().$implicit;return c(3).toggleMoveSelect(d.id),p(a.stopPropagation())}),i(1,"span",43),o(2,"swap_horiz"),n()()}}function Vt(s,t){if(s&1&&(i(0,"option",123),o(1),n()),s&2){let e=t.$implicit,r=c(5);m("value",e.id)("disabled",e.id===(r.currentOrder==null?null:r.currentOrder.id)),l(),v(" Comanda ",e.comanda_number," ")}}function Rt(s,t){if(s&1){let e=x();i(0,"div",199)(1,"select",200,5),_("change",function(){u(e);let a=z(2),d=c().$implicit;return c(3).onComandaChange(d,a.value),p(a.value="")})("click",function(a){return u(e),p(a.stopPropagation())}),i(3,"option",201),o(4,"Sposta 1 piatto in..."),n(),g(5,Vt,2,3,"option",117),n()()}if(s&2){let e=c(4);l(5),m("ngForOf",e.tableComandas)}}function Ft(s,t){if(s&1){let e=x();i(0,"div",190)(1,"div",191)(2,"div",130)(3,"strong"),o(4),n(),i(5,"div",133)(6,"span",134),o(7),I(8,"number"),n(),i(9,"span",134),o(10,"\u2022"),n(),i(11,"span",134),o(12),I(13,"number"),n()()(),i(14,"div",52)(15,"button",192),_("click",function(a){let d=u(e).$implicit;return c(3).updateComandaItemQuantity(d,-1),p(a.stopPropagation())}),g(16,Ct,2,0,"span",163)(17,Ot,2,0,"span",181),n(),i(18,"span",193),o(19),n(),i(20,"button",194),_("click",function(a){let d=u(e).$implicit;return c(3).updateComandaItemQuantity(d,1),p(a.stopPropagation())}),g(21,Mt,2,0,"span",163)(22,Et,2,0,"span",181),n(),i(23,"button",195),_("click",function(a){let d=u(e).$implicit;return c(3).removeComandaItem(d),p(a.stopPropagation())}),g(24,It,2,0,"span",163)(25,kt,2,0,"span",181),n(),g(26,Pt,3,0,"button",196),n()(),g(27,Rt,6,1,"div",197),n()}if(s&2){let e=t.$implicit,r=c(3);l(4),f(r.getDishName(e)),l(3),v("\u20AC",P(8,15,e.unit_price,"1.2-2")," cad."),l(5),v("Tot: \u20AC",P(13,18,e.total_price,"1.2-2")),l(3),m("disabled",r.loadingItemOperations.has("update-"+e.id)||r.loadingItemOperations.has("move-"+e.id)),l(),m("ngIf",!r.loadingItemOperations.has("update-"+e.id)),l(),m("ngIf",r.loadingItemOperations.has("update-"+e.id)),l(2),v(" ",e.quantity," "),l(),m("disabled",r.loadingItemOperations.has("update-"+e.id)||r.loadingItemOperations.has("move-"+e.id)),l(),m("ngIf",!r.loadingItemOperations.has("update-"+e.id)),l(),m("ngIf",r.loadingItemOperations.has("update-"+e.id)),l(),m("disabled",r.loadingItemOperations.has("update-"+e.id)||r.loadingItemOperations.has("delete-"+e.id)||r.loadingItemOperations.has("move-"+e.id)),l(),m("ngIf",!r.loadingItemOperations.has("delete-"+e.id)),l(),m("ngIf",r.loadingItemOperations.has("delete-"+e.id)),l(),m("ngIf",r.tableComandas.length>1),l(),m("ngIf",r.tableComandas.length>1&&r.isMoveSelectVisible(e.id))}}function Dt(s,t){if(s&1&&(i(0,"div",152)(1,"span",134),o(2),n(),i(3,"strong",202),o(4),I(5,"number"),n()()),s&2){let e=c(3);l(2),v(" Totale generale (",e.tableComandas.length," comande): "),l(2),v(" \u20AC",P(5,2,e.calcolaTotaleTavolata(),"1.2-2")," ")}}function Ht(s,t){if(s&1&&(i(0,"div"),g(1,Ft,28,21,"div",184),i(2,"div",185)(3,"div",186)(4,"strong",187),o(5,"Totale Comanda:"),n(),i(6,"strong",188),o(7),I(8,"number"),n()(),g(9,Dt,6,5,"div",189),n()()),s&2){let e=c(2);l(),m("ngForOf",e.getOrderItems()),l(6),v(" \u20AC",P(8,3,e.getCurrentOrderTotal(),"1.2-2")," "),l(2),m("ngIf",e.tableComandas.length>1)}}function At(s,t){s&1&&(i(0,"div",203)(1,"span",204),o(2,"restaurant_menu"),n(),i(3,"p",12),o(4,"Nessun piatto in questa comanda"),n(),i(5,"p",205),o(6,"Clicca sui piatti per aggiungerli"),n()())}function zt(s,t){if(s&1){let e=x();i(0,"div",206)(1,"div",207)(2,"span",17),o(3,"check_circle"),n(),i(4,"div",208)(5,"strong",209),o(6,"Ordine salvato con successo!"),n(),i(7,"p",24),o(8,"Cosa vuoi fare ora?"),n()(),i(9,"button",47),_("click",function(){u(e);let a=c(2);return p(a.showOrderActionsAfterSave=!1)}),i(10,"span",43),o(11,"close"),n()()(),i(12,"div",210)(13,"button",70),_("click",function(){u(e);let a=c(2);return p(a.showOrderActionsAfterSave=!1)}),i(14,"span",43),o(15,"edit"),n(),o(16," Modifica Ordine "),n(),i(17,"button",103),_("click",function(){u(e);let a=c(2);return p(a.createNewOrderInSameTavolata())}),i(18,"span",43),o(19,"add"),n(),o(20," Nuovo Ordine "),n()()()}}function $t(s,t){s&1&&(i(0,"span",43),o(1,"save"),n())}function Bt(s,t){s&1&&(i(0,"span",43),o(1,"save_as"),n())}function Wt(s,t){if(s&1&&(i(0,"span"),o(1),n()),s&2){let e=c(2);l(),v("Salva* (",e.pendingItems.length,")")}}function Nt(s,t){s&1&&(i(0,"span"),o(1,"Salva"),n())}function qt(s,t){if(s&1){let e=x();i(0,"div",84)(1,"div",127),_("click",function(a){return u(e),p(a.stopPropagation())}),i(2,"div",128)(3,"div",129)(4,"button",47),_("click",function(){u(e);let a=c();return p(a.closeCreateOrderModal())}),i(5,"span",43),o(6,"arrow_back"),n()(),i(7,"div",130)(8,"h1",131),o(9),g(10,ut,2,1,"span",132),n(),i(11,"div",133)(12,"span",134),o(13),I(14,"number"),n()()()(),i(15,"div",52),g(16,_t,2,2,"select",135),i(17,"select",34),O("ngModelChange",function(a){u(e);let d=c();return C(d.currentOrder,a)||(d.currentOrder=a),p(a)}),_("ngModelChange",function(a){u(e);let d=c();return p(d.setCurrentComanda(a))}),g(18,vt,2,3,"option",33),n(),i(19,"button",136),_("click",function(){u(e);let a=c();return p(a.closeCreateOrderModal())}),i(20,"span",43),o(21,"close"),n()()()(),i(22,"div",137)(23,"div",138)(24,"div",29)(25,"div",139)(26,"input",140),O("ngModelChange",function(a){u(e);let d=c();return C(d.dishSearchTerm,a)||(d.dishSearchTerm=a),p(a)}),n()(),i(27,"div",141)(28,"select",142),O("ngModelChange",function(a){u(e);let d=c();return C(d.selectedCategory,a)||(d.selectedCategory=a),p(a)}),i(29,"option",35),o(30,"Tutte"),n(),g(31,gt,3,7,"option",143),n()(),i(32,"div",144)(33,"button",47),_("click",function(){u(e);let a=c();return p(a.resetDishFilters())}),i(34,"span",43),o(35,"refresh"),n()()()()(),i(36,"div",145)(37,"div",15)(38,"div",146)(39,"div",147),_("click",function(){u(e);let a=c();return p(a.selectedCategory="all")}),i(40,"span",43),o(41,"restaurant_menu"),n(),i(42,"span",148),o(43,"Tutti"),n(),i(44,"span",134),o(45),n()(),g(46,ht,8,9,"div",149),n(),i(47,"div",94),g(48,wt,2,1,"ng-container",150)(49,yt,7,0,"ng-template",null,3,Y),n()(),i(51,"div",15)(52,"div",151)(53,"div",152)(54,"h3",153)(55,"span",17),o(56,"receipt"),n(),o(57),n(),i(58,"span",154),o(59),n()()(),i(60,"div",155),g(61,Ht,10,6,"div",150)(62,At,7,0,"ng-template",null,4,Y),n(),i(64,"div",146)(65,"button",147),_("click",function(){u(e);let a=c();return p(a.openOrderDetails())}),i(66,"span",43),o(67,"receipt_long"),n(),i(68,"span",148),o(69,"Dettagli"),n()(),i(70,"button",147),_("click",function(){u(e);let a=c();return p(a.createNewComanda())}),i(71,"span",43),o(72,"add_circle"),n(),i(73,"span",148),o(74,"Nuova Comanda"),n()(),i(75,"button",156),_("click",function(){u(e);let a=c();return p(a.viewBillPreview())}),i(76,"span",43),o(77,"visibility"),n(),i(78,"span",148),o(79,"Anteprima Conto"),n()(),i(80,"button",157),_("click",function(){u(e);let a=c();return p(a.closeOrderAndCreateBill())}),i(81,"span",43),o(82,"receipt"),n(),i(83,"span",148),o(84,"Chiudi Conto"),n()()()()(),g(85,zt,21,0,"div",158),n(),i(86,"div",159)(87,"button",160),_("click",function(){u(e);let a=c();return p(a.closeCreateOrderModal())}),i(88,"span",43),o(89,"close"),n(),o(90," Chiudi "),n(),i(91,"button",161),_("click",function(){u(e);let a=c();return p(a.createNewComanda())}),i(92,"span",43),o(93,"receipt"),n(),o(94," Nuova Comanda "),n(),i(95,"button",162),_("click",function(){u(e);let a=c();return p(a.saveComandaOrder())}),g(96,$t,2,0,"span",163)(97,Bt,2,0,"span",163)(98,Wt,2,1,"span",164)(99,Nt,2,0,"span",164),n()()()()}if(s&2){let e=z(50),r=z(63),a=c();l(),D("fullscreen-mobile",a.isMobile()),l(8),v(" Tavolo ",a.selectedTable==null?null:a.selectedTable.table_number," "),l(),m("ngIf",a.currentOrder),l(3),L(" ",a.getComandeCount()," piatto",a.getComandeCount()!==1?"i":""," \u2022 \u20AC",P(14,37,a.calcolaTotaleTavolata(),"1.2-2")," "),l(3),m("ngIf",a.orderHeaders.length>1),l(),y("ngModel",a.currentOrder),l(),m("ngForOf",a.getComandeInCurrentOrderHeader()),l(8),y("ngModel",a.dishSearchTerm),l(2),y("ngModel",a.selectedCategory),l(3),m("ngForOf",a.categories),l(5),D("mobile-vertical",a.isMobile()),l(3),D("active",a.selectedCategory==="all"),l(6),f(a.getDishesCountByCategory("all")),l(),m("ngForOf",a.categories.slice(0,4)),l(2),m("ngIf",a.getDishesGroupedByCategory().length>0)("ngIfElse",e),l(9),v(" Comanda ",(a.currentOrder==null?null:a.currentOrder.comanda_number)||"1"," "),l(2),V(" ",a.getOrderItems().length," piatto",a.getOrderItems().length!==1?"i":""," "),l(2),m("ngIf",a.getOrderItems().length>0)("ngIfElse",r),l(14),m("disabled",!a.hasOrders()),l(5),m("disabled",!a.getReadyForBillStatus()),l(5),m("ngIf",a.showOrderActionsAfterSave),l(6),m("disabled",!a.selectedTable),l(4),D("has-pending",a.pendingItems.length>0),m("title",a.getOrderItems().length===0?"Salva comunque - Le comande vuote verranno rimosse":"Salva ordine"),l(),m("ngIf",a.getOrderItems().length>0),l(),m("ngIf",a.getOrderItems().length===0),l(),m("ngIf",a.pendingItems.length>0),l(),m("ngIf",a.pendingItems.length===0)}}function Lt(s,t){if(s&1&&(i(0,"div",244)(1,"small",12),o(2),n()()),s&2){let e=c().$implicit;l(2),v("Note: ",e.item_notes)}}function jt(s,t){if(s&1&&(i(0,"div",239)(1,"div",130)(2,"div",240)(3,"span",241),o(4),n(),i(5,"div")(6,"strong"),o(7),n(),g(8,Lt,3,1,"div",242),n()(),i(9,"div",243)(10,"span"),o(11),I(12,"number"),n(),i(13,"span"),o(14,"\u2022"),n(),i(15,"span"),o(16),n()()(),i(17,"div",223)(18,"span",46),o(19),I(20,"number"),n(),i(21,"small",12),o(22,"Totale"),n()()()),s&2){let e=t.$implicit,r=c(7);l(3),m("ngClass",r.getOrderStatusColor(e.status)),l(),v(" ",r.getOrderStatusText(e.status)," "),l(3),f(r.getDishName(e)),l(),m("ngIf",e.item_notes),l(3),v("\u20AC",P(12,7,e.unit_price,"1.2-2")," cad."),l(5),v("Quantit\xE0: ",e.quantity),l(3),v("\u20AC",P(20,10,e.total_price,"1.2-2"))}}function Qt(s,t){if(s&1&&(i(0,"div",237),g(1,jt,23,13,"div",238),n()),s&2){let e=c(2).$implicit;l(),m("ngForOf",e.order_items)}}function Zt(s,t){s&1&&(i(0,"div",245)(1,"span",43),o(2,"restaurant_menu"),n(),i(3,"p",12),o(4,"Nessun piatto in questa comanda"),n()())}function Gt(s,t){if(s&1&&(i(0,"div",234),g(1,Qt,2,1,"div",235)(2,Zt,5,0,"div",236),n()),s&2){let e=c().$implicit;l(),m("ngIf",e.order_items&&e.order_items.length>0),l(),m("ngIf",!e.order_items||e.order_items.length===0)}}function Kt(s,t){if(s&1){let e=x();i(0,"div",228)(1,"div",229),_("click",function(){let a=u(e).$implicit,d=c(4);return p(d.toggleOrderExpansion(a.id))}),i(2,"div",52)(3,"span",230),o(4),n(),i(5,"div",221)(6,"div",52)(7,"h4",46),o(8),n(),i(9,"span",231),o(10),n()(),i(11,"div",24),o(12),n()()(),i(13,"div",22)(14,"span",232),o(15),I(16,"number"),n()()(),g(17,Gt,3,2,"div",233),n()}if(s&2){let e=t.$implicit,r=c(4);l(4),v(" ",r.isOrderExpanded(e.id)?"expand_less":"expand_more"," "),l(4),v("Comanda ",e.comanda_number),l(),m("ngClass",r.getOrderStatusColor(r.getOverallOrderStatus(e))),l(),v(" ",r.getOrderStatusText(r.getOverallOrderStatus(e))," "),l(2),V(" ",(e.order_items==null?null:e.order_items.length)||0," piatto",(e.order_items==null?null:e.order_items.length)!==1?"i":""," "),l(3),v(" \u20AC",P(16,8,r.getOrderTotal(e),"1.2-2")," "),l(2),m("ngIf",r.isOrderExpanded(e.id))}}function Ut(s,t){if(s&1&&(i(0,"div",185),g(1,Kt,18,11,"div",225),i(2,"div",226)(3,"div",221)(4,"strong",187),o(5),n(),i(6,"small",12),o(7),n()(),i(8,"strong",227),o(9),I(10,"number"),n()()()),s&2){let e=c().$implicit,r=c(2);l(),m("ngForOf",e.orders),l(4),v("Totale Ordine ",e.order_number),l(2),v("",(e.orders==null?null:e.orders.length)||0," comande"),l(2),v(" \u20AC",P(10,4,r.calcolaTotaleOrderHeader(e),"1.2-2")," ")}}function Yt(s,t){if(s&1){let e=x();i(0,"div",28)(1,"div",219),_("click",function(){let a=u(e).$implicit,d=c(2);return p(d.toggleOrderHeaderExpansion(a.id))}),i(2,"div",220)(3,"span",17),o(4),n(),i(5,"div",221)(6,"div",52)(7,"h3",46),o(8),n(),i(9,"span",222),o(10),n()(),i(11,"div",24),o(12),I(13,"date"),n()()(),i(14,"div",22)(15,"div",223)(16,"span",171),o(17),I(18,"number"),n(),i(19,"span",134),o(20,"Totale ordine"),n()()()(),g(21,Ut,11,7,"div",224),n()}if(s&2){let e=t.$implicit,r=c(2);l(4),v(" ",r.isOrderHeaderExpanded(e.id)?"expand_less":"expand_more"," "),l(4),v("Ordine ",e.order_number),l(2),V(" ",(e.orders==null?null:e.orders.length)||0," comanda",(e.orders==null?null:e.orders.length)!==1?"e":""," "),l(2),v(" ",P(13,7,e.created_at,"dd/MM/yyyy HH:mm")," "),l(5),v(" \u20AC",P(18,10,r.calcolaTotaleOrderHeader(e),"1.2-2")," "),l(4),m("ngIf",r.isOrderHeaderExpanded(e.id))}}function Xt(s,t){s&1&&(i(0,"div",83)(1,"span",43),o(2,"receipt"),n(),i(3,"h3"),o(4,"Nessun ordine attivo"),n(),i(5,"p",12),o(6,"Non ci sono ordini per questo tavolo"),n()())}function Jt(s,t){if(s&1&&(i(0,"div",246)(1,"div",152)(2,"div")(3,"strong",247),o(4,"TOTALE TAVOLO"),n(),i(5,"p",248),o(6),n()(),i(7,"strong",249),o(8),I(9,"number"),n()()()),s&2){let e=c(2);l(6),L(" ",e.orderHeaders.length," ordine",e.orderHeaders.length!==1?"i":""," \u2022 ",e.getTotalComandeCount()," comande "),l(2),v(" \u20AC",P(9,4,e.calcolaTotaleTavolata(),"1.2-2")," ")}}function ei(s,t){if(s&1){let e=x();i(0,"div",84)(1,"div",211)(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"receipt_long"),n()(),i(7,"div")(8,"h1",11),o(9),n(),i(10,"div",212)(11,"span",154),o(12),n(),i(13,"span",69),o(14),I(15,"number"),n()()()(),i(16,"button",47),_("click",function(){u(e);let a=c();return p(a.closeOrderDetailsModal())}),i(17,"span",43),o(18,"close"),n()()(),i(19,"div",88)(20,"div",89),g(21,Yt,22,13,"div",213)(22,Xt,7,0,"div",63)(23,Jt,10,7,"div",214),n(),i(24,"div",215)(25,"div",216)(26,"button",217),_("click",function(){u(e);let a=c();return p(a.closeOrderAndCreateBill())}),i(27,"span",43),o(28,"receipt"),n(),o(29),n(),i(30,"button",218),_("click",function(){u(e);let a=c();return p(a.openCreateOrderModal())}),i(31,"span",43),o(32,"add"),n(),o(33," Aggiungi Piatti "),n(),i(34,"button",104),_("click",function(){u(e);let a=c();return p(a.viewBillPreview())}),i(35,"span",43),o(36,"visibility"),n(),o(37," Anteprima Conto "),n(),i(38,"button",104),_("click",function(){u(e);let a=c();return p(a.closeOrderDetailsModal())}),i(39,"span",43),o(40,"close"),n(),o(41," Chiudi "),n()()()()()()}if(s&2){let e=c();l(9),v("Ordini Tavolo ",e.selectedTable==null?null:e.selectedTable.table_number),l(3),V(" ",e.orderHeaders.length," Ordine",e.orderHeaders.length!==1?"i":""," "),l(2),v(" Totale: \u20AC",P(15,9,e.calcolaTotaleTavolata(),"1.2-2")," "),l(7),m("ngForOf",e.orderHeaders),l(),m("ngIf",e.orderHeaders.length===0),l(),m("ngIf",e.orderHeaders.length>0),l(3),m("disabled",e.orderHeaders.length===0),l(3),v(" ",e.isReadyForBill()?"CHIUDI CONTO":"Chiudi Conto"," ")}}function ti(s,t){if(s&1){let e=x();i(0,"div",250),_("click",function(){u(e);let a=c();return p(a.showBillPreviewModal=!1)}),i(1,"div",251),_("click",function(a){return u(e),p(a.stopPropagation())}),i(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"receipt"),n()(),i(7,"div")(8,"h2",46),o(9,"Anteprima Conto"),n(),i(10,"p",134),o(11),n()()(),i(12,"button",47),_("click",function(){u(e);let a=c();return p(a.showBillPreviewModal=!1)}),i(13,"span",43),o(14,"close"),n()()(),i(15,"div",88),H(16,"div",252,6),i(18,"div",120)(19,"button",253),_("click",function(){u(e);let a=c();return p(a.showBillPreviewModal=!1)}),i(20,"span",43),o(21,"close"),n(),o(22," Chiudi "),n(),i(23,"button",48),_("click",function(){u(e);let a=c();return p(a.closeOrderAndCreateBill())}),i(24,"span",43),o(25,"print"),n(),o(26," Stampa Scontrino "),n()()()()()}if(s&2){let e=c();l(11),V("Tavolo ",e.selectedTable==null?null:e.selectedTable.table_number," - ",e.selectedTable==null?null:e.selectedTable.table_name),l(5),m("innerHTML",e.billPreviewHtml,ne)}}function ii(s,t){s&1&&(i(0,"div",83)(1,"span",43),o(2,"check_circle"),n(),i(3,"h3"),o(4,"Tutte le prenotazioni assegnate!"),n(),i(5,"p",12),o(6,"Non ci sono prenotazioni da assegnare per oggi."),n()())}function ri(s,t){if(s&1&&(i(0,"div",262)(1,"span",263),o(2,"Email:"),n(),i(3,"span",264),o(4),n()()),s&2){let e=c().$implicit;l(4),f(e.customer_email)}}function ni(s,t){if(s&1&&(i(0,"div",267)(1,"span",263),o(2,"Note:"),n(),i(3,"span",264),o(4),n()()),s&2){let e=c().$implicit;l(4),f(e.special_requests)}}function ai(s,t){if(s&1){let e=x();i(0,"div",257),_("click",function(){let a=u(e).$implicit,d=c(3);return p(d.selectReservationForAssignment(a))}),i(1,"div",258)(2,"div")(3,"h4",46),o(4),n(),i(5,"div",212)(6,"span",69),o(7),n(),i(8,"span",259),o(9),n()()(),i(10,"span",260),o(11,"chevron_right"),n()(),i(12,"div",261)(13,"div",262)(14,"span",263),o(15,"Telefono:"),n(),i(16,"span",264),o(17),n()(),g(18,ri,5,1,"div",265)(19,ni,5,1,"div",266),n()()}if(s&2){let e=t.$implicit;l(4),f(e.customer_name),l(3),v("",e.party_size," persone"),l(2),f(e.reservation_time==null?null:e.reservation_time.substring(0,5)),l(8),f(e.customer_phone),l(),m("ngIf",e.customer_email),l(),m("ngIf",e.special_requests)}}function oi(s,t){if(s&1&&(i(0,"div",145),g(1,ai,20,6,"div",256),n()),s&2){let e=c(2);l(),m("ngForOf",e.availableReservationsWithoutTable)}}function li(s,t){if(s&1){let e=x();i(0,"div",250),_("click",function(){u(e);let a=c();return p(a.closeAssignReservationModal())}),i(1,"div",254),_("click",function(a){return u(e),p(a.stopPropagation())}),i(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"event_available"),n()(),i(7,"div")(8,"h2",11),o(9,"Prenotazioni da assegnare"),n(),i(10,"p",24),o(11),n()()(),i(12,"button",47),_("click",function(){u(e);let a=c();return p(a.closeAssignReservationModal())}),i(13,"span",43),o(14,"close"),n()()(),i(15,"div",88),g(16,ii,7,0,"div",63)(17,oi,2,1,"div",255),n(),i(18,"div",120)(19,"button",253),_("click",function(){u(e);let a=c();return p(a.closeAssignReservationModal())}),o(20," Chiudi "),n()()()()}if(s&2){let e=c();l(11),v("Oggi - ",e.getCurrentDate()),l(5),m("ngIf",e.availableReservationsWithoutTable.length===0),l(),m("ngIf",e.availableReservationsWithoutTable.length>0)}}function si(s,t){if(s&1&&(i(0,"div",9)(1,"span",263),o(2,"Email:"),n(),i(3,"span",264),o(4),n()()),s&2){let e=c(2);l(4),f(e.assignmentReservation==null?null:e.assignmentReservation.customer_email)}}function di(s,t){if(s&1&&(i(0,"div",9)(1,"span",263),o(2,"Note:"),n(),i(3,"span",264),o(4),n()()),s&2){let e=c(2);l(4),f(e.assignmentReservation==null?null:e.assignmentReservation.special_requests)}}function ci(s,t){if(s&1&&(i(0,"option",166),o(1),n()),s&2){let e=t.$implicit,r=c(3);m("value",e),l(),V(" ",r.getFloorPlanName(e)," (",(r.suggestedTablesByFloorPlan[e]==null?null:r.suggestedTablesByFloorPlan[e].length)||0,") ")}}function mi(s,t){if(s&1){let e=x();i(0,"select",278),O("ngModelChange",function(a){u(e);let d=c(2);return C(d.selectedFloorPlanForAssignment,a)||(d.selectedFloorPlanForAssignment=a),p(a)}),g(1,ci,2,3,"option",143),n()}if(s&2){let e=c(2);y("ngModel",e.selectedFloorPlanForAssignment),l(),m("ngForOf",e.getFloorPlanKeys())}}function ui(s,t){if(s&1){let e=x();i(0,"div",280),_("click",function(){let a=u(e).$implicit,d=c(3);return p(d.assignSelectedTableToReservation(a))}),i(1,"div",281)(2,"div",282)(3,"span",170),o(4,"table_restaurant"),n()(),i(5,"div",283)(6,"div",284),o(7),n(),i(8,"div",24),o(9),n(),i(10,"div",285),o(11),n()()(),i(12,"div",286)(13,"button",287)(14,"span",43),o(15,"check"),n(),o(16," Assegna questo tavolo "),n()()()}if(s&2){let e=t.$implicit;l(7),f(e.table_number),l(2),f(e.table_name),l(2),v("",e.capacity," persone")}}function pi(s,t){if(s&1&&(W(0),i(1,"div",13),g(2,ui,17,3,"div",279),n(),N()),s&2){let e=c(2);l(2),m("ngForOf",e.suggestedTablesByFloorPlan[e.getFloorPlanKeys()[0]])}}function _i(s,t){if(s&1){let e=x();i(0,"button",290),_("click",function(){let a=u(e).$implicit,d=c(3);return p(d.selectedFloorPlanForAssignment=a)}),o(1),i(2,"span",291),o(3),n()()}if(s&2){let e=t.$implicit,r=c(3);q(r.selectedFloorPlanForAssignment===e?"chip active":"chip"),l(),v(" ",r.getFloorPlanName(e)," "),l(2),f((r.suggestedTablesByFloorPlan[e]==null?null:r.suggestedTablesByFloorPlan[e].length)||0)}}function vi(s,t){if(s&1){let e=x();i(0,"div",280),_("click",function(){let a=u(e).$implicit,d=c(3);return p(d.assignSelectedTableToReservation(a))}),i(1,"div",281)(2,"div",282)(3,"span",170),o(4,"table_restaurant"),n()(),i(5,"div",283)(6,"div",284),o(7),n(),i(8,"div",24),o(9),n(),i(10,"div",285),o(11),n(),i(12,"div",292),o(13),n()()(),i(14,"div",286)(15,"button",287)(16,"span",43),o(17,"check"),n(),o(18," Assegna questo tavolo "),n()()()}if(s&2){let e=t.$implicit,r=c(3);l(7),f(e.table_number),l(2),f(e.table_name),l(2),v("",e.capacity," persone"),l(2),f(r.getFloorPlanName(e.floor_plan_id))}}function gi(s,t){if(s&1&&(W(0),i(1,"div",288),g(2,_i,4,4,"button",289),n(),i(3,"div",13),g(4,vi,19,4,"div",279),n(),N()),s&2){let e=c(2);l(2),m("ngForOf",e.getFloorPlanKeys()),l(2),m("ngForOf",e.suggestedTablesByFloorPlan[e.selectedFloorPlanForAssignment])}}function hi(s,t){s&1&&(i(0,"div",83)(1,"span",43),o(2,"search_off"),n(),i(3,"p",12),o(4,"Nessun tavolo disponibile con capacit\xE0 sufficiente."),n(),i(5,"p",293),o(6,"Prova a liberare alcuni tavoli o aumentare la capacit\xE0."),n()())}function bi(s,t){if(s&1){let e=x();i(0,"div",250),_("click",function(){u(e);let a=c();return p(a.closeTableAssignmentModal())}),i(1,"div",251),_("click",function(a){return u(e),p(a.stopPropagation())}),i(2,"div",86)(3,"div",52)(4,"div",87)(5,"span",43),o(6,"table_restaurant"),n()(),i(7,"div")(8,"h2",11),o(9,"Assegna tavolo"),n(),i(10,"p",24),o(11),n()()(),i(12,"button",47),_("click",function(){u(e);let a=c();return p(a.closeTableAssignmentModal())}),i(13,"span",43),o(14,"close"),n()()(),i(15,"div",88)(16,"div",268)(17,"div",269)(18,"div",270)(19,"span",43),o(20,"person"),n()(),i(21,"div",94)(22,"h3",232),o(23),n(),i(24,"div",52)(25,"span",12),o(26),n(),i(27,"span",12),o(28,"\u2022"),n(),i(29,"span",12),o(30),n()()()(),i(31,"div",271)(32,"div",9)(33,"span",263),o(34,"Telefono:"),n(),i(35,"span",264),o(36),n()(),g(37,si,5,1,"div",272)(38,di,5,1,"div",272),n()(),i(39,"div",228)(40,"div",273)(41,"h3",46),o(42,"Tavoli disponibili"),n(),i(43,"div",9),g(44,mi,2,2,"select",274),i(45,"div",69),o(46),n()()(),g(47,pi,3,1,"ng-container",164)(48,gi,5,2,"ng-container",164)(49,hi,7,0,"div",63),n(),i(50,"div",275)(51,"span",43),o(52,"info"),n(),i(53,"div")(54,"strong"),o(55,"Assegnazione manuale"),n(),i(56,"p",276),o(57,' Puoi anche chiudere questo modal e selezionare un tavolo direttamente dalla mappa. Clicca su un tavolo libero e seleziona "Assegna a prenotazione". '),n()()()(),i(58,"div",120)(59,"button",253),_("click",function(){u(e);let a=c();return p(a.closeTableAssignmentModal())}),o(60," Annulla "),n(),i(61,"button",277),_("click",function(){u(e);let a=c();return p(a.closeTableAssignmentModal())}),i(62,"span",43),o(63,"refresh"),n(),o(64," Carica altri tavoli "),n()()()()}if(s&2){let e=c();l(11),V("",e.assignmentReservation==null?null:e.assignmentReservation.customer_name," - ",e.assignmentReservation==null?null:e.assignmentReservation.party_size," persone"),l(12),f(e.assignmentReservation==null?null:e.assignmentReservation.customer_name),l(3),v("",e.assignmentReservation==null?null:e.assignmentReservation.party_size," ospiti"),l(4),f(e.assignmentReservation==null||e.assignmentReservation.reservation_time==null?null:e.assignmentReservation.reservation_time.substring(0,5)),l(6),f(e.assignmentReservation==null?null:e.assignmentReservation.customer_phone),l(),m("ngIf",e.assignmentReservation==null?null:e.assignmentReservation.customer_email),l(),m("ngIf",e.assignmentReservation==null?null:e.assignmentReservation.special_requests),l(6),m("ngIf",e.getFloorPlanKeys().length>1),l(2),v(" ",e.getTotalSuggestedTables()," tavoli disponibili "),l(),m("ngIf",e.getFloorPlanKeys().length===1),l(),m("ngIf",e.getFloorPlanKeys().length>1&&e.selectedFloorPlanForAssignment),l(),m("ngIf",e.getTotalSuggestedTables()===0)}}var $e=class s{floorPlanService=R(Ve);tableService=R(Re);orderService=R(He);dishService=R(ke);tableStatusService=R(Z);categoryService=R(Pe);tavolataService=R(De);reservationService=R(Fe);shiftService=R(ze);floorManagementService=R(Ae);loadingService=R(Ee);mapCard;orderingStatus={allowed:!1,reason:"Caricamento...",currentShift:null};shiftCheckInterval;get floorPlans(){return this.floorPlanService.data}get tables(){return this.tableService.data}get dishes(){return this.dishService.data.filter(t=>t.status==="available")}get categories(){return this.categoryService.data}currentFloorPlan=null;tableStatuses=[];selectedTable=null;selectedTableStatus=null;currentOrder=null;currentTavolataId=null;orderHeaders=[];currentOrderHeader=null;selectedOrderHeader=null;currentRestaurant=null;unsavedChanges=!1;isCreatingOrder=!1;pendingItems=[];isDraftMode=!1;allTableStatuses=[];zoomLevel=1;minZoom=.5;maxZoom=3;mobileView=!1;isFullscreen=!1;isLargeText=!1;showQuickActionsModal=!1;showCreateOrderModal=!1;showOrderDetailsModal=!1;showManualReservationModal=!1;showEditReservationModal=!1;showBillPreviewModal=!1;showOrderActionsAfterSave=!1;billPreviewHtml="";searchTerm="";statusFilter="all";selectedCategory="all";dishSearchTerm="";manualReservationData={customer_name:"",customer_phone:"",reservation_date:"",reservation_time:"",party_size:2,special_requests:""};editingReservation=null;showAssignReservationModal=!1;availableReservationsWithoutTable=[];selectedReservationForAssignment=null;showTableAssignmentModal=!1;assignmentReservation=null;suggestedTables=[];suggestedTablesByFloorPlan={};selectedFloorPlanForAssignment=null;loadingItemOperations=new Set;orderHeadersExpanded={};ordersExpanded={};showMoveSelectForItem=null;get freeTablesCount(){return this.tableStatuses.filter(t=>t.status==="free").length}get reservedTablesCount(){return this.tableStatuses.filter(t=>t.status==="reserved").length}get occupiedTablesCount(){return this.tableStatuses.filter(t=>t.status==="occupied").length}get totalTablesCount(){return this.tableStatuses.length}get readyForBillTablesCount(){return this.tableStatuses.filter(t=>t.status==="occupied"&&this.tableStatusService.areAllTableItemsServed(t.currentOrders||[])).length}get globalFreeTablesCount(){return this.allTableStatuses.filter(t=>t.status==="free").length}get globalReservedTablesCount(){return this.allTableStatuses.filter(t=>t.status==="reserved").length}get globalOccupiedTablesCount(){return this.allTableStatuses.filter(t=>t.status==="occupied").length}get globalTotalTablesCount(){return this.allTableStatuses.length}get globalReadyForBillTablesCount(){return this.allTableStatuses.filter(t=>t.status==="occupied"&&this.tableStatusService.areAllTableItemsServed(t.currentOrders||[])).length}get tableComandas(){return this.getComandeInCurrentOrderHeader()}subscriptions=new ee;ngOnInit(){return h(this,null,function*(){yield this.loadData(),yield this.loadCurrentRestaurant(),this.checkMobileView(),window.addEventListener("resize",()=>this.checkMobileView()),this.setupSubscriptions(),yield this.shiftService.debugShiftStatus(),this.startShiftChecking()})}ngOnDestroy(){this.subscriptions.unsubscribe(),window.removeEventListener("resize",()=>this.checkMobileView()),this.shiftCheckInterval&&this.shiftCheckInterval.unsubscribe()}startShiftChecking(){this.checkCurrentShift(),this.shiftCheckInterval=te(6e4).subscribe(()=>{this.checkCurrentShift()})}checkCurrentShift(){return h(this,null,function*(){let t=yield this.shiftService.getOrderingStatus();this.orderingStatus=t})}getShiftStatusClass(){return this.orderingStatus.allowed?"shift-active":"shift-inactive"}getShiftStatusText(){return this.orderingStatus.allowed?"\u{1F4CB} Orario di turno":"\u23F0 "+this.orderingStatus.reason}setupSubscriptions(){this.subscriptions.add(this.floorPlanService.data$.subscribe(()=>{this.floorPlans.length>0&&!this.currentFloorPlan&&(this.currentFloorPlan=this.floorPlans[0],this.loadTablesForFloorPlan())})),this.subscriptions.add(this.tableService.data$.subscribe(()=>{this.currentFloorPlan&&this.loadTablesForFloorPlan()}))}loadData(){return h(this,null,function*(){yield Promise.all([this.floorPlanService.loadFloorPlans(),this.tableService.loadData(),this.dishService.loadDishes(),this.categoryService.loadCategories(),this.floorManagementService.loadTodaysReservations()]),yield this.loadAvailableReservations();let t=this.tableService.data.filter(e=>!e.is_merged||e.parent_table_id===null);this.allTableStatuses=yield this.tableStatusService.calculateTableStatus(t),this.floorPlans.length>0&&!this.currentFloorPlan&&(this.currentFloorPlan=this.floorPlans[0],yield this.loadTablesForFloorPlan()),this.allTableStatuses=yield this.tableStatusService.calculateTableStatus(t)})}get pendingAssignmentsCount(){return this.availableReservationsWithoutTable.length}loadCurrentRestaurant(){return h(this,null,function*(){try{let t=yield this.getCurrentRestaurantId();if(!t){this.currentRestaurant=null;return}let{data:e,error:r}=yield this.orderService.supabaseService.getSupabaseClient().from("restaurants").select("*").eq("id",t).single();if(r)throw r;e&&(this.currentRestaurant=e)}catch(t){console.error("Error loading restaurant info:",t),this.currentRestaurant=null}})}loadTablesForFloorPlan(){return h(this,null,function*(){if(!this.currentFloorPlan)return;let e=this.tableService.getTablesByFloorPlan(this.currentFloorPlan.id).filter(r=>!r.is_merged||r.parent_table_id===null);this.tableStatuses=yield this.tableStatusService.calculateTableStatus(e)})}onTableClick(t){return h(this,null,function*(){if(this.selectedTable=t.table,this.selectedTableStatus=t,this.currentTavolataId=yield this.tavolataService.getCurrentTavolataId(t.table.id),this.currentTavolataId){if(yield this.loadOrderHeaders(),(!this.currentOrder||!this.currentOrder.id)&&this.currentOrderHeader?.orders?.length>0){let e=this.currentOrderHeader.orders.find(r=>r.comanda_number===1);this.currentOrder=e||this.currentOrderHeader.orders[0]}}else this.currentOrder=null,this.currentOrderHeader=null,this.orderHeaders=[];this.showQuickActionsModal=!0})}deselectTable(){this.selectedTable=null,this.selectedTableStatus=null,this.currentOrder=null,this.currentTavolataId=null,this.orderHeaders=[],this.showQuickActionsModal=!1,this.showCreateOrderModal=!1,this.showOrderDetailsModal=!1}loadOrderHeaders(){return h(this,null,function*(){if(!this.currentTavolataId){console.log("\u2139\uFE0F Nessuna tavolata corrente"),this.orderHeaders=[],this.currentOrderHeader=null,this.currentOrder=null;return}try{console.log(`\u{1F4CB} Carico order headers per tavolata: ${this.currentTavolataId}`);let t=yield this.orderService.getOrderHeadersByTavolata(this.currentTavolataId);if(this.orderHeaders=t.sort((e,r)=>new Date(e.created_at).getTime()-new Date(r.created_at).getTime()),console.log(`\u2705 Trovati ${this.orderHeaders.length} order headers`),this.orderHeaders.length===0)console.log("\u2139\uFE0F Nessun order header trovato"),this.currentOrderHeader=null,this.currentOrder=null;else{if(this.currentOrderHeader?.id){let e=this.orderHeaders.find(r=>r.id===this.currentOrderHeader?.id);this.currentOrderHeader=e||this.orderHeaders[0]}else this.currentOrderHeader=this.orderHeaders[0];if(this.currentOrderHeader?.orders?.length>0)if(this.currentOrderHeader.orders.sort((e,r)=>(e.comanda_number||0)-(r.comanda_number||0)),this.currentOrder?.id){let e=this.currentOrderHeader.orders.find(r=>r.id===this.currentOrder?.id);this.currentOrder=e||this.currentOrderHeader.orders[0]}else this.currentOrder=this.currentOrderHeader.orders[0];else this.currentOrder=null}}catch(t){console.error("\u274C Errore caricamento ordini:",t),this.orderHeaders=[],this.currentOrderHeader=null,this.currentOrder=null}})}createNewOrderHeader(){return h(this,null,function*(){if(!this.selectedTable||!this.selectedTableStatus)return console.error("\u274C Nessun tavolo selezionato"),null;try{if(!(yield this.getCurrentRestaurantId()))return console.error("\u274C Nessun ristorante trovato"),null;this.currentTavolataId||(this.currentTavolataId=yield this.tavolataService.startNewTavolata(this.selectedTable.id),console.log(`\u2705 Creata nuova tavolata: ${this.currentTavolataId}`));let e=yield this.orderService.createNewOrderHeader(this.selectedTable.id,this.currentTavolataId,"Cliente");if(!e)return console.error("\u274C Errore creazione order header"),null;console.log(`\u2705 Creato order header: ${e.header.order_number} (ID: ${e.header.id})`);let r=j(B({},e.header),{orders:[e.order]});return this.orderHeaders.push(r),this.currentOrderHeader=r,this.selectedOrderHeader=r,this.currentOrder=e.order,console.log(`\u2705 Comanda corrente impostata: ${e.order.comanda_number||1}`),r}catch(t){return console.error("\u274C Errore creazione ordine:",t),alert("Errore creazione nuovo ordine"),null}})}createNewComanda(){return h(this,null,function*(){if(!this.orderingStatus.allowed){alert(`\u26A0\uFE0F ${this.orderingStatus.reason}

Non \xE8 possibile creare comande al di fuori degli orari dei turni.`);return}if(!this.selectedTable||!this.currentTavolataId||!this.currentOrderHeader){console.error("\u274C Dati insufficienti per creare comanda");return}try{console.log(`\u2795 Creazione nuova comanda per order header: ${this.currentOrderHeader.id}`);let t,e;if(this.isDraftMode&&this.currentOrderHeader.id.startsWith("temp-")){let r=this.currentOrderHeader.orders||[];r.length===0?t=1:t=Math.max(...r.map(S=>S.comanda_number||0))+1,console.log(`\u{1F4CA} Calcolato comanda number ${t} per DRAFT (${r.length} comande esistenti)`);let a=`temp-order-${Date.now()}`,d=yield this.getCurrentRestaurantId();e={id:a,restaurant_id:d,table_id:this.selectedTable.id,order_header_id:this.currentOrderHeader.id,tavolata_id:this.currentTavolataId,comanda_number:t,order_number:`DRAFT-COM-${Date.now()}-${t}`,order_type:"dine_in",status:"draft",subtotal:0,tax_amount:0,discount_amount:0,total_amount:0,customer_name:"Cliente",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),order_items:[]},console.log(`\u2705 Creata comanda DRAFT ${t} in memoria`)}else t=yield this.orderService.getNextComandaNumber(this.currentOrderHeader.id),e=yield this.orderService.createOrderForHeader(this.selectedTable.id,this.currentOrderHeader.id,this.currentTavolataId),console.log(`\u2705 Creata comanda ${e.comanda_number} (ID: ${e.id})`);e&&(this.currentOrder=e,this.currentOrderHeader.orders||(this.currentOrderHeader.orders=[]),this.currentOrderHeader.orders.findIndex(a=>a.id===e.id)===-1&&this.currentOrderHeader.orders.push(e),this.currentOrderHeader.orders.sort((a,d)=>(a.comanda_number||0)-(d.comanda_number||0)),console.log(`\u2705 Ora ci sono ${this.currentOrderHeader.orders.length} comande nell'order header`))}catch(t){console.error("\u274C Errore creazione comanda:",t),alert("Errore creazione nuova comanda")}})}cleanupEmptyOrders(){return h(this,null,function*(){try{yield this.deleteEmptyOrders(),yield this.loadOrderHeaders()}catch(t){console.error("\u274C Errore pulizia comande:",t)}})}createNewOrderInSameTavolata(t){return h(this,null,function*(){if(!this.orderingStatus.allowed){alert(`\u26A0\uFE0F ${this.orderingStatus.reason}

\xC8 possibile ordinare solo durante i turni attivi o entro un'ora prima/dopo.`);return}if(!this.isCreatingOrder){this.isCreatingOrder=!0;try{console.log("\u{1F504} Inizio creazione nuovo ordine...");let e=t?.target;if(e&&(e.disabled=!0,setTimeout(()=>{e.disabled=!1},2e3)),this.unsavedChanges=!1,this.currentTavolataId&&this.orderHeaders.length>0){let w=this.orderHeaders.filter(T=>!T.orders?.some(E=>E.order_items&&E.order_items.length>0));if(w.length>0){console.log("\u{1F4C4} Trovato order header vuoto esistente, riutilizzo..."),this.currentOrderHeader=w[0],this.selectedOrderHeader=w[0],!this.currentOrderHeader.orders||this.currentOrderHeader.orders.length===0?yield this.createNewComanda():this.currentOrder=this.currentOrderHeader.orders[0],this.showQuickActionsModal=!1,this.showCreateOrderModal=!0;return}}let r=`temp-header-${Date.now()}`,a=`temp-order-${Date.now()}`,d=yield this.getCurrentRestaurantId();this.currentTavolataId||(this.currentTavolataId=`temp-tavolata-${Date.now()}`,console.log(`\u{1F4DD} Creata tavolata temporanea: ${this.currentTavolataId}`));let b={id:r,restaurant_id:d,table_id:this.selectedTable.id,tavolata_id:this.currentTavolataId,order_number:`DRAFT-${Date.now()}`,status:"draft",customer_name:"Cliente",total_amount:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),orders:[]},S={id:a,restaurant_id:d,table_id:this.selectedTable.id,order_header_id:r,tavolata_id:this.currentTavolataId,comanda_number:1,order_number:`DRAFT-COM-${Date.now()}`,order_type:"dine_in",status:"draft",subtotal:0,tax_amount:0,discount_amount:0,total_amount:0,customer_name:"Cliente",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),order_items:[]};b.orders=[S],this.orderHeaders.push(b),this.currentOrderHeader=b,this.selectedOrderHeader=b,this.currentOrder=S,this.isDraftMode=!0,this.pendingItems=[],this.showQuickActionsModal=!1,this.showCreateOrderModal=!0,console.log("\u{1F4DD} Creato ordine DRAFT in memoria (non salvato nel DB)")}catch(e){console.error("Errore creazione nuovo ordine:",e),alert("Errore nella creazione del nuovo ordine")}finally{this.isCreatingOrder=!1}}})}getOrderHeaderDisplayName(t,e){return t.order_number&&t.order_number.startsWith("Ordine ")?t.order_number:`Ordine ${e+1}`}addDishToCurrentOrder(t){return h(this,null,function*(){if(!this.orderingStatus.allowed){alert(`\u26A0\uFE0F ${this.orderingStatus.reason}

Non \xE8 possibile aggiungere piatti al di fuori degli orari dei turni.`);return}if(!this.selectedTable||!this.selectedTableStatus){console.error("\u274C Nessun tavolo selezionato");return}if(this.currentTavolataId||(this.currentTavolataId=`temp-tavolata-${Date.now()}`,console.log(`\u{1F4DD} Creata tavolata temporanea in memoria: ${this.currentTavolataId}`)),!this.currentOrderHeader||this.orderHeaders.length===0){console.log("\u{1F4DD} Creazione order header DRAFT in memoria...");let d=yield this.getCurrentRestaurantId(),b=`temp-header-${Date.now()}`,S=`temp-order-${Date.now()}`,w={id:b,restaurant_id:d,table_id:this.selectedTable.id,tavolata_id:this.currentTavolataId,order_number:`DRAFT-${Date.now()}`,status:"draft",customer_name:"Cliente",total_amount:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),orders:[]},T={id:S,restaurant_id:d,table_id:this.selectedTable.id,order_header_id:b,tavolata_id:this.currentTavolataId,comanda_number:1,order_number:`DRAFT-COM-${Date.now()}`,order_type:"dine_in",status:"draft",subtotal:0,tax_amount:0,discount_amount:0,total_amount:0,customer_name:"Cliente",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),order_items:[]};w.orders=[T],this.orderHeaders.push(w),this.currentOrderHeader=w,this.selectedOrderHeader=w,this.currentOrder=T,this.isDraftMode=!0,this.pendingItems=[],console.log("\u2705 Creato order header DRAFT in memoria")}if(!this.currentOrder)if(this.currentOrderHeader?.orders&&this.currentOrderHeader.orders.length>0)this.currentOrderHeader.orders.sort((d,b)=>(d.comanda_number||0)-(b.comanda_number||0)),this.currentOrder=this.currentOrderHeader.orders[0],console.log(`\u{1F50D} Trovata comanda esistente: ${this.currentOrder?.comanda_number}`);else{console.log("\u2795 Creazione comanda 1 DRAFT in memoria perch\xE9 non esiste");let d=yield this.getCurrentRestaurantId(),S={id:`temp-order-${Date.now()}`,restaurant_id:d,table_id:this.selectedTable.id,order_header_id:this.currentOrderHeader.id,tavolata_id:this.currentTavolataId,comanda_number:1,order_number:`DRAFT-COM-${Date.now()}`,order_type:"dine_in",status:"draft",subtotal:0,tax_amount:0,discount_amount:0,total_amount:0,customer_name:"Cliente",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),order_items:[]};this.currentOrderHeader.orders||(this.currentOrderHeader.orders=[]),this.currentOrderHeader.orders.push(S),this.currentOrder=S,this.isDraftMode=!0}if(!this.currentOrder||!this.currentOrder.id){console.error("\u274C Nessuna comanda disponibile");return}let e=this.currentOrder.id,r=this.currentOrder.comanda_number||1,a=`add-${t.id}-${e}`;if(!this.loadingItemOperations.has(a)){this.loadingItemOperations.add(a);try{console.log(`\u2795 Aggiungo ${t.name} alla comanda ${r}`),this.unsavedChanges=!0,this.isDraftMode||e.startsWith("temp-")?(this.pendingItems.push({action:"add",dish:{id:t.id,base_price:t.base_price,name:t.name},orderId:e,quantity:1}),yield this.refreshCurrentOrderInMemory(t)):(yield this.orderService.addDishToOrder(e,{id:t.id,base_price:t.base_price,name:t.name},1,""))&&(yield this.refreshCurrentOrder()),this.showQuickAddFeedback(t.name)}catch(d){console.error("\u274C Errore aggiunta piatto:",d)}finally{this.loadingItemOperations.delete(a)}}})}refreshCurrentOrderInMemory(t){return h(this,null,function*(){if(!this.currentOrder){console.error("\u274C Nessuna comanda corrente per refresh in memoria");return}let e={id:`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,order_id:this.currentOrder.id,dish_id:t.id,dish:t,quantity:1,unit_price:t.base_price,total_price:t.base_price,status:"waiting",item_notes:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};this.currentOrder.order_items||(this.currentOrder.order_items=[]);let r=this.currentOrder.order_items.findIndex(a=>a.dish_id===t.id&&a.id.startsWith("temp-"));if(r!==-1){let a=this.currentOrder.order_items[r];a.quantity+=1,a.total_price=a.quantity*a.unit_price}else this.currentOrder.order_items.push(e);this.updateLocalTotals()})}updateLocalTotals(){if(this.currentOrder&&this.currentOrder.order_items){let t=this.currentOrder.order_items.reduce((e,r)=>e+(r.total_price||0),0);this.currentOrderHeader&&(this.currentOrderHeader.total_amount=this.calcolaTotaleOrderHeader(this.currentOrderHeader))}}refreshCurrentOrder(){return h(this,null,function*(){if(!this.currentOrder?.id){console.warn("\u26A0\uFE0F Nessuna comanda corrente da aggiornare");return}try{console.log(`\u{1F504} Ricarico comanda ${this.currentOrder.comanda_number} (ID: ${this.currentOrder.id})`);let t=yield this.orderService.refreshOrder(this.currentOrder.id);if(t){if(this.currentOrder=t,this.currentOrderHeader&&this.currentOrderHeader.orders){let e=this.currentOrderHeader.orders.findIndex(r=>r.id===t.id);e!==-1?this.currentOrderHeader.orders[e]=t:this.currentOrderHeader.orders.push(t)}console.log(`\u2705 Comanda ${this.currentOrder.comanda_number} aggiornata con ${t.order_items?.length||0} piatti`)}}catch(t){console.error("\u274C Errore refresh ordine:",t)}})}updateComandaItemQuantity(t,e){return h(this,null,function*(){if(e>0&&!this.orderingStatus.allowed){alert(`\u26A0\uFE0F ${this.orderingStatus.reason}

Non \xE8 possibile aumentare le quantit\xE0 al di fuori degli orari dei turni.`);return}if(!t||!t.id){console.error("\u274C Item non valido per aggiornamento quantit\xE0");return}if(this.unsavedChanges=!0,(this.isDraftMode||t.id.startsWith("temp-"))&&t.id.startsWith("temp-")){if(!this.currentOrder||!this.currentOrder.order_items){console.error("\u274C Nessuna comanda corrente per aggiornare quantit\xE0");return}let r=this.currentOrder.order_items.findIndex(a=>a.id===t.id);if(r!==-1){let a=t.quantity+e;if(a<1){this.currentOrder.order_items.splice(r,1);let d=this.pendingItems.findIndex(b=>b.itemId===t.id||b.action==="add"&&b.dish.id===t.dish_id);d!==-1&&this.pendingItems.splice(d,1)}else this.currentOrder.order_items[r].quantity=a,this.currentOrder.order_items[r].total_price=a*this.currentOrder.order_items[r].unit_price;this.updateLocalTotals()}}else t.id.startsWith("temp-")||(yield this.orderService.updateOrderItemQuantity(t.id,e))&&(yield this.refreshCurrentOrder())})}removeComandaItem(t){return h(this,null,function*(){if(t.id&&confirm("Rimuovere questo piatto?"))if(this.unsavedChanges=!0,this.isDraftMode&&t.id.startsWith("temp-")){if(this.currentOrder?.order_items){let r=this.currentOrder.order_items.findIndex(a=>a.id===t.id);r!==-1&&this.currentOrder.order_items.splice(r,1)}let e=this.pendingItems.findIndex(r=>r.itemId===t.id||r.action==="add"&&r.dish.id===t.dish_id);e!==-1&&this.pendingItems.splice(e,1),this.updateLocalTotals()}else t.id.startsWith("temp-")||(yield this.orderService.deleteOrderItem(t.id))&&(yield this.refreshCurrentOrder())})}onComandaChange(t,e){return h(this,null,function*(){if(!t.id||!e||e===this.currentOrder?.id)return;let r=this.dishes.find(a=>a.id===t.dish_id);if(r)try{this.unsavedChanges=!0,yield this.orderService.addDishToOrder(e,{id:r.id,base_price:r.base_price,name:r.name},1,t.item_notes||""),t.quantity>1?yield this.orderService.updateOrderItemQuantity(t.id,-1):yield this.orderService.deleteOrderItem(t.id),yield this.refreshCurrentOrder(),this.showMoveSelectForItem=null}catch(a){console.error("Errore spostamento item:",a)}})}openCreateOrderModal(){this.showQuickActionsModal=!1,this.showCreateOrderModal=!0}closeCreateOrderModal(){return h(this,null,function*(){if(this.isDraftMode&&this.currentOrderHeader?.id?.startsWith("temp-")){if(!confirm(`Hai modifiche non salvate.
Sei sicuro di voler chiudere senza salvare?
Tutte le modifiche andranno perse.`))return;let e=this.orderHeaders.findIndex(r=>r.id===this.currentOrderHeader.id);e!==-1&&this.orderHeaders.splice(e,1),this.currentTavolataId?.startsWith("temp-")&&(this.currentTavolataId=null)}else if(this.unsavedChanges&&this.getOrderItems().length>0){if(!confirm(`Hai modifiche non salvate.
Sei sicuro di voler chiudere senza salvare?`))return;yield this.cleanupEmptyOrdersBeforeClose()}this.unsavedChanges=!1,this.isDraftMode=!1,this.pendingItems=[],this.showCreateOrderModal=!1,this.selectedTable&&this.currentTavolataId&&!this.currentTavolataId.startsWith("temp-")&&setTimeout(()=>{this.loadOrderHeaders()},300)})}cleanupEmptyOrdersBeforeClose(){return h(this,null,function*(){if(this.currentOrderHeader?.orders)try{let t=this.currentOrderHeader.orders.filter(r=>!r.order_items||r.order_items.length===0);for(let r of t)r.id&&(yield this.orderService.deleteOrder(r.id));!this.currentOrderHeader.orders.some(r=>r.order_items&&r.order_items.length>0)&&this.currentOrderHeader.id&&(yield this.orderService.deleteOrderHeader(this.currentOrderHeader.id))}catch(t){console.error("\u274C Errore pulizia prima della chiusura:",t)}})}onBackdropClick(t){t.target.classList.contains("modal-overlay")&&this.closeCreateOrderModal()}openOrderDetails(){this.showQuickActionsModal=!1,this.showOrderDetailsModal=!0}closeOrderDetailsModal(){this.showOrderDetailsModal=!1}openManualReservationModal(){if(!this.selectedTable)return;let t=new Date;this.manualReservationData={customer_name:"",customer_phone:"",reservation_date:t.toISOString().split("T")[0],reservation_time:t.toTimeString().split(" ")[0].substring(0,5),party_size:this.selectedTable.capacity||2,special_requests:""},this.showQuickActionsModal=!1,this.showManualReservationModal=!0}closeManualReservationModal(){this.showManualReservationModal=!1}openEditReservationModal(){this.selectedTableStatus?.currentReservation&&(this.editingReservation=B({},this.selectedTableStatus.currentReservation),this.showEditReservationModal=!0,this.showQuickActionsModal=!1)}closeEditReservationModal(){this.showEditReservationModal=!1,this.editingReservation=null}saveOrder(){return h(this,null,function*(){if(!this.currentOrder)return;let t=this.getOrderItems().filter(e=>!e.id?.startsWith("temp-"));if(t.length===0){alert("\u274C Aggiungi almeno un piatto!");return}if(t.some(e=>e.quantity<=0)){alert("\u274C Quantit\xE0 non valide!");return}try{yield this.refreshCurrentOrder(),this.showCreateOrderModal=!1,this.showOrderActionsAfterSave=!0,alert("\u2705 Ordine salvato!")}catch{alert("\u274C Errore salvataggio")}})}saveComandaOrder(){return h(this,null,function*(){this.loadingService.start();try{this.isDraftMode&&this.currentOrderHeader?.id?.startsWith("temp-")?yield this.saveDraftOrder():this.currentTavolataId&&this.currentOrderHeader?.id&&!this.currentOrderHeader.id.startsWith("temp-")?yield this.saveExistingOrder():alert("Nessun ordine da salvare")}catch(t){console.error("\u274C Errore durante il salvataggio:",t),alert("Si \xE8 verificato un errore durante il salvataggio")}finally{this.loadingService.stop()}})}saveDraftOrder(){return h(this,null,function*(){try{console.log("\u{1F4BE} Salvataggio DRAFT nel database...");let t=0;if(this.currentOrderHeader?.orders)for(let w of this.currentOrderHeader.orders)t+=w.order_items?.length||0;if(t===0){alert("\u274C Aggiungi almeno un piatto prima di salvare!");return}console.log(`\u{1F4CA} Totale ${t} piatti in ${this.currentOrderHeader?.orders?.length||0} comande`);let e=this.currentTavolataId;if((!e||e.startsWith("temp-"))&&(e=yield this.tavolataService.startNewTavolata(this.selectedTable.id),this.currentTavolataId=e,console.log(`\u2705 Creata tavolata reale: ${e}`)),!(yield this.getCurrentRestaurantId())){alert("\u274C Nessun ristorante selezionato");return}let a=yield this.orderService.createNewOrderHeader(this.selectedTable.id,e,"Cliente");if(!a||!a.header||!a.order){console.error("\u274C Errore creazione order header"),alert("Errore durante la creazione dell'ordine");return}console.log(`\u2705 Creato order header: ${a.header.order_number} (ID: ${a.header.id})`);let d=[];if(this.currentOrderHeader.orders&&this.currentOrderHeader.orders.length>0){let w=[...this.currentOrderHeader.orders].sort((T,M)=>(T.comanda_number||0)-(M.comanda_number||0));for(let T=0;T<w.length;T++){let M=w[T],E;if(T===0?E=a.order:(E=yield this.orderService.createOrderForHeader(this.selectedTable.id,a.header.id,e),E.comanda_number=M.comanda_number||T+1),M.order_items&&M.order_items.length>0)for(let k of M.order_items)k.dish&&(yield this.orderService.addDishToOrder(E.id,{id:k.dish_id,base_price:k.unit_price||k.dish.base_price,name:k.dish.name},k.quantity||1,k.item_notes||""));d.push(E),console.log(`\u2705 Trasferita comanda ${M.comanda_number||T+1} con ${M.order_items?.length||0} piatti`)}}let b=this.orderHeaders.findIndex(w=>w.id===this.currentOrderHeader.id);b!==-1&&this.orderHeaders.splice(b,1);let S=j(B({},a.header),{orders:d.sort((w,T)=>(w.comanda_number||0)-(T.comanda_number||0)),table:{table_number:this.selectedTable.table_number,table_name:this.selectedTable.table_name}});this.orderHeaders.push(S),this.currentOrderHeader=S,this.selectedOrderHeader=S,this.currentOrder=d[0],this.isDraftMode=!1,this.pendingItems=[],this.unsavedChanges=!1,yield this.updateTableStatusImmediately(),this.showCreateOrderModal=!1,this.showOrderActionsAfterSave=!0,alert(`\u2705 Ordine salvato con successo! ${d.length} comande create`)}catch(t){throw console.error("\u274C Errore salvataggio DRAFT:",t),t}})}transferItemsToRealOrder(t){return h(this,null,function*(){try{if(this.currentOrder?.order_items&&this.currentOrder.order_items.length>0)for(let e of this.currentOrder.order_items)e.dish&&(yield this.orderService.addDishToOrder(t,{id:e.dish_id,base_price:e.unit_price||e.dish.base_price,name:e.dish.name},e.quantity||1,e.item_notes||""));if(this.pendingItems.length>0)for(let e of this.pendingItems)yield this.orderService.addDishToOrder(t,e.dish,e.quantity||1,"");console.log(`\u2705 Trasferiti ${this.getOrderItems().length} piatti all'ordine reale`)}catch(e){throw console.error("\u274C Errore trasferimento items:",e),e}})}saveExistingOrder(){return h(this,null,function*(){try{console.log(`\u{1F4BE} Salvataggio ordine esistente ${this.currentOrderHeader.order_number}`);let t=yield this.orderService.saveAndValidateOrder(this.currentTavolataId,this.currentOrderHeader.id);if(!t.success){alert(t.message);return}yield this.loadOrderHeaders(),this.selectedTable&&this.selectedTableStatus&&(yield this.updateTableStatusImmediately()),this.unsavedChanges=!1,this.showCreateOrderModal=!1,this.showOrderActionsAfterSave=!0,console.log("\u2705 "+t.message),alert(t.message)}catch(t){throw console.error("\u274C Errore salvataggio:",t),t}})}updateTableStatusImmediately(){return h(this,null,function*(){if(!(!this.selectedTable||!this.selectedTableStatus))try{console.log(`\u{1F504} Aggiorno stato del tavolo ${this.selectedTable.table_number}`);let t=this.tableStatuses.findIndex(e=>e.table.id===this.selectedTable.id);if(t!==-1){this.tableStatuses[t].status="occupied";let e=yield this.orderService.getTableOrders(this.selectedTable.id,this.currentTavolataId||void 0);this.tableStatuses[t].currentOrders=e,console.log(`\u2705 Tavolo ${this.selectedTable.table_number} impostato come occupied con ${e.length} ordini attivi`)}}catch(t){console.error("\u274C Errore aggiornamento stato tavolo:",t)}})}deleteEmptyOrders(){return h(this,null,function*(){if(!this.currentOrderHeader?.orders)return;let t=this.currentOrderHeader.orders.filter(e=>!e.order_items||e.order_items.length===0);for(let e of t)if(e.id)try{let{error:r}=yield this.orderService.supabaseService.getSupabaseClient().from("orders").delete().eq("id",e.id);r&&console.error(`\u274C Errore eliminazione comanda ${e.id}:`,r)}catch(r){console.error(`\u274C Errore eliminazione comanda ${e.id}:`,r)}console.log(`\u{1F5D1}\uFE0F Eliminate ${t.length} comande vuote`)})}checkIfAnyOrderHasItems(){return h(this,null,function*(){if(!this.currentOrderHeader?.orders)return!1;let{data:t,error:e}=yield this.orderService.supabaseService.getSupabaseClient().from("orders").select(`
      id,
      order_items (*)
    `).eq("order_header_id",this.currentOrderHeader.id);return e?(console.error("\u274C Errore verifica ordini:",e),!1):t.some(r=>r.order_items&&r.order_items.length>0)})}updateAllOrderTotals(){return h(this,null,function*(){if(!this.currentOrderHeader?.orders)return;let{data:t,error:e}=yield this.orderService.supabaseService.getSupabaseClient().from("orders").select("id").eq("order_header_id",this.currentOrderHeader.id);if(e){console.error("\u274C Errore recupero comande:",e);return}for(let r of t)yield this.orderService.updateOrderTotal(r.id)})}closeTableBill(){return h(this,null,function*(){if(!(!this.selectedTableStatus||!this.currentTavolataId||!confirm(`Chiudere il conto? Verr\xE0 stampato lo scontrino.

Se ci sono ordini aperti, verranno chiusi.`)))try{this.loadingService.start(),yield this.loadOrderHeaders();let e=this.generateBillPreviewHtml();yield this.orderService.closeTavolata(this.selectedTableStatus.table.id,this.currentTavolataId),this.printBill(e),yield this.loadData(),this.deselectTable(),this.showQuickActionsModal=!1}catch(e){console.error("Error freeing table:",e),alert("Errore durante la chiusura del conto")}finally{this.loadingService.stop()}})}closeOrderAndCreateBill(){return h(this,null,function*(){yield this.closeTableBill()})}createManualReservation(){return h(this,null,function*(){if(this.selectedTable)try{let t={restaurant_id:this.selectedTable.restaurant_id,table_id:this.selectedTable.id,reservation_date:this.manualReservationData.reservation_date,reservation_time:this.manualReservationData.reservation_time,party_size:this.manualReservationData.party_size,special_requests:this.manualReservationData.special_requests,status:"confirmed",customer_id:null,customer_name:this.manualReservationData.customer_name,customer_phone:this.manualReservationData.customer_phone},{data:e,error:r}=yield this.reservationService.supabaseService.getSupabaseClient().from("reservations").insert(t).select().single();if(r)throw r;this.closeManualReservationModal(),yield this.loadData(),alert("Prenotazione creata con successo!")}catch(t){console.error("Error creating manual reservation:",t),alert("Errore durante la creazione della prenotazione: "+t.message)}})}updateReservation(){return h(this,null,function*(){if(this.editingReservation)try{let{error:t}=yield this.reservationService.supabaseService.getSupabaseClient().from("reservations").update(j(B({},this.editingReservation),{updated_at:new Date().toISOString()})).eq("id",this.editingReservation.id);if(t)throw t;yield this.loadData(),this.closeEditReservationModal(),this.deselectTable()}catch(t){console.error("Errore nell'aggiornamento della prenotazione:",t),alert("Errore durante l'aggiornamento della prenotazione")}})}deleteReservation(){return h(this,null,function*(){if(this.editingReservation&&this.isReservationDeletable(this.editingReservation))try{let{error:t}=yield this.reservationService.supabaseService.getSupabaseClient().from("reservations").delete().eq("id",this.editingReservation.id);if(t)throw t;yield this.loadData(),this.closeEditReservationModal(),this.deselectTable()}catch(t){console.error("Errore nell'eliminazione della prenotazione:",t),alert("Errore durante l'eliminazione della prenotazione")}else alert("Impossibile eliminare questa prenotazione")})}isReservationDeletable(t){if(!t?.reservation_date||!t?.reservation_time)return!1;try{return new Date(`${t.reservation_date}T${t.reservation_time}`)>new Date}catch(e){return console.error("Errore nel parsing della data:",e),!1}}freeTableManually(){return h(this,null,function*(){if(!(!this.selectedTableStatus||!confirm(`Sei sicuro di voler liberare questo tavolo?

Se ci sono ordini aperti, verranno chiusi.`)))try{this.currentTavolataId&&(yield this.orderService.closeTavolata(this.selectedTableStatus.table.id,this.currentTavolataId)),yield this.loadData(),this.deselectTable(),this.showQuickActionsModal=!1}catch(e){console.error("Error freeing table:",e),alert("Errore durante la liberazione del tavolo")}})}viewBillPreview(){return h(this,null,function*(){if(!this.selectedTableStatus||!this.currentTavolataId){alert("Nessun ordine attivo per questo tavolo");return}if(yield this.loadOrderHeaders(),this.orderHeaders.length===0){alert("Nessun ordine da visualizzare");return}this.billPreviewHtml=this.generateBillPreviewHtml(),this.showBillPreviewModal=!0})}generateBillPreviewHtml(){let t=new Date().toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return`
    <div class="bill-preview">
      <!-- HEADER -->
      <div class="header text-center mb-lg">
        <h1 class="text-primary text-lg font-bold">${this.getRestaurantName()}</h1>
        ${this.getRestaurantAddress()?`<p class="text-muted mt-xs">${this.getRestaurantAddress()}</p>`:""}
        ${this.getRestaurantPhone()?`<p class="text-muted mt-xs">\u{1F4DE} ${this.getRestaurantPhone()}</p>`:""}
        ${this.getRestaurantEmail()?`<p class="text-muted mt-xs">\u2709\uFE0F ${this.getRestaurantEmail()}</p>`:""}
        <p class="text-muted mt-sm"><strong>Tavolo:</strong> ${this.selectedTable?.table_number||"N/A"} - ${this.selectedTable?.table_name||""}</p>
        <p class="text-muted">${t}</p>
      </div>

      <!-- CONTENUTO ORDINI -->
      <div class="order-sections">
        ${this.orderHeaders.map((e,r)=>{let a=this.calcolaTotaleOrderHeader(e);return`
            <div class="form-card mb-lg">
              <div class="section-title text-primary font-bold mb-md">ORDINE ${r+1}</div>
              ${e.orders?.map(d=>{let b=this.getOrderTotal(d);return`
                  <div class="comanda mb-md p-md border rounded">
                    <div class="comanda-header font-semibold text-md mb-sm">Comanda ${d.comanda_number||1}</div>
                    <div class="items">
                      ${d.order_items?.length>0?d.order_items.map(S=>{let w=S.dishes?.name||S.dish?.name||"Piatto",T=S.quantity||1,M=S.unit_price||0,E=S.total_price||T*M;return`
                            <div class="item flex justify-between mb-xs">
                              <div class="item-details">
                                <span class="item-quantity">${T} \xD7</span>
                                <span class="item-name ml-xs">${w}</span>
                              </div>
                              <div class="item-prices">
                                <span class="item-price font-semibold">\u20AC${E.toFixed(2)}</span>
                                ${T>1?`<small class="text-muted ml-xs">(\u20AC${M.toFixed(2)} l'uno)</small>`:""}
                              </div>
                            </div>
                          `}).join(""):'<em class="text-muted">Nessun piatto</em>'}
                    </div>
                    <div class="comanda-total flex justify-between mt-sm pt-sm border-t">
                      <span class="font-semibold">Totale comanda</span>
                      <span class="font-semibold text-primary">\u20AC${b.toFixed(2)}</span>
                    </div>
                  </div>
                `}).join("")||""}
              <div class="header-total flex justify-between mt-md pt-md border-t text-md">
                <span class="font-bold">Totale Ordine ${r+1}</span>
                <span class="font-bold text-primary">\u20AC${a.toFixed(2)}</span>
              </div>
            </div>
          `}).join("")}
      </div>

      <!-- TOTALE FINALE -->
      <div class="grand-total mt-lg p-lg bg-gradient text-white rounded-lg text-center">
        <div class="text-xl font-bold">TOTALE DA PAGARE</div>
        <div class="text-3xl font-bold mt-sm">\u20AC${this.calcolaTotaleTavolata().toFixed(2)}</div>
      </div>
    </div>
  `}getRestaurantName(){return this.currentRestaurant?.name||"Ristorante"}getRestaurantAddress(){return this.currentRestaurant?.address||""}getRestaurantPhone(){return this.currentRestaurant?.phone||""}getRestaurantEmail(){return this.currentRestaurant?.email||""}getCurrentRestaurantId(){return h(this,null,function*(){return yield this.tavolataService.getCurrentRestaurantId()})}checkMobileView(){this.mobileView=window.innerWidth<=768}isMobile(){return this.mobileView}showQuickAddFeedback(t){if(!this.mobileView)return;let e=document.createElement("div");e.innerHTML=`<div style="position:fixed;bottom:100px;left:50%;transform:translateX(-50%);background:var(--primary);color:white;padding:12px 24px;border-radius:24px;z-index:9999">\u2705 ${t} aggiunto!</div>`,document.body.appendChild(e),setTimeout(()=>e.remove(),1500)}getOrderItems(t){return(t||this.currentOrder)?.order_items||[]}getFilteredTables(){let t=this.tableStatuses;if(this.statusFilter!=="all"&&(t=t.filter(e=>e.status===this.statusFilter)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(r=>r.table.table_number.toLowerCase().includes(e)||r.table.table_name.toLowerCase().includes(e))}return t}getFilteredDishes(){let t=this.dishes;if(this.selectedCategory!=="all"&&(t=t.filter(e=>e.category_id===this.selectedCategory)),this.dishSearchTerm){let e=this.dishSearchTerm.toLowerCase();t=t.filter(r=>r.name.toLowerCase().includes(e))}return t}getTableClass(t){return`table-element shape-${t.table.shape} ${t.status} ${this.selectedTable?.id===t.table.id?"selected":""}`}getTableStyle(t){return{left:t.position_x+"px",top:t.position_y+"px",width:t.width+"px",height:t.height+"px","border-radius":t.shape==="circle"?"50%":"0px",transform:`rotate(${t.rotation}deg)`}}getDishName(t){return t.dish_name||t.dishes?.name||t.dish?.name||"Piatto"}getCurrentOrderTotal(){return this.getOrderItems().reduce((t,e)=>t+(e.total_price||0),0)}getTotalTavolata(){return this.calcolaTotaleTavolata()}calcolaTotaleTavolata(){return this.orderService.calculateTavolataTotal(this.orderHeaders)}calcolaTotaleOrderHeader(t){return this.orderService.calculateOrderHeaderTotal(t)}getOrderTotal(t){return this.orderService.calculateOrderTotal(t)}getStatusColorClass(t=""){return`status-${t}`}getStatusText(t=""){return{free:"Libero",reserved:"Prenotato",occupied:"Occupato"}[t]||t}hasOrders(){return(this.selectedTableStatus?.currentOrders?.length||0)>0}getComandeCount(){return this.selectedTableStatus?.currentOrders?.length||0}getComandeInCurrentOrderHeader(){return!this.currentOrderHeader?.orders||this.currentOrderHeader.orders.length===0?[]:[...this.currentOrderHeader.orders].sort((t,e)=>(t.comanda_number||0)-(e.comanda_number||0))}onOrderHeaderChange(t){if(this.currentOrderHeader=t,this.selectedOrderHeader=t,this.unsavedChanges=!1,t.orders&&t.orders.length>0){let e=t.orders.sort((r,a)=>(r.comanda_number||0)-(a.comanda_number||0));this.currentOrder=e[0]}else this.currentOrder=null}setCurrentComanda(t){return h(this,null,function*(){t&&(console.log(`\u{1F504} Cambio comanda: ${this.currentOrder?.comanda_number||"nessuna"} -> ${t.comanda_number}`),this.currentOrder=t,this.unsavedChanges=!1,yield this.refreshCurrentOrder())})}getTableOrderItemsCount(t){return this.getTotalOrderItems(t.currentOrders)}getTotalOrderItems(t){return t?t.reduce((e,r)=>e+(r.order_items?.length||0),0):0}getTotalComandeCount(){return this.orderHeaders.reduce((t,e)=>t+(e.orders?.length||0),0)}resetDishFilters(){this.selectedCategory="all",this.dishSearchTerm=""}getDishesCountByCategory(t){return t==="all"?this.dishes.length:this.dishes.filter(e=>e.category_id===t).length}getDishesGroupedByCategory(){let t=this.getFilteredDishes();if(t.length===0)return[];if(this.selectedCategory!=="all"){let r=this.categories.find(a=>a.id===this.selectedCategory);return r?[{category:r,dishes:t}]:[]}let e=new Map;return this.categories.forEach(r=>{e.set(r.id,{category:r,dishes:[]})}),e.set("no-category",{category:{id:"no-category",name:"Senza categoria",order_index:999},dishes:[]}),t.forEach(r=>{let a=r.category_id||"no-category";e.has(a)||e.set(a,{category:{id:a,name:"Categoria",order_index:998},dishes:[]}),e.get(a).dishes.push(r)}),Array.from(e.values()).filter(r=>r.dishes.length>0).sort((r,a)=>(r.category.order_index||0)-(a.category.order_index||0))}toggleOrderHeaderExpansion(t){this.orderHeadersExpanded[t]=!this.orderHeadersExpanded[t]}toggleOrderExpansion(t){this.ordersExpanded[t]=!this.ordersExpanded[t]}isOrderHeaderExpanded(t){return this.orderHeadersExpanded[t]||!1}isOrderExpanded(t){return this.ordersExpanded[t]||!1}getOverallOrderStatus(t){if(!t.order_items||t.order_items.length===0)return t.status||"received";let e=this.orderService.calculateOverallOrderStatus(t.order_items);return e==="served"&&this.orderService.areAllItemsServed(t)?"ready_for_bill":e}getOrderStatusText(t){return{waiting:"In Attesa",preparing:"In Preparazione",ready:"Pronto",served:"Servito",ready_for_bill:"Pronto per conto",out_of_stock:"Esaurito",received:"Ricevuto"}[t]||t}getOrderStatusColor(t){return{waiting:"warning",preparing:"preparing",ready:"success",served:"secondary",ready_for_bill:"success",out_of_stock:"danger",received:"info"}[t]||"secondary"}isReadyForBill(){let t=this.selectedTableStatus?.currentOrders||[];return t.length===0?!1:t.every(e=>this.orderService.areAllItemsServed(e))}getReadyForBillStatus(){return this.isReadyForBill()}toggleMoveSelect(t){this.showMoveSelectForItem=this.showMoveSelectForItem===t?null:t}isMoveSelectVisible(t){return this.showMoveSelectForItem===t}onFloorPlanSelect(t){this.currentFloorPlan=t,this.loadTablesForFloorPlan(),this.deselectTable()}safeToggleFullscreen(){return h(this,null,function*(){try{this.isFullscreen?yield this.exitFullscreen():yield this.enterFullscreen()}catch(t){console.error("Error toggling fullscreen:",t)}})}enterFullscreen(){return h(this,null,function*(){let t=this.mapCard?.nativeElement;t&&(t.requestFullscreen?yield t.requestFullscreen():t.webkitRequestFullscreen?yield t.webkitRequestFullscreen():t.msRequestFullscreen&&(yield t.msRequestFullscreen()),this.isFullscreen=!0)})}exitFullscreen(){return h(this,null,function*(){document.exitFullscreen?yield document.exitFullscreen():document.webkitExitFullscreen?yield document.webkitExitFullscreen():document.msExitFullscreen&&(yield document.msExitFullscreen()),this.isFullscreen=!1,document.body.classList.remove("table-map-fullscreen"),this.resetZoom()})}toggleSize(){this.isLargeText=!this.isLargeText}zoomIn(){this.zoomLevel=Math.min(this.zoomLevel*1.25,this.maxZoom)}zoomOut(){this.zoomLevel=Math.max(this.zoomLevel/1.25,this.minZoom)}resetZoom(){this.zoomLevel=1}getScaledWidth(){return(this.currentFloorPlan?.width||1e3)*this.zoomLevel}getScaledHeight(){return(this.currentFloorPlan?.height||800)*this.zoomLevel}loadAvailableReservations(){return h(this,null,function*(){try{yield this.floorManagementService.loadTodaysReservations(),this.availableReservationsWithoutTable=this.floorManagementService.getReservationsWithoutTable(),console.log("\u{1F50D} DEBUG Prenotazioni senza tavolo:",{count:this.availableReservationsWithoutTable.length,data:this.availableReservationsWithoutTable})}catch(t){console.error("\u274C Errore nel caricamento delle prenotazioni:",t)}})}openAssignReservationModal(){this.loadAvailableReservations(),this.showAssignReservationModal=!0,this.showQuickActionsModal=!1}closeAssignReservationModal(){this.showAssignReservationModal=!1,this.selectedReservationForAssignment=null}selectReservationForAssignment(t){this.selectedReservationForAssignment=t,this.assignmentReservation=t,this.showAssignReservationModal=!1,this.showTableAssignmentModal=!0,this.loadSuggestedTables(t)}loadSuggestedTables(t){return h(this,null,function*(){try{let e=yield this.floorManagementService.suggestTablesForReservation(t.id,t.party_size);this.suggestedTablesByFloorPlan={},e.forEach(a=>{let d=a.floor_plan_id;this.suggestedTablesByFloorPlan[d]||(this.suggestedTablesByFloorPlan[d]=[]),this.suggestedTablesByFloorPlan[d].push(a)});let r=Object.keys(this.suggestedTablesByFloorPlan);r.length>0&&(this.selectedFloorPlanForAssignment=r[0]),console.log("\u{1F4CA} Tavoli suggeriti raggruppati:",this.suggestedTablesByFloorPlan)}catch(e){console.error("\u274C Errore nel caricamento dei tavoli suggeriti:",e)}})}assignSelectedTableToReservation(t){return h(this,null,function*(){if(!this.selectedReservationForAssignment||!t)return;(yield this.floorManagementService.assignTableToReservation(this.selectedReservationForAssignment.id,t.id))?(alert(`\u2705 Tavolo ${t.table_number} assegnato a ${this.selectedReservationForAssignment.customer_name}`),yield this.loadData(),this.closeTableAssignmentModal(),this.deselectTable()):alert("\u274C Errore nell'assegnazione del tavolo")})}getFloorPlanName(t){return this.floorPlans.find(r=>r.id===t)?.name||`Mappa ${t.substring(0,4)}`}getFloorPlanKeys(){return Object.keys(this.suggestedTablesByFloorPlan)}getTotalSuggestedTables(){return Object.values(this.suggestedTablesByFloorPlan).reduce((t,e)=>t+(e?.length||0),0)}closeTableAssignmentModal(){this.showTableAssignmentModal=!1,this.assignmentReservation=null,this.suggestedTablesByFloorPlan={},this.selectedFloorPlanForAssignment=null}getCurrentDate(){return new Date().toLocaleDateString("it-IT",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}printBill(t){try{let e=window.open("","_blank");if(!e){alert("\u26A0\uFE0F Popup bloccato. Permetti i popup per stampare lo scontrino.");return}let r=new Date().toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});e.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Scontrino Tavolo ${this.selectedTable?.table_number||""}</title>
        <style>
          body { 
            font-family: 'Courier New', monospace;
            font-size: 10px;
            margin: 0;
            padding: 5px;
            width: 58mm; /* Larghezza scontrino termico */
          }
          .bill-preview {
            width: 100%;
          }
          .header { 
            text-align: center;
            margin-bottom: 10px;
            border-bottom: 1px dashed #000;
            padding-bottom: 5px;
          }
          .header h1 { 
            font-size: 12px;
            margin: 0 0 2px 0;
          }
          .header p { 
            margin: 1px 0;
            font-size: 9px;
          }
          .form-card {
            margin-bottom: 10px;
          }
          .section-title {
            font-weight: bold;
            text-align: center;
            margin-bottom: 5px;
            font-size: 10px;
          }
          .comanda { 
            margin-bottom: 8px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
          }
          .comanda-header {
            font-weight: bold;
            font-size: 10px;
            margin-bottom: 5px;
            text-align: center;
          }
          .item { 
            display: flex;
            justify-content: space-between;
            margin: 2px 0;
            font-size: 9px;
          }
          .comanda-total {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            border-top: 1px solid #000;
            margin-top: 5px;
            padding-top: 3px;
            font-size: 10px;
          }
          .header-total {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-top: 5px;
            font-size: 10px;
          }
          .grand-total {
            background-color: #000;
            color: white;
            padding: 8px;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
          }
          @media print {
            @page {
              margin: 0;
              size: 58mm auto;
            }
            body {
              margin: 0;
              -webkit-print-color-adjust: exact;
            }
          }
        </style>
      </head>
      <body onload="window.print(); window.close();">
        ${t}
      </body>
      </html>
    `),e.document.close()}catch(e){console.error("\u274C Errore stampa scontrino:",e),alert("Errore durante la stampa dello scontrino")}}handleAddDish(t,e){e.preventDefault(),e.stopPropagation(),this.addDishToCurrentOrder(t)}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=ae({type:s,selectors:[["app-table-map"]],viewQuery:function(e,r){if(e&1&&oe(Ne,5),e&2){let a;le(a=se())&&(r.mapCard=a.first)}},decls:154,vars:46,consts:[["mapContainer","","mapCard",""],["floorPlanCanvas",""],["reservationForm","ngForm"],["noDishes",""],["emptyOrder",""],["selectElem",""],["billPreviewContent",""],[1,"page-container"],[1,"section-header"],[1,"flex","gap-sm"],[1,"material-icons","fs-lg"],[1,"section-title"],[1,"text-muted"],[1,"grid-cards"],[1,"card"],[1,"flex","flex-col","gap-md"],[1,"flex","items-center","gap-sm","mb-md"],[1,"material-icons","text-primary","text-md"],[1,"card-title"],[1,"text-md","font-bold","text-primary","justify-center","flex"],[1,"form-card","flex-col","flex","gap-md"],[1,"flex","justify-between","items-center","m-sm02"],[1,"flex","items-center","gap-md"],[1,"flex"],[1,"text-muted","text-sm"],[1,"text-sm","text-muted"],["style","width: 100%; border-top: 1px dashed var(--secondary);",4,"ngIf"],["class","m-sm02",4,"ngIf"],[1,"form-card"],[1,"form-row"],[1,"form-group"],[1,"standard-label"],[1,"form-input",3,"ngModelChange","change","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-input",3,"ngModelChange","ngModel"],["value","all"],["value","free"],["value","reserved"],["value","occupied"],["type","text","placeholder","Numero o nome tavolo...",1,"form-input",3,"ngModelChange","ngModel"],[1,"modal-footer",2,"margin","0","justify-content","space-between"],[1,"flex","gap-md"],[1,"icon-button",3,"click","disabled"],[1,"material-icons"],[1,"flex","items-center","gap-sm","px-md","py-sm","justify-center"],[1,"material-icons","text-sm"],[1,"font-semibold"],[1,"icon-button",3,"click"],[1,"promethea-button","primary",3,"click"],[1,"form-card","mt-lg",2,"overflow","auto"],["class","fullscreen-header",4,"ngIf"],[1,"flex","justify-between","items-center","mb-md","flex-wrap"],[1,"flex","items-center","gap-sm"],[1,"flex","gap-sm","mr-md"],[1,"legend-color","free"],[1,"text-sm"],[1,"legend-color","reserved"],[1,"legend-color","occupied"],[1,"canvas-container"],[1,"canvas-wrapper"],[1,"floor-plan-canvas"],[1,"grid-overlay"],["class","table-element",3,"class","ngStyle","click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["class","modal-overlay",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[2,"width","100%","border-top","1px dashed var(--secondary)"],[1,"m-sm02"],[1,"flex","gap-sm","items-center","justify-between"],[1,"chip"],[1,"promethea-button",3,"click"],[3,"ngValue"],[1,"fullscreen-header"],[1,"font-bold","text-lg"],[1,"flex","items-center","gap-sm","bg-smoke","px-md","py-sm","rounded-full","min-w-32","justify-center"],[1,"form-input","text-sm",3,"ngModelChange","ngModel"],[1,"table-element",3,"click","ngStyle"],[1,"table-content"],[1,"table-number"],[1,"table-details"],[1,"table-capacity"],["class","table-info",4,"ngIf"],[1,"table-info"],[1,"empty-state"],[1,"modal-overlay"],[1,"modal-container","modal-sm"],[1,"modal-header"],[1,"header-icon"],[1,"p-lg"],[1,"flex","flex-col","gap-lg"],[1,"flex","justify-center"],["class","flex flex-col gap-sm",4,"ngIf"],["class","action-section",4,"ngIf"],["class","border-t border-[var(--smoke-1)] pt-md",4,"ngIf"],[1,"flex","flex-col","gap-sm"],[1,"promethea-button",3,"click","disabled","title"],[1,"action-section"],[1,"text-md","mb-sm"],[1,"promethea-button","secondary","btn-block",3,"click"],["class","current-assignment mt-sm p-sm bg-smoke rounded",4,"ngIf"],[1,"current-assignment","mt-sm","p-sm","bg-smoke","rounded"],[1,"flex","justify-between","items-center","mb-xs"],[1,"icon-button","x-small",3,"click"],[1,"promethea-button","success",3,"click"],[1,"promethea-button","ghost","flex-1",3,"click"],[1,"promethea-button","flex-1",3,"click"],[1,"promethea-button","primary",3,"click","disabled"],[1,"promethea-button","success",3,"click","disabled"],[1,"border-t","border-[var(--smoke-1)]","pt-md"],[1,"promethea-button","ghost","full-width",3,"click"],[1,"modal-container","modal-md"],[1,"generic-form",3,"ngSubmit"],["type","text","name","customer_name","required","","placeholder","Inserisci il nome del cliente",1,"form-input",3,"ngModelChange","ngModel"],["type","tel","name","customer_phone","required","","placeholder","Inserisci il telefono",1,"form-input",3,"ngModelChange","ngModel"],["type","date","name","reservation_date","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","time","name","reservation_time","required","",1,"form-input",3,"ngModelChange","ngModel"],["name","party_size","required","",1,"form-input",3,"ngModelChange","ngModel"],[3,"value","disabled",4,"ngFor","ngForOf"],[1,"text-muted","mt-sm"],["name","special_requests","rows","3","placeholder","Note o richieste speciali...",1,"form-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button",3,"disabled"],[3,"value","disabled"],[1,"flex","justify-between","items-center","w-full"],["type","button","class","promethea-button danger",3,"click",4,"ngIf"],["type","button",1,"promethea-button","danger",3,"click"],[1,"modal-container","modal-lg","fullscreen-mobile",3,"click"],[1,"modal-header","compact-header"],[1,"flex","items-center","gap-sm","flex-1"],[1,"flex","flex-col","flex-1"],[1,"section-title","text-md"],["class","chip active ml-sm",4,"ngIf"],[1,"flex","items-center","gap-sm","mt-xs"],[1,"text-muted","text-mini"],["class","form-input",3,"ngModel","ngModelChange",4,"ngIf"],["title","Chiudi",1,"icon-button",3,"click"],[1,"p-lg","mobile-scroll"],[1,"search-bar-mobile","mb-md"],[1,"form-group",2,"flex","3"],["type","text","placeholder","Cerca piatto...","autofocus","",1,"form-input","touch-target",3,"ngModelChange","ngModel"],[1,"form-group",2,"flex","1"],[1,"form-input","touch-target",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex",2,"margin-bottom","var(--gap-sm)"],[1,"grid-form"],[1,"quick-actions-mobile"],[1,"quick-action-button",3,"click"],[1,"text-mini"],["class","quick-action-button",3,"active","click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"form-card",2,"margin","0","padding","var(--gap-sm)"],[1,"flex","justify-between","items-center"],[1,"flex","items-center","gap-sm","font-semibold"],[1,"chip","active"],[1,"form-card",2,"margin","0","max-height","50vh","overflow-y","auto"],["title","Anteprima conto",1,"quick-action-button",3,"click","disabled"],[1,"quick-action-button",3,"click","disabled"],["class","form-card bg-primary-light border-primary border-l-4 mb-md",4,"ngIf"],[1,"modal-footer","mobile-footer"],[1,"promethea-button","ghost","flex-1","mobile-button",3,"click"],[1,"promethea-button","flex-1",3,"click","disabled"],[1,"promethea-button","primary","flex-1",3,"click","title"],["class","material-icons",4,"ngIf"],[4,"ngIf"],[1,"chip","active","ml-sm"],[3,"value"],[4,"ngFor","ngForOf"],[1,"flex","gap-sm","items-center"],[1,"font-bold","text-md"],[1,"material-icons","text-md"],[1,"font-bold","text-primary","text-md"],[1,"dishes-grid"],["class","card dish-card mobile-card",4,"ngFor","ngForOf"],[1,"card","dish-card","mobile-card"],[1,"flex","gap-sm","flex-col","flex-1"],[1,"dish-name"],[1,"dish-price","text-primary"],["class","text-muted text-mini",4,"ngIf"],[1,"flex","gap-sm","justify-end"],["title","Aggiungi 1",1,"icon-button","x-small",3,"click","disabled"],["class","material-icons animate-spin text-mini",4,"ngIf"],[1,"material-icons","animate-spin","text-mini"],[1,"promethea-button","ghost","mt-sm",3,"click"],["class","mb-sm pb-sm border-b border-[var(--smoke-1)] last:border-0",4,"ngFor","ngForOf"],[1,"mt-md","pt-md","border-t","border-[var(--smoke-1)]"],[1,"flex","justify-between","items-center","mb-sm"],[1,"text-md"],[1,"text-primary","text-md"],["class","flex justify-between items-center",4,"ngIf"],[1,"mb-sm","pb-sm","border-b","border-[var(--smoke-1)]","last:border-0"],[1,"flex","justify-between","items-start","gap-sm"],["title","Riduci quantit\xE0",1,"icon-button","x-small",3,"click","disabled"],[1,"font-bold","px-2","text-center","text-sm"],["title","Aumenta quantit\xE0",1,"icon-button","x-small",3,"click","disabled"],["title","Elimina piatto",1,"icon-button","x-small","ml-1","text-danger",3,"click","disabled"],["class","icon-button x-small ml-1 text-secondary","title","Sposta piatto in altra comanda",3,"click",4,"ngIf"],["class","mt-sm",4,"ngIf"],["title","Sposta piatto in altra comanda",1,"icon-button","x-small","ml-1","text-secondary",3,"click"],[1,"mt-sm"],[1,"form-input","text-mini",2,"padding","6px 8px","width","100%","padding-right","35px",3,"change","click"],["value","","disabled","","selected",""],[1,"text-secondary"],[1,"empty-state","py-lg"],[1,"material-icons","text-lg"],[1,"text-muted","text-mini","mt-xs"],[1,"form-card","bg-primary-light","border-primary","border-l-4","mb-md"],[1,"flex","items-center","gap-sm","mb-sm"],[1,"flex-1"],[1,"text-primary"],[1,"grid","grid-cols-2","gap-sm"],[1,"modal-container","modal-lg"],[1,"flex","items-center","gap-sm","mt-sm"],["class","form-card",4,"ngFor","ngForOf"],["class","form-card mt-md bg-gradient text-white",4,"ngIf"],[1,"modal-footer","mt-lg"],[1,"flex","flex-wrap","gap-sm","w-full"],[1,"promethea-button","success","flex-1",3,"click","disabled"],[1,"promethea-button","primary","flex-1",3,"click"],[1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"flex","items-center","gap-md","flex-1"],[1,"flex","flex-col"],[1,"chip","small"],[1,"flex","flex-col","items-end"],["class","mt-md pt-md border-t border-[var(--smoke-1)]",4,"ngIf"],["class","mb-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mt-lg","pt-lg","border-t"],[1,"text-primary","text-lg"],[1,"mb-lg"],[1,"flex","justify-between","items-center","cursor-pointer","mb-sm","p-sm","rounded","bg-smoke",3,"click"],[1,"material-icons","text-secondary"],[1,"chip","small",3,"ngClass"],[1,"font-bold"],["class","mt-sm p-sm",4,"ngIf"],[1,"mt-sm","p-sm"],["class","space-y-sm",4,"ngIf"],["class","empty-state py-md",4,"ngIf"],[1,"space-y-sm"],["class","flex justify-between items-start p-sm border-b last:border-0",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-start","p-sm","border-b","last:border-0"],[1,"flex","items-start","gap-sm"],[1,"chip","x-small","mt-1",3,"ngClass"],["class","mt-xs",4,"ngIf"],[1,"flex","items-center","gap-sm","mt-xs","text-sm","text-muted"],[1,"mt-xs"],[1,"empty-state","py-md"],[1,"form-card","mt-md","bg-gradient","text-white"],[1,"text-white"],[1,"text-white","text-sm","opacity-80"],[1,"text-white","text-xl"],[1,"modal-overlay",3,"click"],[1,"modal-container","modal-lg",3,"click"],[3,"innerHTML"],[1,"promethea-button","ghost",3,"click"],[1,"modal-container","modal-md",3,"click"],["class","grid-form",4,"ngIf"],["class","card reservation-card clickable",3,"click",4,"ngFor","ngForOf"],[1,"card","reservation-card","clickable",3,"click"],[1,"flex","justify-between","items-start","mb-sm"],[1,"chip","secondary"],[1,"material-icons","text-primary"],[1,"reservation-details"],[1,"detail"],[1,"label"],[1,"value"],["class","detail",4,"ngIf"],["class","detail full-width",4,"ngIf"],[1,"detail","full-width"],[1,"form-card","mb-lg"],[1,"flex","items-center","gap-md","mb-md"],[1,"avatartondo"],[1,"grid","grid-cols-2","gap-sm","text-sm"],["class","flex gap-sm",4,"ngIf"],[1,"flex","justify-between","items-center","mb-md"],["class","form-input text-sm","style","max-width: 200px;",3,"ngModel","ngModelChange",4,"ngIf"],[1,"info-message"],[1,"text-sm","text-muted","mt-sm"],[1,"promethea-button","secondary",3,"click"],[1,"form-input","text-sm",2,"max-width","200px",3,"ngModelChange","ngModel"],["class","card table-suggestion-card clickable",3,"click",4,"ngFor","ngForOf"],[1,"card","table-suggestion-card","clickable",3,"click"],[1,"flex","flex-col","items-center","text-center"],[1,"table-suggestion-icon"],[1,"mt-sm","flex","flex-col","gap-sm","items-center",2,"width","100%"],[1,"text-md","font-bold"],[1,"chip",2,"max-width","fit-content"],[1,"card-footer"],[1,"promethea-button","btn-block"],[1,"flex","gap-sm","mb-md"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"],[1,"ml-xs"],[1,"text-mini","text-muted"],[1,"text-muted","text-sm","mt-xs"]],template:function(e,r){if(e&1){let a=x();i(0,"div",7)(1,"div",8)(2,"div",9)(3,"span",10),o(4,"brunch_dining"),n(),i(5,"h1",11),o(6,"Prenotazioni Tavoli"),n()(),i(7,"p",12),o(8,"Gestisci prenotazioni e ordini in tempo reale"),n()(),i(9,"div",13)(10,"div",14)(11,"div",15)(12,"div",16)(13,"span",17),o(14,"event_available"),n(),i(15,"div",18),o(16,"Tavoli Liberi"),n()(),i(17,"div",19),o(18),n()()(),i(19,"div",14)(20,"div",15)(21,"div",16)(22,"span",17),o(23,"event"),n(),i(24,"div",18),o(25,"Prenotati"),n()(),i(26,"div",19),o(27),n()()(),i(28,"div",14)(29,"div",15)(30,"div",16)(31,"span",17),o(32,"restaurant"),n(),i(33,"div",18),o(34,"Occupati"),n()(),i(35,"div",19),o(36),n()()(),i(37,"div",14)(38,"div",15)(39,"div",16)(40,"span",17),o(41,"table_restaurant"),n(),i(42,"div",18),o(43,"Tavoli Totali"),n()(),i(44,"div",19),o(45),n()()(),i(46,"div",14)(47,"div",15)(48,"div",16)(49,"span",17),o(50,"receipt"),n(),i(51,"div",18),o(52,"Pronti per conto"),n()(),i(53,"div",19),o(54),n()()()(),i(55,"div",20)(56,"div",21)(57,"div",22)(58,"div",23),o(59),n(),i(60,"div",24),o(61),n()(),i(62,"div",25),o(63," \u23F0 Si pu\xF2 ordinare 1h prima/dopo il turno "),n()(),g(64,qe,1,0,"div",26)(65,Le,11,1,"div",27),n(),i(66,"div",28)(67,"div",29)(68,"div",30)(69,"label",31),o(70,"Mappa"),n(),i(71,"select",32),O("ngModelChange",function(b){return u(a),C(r.currentFloorPlan,b)||(r.currentFloorPlan=b),p(b)}),_("change",function(){return u(a),p(r.onFloorPlanSelect(r.currentFloorPlan))}),g(72,je,2,2,"option",33),n()(),i(73,"div",30)(74,"label",31),o(75,"Stato"),n(),i(76,"select",34),O("ngModelChange",function(b){return u(a),C(r.statusFilter,b)||(r.statusFilter=b),p(b)}),i(77,"option",35),o(78,"Tutti gli stati"),n(),i(79,"option",36),o(80,"Libero"),n(),i(81,"option",37),o(82,"Prenotato"),n(),i(83,"option",38),o(84,"Occupato"),n()()(),i(85,"div",30)(86,"label",31),o(87,"Cerca"),n(),i(88,"input",39),O("ngModelChange",function(b){return u(a),C(r.searchTerm,b)||(r.searchTerm=b),p(b)}),n()(),i(89,"div",30)(90,"label",31),o(91,"Azioni"),n(),i(92,"div",40)(93,"div",41)(94,"button",42),_("click",function(){return u(a),p(r.zoomOut())}),i(95,"span",43),o(96,"zoom_out"),n()(),i(97,"div",44)(98,"span",45),o(99,"search"),n(),i(100,"span",46),o(101),n()(),i(102,"button",42),_("click",function(){return u(a),p(r.zoomIn())}),i(103,"span",43),o(104,"zoom_in"),n()(),i(105,"button",47),_("click",function(){return u(a),p(r.resetZoom())}),i(106,"span",43),o(107,"history"),n()()(),i(108,"button",48),_("click",function(){return u(a),p(r.loadData())}),i(109,"span",43),o(110,"refresh"),n(),o(111," Aggiorna "),n()()()()(),i(112,"div",49,0),g(115,Ze,23,6,"div",50),i(116,"div",51)(117,"h2",46),o(118),n(),i(119,"div",52)(120,"div",53)(121,"div",52),H(122,"div",54),i(123,"span",55),o(124,"Libero"),n()(),i(125,"div",52),H(126,"div",56),i(127,"span",55),o(128,"Prenotato"),n()(),i(129,"div",52),H(130,"div",57),i(131,"span",55),o(132,"Occupato"),n()()(),i(133,"button",47),_("click",function(){return u(a),p(r.safeToggleFullscreen())}),i(134,"span",43),o(135),n()(),i(136,"button",47),_("click",function(){return u(a),p(r.toggleSize())}),i(137,"span",43),o(138),n()()()(),i(139,"div",58)(140,"div",59)(141,"div",60,1),H(143,"div",61),g(144,Ue,11,9,"div",62)(145,Ye,7,0,"div",63),n()(),g(146,ot,23,9,"div",64)(147,st,52,11,"div",64)(148,mt,55,12,"div",64)(149,qt,100,40,"div",64)(150,ei,42,12,"div",64)(151,ti,27,3,"div",65)(152,li,21,3,"div",65)(153,bi,65,13,"div",65),n()()()}e&2&&(l(18),f(r.globalFreeTablesCount),l(9),f(r.globalReservedTablesCount),l(9),f(r.globalOccupiedTablesCount),l(9),f(r.globalTotalTablesCount),l(9),f(r.globalReadyForBillTablesCount),l(4),q(r.getShiftStatusClass()),l(),v(" ",r.getShiftStatusText()," "),l(2),v(" ",r.orderingStatus.reason," "),l(3),m("ngIf",r.pendingAssignmentsCount>0),l(),m("ngIf",r.pendingAssignmentsCount>0),l(6),y("ngModel",r.currentFloorPlan),l(),m("ngForOf",r.floorPlans),l(4),y("ngModel",r.statusFilter),l(12),y("ngModel",r.searchTerm),l(6),m("disabled",r.zoomLevel<=r.minZoom),l(7),v("",(r.zoomLevel*100).toFixed(0),"%"),l(),m("disabled",r.zoomLevel>=r.maxZoom),l(13),m("ngIf",r.isFullscreen),l(3),f(r.currentFloorPlan?r.currentFloorPlan.name:"Mappa"),l(15),D("active",r.isFullscreen),l(2),v(" ",r.isFullscreen?"fullscreen_exit":"fullscreen"," "),l(3),v(" ",r.isLargeText?"text_decrease":"text_increase"," "),l(2),K("width",r.getScaledWidth(),"px")("height",r.getScaledHeight(),"px"),l(),K("width",r.currentFloorPlan?r.currentFloorPlan.width:1e3,"px")("height",r.currentFloorPlan?r.currentFloorPlan.height:800,"px")("transform","scale("+r.zoomLevel+")")("transform-origin","0 0"),l(3),m("ngForOf",r.getFilteredTables()),l(),m("ngIf",r.getFilteredTables().length===0),l(),m("ngIf",r.showQuickActionsModal),l(),m("ngIf",r.showManualReservationModal),l(),m("ngIf",r.showEditReservationModal),l(),m("ngIf",r.showCreateOrderModal),l(),m("ngIf",r.showOrderDetailsModal),l(),m("ngIf",r.showBillPreviewModal),l(),m("ngIf",r.showAssignReservationModal),l(),m("ngIf",r.showTableAssignmentModal))},dependencies:[ge,de,ce,me,ue,Me,Se,ye,Ce,he,we,be,xe,Oe,Te,fe,ve,_e,pe],styles:[".fullscreen-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1000;background:var(--background);padding:var(--gap-sm);display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;border-bottom:1px solid var(--smoke-1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);gap:var(--gap-sm)}.fullscreen-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--fs-md)!important;margin:0;flex:1;min-width:120px}.table-map-fullscreen[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]{position:absolute!important;inset:70px 0 0!important;height:auto!important;max-height:none!important;min-height:auto!important;border:none!important;margin-top:0!important;border-radius:0!important;padding:var(--gap-md)!important;overflow:auto!important;-webkit-overflow-scrolling:touch!important}.table-map-fullscreen[_ngcontent-%COMP%]   .canvas-wrapper[_ngcontent-%COMP%]{width:auto!important;height:auto!important}.table-map-fullscreen[_ngcontent-%COMP%]   .floor-plan-canvas[_ngcontent-%COMP%]{transform-origin:0 0!important}.canvas-container[_ngcontent-%COMP%]{position:relative;width:100%;min-height:400px;max-height:80vh;border:2px solid var(--smoke-1);border-radius:12px;background-color:var(--background);overflow:auto!important;-webkit-overflow-scrolling:touch!important;padding:var(--gap-sm);box-sizing:border-box}.canvas-wrapper[_ngcontent-%COMP%]{position:relative;min-width:100%;min-height:100%}.floor-plan-canvas[_ngcontent-%COMP%]{position:relative;background-color:var(--background);box-shadow:0 4px 12px var(--smoke-1);border-radius:8px;transform-origin:0 0;transition:transform .2s ease-out}@media (max-width: 768px){.chip.active.ml-sm[_ngcontent-%COMP%]{display:none}.canvas-container[_ngcontent-%COMP%]{min-height:400px;max-height:80vh;overflow:auto!important;-webkit-overflow-scrolling:touch!important;touch-action:pan-x pan-y!important;display:block}}.table-map-fullscreen[_ngcontent-%COMP%]   .floor-plan-canvas[_ngcontent-%COMP%]{display:block!important;width:max-content!important;height:max-content!important;min-width:100%!important;min-height:100%!important;margin:auto!important;transform-origin:center center;transition:transform .2s ease-out;background:var(--background)}@media (max-width: 768px){.fullscreen-header[_ngcontent-%COMP%]{padding:var(--gap-sm)}.table-map-fullscreen[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]{top:80px}}.icon-button[disabled][_ngcontent-%COMP%]{opacity:.4;cursor:not-allowed}.quick-actions-mobile[_ngcontent-%COMP%]{display:flex!important;gap:var(--gap-sm)!important;overflow-x:auto!important;padding-bottom:var(--gap-sm)!important;-webkit-overflow-scrolling:touch!important;scrollbar-width:none!important}.quick-actions-mobile[_ngcontent-%COMP%]::-webkit-scrollbar{display:none!important}.quick-action-button[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;align-items:center!important;justify-content:center!important;padding:var(--gap-sm)!important;min-width:80px!important;border:1px solid var(--smoke-1)!important;border-radius:12px!important;background:var(--background)!important;transition:all .2s ease!important;cursor:pointer!important;flex-shrink:0!important}.quick-action-button[_ngcontent-%COMP%]:hover, .quick-action-button[_ngcontent-%COMP%]:active{background:var(--smoke-1)!important;border-color:var(--primary)!important}.quick-action-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:var(--fs-md)!important;margin-bottom:4px!important}.dish-card[_ngcontent-%COMP%]{border:1px solid var(--smoke-1)!important;border-radius:12px!important;padding:var(--gap-sm);background:var(--background);transition:none;cursor:pointer!important}.dish-card[_ngcontent-%COMP%]:hover, .dish-card[_ngcontent-%COMP%]:active{transform:translateY(-2px)!important;border-color:var(--primary)!important;box-shadow:0 4px 12px var(--smoke-2)!important}.dish-card.mobile-card[_ngcontent-%COMP%]{margin-bottom:var(--gap-sm)!important}.dish-name[_ngcontent-%COMP%]{font-weight:600!important;font-size:var(--fs-sm)!important;line-height:1.3!important;color:var(--text-color)!important}.dish-price[_ngcontent-%COMP%]{font-weight:700!important;font-size:var(--fs-sm)!important;color:var(--primary)!important}.bill-preview[_ngcontent-%COMP%]{background:var(--background);color:var(--text-color);max-height:70vh;overflow-y:auto;padding:var(--gap-lg)}.bill-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:var(--gap-lg);padding-bottom:var(--gap-md);border-bottom:2px solid var(--smoke-1)}.bill-preview[_ngcontent-%COMP%]   .comanda[_ngcontent-%COMP%]{background:var(--vetro);border:1px solid var(--smoke-1);border-radius:12px;margin-bottom:var(--gap-md);transition:all .3s ease}.bill-preview[_ngcontent-%COMP%]   .comanda[_ngcontent-%COMP%]:hover{border-color:var(--secondary);box-shadow:0 4px 12px var(--smoke-2)}.bill-preview[_ngcontent-%COMP%]   .comanda-header[_ngcontent-%COMP%]{color:var(--text-color);font-weight:600;border-bottom:1px solid var(--smoke-1);padding-bottom:var(--gap-sm);margin-bottom:var(--gap-sm)}.bill-preview[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:calc(var(--gap-sm) / 2) 0;border-bottom:1px dashed var(--smoke-1)}.bill-preview[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{border-bottom:none}.bill-preview[_ngcontent-%COMP%]   .comanda-total[_ngcontent-%COMP%]{color:var(--primary);font-weight:600;margin-top:var(--gap-sm);padding-top:var(--gap-sm)}.bill-preview[_ngcontent-%COMP%]   .header-total[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 10%,transparent);padding:var(--gap-sm);border-radius:8px;margin-top:var(--gap-md)}.bill-preview[_ngcontent-%COMP%]   .grand-total[_ngcontent-%COMP%]{background:var(--gradiente);color:#fff;padding:var(--gap-lg);border-radius:16px;margin-top:var(--gap-lg);box-shadow:0 8px 24px var(--shadow-2)}@media print{.bill-preview[_ngcontent-%COMP%]   .grand-total[_ngcontent-%COMP%]{background:#000!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.modal-footer[_ngcontent-%COMP%]{display:none!important}}.canvas-wrapper[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.legend-color[_ngcontent-%COMP%]{width:var(--fs-md);height:var(--fs-sm);display:flex;border-radius:var(--gap-sm)}.legend-color.free[_ngcontent-%COMP%]{background:#10b981}.legend-color.reserved[_ngcontent-%COMP%]{background:#f59e0b}.legend-color.occupied[_ngcontent-%COMP%]{background:#ef4444}.legend-color.merged[_ngcontent-%COMP%]{background:#ff6b35}.detail[_ngcontent-%COMP%]{display:flex;gap:var(--gap-sm)}.table-suggestion-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gap-sm);padding:var(--gap-sm)}.table-suggestion-icon[_ngcontent-%COMP%]{font-size:var(--fs-md)}"]})};export{$e as TableMap};
