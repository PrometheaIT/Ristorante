import{a as pe}from"./chunk-5IUMXHBR.js";import{a as ue}from"./chunk-BHA4RY6H.js";import{a as Y,b as Z,c as b,d as ee,e as te,h as ie,i as ne,m as re,p as oe,q as ae,r as se,s as le,w as ce,x as de,y as me}from"./chunk-PZ6IGEMS.js";import{b as K}from"./chunk-F35UPSG6.js";import{b as J}from"./chunk-4GBXVLF4.js";import"./chunk-37GYPR4T.js";import{j as H,k as Q,s as X}from"./chunk-PWZZTUE6.js";import{$a as f,Ab as B,Bb as G,Cb as W,D as z,Da as T,Eb as E,Fb as q,Ga as c,Gb as U,H as N,Hb as a,Ib as P,Jb as y,Kb as D,Nb as R,Ob as M,Pb as V,Sb as C,T as I,Wa as L,ba as w,f as O,ha as u,hb as d,ia as p,ib as o,jb as i,kb as S,qb as x,tb as g,vb as m,zb as $}from"./chunk-DU5L5MFQ.js";import{a as A,b as j,j as v}from"./chunk-4ZZIO3ZI.js";var he=["fileInput"],fe=()=>[1,2,3,4,5,6,7,8],F=()=>({standalone:!0});function _e(s,t){if(s&1&&(o(0,"option",62),a(1),i()),s&2){let e=t.$implicit;d("value",e),c(),P(e)}}function ve(s,t){if(s&1&&(o(0,"option",62),a(1),i()),s&2){let e=t.$implicit;d("value",e),c(),y(" ",e," ")}}function xe(s,t){if(s&1&&(o(0,"option",62),a(1),i()),s&2){let e=t.$implicit;d("value",e.code),c(),y(" ",e.name," ")}}function Se(s,t){s&1&&(o(0,"div",63)(1,"span",16),a(2,"info"),i(),a(3," Nessuna provincia disponibile per questa regione "),i())}function ye(s,t){s&1&&(o(0,"div",64)(1,"span",16),a(2,"info"),i(),a(3," Seleziona prima una regione "),i())}function be(s,t){if(s&1){let e=x();o(0,"button",76),g("click",function(){u(e);let r=m().index,l=m();return p(l.deleteShift(r))}),o(1,"span",16),a(2,"delete"),i()()}}function we(s,t){if(s&1&&(o(0,"span",69),a(1),i()),s&2){let e=t.$implicit,n=t.index,r=m().$implicit,l=m();E("active",l.isDaySelected(r.days_of_week,n)),c(),y(" ",e," ")}}function Ee(s,t){if(s&1){let e=x();o(0,"div",65)(1,"div",66)(2,"div",49)(3,"h3",67),a(4),i(),o(5,"div",68)(6,"span",69)(7,"span",70),a(8,"access_time"),i(),a(9),i(),o(10,"span",69),a(11),i()()(),o(12,"div",4)(13,"button",71),g("click",function(){let r=u(e).index,l=m();return p(l.toggleShiftActive(r))}),o(14,"span",16),a(15),i()(),o(16,"button",72),g("click",function(){let r=u(e).index,l=m();return p(l.editShift(r))}),o(17,"span",16),a(18,"edit"),i()(),f(19,be,3,0,"button",73),i()(),o(20,"div",74),f(21,we,2,3,"span",75),i()()}if(s&2){let e=t.$implicit,n=m();c(4),P(e.name),c(5),D(" ",e.start_time.substring(0,5)," - ",e.end_time.substring(0,5)," "),c(),U(e.is_active?"active":"warning"),c(),y(" ",e.is_active?"Attivo":"Disattivato"," "),c(2),E("text-green-500",!e.is_active)("text-orange-500",e.is_active),d("title",e.is_active?"Disattiva turno":"Attiva turno"),c(2),y(" ",e.is_active?"pause":"play_arrow"," "),c(4),d("ngIf",n.shifts.length>1),c(2),d("ngForOf",n.weekDays)}}function Pe(s,t){if(s&1){let e=x();o(0,"button",50),g("click",function(){u(e);let r=m();return p(r.addNewShift())}),o(1,"span",16),a(2,"add"),i(),a(3," Aggiungi Nuovo Turno "),i()}}function Ce(s,t){if(s&1&&S(0,"img",77),s&2){let e=m();d("src",e.logoPreview,T)}}function ke(s,t){s&1&&(o(0,"span",78),a(1," add_a_photo "),i())}function Ie(s,t){if(s&1){let e=x();o(0,"button",79),g("click",function(){u(e);let r=m();return p(r.removeLogo())}),o(1,"span",16),a(2,"delete"),i(),a(3," Rimuovi Logo "),i()}}function Re(s,t){if(s&1&&(o(0,"option",98),a(1),i()),s&2){let e=t.$implicit,n=m(2).$implicit;d("value",e)("selected",(n==null?null:n.display_order)===e),c(),y(" ",e," ")}}function Me(s,t){if(s&1){let e=x();o(0,"div",94)(1,"label",95),a(2,"Posizione:"),i(),o(3,"select",96),g("change",function(r){u(e);let l=m().index,h=m(2);return p(h.onPhotoOrderChange(l,r))}),f(4,Re,2,3,"option",97),i()()}if(s&2){let e=m(3);c(3),d("disabled",e.loadingPhotos),c(),d("ngForOf",C(2,fe))}}function Ve(s,t){if(s&1){let e=x();o(0,"div",99)(1,"img",100),g("error",function(r){u(e);let l=m().index,h=m(2);return p(h.onImageError(r,l))}),i(),o(2,"div",101)(3,"span",16),a(4,"zoom_in"),i()()()}if(s&2){let e=m().$implicit;c(),d("src",e.url,T)("alt","Foto "+e.display_order)}}function Te(s,t){if(s&1&&(o(0,"div",102)(1,"span",103),a(2,"add_photo_alternate"),i(),o(3,"p",104),a(4),i()()),s&2){let e=m().index;c(4),y("Slot ",e+1," vuoto")}}function Fe(s,t){if(s&1){let e=x();o(0,"button",105),g("click",function(){u(e);let r=m().index,l=m(2);return p(l.deletePhoto(r))}),o(1,"span",16),a(2,"delete"),i()()}if(s&2){let e=m(3);d("disabled",e.loadingPhotos)}}function Oe(s,t){if(s&1){let e=x();o(0,"div",85)(1,"div",86)(2,"div",69),a(3),i(),f(4,Me,5,3,"div",87),i(),o(5,"div",88),g("click",function(){let r=u(e),l=r.$implicit,h=r.index,_=m(2);return p(l?_.openPhoto(l,h):null)}),f(6,Ve,5,2,"div",89)(7,Te,5,1,"div",90),i(),o(8,"div",91)(9,"button",92),g("click",function(){let r=u(e).index,l=m(2);return p(l.triggerFileInput(r))}),o(10,"span",16),a(11),i()(),f(12,Fe,3,1,"button",93),i()()}if(s&2){let e=t.$implicit,n=t.index,r=m(2);c(3),P(n+1),c(),d("ngIf",e),c(),q(e?"border: 2px solid var(--smoke-2); background: transparent;":"border: 2px dashed var(--smoke-1); background: var(--smoke-1);"),E("has-photo",e),c(),d("ngIf",e),c(),d("ngIf",!e),c(2),d("title",e?"Sostituisci foto":"Aggiungi foto")("disabled",r.loadingPhotos),c(2),P(e?"camera_alt":"add_a_photo"),c(),d("ngIf",e)}}function ze(s,t){s&1&&(o(0,"div",106),S(1,"div",107),o(2,"p",7),a(3,"Caricamento in corso..."),i()())}function Ne(s,t){if(s&1){let e=x();o(0,"div",9)(1,"div",31)(2,"span",11),a(3,"photo_library"),i(),o(4,"h2",12),a(5,"Galleria Foto del Ristorante"),i()(),o(6,"p",80),a(7," Carica fino a 5 foto (max 10MB ciascuna) per mostrare il tuo ristorante ai clienti. Solo immagini sono permesse. "),i(),o(8,"input",81,1),g("change",function(r){u(e);let l=m();return p(l.onPhotoFileSelected(r))}),i(),o(10,"div",82)(11,"div",32),f(12,Oe,13,12,"div",83),i(),f(13,ze,4,0,"div",84),i()()}if(s&2){let e=m();c(8),d("disabled",e.loadingPhotos),c(2),E("loading",e.loadingPhotos),c(2),d("ngForOf",e.photos)("ngForTrackBy",e.trackByIndex),c(),d("ngIf",e.loadingPhotos)}}function De(s,t){if(s&1){let e=x();o(0,"button",120),g("click",function(r){return u(e),m(2).navigateFullscreenPhoto("prev"),p(r.stopPropagation())}),o(1,"span",16),a(2,"chevron_left"),i()()}}function Ae(s,t){if(s&1){let e=x();o(0,"button",121),g("click",function(r){return u(e),m(2).navigateFullscreenPhoto("next"),p(r.stopPropagation())}),o(1,"span",16),a(2,"chevron_right"),i()()}}function je(s,t){if(s&1&&(o(0,"div",122),a(1),i()),s&2){let e=m(2);c(),D(" ",e.currentPhotoIndex+1," / ",e.photos.length," ")}}function Le(s,t){if(s&1){let e=x();o(0,"div",108),g("click",function(){u(e);let r=m();return p(r.closeFullscreenPhoto())}),o(1,"div",109),g("click",function(r){return u(e),p(r.stopPropagation())}),o(2,"div",110)(3,"h2",111)(4,"span",16),a(5,"photo"),i(),a(6," Galleria Foto "),i(),o(7,"button",112),g("click",function(){u(e);let r=m();return p(r.closeFullscreenPhoto())}),o(8,"span",16),a(9,"close"),i()()(),o(10,"div",113)(11,"div",114),f(12,De,3,0,"button",115),o(13,"div",116),S(14,"img",117),i(),f(15,Ae,3,0,"button",118)(16,je,2,2,"div",119),i()()()()}if(s&2){let e=m();c(12),d("ngIf",e.hasMultiplePhotos),c(2),d("src",e.fullscreenPhoto,T)("alt","Foto galleria "+(e.currentPhotoIndex||0)),c(),d("ngIf",e.hasMultiplePhotos),c(),d("ngIf",e.currentPhotoIndex!==null)}}function $e(s,t){s&1&&(o(0,"span",16),a(1,"sync"),i())}function Be(s,t){s&1&&(o(0,"span",16),a(1,"save"),i())}function Ge(s,t){s&1&&(o(0,"span"),a(1,"Salvataggio..."),i())}function We(s,t){s&1&&(o(0,"span"),a(1,"Salva Impostazioni"),i())}function qe(s,t){if(s&1){let e=x();o(0,"label",33)(1,"input",131),g("change",function(r){let l=u(e).index,h=m(2);return p(h.toggleCurrentShiftDay(l,r))}),i(),o(2,"div",36)(3,"strong"),a(4),i()()()}if(s&2){let e=t.$implicit,n=t.index,r=m(2);c(),d("checked",r.isDaySelected(r.currentShift.days_of_week,n)),c(3),P(e)}}function Ue(s,t){if(s&1){let e=x();o(0,"div",108),g("click",function(){u(e);let r=m();return p(r.closeShiftModal())}),o(1,"div",123),g("click",function(r){return u(e),p(r.stopPropagation())}),o(2,"div",110)(3,"h2",124)(4,"span",16),a(5,"schedule"),i(),a(6),i(),o(7,"button",112),g("click",function(){u(e);let r=m();return p(r.closeShiftModal())}),o(8,"span",16),a(9,"close"),i()()(),o(10,"div",125)(11,"div",9)(12,"div",10)(13,"label",15)(14,"span",16),a(15,"badge"),i(),a(16," Nome Turno * "),i(),o(17,"input",126),V("ngModelChange",function(r){u(e);let l=m();return M(l.currentShift.name,r)||(l.currentShift.name=r),p(r)}),i()(),o(18,"div",10)(19,"div",14)(20,"label",15)(21,"span",16),a(22,"schedule"),i(),a(23," Ora Inizio * "),i(),o(24,"input",127),V("ngModelChange",function(r){u(e);let l=m();return M(l.currentShift.start_time,r)||(l.currentShift.start_time=r),p(r)}),i()(),o(25,"div",14)(26,"label",15)(27,"span",16),a(28,"schedule"),i(),a(29," Ora Fine * "),i(),o(30,"input",127),V("ngModelChange",function(r){u(e);let l=m();return M(l.currentShift.end_time,r)||(l.currentShift.end_time=r),p(r)}),i()()(),o(31,"div",10)(32,"label",33)(33,"input",128),V("ngModelChange",function(r){u(e);let l=m();return M(l.currentShift.is_active,r)||(l.currentShift.is_active=r),p(r)}),i(),o(34,"div",36)(35,"strong"),a(36,"Turno attivo"),i(),o(37,"div",7),a(38,"Il turno sar\xE0 disponibile per le prenotazioni"),i()()()(),o(39,"div",49)(40,"label",15)(41,"span",16),a(42,"event"),i(),a(43," Giorni Attivi * "),i(),o(44,"div",32),f(45,qe,5,2,"label",129),i()()()(),o(46,"div",55)(47,"button",50),g("click",function(){u(e);let r=m();return p(r.closeShiftModal())}),o(48,"span",16),a(49,"close"),i(),a(50," Annulla "),i(),o(51,"button",130),g("click",function(){u(e);let r=m();return p(r.saveShift())}),o(52,"span",16),a(53,"save"),i(),a(54),i()()()()}if(s&2){let e=m();c(6),y(" ",e.editingShift==="new"?"Aggiungi Nuovo Turno":"Modifica Turno"," "),c(11),R("ngModel",e.currentShift.name),d("ngModelOptions",C(12,F)),c(7),R("ngModel",e.currentShift.start_time),d("ngModelOptions",C(13,F)),c(6),R("ngModel",e.currentShift.end_time),d("ngModelOptions",C(14,F)),c(3),R("ngModel",e.currentShift.is_active),d("ngModelOptions",C(15,F)),c(12),d("ngForOf",e.weekDays),c(6),d("disabled",!e.isCurrentShiftValid()),c(3),y(" ",e.editingShift==="new"?"Aggiungi Turno":"Salva Modifiche"," ")}}var ge=class s{settingsForm;loading=!1;loadingPhotos=!1;restaurantId;showShiftModal=!1;editingShift=null;currentSlotIndex=null;fullscreenPhoto=null;currentPhotoIndex=null;canManagePhotos=!1;provinces=[];regions=[];filteredProvinces=[];shifts=[];photos=Array(8).fill(null);logoPreview;coverPreview;weekDays=["Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato","Domenica"];cuisineTypes=["Italiana","Giapponese","Cinese","Indiana","Messicana","Francese","Spagnola","Thailandese","Greca","Americana","Vegetariana","Vegana"];fileInput;fb=w(ce);supabaseService=w(J);shiftService=w(pe);geographyService=w(ue);auth=w(K);destroy$=new O;supabaseClient=this.supabaseService.getSupabaseClient();autoSaveTrigger=new O;currentShift=this.createEmptyShift();ngOnInit(){this.initForm(),this.setupSubscriptions(),this.loadInitialData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initForm(){this.settingsForm=this.fb.group({name:["",[b.required,b.minLength(2)]],description:[""],address:["",b.required],phone:["",[b.required,b.pattern(/^[\+\d\s\-\(\)]{8,20}$/)]],email:["",[b.required,b.email]],cuisine_type:[""],region:[""],province:[""],accepts_delivery:[!1],accepts_takeaway:[!1],allow_table_selection:[!1],is_active:[!0]})}setupSubscriptions(){this.shiftService.shifts$.pipe(I(this.destroy$)).subscribe(t=>{this.shifts=t,this.triggerAutoSave()}),this.settingsForm.valueChanges.pipe(I(this.destroy$),N(1500),z(()=>this.settingsForm.valid&&!!this.restaurantId)).subscribe(()=>{this.autoSaveChanges()}),this.autoSaveTrigger.pipe(I(this.destroy$),N(1e3),z(()=>!!this.restaurantId)).subscribe(()=>{this.autoSaveChanges()})}triggerAutoSave(){this.autoSaveTrigger.next()}loadInitialData(){return v(this,null,function*(){this.loading=!0;try{yield Promise.all([this.loadProvinces(),this.loadRestaurantData()])}catch(t){console.error("Errore caricamento iniziale:",t),alert("Errore durante il caricamento dei dati: "+t.message)}finally{this.loading=!1}})}loadRestaurantData(){return v(this,null,function*(){let t=this.auth.currentUserValue;if(!t)throw new Error("Utente non loggato");let{data:e,error:n}=yield this.supabaseClient.from("restaurants").select("*").eq("owner_id",t.id).single();if(n)throw n;if(!e)throw new Error("Ristorante non trovato");this.restaurantId=e.id,this.patchForm(e),this.logoPreview=e.logo_url||void 0,this.coverPreview=e.cover_image_url||void 0,this.restaurantId&&(this.canManagePhotos=this.auth.hasPermission("manage_restaurant_settings"),this.canManagePhotos&&(yield this.loadRestaurantPhotos()))})}loadProvinces(){return v(this,null,function*(){return new Promise((t,e)=>{this.geographyService.getFilteredProvinces().pipe(I(this.destroy$)).subscribe({next:n=>{this.provinces=n,this.regions=[...new Set(n.map(l=>l.region))].filter(l=>l!=="Tutte").sort();let r=this.settingsForm.get("region")?.value;r&&this.filterProvincesByRegion(r),t()},error:e})})})}loadRestaurantPhotos(){return v(this,null,function*(){if(this.restaurantId){this.loadingPhotos=!0;try{let t=yield this.supabaseService.getRestaurantPhotos(this.restaurantId);this.photos=Array(8).fill(null),t.forEach(e=>{let n=e.display_order-1;if(n>=0&&n<8){if(!e.url&&e.file_path){let{data:{publicUrl:r}}=this.supabaseClient.storage.from("restaurant-images").getPublicUrl(e.file_path);e.url=r}this.photos[n]=e}})}catch(t){console.error("Errore caricamento foto:",t)}finally{this.loadingPhotos=!1}}})}patchForm(t){let e=t.province,n="";if(e&&this.provinces.length>0){let r=this.provinces.find(l=>l.code===e);r&&(n=r.region,this.filterProvincesByRegion(n))}this.settingsForm.patchValue({name:t.name,description:t.description||"",address:t.address,phone:t.phone,email:t.email,cuisine_type:t.cuisine_type||"",region:n,province:e||"",accepts_delivery:t.accepts_delivery,accepts_takeaway:t.accepts_takeaway,allow_table_selection:t.allow_table_selection,is_active:t.is_active})}filterProvincesByRegion(t){this.filteredProvinces=t?this.provinces.filter(e=>e.region===t):[],t||this.settingsForm.patchValue({province:""})}createEmptyShift(){return{name:"",start_time:"12:00",end_time:"15:00",days_of_week:[1,2,3,4,5,6,7],is_active:!0}}addNewShift(){this.editingShift="new",this.currentShift=this.createEmptyShift(),this.showShiftModal=!0}editShift(t){this.editingShift=t,this.currentShift={name:this.shifts[t].name,start_time:this.shifts[t].start_time,end_time:this.shifts[t].end_time,days_of_week:[...this.shifts[t].days_of_week],is_active:this.shifts[t].is_active},this.showShiftModal=!0}saveShift(){return v(this,null,function*(){if(!(!this.isCurrentShiftValid()||!this.restaurantId)){this.loading=!0;try{if(this.editingShift==="new")yield this.shiftService.createShift(this.currentShift),alert("Turno creato con successo!");else if(typeof this.editingShift=="number"){let t=this.shifts[this.editingShift].id;yield this.shiftService.updateShift(t,this.currentShift),alert("Turno aggiornato con successo!")}this.triggerAutoSave(),this.closeShiftModal()}catch(t){alert("Errore salvataggio turno: "+t.message),console.error(t)}finally{this.loading=!1}}})}deleteShift(t){return v(this,null,function*(){if(!confirm("Sei sicuro di voler eliminare questo turno?"))return;let e=this.shifts[t].id;if(e){this.loading=!0;try{yield this.shiftService.deleteShift(e),alert("Turno eliminato con successo!"),this.triggerAutoSave()}catch(n){alert("Errore eliminazione turno: "+n.message),console.error(n)}finally{this.loading=!1}}})}toggleShiftActive(t){return v(this,null,function*(){let e=this.shifts[t],n=!e.is_active;if(confirm(`Sei sicuro di voler ${n?"attivare":"disattivare"} il turno "${e.name}"?`)){this.loading=!0;try{yield this.shiftService.updateShift(e.id,{is_active:n}),alert(`Turno "${e.name}" ${n?"attivato":"disattivato"} con successo!`),this.triggerAutoSave()}catch(r){alert(`Errore: ${r.message}`),console.error(r)}finally{this.loading=!1}}})}onPhotoFileSelect(t,e){return v(this,null,function*(){if(this.restaurantId){if(t.size>10*1024*1024){alert("File troppo grande (max 10MB)");return}if(!t.type.startsWith("image/")){alert("Solo file immagine sono permessi");return}this.loadingPhotos=!0;try{let n=e+1,r=yield this.supabaseService.uploadRestaurantPhoto(this.restaurantId,t,n);if(!r)throw new Error("Upload fallito");let l=yield this.supabaseService.saveRestaurantPhotoRecord({restaurant_id:this.restaurantId,file_path:r.filePath,display_order:n});if(!l)throw new Error("Salvataggio record fallito");this.photos[e]=j(A({},l),{url:r.publicUrl}),this.triggerAutoSave(),alert(`Foto ${n} caricata con successo!`)}catch(n){console.error("Errore upload foto:",n),alert("Errore durante l'upload: "+n.message)}finally{this.loadingPhotos=!1}}})}deletePhoto(t){return v(this,null,function*(){if(!this.restaurantId)return;let e=this.photos[t];if(!(!e||!confirm("Sei sicuro di voler eliminare questa foto?"))){this.loadingPhotos=!0;try{yield this.supabaseService.deleteRestaurantPhoto(e.id,e.file_path),this.photos[t]=null,this.triggerAutoSave(),alert("Foto eliminata con successo!")}catch(n){console.error("Errore eliminazione foto:",n),alert("Errore durante l'eliminazione: "+n.message)}finally{this.loadingPhotos=!1}}})}onFileSelect(t,e){return v(this,null,function*(){let n=t.target;if(!n.files?.length||!this.restaurantId)return;let r=n.files[0],l=5*1024*1024;if(r.size>l){alert("Immagine troppo grande (max 5MB)");return}let h=`restaurants/${this.restaurantId}/${e}s/${Date.now()}_${r.name}`;this.loading=!0;try{let{error:_}=yield this.supabaseClient.storage.from("restaurant-images").upload(h,r,{upsert:!0});if(_)throw _;let{data:{publicUrl:k}}=this.supabaseClient.storage.from("restaurant-images").getPublicUrl(h);e==="logo"?this.logoPreview=k:this.coverPreview=k,yield this.autoSaveChanges(),alert(`${e==="logo"?"Logo":"Copertina"} caricata!`)}catch(_){alert("Errore upload: "+_.message),console.error(_)}finally{this.loading=!1}})}autoSaveChanges(){return v(this,null,function*(){if(!(this.settingsForm.invalid||!this.restaurantId))try{yield this.saveFormData(),console.log("\u2705 Salvataggio automatico completato")}catch(t){console.error("\u274C Errore salvataggio automatico:",t)}})}onSubmit(){return v(this,null,function*(){if(!(this.settingsForm.invalid||!this.restaurantId)){this.loading=!0;try{yield this.saveFormData(),alert("Impostazioni salvate con successo!")}catch(t){console.error("\u274C Errore salvataggio:",t),alert("Errore durante il salvataggio: "+t.message)}finally{this.loading=!1}}})}saveFormData(){return v(this,null,function*(){let t=this.settingsForm.value,e={name:t.name,description:t.description||null,address:t.address,phone:this.cleanPhoneNumber(t.phone),email:t.email,cuisine_type:t.cuisine_type||null,province:t.province||null,accepts_delivery:t.accepts_delivery,accepts_takeaway:t.accepts_takeaway,allow_table_selection:t.allow_table_selection,is_active:t.is_active,updated_at:new Date().toISOString()};this.logoPreview&&(e.logo_url=this.logoPreview),this.coverPreview&&(e.cover_image_url=this.coverPreview);let{error:n}=yield this.supabaseClient.from("restaurants").update(e).eq("id",this.restaurantId);if(n)throw n})}cleanPhoneNumber(t){return t?t.startsWith("+")?"+"+t.substring(1).replace(/\D/g,""):t.replace(/\D/g,""):""}toggleRestaurantActive(){return v(this,null,function*(){if(!this.restaurantId)return;let t=this.settingsForm.get("is_active")?.value,e=!t;if(!t&&!confirm(`Sei sicuro di voler disattivare il ristorante?

I clienti non potranno pi\xF9 vederlo n\xE9 effettuare ordini fino a quando non lo riattiverai.`)){this.settingsForm.patchValue({is_active:e},{emitEvent:!1});return}this.loading=!0;try{let{error:n}=yield this.supabaseClient.from("restaurants").update({is_active:t,updated_at:new Date().toISOString()}).eq("id",this.restaurantId);if(n)throw n;this.triggerAutoSave(),alert(t?"Ristorante riattivato! Ora \xE8 visibile ai clienti.":"Ristorante disattivato correttamente.")}catch(n){alert("Errore: "+n.message),this.settingsForm.patchValue({is_active:e},{emitEvent:!1})}finally{this.loading=!1}})}onPhotoFileSelected(t){let e=t.target;if(!e.files?.length||this.currentSlotIndex===null||!this.restaurantId)return;let n=e.files[0],r=this.currentSlotIndex;this.currentSlotIndex=null,e.value="",this.onPhotoFileSelect(n,r)}onPhotoOrderChange(t,e){return v(this,null,function*(){let n=e.target,r=Number(n.value);if(r<1||r>8){alert("Ordine non valido. Deve essere tra 1 e 8.");let _=this.photos[t];_&&(n.value=_.display_order.toString());return}let l=this.photos[t];if(!l){alert("Nessuna foto in questo slot");return}if(l.display_order===r)return;let h=l.display_order;try{this.loadingPhotos=!0;let _=this.photos.find(k=>k&&k.display_order===r);_?(yield Promise.all([this.supabaseService.updatePhotoOrder(l.id,r),this.supabaseService.updatePhotoOrder(_.id,h)]),l.display_order=r,_.display_order=h):(yield this.supabaseService.updatePhotoOrder(l.id,r),l.display_order=r),this.reorganizePhotosByOrder(),this.triggerAutoSave(),console.log("\u2705 Ordine aggiornato nel database e localmente")}catch(_){console.error("\u274C Errore aggiornamento ordine:",_),alert("Errore durante l'aggiornamento: "+_.message),n.value=h.toString(),l.display_order=h}finally{this.loadingPhotos=!1}})}onImageError(t,e){let n=t.target;console.error(`Errore caricamento immagine slot ${e}:`,n.src),n.style.display="none";let r=n.parentElement;if(r){let l=document.createElement("div");l.className="error-placeholder",l.style.cssText="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: var(--danger); font-size: 12px;",l.textContent="Errore caricamento",r.appendChild(l)}}triggerFileInput(t){this.currentSlotIndex=t,this.fileInput.nativeElement.click()}navigateFullscreenPhoto(t){if(this.currentPhotoIndex===null||!this.photos)return;let e=t==="next"?this.currentPhotoIndex+1:this.currentPhotoIndex-1;e<0&&(e=this.photos.length-1),e>=this.photos.length&&(e=0);let n=!1,r=0;for(;!n&&r<this.photos.length;){let l=this.photos[e];l?.url?(this.fullscreenPhoto=l.url,this.currentPhotoIndex=e,n=!0):(e=t==="next"?e+1:e-1,e<0&&(e=this.photos.length-1),e>=this.photos.length&&(e=0),r++)}}isCurrentShiftValid(){return!!(this.currentShift?.name&&this.currentShift?.start_time&&this.currentShift?.end_time&&this.currentShift?.days_of_week?.length>0)}reorganizePhotosByOrder(){let t=this.photos.filter(n=>n!==null).sort((n,r)=>n.display_order-r.display_order),e=Array(8).fill(null);t.forEach(n=>{let r=n.display_order-1;r>=0&&r<8&&(e[r]=n)}),this.photos=e}closeShiftModal(){this.showShiftModal=!1,this.editingShift=null}openPhoto(t,e){t?.url&&(this.fullscreenPhoto=t.url,this.currentPhotoIndex=e)}closeFullscreenPhoto(){this.fullscreenPhoto=null,this.currentPhotoIndex=null}onRegionChange(t){let n=t.target.value;this.filterProvincesByRegion(n)}onProvinceChange(t){let n=t.target.value;if(n){let r=this.provinces.find(l=>l.code===n);r&&(this.settingsForm.patchValue({region:r.region}),this.filterProvincesByRegion(r.region))}else this.settingsForm.patchValue({region:""}),this.filteredProvinces=[]}toggleCurrentShiftDay(t,e){let n=e.target.checked,r=t+1;n?this.currentShift.days_of_week.includes(r)||this.currentShift.days_of_week.push(r):this.currentShift.days_of_week=this.currentShift.days_of_week.filter(l=>l!==r)}isDaySelected(t,e){let n=e+1;return t.includes(n)}trackByIndex(t){return t}get loadedPhotosCount(){return this.photos.filter(t=>t!==null).length}get hasMultiplePhotos(){return this.loadedPhotosCount>1}removeLogo(){return v(this,null,function*(){if(this.restaurantId&&confirm("Sei sicuro di voler rimuovere il logo?")){this.loading=!0;try{let{error:t}=yield this.supabaseClient.from("restaurants").update({logo_url:null,updated_at:new Date().toISOString()}).eq("id",this.restaurantId);if(t)throw t;this.logoPreview=void 0,this.triggerAutoSave(),alert("Logo rimosso con successo!")}catch(t){alert("Errore durante la rimozione: "+t.message),console.error(t)}finally{this.loading=!1}}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=L({type:s,selectors:[["app-restaurant-settings"]],viewQuery:function(e,n){if(e&1&&$(he,5),e&2){let r;B(r=G())&&(n.fileInput=r.first)}},decls:172,vars:23,consts:[["logoInput",""],["fileInput",""],[1,"page-container"],[1,"section-header"],[1,"flex","gap-sm"],[1,"material-icons","fs-lg"],[1,"section-title"],[1,"text-muted"],[1,"flex","flex-col","gap-sm",3,"ngSubmit","formGroup"],[1,"form-card"],[1,"form-row","mb-md"],[1,"material-icons","text-md"],[1,"text-md","font-semibold","m-0"],[1,"form-row","mb-sm"],[1,"form-group"],[1,"standard-label"],[1,"material-icons"],["type","text","formControlName","name","placeholder","Es: Trattoria da Mario"],["type","email","formControlName","email","placeholder","info@ristorante.it"],["type","tel","formControlName","phone","placeholder","+39 123 456 7890"],["formControlName","cuisine_type"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-row","mt-sm"],["formControlName","region",1,"standard-select",3,"change"],["formControlName","province",1,"standard-select",3,"change","disabled"],["class","text-warning text-mini mt-sm",4,"ngIf"],["class","text-muted text-mini mt-sm",4,"ngIf"],[1,"form-group","mt-sm"],["type","text","formControlName","address","placeholder","Via Roma 123, Milano"],["formControlName","description","rows","3","placeholder","Racconta la storia del tuo ristorante..."],[1,"flex","items-center","gap-sm","mb-md"],[1,"grid-cards"],[1,"checkbox-label"],[1,"checkbox-grid"],["type","checkbox","formControlName","accepts_delivery"],[1,"checkbox-content"],["type","checkbox","formControlName","accepts_takeaway"],["type","checkbox","formControlName","allow_table_selection"],["type","checkbox","formControlName","is_active",3,"change"],[1,"flex","flex-col","gap-md"],["class","shift-item",4,"ngFor","ngForOf"],["type","button","class","promethea-button ghost",3,"click",4,"ngIf"],[1,"form-row"],["type","file","accept","image/*",2,"display","none",3,"change"],[1,"flex","items-center","gap-md","flex-wrap"],[1,"logo-preview-container",2,"width","120px","height","120px","border","2px dashed var(--smoke-2)","border-radius","12px","display","flex","align-items","center","justify-content","center","overflow","hidden","background","var(--smoke-1)"],["alt","Logo","style","max-width: 100%; max-height: 100%; object-fit: contain;",3,"src",4,"ngIf"],["class","material-icons","style","font-size: 48px; color: var(--smoke-3);",4,"ngIf"],[1,"flex","flex-col","gap-sm"],["type","button",1,"promethea-button","ghost",3,"click"],["type","button","class","promethea-button ghost","style","color: var(--danger);",3,"click",4,"ngIf"],[1,"text-mini","text-muted"],["class","form-card",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-footer"],["type","submit",1,"promethea-button",3,"disabled"],["class","material-icons",4,"ngIf"],[4,"ngIf"],[1,"footer"],["href","https://www.prometheasrl.it/","target","_blank",1,"footer-link"],["src","logo.png",1,"logopromethea"],[3,"value"],[1,"text-warning","text-mini","mt-sm"],[1,"text-muted","text-mini","mt-sm"],[1,"shift-item"],[1,"flex","justify-between","items-start","mb-sm","p-sm"],[1,"font-semibold"],[1,"flex","flex-wrap","gap-sm"],[1,"chip"],[1,"material-icons","text-sm"],["type","button",1,"icon-button",3,"click","title"],["type","button","title","Modifica turno",1,"icon-button",3,"click"],["type","button","class","icon-button","title","Elimina turno",3,"click",4,"ngIf"],[1,"flex","flex-wrap","gap-sm","mt-sm","p-sm0"],["class","chip",3,"active",4,"ngFor","ngForOf"],["type","button","title","Elimina turno",1,"icon-button",3,"click"],["alt","Logo",2,"max-width","100%","max-height","100%","object-fit","contain",3,"src"],[1,"material-icons",2,"font-size","48px","color","var(--smoke-3)"],["type","button",1,"promethea-button","ghost",2,"color","var(--danger)",3,"click"],[1,"text-muted","mb-md"],["type","file","accept","image/*",2,"display","none",3,"change","disabled"],[1,"gallery-container"],["class","card",4,"ngFor","ngForOf","ngForTrackBy"],["style","position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.9); z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center;",4,"ngIf"],[1,"card"],[1,"flex","flex-wrap","justify-between","items-center","mb-sm"],["class","order-selector flex items-center gap-sm",4,"ngIf"],[1,"photo-preview","rounded-lg","border","transition","cursor-pointer","mb-sm",2,"min-height","150px","display","flex","align-items","center","justify-content","center","overflow","hidden","position","relative",3,"click"],["class","w-full h-full",4,"ngIf"],["class","empty-photo-slot flex flex-col items-center justify-center p-md",4,"ngIf"],[1,"card-footer","gap-sm"],["type","button",1,"icon-button","x-small",3,"click","title","disabled"],["type","button","class","icon-button x-small","title","Elimina foto","style","color: var(--primary);",3,"disabled","click",4,"ngIf"],[1,"order-selector","flex","items-center","gap-sm"],[1,"text-mini"],[1,"text-mini",3,"change","disabled"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"],[1,"w-full","h-full"],[2,"width","100%","height","100%","object-fit","cover","border-radius","8px",3,"error","src","alt"],[1,"photo-hover-overlay"],[1,"empty-photo-slot","flex","flex-col","items-center","justify-center","p-md"],[1,"material-icons","empty-icon",2,"font-size","48px","color","var(--smoke-3)","margin-bottom","8px"],[1,"text-sm","text-muted"],["type","button","title","Elimina foto",1,"icon-button","x-small",2,"color","var(--primary)",3,"click","disabled"],[2,"position","absolute","top","0","left","0","right","0","bottom","0","background","rgba(255,255,255,0.9)","z-index","10","display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"spinner",2,"width","40px","height","40px","border","3px solid var(--smoke-1)","border-top-color","var(--primary)","border-radius","50%","animation","spin 1s linear infinite","margin-bottom","var(--gap-sm)"],[1,"modal-overlay",3,"click"],[1,"modal-container","modal-lg",3,"click"],[1,"modal-header"],[1,"text-md","font-semibold","m-0","flex","items-center","gap-sm"],[1,"icon-button",3,"click"],[1,"modal-content","p-lg","flex","items-center","justify-center",2,"min-height","60vh"],[2,"position","relative","width","100%","height","100%","display","flex","align-items","center","justify-content","center"],["style","position: absolute; left: 0; z-index: 20; background: var(--smoke-2); margin: 0 var(--gap-sm);","class","icon-button",3,"click",4,"ngIf"],[2,"max-width","64rem","max-height","70vh","display","flex","align-items","center","justify-content","center"],[2,"max-width","100%","max-height","70vh","object-fit","contain","border-radius","12px",3,"src","alt"],["style","position: absolute; right: 0; z-index: 20; background: var(--smoke-2); margin: 0 var(--gap-sm);","class","icon-button",3,"click",4,"ngIf"],["style","position: absolute; bottom: 1rem; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); color: white; padding: 0.25rem 1rem; border-radius: 999px; font-size: 0.875rem;",4,"ngIf"],[1,"icon-button",2,"position","absolute","left","0","z-index","20","background","var(--smoke-2)","margin","0 var(--gap-sm)",3,"click"],[1,"icon-button",2,"position","absolute","right","0","z-index","20","background","var(--smoke-2)","margin","0 var(--gap-sm)",3,"click"],[2,"position","absolute","bottom","1rem","left","50%","transform","translateX(-50%)","background","rgba(0,0,0,0.7)","color","white","padding","0.25rem 1rem","border-radius","999px","font-size","0.875rem"],[1,"modal-container",3,"click"],[1,"section-title","m-0"],[1,"modal-content"],["type","text","placeholder","Es: Pranzo, Cena","autofocus","",3,"ngModelChange","ngModel","ngModelOptions"],["type","time",3,"ngModelChange","ngModel","ngModelOptions"],["type","checkbox",3,"ngModelChange","ngModel","ngModelOptions"],["class","checkbox-label",4,"ngFor","ngForOf"],["type","button",1,"promethea-button",3,"click","disabled"],["type","checkbox",3,"change","checked"]],template:function(e,n){if(e&1){let r=x();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"span",5),a(4,"settings"),i(),o(5,"h1",6),a(6,"Impostazioni Ristorante"),i()(),o(7,"p",7),a(8,"Gestisci le informazioni e i servizi del tuo ristorante"),i()(),o(9,"form",8),g("ngSubmit",function(){return u(r),p(n.onSubmit())}),o(10,"div",9)(11,"div",10)(12,"span",11),a(13,"info"),i(),o(14,"h2",12),a(15,"Informazioni Base"),i()(),o(16,"div",13)(17,"div",14)(18,"label",15)(19,"span",16),a(20,"restaurant"),i(),a(21," Nome Ristorante * "),i(),S(22,"input",17),i()(),o(23,"div",13)(24,"div",14)(25,"label",15)(26,"span",16),a(27,"email"),i(),a(28," Email * "),i(),S(29,"input",18),i(),o(30,"div",14)(31,"label",15)(32,"span",16),a(33,"phone"),i(),a(34," Telefono * "),i(),S(35,"input",19),i()(),o(36,"div",14)(37,"label",15)(38,"span",16),a(39,"local_dining"),i(),a(40," Tipo di Cucina "),i(),o(41,"select",20)(42,"option",21),a(43,"Seleziona..."),i(),f(44,_e,2,2,"option",22),i()(),o(45,"div",23)(46,"div",14)(47,"label",15)(48,"span",16),a(49,"public"),i(),a(50," Regione "),i(),o(51,"select",24),g("change",function(h){return u(r),p(n.onRegionChange(h))}),o(52,"option",21),a(53,"Seleziona Regione"),i(),f(54,ve,2,2,"option",22),i()(),o(55,"div",14)(56,"label",15)(57,"span",16),a(58,"map"),i(),a(59," Provincia "),i(),o(60,"select",25),g("change",function(h){return u(r),p(n.onProvinceChange(h))}),o(61,"option",21),a(62,"Seleziona Provincia"),i(),f(63,xe,2,2,"option",22),i(),f(64,Se,4,0,"div",26)(65,ye,4,0,"div",27),i()(),o(66,"div",28)(67,"label",15)(68,"span",16),a(69,"location_on"),i(),a(70," Indirizzo * "),i(),S(71,"input",29),i(),o(72,"div",10)(73,"label",15)(74,"span",16),a(75,"description"),i(),a(76," Descrizione "),i(),S(77,"textarea",30),i()(),o(78,"div",9)(79,"div",31)(80,"span",11),a(81,"room_service"),i(),o(82,"h2",12),a(83,"Servizi Offerti"),i()(),o(84,"div",32)(85,"label",33)(86,"div",34),S(87,"input",35),i(),o(88,"div",36)(89,"strong"),a(90,"Consegna a domicilio"),i(),o(91,"div",7),a(92,"I clienti possono ordinare con consegna"),i()()(),o(93,"label",33)(94,"div",34),S(95,"input",37),i(),o(96,"div",36)(97,"strong"),a(98,"Asporto"),i(),o(99,"div",7),a(100,"I clienti possono ritirare in loco"),i()()(),o(101,"label",33)(102,"div",34),S(103,"input",38),i(),o(104,"div",36)(105,"strong"),a(106,"Prenotazione tavolo"),i(),o(107,"div",7),a(108,"I clienti possono scegliere il tavolo"),i()()()()(),o(109,"div",9)(110,"div",31)(111,"span",11),a(112,"visibility"),i(),o(113,"h2",12),a(114,"Stato Ristorante"),i()(),o(115,"label",33)(116,"div",34)(117,"input",39),g("change",function(){return u(r),p(n.toggleRestaurantActive())}),i()(),o(118,"div",36)(119,"strong"),a(120,"Ristorante attivo"),i(),o(121,"div",7),a(122,"Visibile ai clienti e accettazione ordini"),i()()()(),o(123,"div",9)(124,"div",31)(125,"span",11),a(126,"schedule"),i(),o(127,"h2",12),a(128,"Turni di Lavoro"),i()(),o(129,"div",40),f(130,Ee,22,14,"div",41)(131,Pe,4,0,"button",42),i()(),o(132,"div",9)(133,"div",31)(134,"span",11),a(135,"image"),i(),o(136,"h2",12),a(137,"Logo Ristorante"),i()(),o(138,"div",43)(139,"div",14)(140,"label",15)(141,"span",16),a(142,"upload"),i(),a(143," Carica Logo "),i(),o(144,"input",44,0),g("change",function(h){return u(r),p(n.onFileSelect(h,"logo"))}),i(),o(146,"div",45)(147,"div",46),f(148,Ce,1,1,"img",47)(149,ke,2,0,"span",48),i(),o(150,"div",49)(151,"button",50),g("click",function(){u(r);let h=W(145);return p(h.click())}),o(152,"span",16),a(153,"cloud_upload"),i(),a(154),i(),f(155,Ie,4,0,"button",51),o(156,"span",52),a(157," Formati: JPG, PNG, WEBP. Max 5MB. "),i()()()()()(),f(158,Ne,14,6,"div",53)(159,Le,17,5,"div",54),o(160,"div",55)(161,"button",56),f(162,$e,2,0,"span",57)(163,Be,2,0,"span",57)(164,Ge,2,0,"span",58)(165,We,2,0,"span",58),i()()(),o(166,"div",59)(167,"a",60)(168,"div"),a(169,"Powered by"),i(),S(170,"img",61),i()()(),f(171,Ue,55,16,"div",54)}if(e&2){let r,l;c(9),d("formGroup",n.settingsForm),c(35),d("ngForOf",n.cuisineTypes),c(10),d("ngForOf",n.regions),c(6),d("disabled",!n.filteredProvinces.length),c(3),d("ngForOf",n.filteredProvinces),c(),d("ngIf",!n.filteredProvinces.length&&((r=n.settingsForm.get("region"))==null?null:r.value)),c(),d("ngIf",!((l=n.settingsForm.get("region"))!=null&&l.value)),c(65),d("ngForOf",n.shifts),c(),d("ngIf",n.editingShift===null),c(16),E("has-logo",n.logoPreview),c(),d("ngIf",n.logoPreview),c(),d("ngIf",!n.logoPreview),c(5),y(" ",n.logoPreview?"Sostituisci":"Carica"," Logo "),c(),d("ngIf",n.logoPreview),c(3),d("ngIf",n.canManagePhotos),c(),d("ngIf",n.fullscreenPhoto),c(2),d("disabled",n.loading||n.settingsForm.invalid),c(),d("ngIf",n.loading),c(),d("ngIf",!n.loading),c(),d("ngIf",n.loading),c(),d("ngIf",!n.loading),c(6),d("ngIf",n.showShiftModal)}},dependencies:[X,H,Q,me,ne,se,le,Z,Y,ae,ee,te,re,oe,de,ie],styles:[".shift-item[_ngcontent-%COMP%]{padding:var(--gap-md);border:1px solid var(--smoke-1);border-radius:12px;transition:all .2s ease}.shift-item[_ngcontent-%COMP%]:hover{border-color:var(--secondary);background:var(--smoke-1)}.shift-form[_ngcontent-%COMP%]{border:2px solid var(--smoke-2)}.chip.warning[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 20%,transparent);color:#f59e0b}.text-green-500[_ngcontent-%COMP%]{color:#10b981}.text-orange-500[_ngcontent-%COMP%]{color:#f59e0b}.material-icons[_ngcontent-%COMP%]{transition:all .2s ease}@media (max-width: 768px){.shift-item[_ngcontent-%COMP%]{padding:var(--gap-sm)}.shift-item[_ngcontent-%COMP%]   .flex-wrap[_ngcontent-%COMP%]{justify-content:flex-start}}@media (max-width: 480px){.grid-form[_ngcontent-%COMP%]{grid-template-columns:1fr}.md\\\\[_ngcontent-%COMP%]:col-span-2{grid-column:1}}.gallery-container[_ngcontent-%COMP%]{position:relative;min-height:300px}.photo-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}.photo-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block;border-radius:8px}.photo-hover-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease;border-radius:8px;pointer-events:none}.photo-preview[_ngcontent-%COMP%]:hover   .photo-hover-overlay[_ngcontent-%COMP%]{opacity:1}.photo-hover-overlay[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#fff;font-size:2rem}.empty-photo-slot[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--text-muted);padding:var(--gap-lg)}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:var(--gap-sm);opacity:.5}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffffe6;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--smoke-1);border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:var(--gap-sm)}.nav-button[_ngcontent-%COMP%]{background:var(--smoke-2);margin:0 var(--gap-sm)}.nav-button[_ngcontent-%COMP%]:hover{background:var(--smoke-3)}.photo-counter[_ngcontent-%COMP%]{background:#000000b3;color:#fff;padding:.25rem 1rem;border-radius:999px;font-size:.875rem}@media (max-width: 768px){.grid-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))!important}.photo-preview[_ngcontent-%COMP%]{min-height:120px!important}}.logopromethea[_ngcontent-%COMP%]{height:var(--fs-lg);width:auto}.footer[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:center;padding-top:var(--gap-lg);margin-top:var(--fs-lg)}.footer-link[_ngcontent-%COMP%]{text-decoration:none;font-weight:800;display:flex;gap:var(--gap-sm);align-items:center}"]})};export{ge as RestaurantSettings};
