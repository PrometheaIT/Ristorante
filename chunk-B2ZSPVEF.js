import{b as d}from"./chunk-ISGJYCJJ.js";import{b as c}from"./chunk-NPOGW2A3.js";import{V as s,_ as o}from"./chunk-UNLQURJ5.js";import{j as n}from"./chunk-4ZZIO3ZI.js";var u=class i{supabase=o(c).getSupabaseClient();authService=o(d);kitchenTransitions={ordered:["waiting","out_of_stock"],waiting:["preparing","ready","out_of_stock"],preparing:["ready","out_of_stock"],ready:["out_of_stock"],out_of_stock:[]};waiterTransitions={ordered:["waiting","cancelled"],waiting:["preparing","cancelled"],preparing:["ready","cancelled"],ready:["served","cancelled"],served:[],cancelled:["ordered"]};canTransitionItem(t,r,e){return console.log(`\u{1F50D} Verifica transizione: ${t} \u2192 ${r} (${e})`),t===r?!1:r==="out_of_stock"?!0:((e==="kitchen"?this.kitchenTransitions:this.waiterTransitions)[t]||[]).includes(r)}updateItemStatus(t,r){return n(this,null,function*(){try{let e=yield this.authService.getCurrentRestaurantId();if(!e)return!1;let{error:a}=yield this.supabase.from("order_items").update({status:r,updated_at:new Date().toISOString()}).eq("id",t).eq("restaurant_id",e);return!a}catch(e){return console.error("\u274C Errore updateItemStatus:",e),!1}})}updateComandaStatus(t,r){return n(this,null,function*(){try{let e=yield this.authService.getCurrentRestaurantId();if(!e)return!1;let{error:a}=yield this.supabase.from("comande").update({status:r,updated_at:new Date().toISOString()}).eq("id",t).eq("restaurant_id",e);return!a}catch(e){return console.error("\u274C Errore updateComandaStatus:",e),!1}})}updateAllItemsInComanda(t,r){return n(this,null,function*(){try{let e=yield this.authService.getCurrentRestaurantId();if(!e)return!1;let{error:a}=yield this.supabase.from("order_items").update({status:r,updated_at:new Date().toISOString()}).eq("order_id",t).eq("restaurant_id",e);return!a}catch(e){return console.error("\u274C Errore updateAllItemsInComanda:",e),!1}})}static \u0275fac=function(r){return new(r||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};export{u as a};
