import{a as L}from"./chunk-JA4P7KVP.js";import{a as A}from"./chunk-LRNIFXNB.js";import"./chunk-5BFIQ7BP.js";import{a as re,b as oe,d as ae,e as le,g as se,h as de,i as ce,j as me,p as pe,q as ue,r as ge,s as _e,t as he,w as be}from"./chunk-77SKEQNN.js";import{a as ie}from"./chunk-KNL3CWA3.js";import{A as ne,d as $,e as ee,k as te}from"./chunk-DCWKKS33.js";import{Db as u,Eb as m,Ib as G,Jb as X,Kb as Q,La as s,Mb as S,Nb as C,Ob as J,Pb as W,Qb as a,Rb as w,Sb as y,Tb as E,Ub as K,Va as q,Vb as _,Wb as h,Xb as b,Zb as Z,a as N,ab as U,b as j,ea as F,f as x,fb as P,g as B,ja as d,ka as c,lb as Y,qb as g,rb as i,sb as o,tb as z,zb as f}from"./chunk-K5RDB55Y.js";var ye=["floorPlanCanvas"];function Fe(p,r){if(p&1&&(i(0,"option",49),a(1),o()),p&2){let e=r.$implicit;g("ngValue",e),s(),w(e.name)}}function Ee(p,r){if(p&1){let e=f();i(0,"div",50)(1,"button",51),u("click",function(t){d(e);let l=m();return c(l.startEditFloorPlan(l.currentFloorPlan,t))}),i(2,"span",27),a(3,"edit"),o()(),i(4,"button",52),u("click",function(t){d(e);let l=m();return c(l.onDeleteFloorPlan(l.currentFloorPlan,t))}),i(5,"span",27),a(6,"delete"),o()()()}if(p&2){let e=m();s(),g("disabled",!e.currentFloorPlan),s(3),g("disabled",!e.currentFloorPlan)}}function Se(p,r){if(p&1){let e=f();i(0,"div",53)(1,"input",54),b("ngModelChange",function(t){d(e);let l=m();return h(l.editedFloorPlanName,t)||(l.editedFloorPlanName=t),c(t)}),u("keyup.enter",function(){d(e);let t=m();return c(t.saveFloorPlanName())})("keyup.escape",function(){d(e);let t=m();return c(t.cancelEditFloorPlan())}),o(),i(2,"button",55),u("click",function(){d(e);let t=m();return c(t.saveFloorPlanName())}),i(3,"span",27),a(4,"check"),o()(),i(5,"button",56),u("click",function(){d(e);let t=m();return c(t.cancelEditFloorPlan())}),i(6,"span",27),a(7,"close"),o()()()}if(p&2){let e=m();s(),_("ngModel",e.editedFloorPlanName)}}function Te(p,r){if(p&1){let e=f();i(0,"div",57)(1,"div",58)(2,"label",13),a(3,"Tavolo Selezionato"),o(),i(4,"span",7),a(5),o()(),i(6,"div",59)(7,"button",26),u("click",function(){d(e);let t=m();return c(t.openEditTableModal(t.selectedTable))}),i(8,"span",27),a(9,"edit"),o(),a(10," Modifica "),o(),i(11,"button",29),u("click",function(){d(e);let t=m();return c(t.deselectAll())}),i(12,"span",27),a(13,"close"),o(),a(14," Deseleziona "),o()()()}if(p&2){let e=m();s(5),E(" Tavolo ",e.selectedTable.table_number," - ",e.selectedTable.capacity," persone ")}}function Oe(p,r){p&1&&z(0,"div",60)}function ke(p,r){if(p&1&&(i(0,"div",61)(1,"div",62)(2,"div",63),a(3),o(),i(4,"div",64),a(5),o()()()),p&2){let e=r.$implicit,n=m();J(n.getTableStyle(e)),W(n.getTableClass(e)),Y("data-table-id",e.id),s(3),w(e.table_number),s(2),y("",e.capacity," p")}}function Ve(p,r){p&1&&(i(0,"div",65)(1,"div",66)(2,"span",27),a(3,"touch_app"),o(),i(4,"h4"),a(5,"Clicca per aggiungere un tavolo"),o(),i(6,"p"),a(7,"Clicca su qualsiasi punto della mappa per aprire il menu di creazione tavolo"),o()()())}function De(p,r){if(p&1){let e=f();i(0,"div",67)(1,"span",27),a(2,"table_restaurant"),o(),i(3,"h3"),a(4,"Nessun tavolo configurato"),o(),i(5,"p"),a(6,'Usa la modalit\xE0 "Aggiungi Tavoli" per iniziare a creare la tua mappa'),o(),i(7,"button",68),u("click",function(){d(e);let t=m();return c(t.toggleDrawingMode())}),i(8,"span",27),a(9,"add"),o(),a(10," Inizia ad Aggiungere Tavoli "),o()()}}function Ie(p,r){if(p&1){let e=f();i(0,"div",69),u("click",function(){d(e);let t=m();return c(t.deselectAll())}),i(1,"div",70),u("click",function(t){return d(e),c(t.stopPropagation())}),i(2,"div",71)(3,"div",72)(4,"div",73)(5,"span",27),a(6,"edit"),o(),i(7,"h3",74),a(8),o()(),i(9,"button",75),u("click",function(){d(e);let t=m();return c(t.deselectAll())}),i(10,"span",27),a(11,"close"),o()()(),i(12,"div",9)(13,"form",76)(14,"div",12)(15,"label",77),a(16,"Nome Tavolo"),o(),i(17,"input",78),b("ngModelChange",function(t){d(e);let l=m();return h(l.selectedTable.table_name,t)||(l.selectedTable.table_name=t),c(t)}),o()(),i(18,"div",24)(19,"div",12)(20,"label",79),a(21,"Numero"),o(),i(22,"input",80),b("ngModelChange",function(t){d(e);let l=m();return h(l.selectedTable.table_number,t)||(l.selectedTable.table_number=t),c(t)}),o()(),i(23,"div",12)(24,"label",81),a(25,"Capacit\xE0"),o(),i(26,"input",82),b("ngModelChange",function(t){d(e);let l=m();return h(l.selectedTable.capacity,t)||(l.selectedTable.capacity=t),c(t)}),o()()(),i(27,"div",83)(28,"button",84),u("click",function(){d(e);let t=m();return c(t.deselectAll())}),a(29," Annulla "),o(),i(30,"button",85),u("click",function(){d(e);let t=m();return c(t.onUpdateTable())}),i(31,"span",27),a(32,"save"),o(),a(33," Aggiorna "),o()()(),i(34,"div",86)(35,"button",87),u("click",function(){d(e);let t=m();return c(t.onDeleteTable())}),i(36,"span",27),a(37,"delete"),o(),a(38," Elimina Tavolo "),o()()()()()()}if(p&2){let e=m();s(8),y("Modifica Tavolo ",e.selectedTable.table_number),s(9),_("ngModel",e.selectedTable.table_name),s(5),_("ngModel",e.selectedTable.table_number),s(4),_("ngModel",e.selectedTable.capacity)}}function Ne(p,r){if(p&1){let e=f();i(0,"div",103),u("click",function(){let t=d(e).$implicit,l=m(2);return c(l.onShapeSelect(t))}),i(1,"div",104)(2,"span",27),a(3),o()(),i(4,"span",105),a(5),o()()}if(p&2){let e=r.$implicit,n=m(2);C("selected",n.tableForm.shape===e.type),s(),W("shape-"+e.type),s(2),w(e.icon),s(2),w(e.name)}}function ze(p,r){if(p&1){let e=f();i(0,"div",12)(1,"label",106),a(2,"Angoli Arrotondati"),o(),i(3,"select",107),b("ngModelChange",function(t){d(e);let l=m(2);return h(l.tableForm.borderRadius,t)||(l.tableForm.borderRadius=t),c(t)}),i(4,"option",108),a(5,"Nessuno"),o(),i(6,"option",109),a(7,"Leggero"),o(),i(8,"option",110),a(9,"Medio"),o(),i(10,"option",111),a(11,"Alto"),o(),i(12,"option",112),a(13,"Massimo"),o()()()}if(p&2){let e=m(2);s(3),_("ngModel",e.tableForm.borderRadius)}}function We(p,r){if(p&1){let e=f();i(0,"div",69),u("click",function(){d(e);let t=m();return c(t.onCancelCreateTable())}),i(1,"div",70),u("click",function(t){return d(e),c(t.stopPropagation())}),i(2,"div",71)(3,"div",72)(4,"div",73)(5,"span",27),a(6,"add_circle"),o(),i(7,"h3",74),a(8,"Crea Nuovo Tavolo"),o()(),i(9,"button",75),u("click",function(){d(e);let t=m();return c(t.onCancelCreateTable())}),i(10,"span",27),a(11,"close"),o()()(),i(12,"div",9)(13,"form",76)(14,"div",12)(15,"label",13),a(16,"Forma del Tavolo"),o(),i(17,"div",88),P(18,Ne,6,6,"div",89),o()(),i(19,"div",24)(20,"div",12)(21,"label",90),a(22,"Larghezza (quadrati)"),o(),i(23,"input",91),b("ngModelChange",function(t){d(e);let l=m();return h(l.tableForm.gridWidth,t)||(l.tableForm.gridWidth=t),c(t)}),o(),i(24,"small",7),a(25),o()(),i(26,"div",12)(27,"label",92),a(28,"Altezza (quadrati)"),o(),i(29,"input",93),b("ngModelChange",function(t){d(e);let l=m();return h(l.tableForm.gridHeight,t)||(l.tableForm.gridHeight=t),c(t)}),o(),i(30,"small",7),a(31),o()()(),i(32,"div",94)(33,"h4"),a(34,"Dimensioni Reali"),o(),i(35,"p"),a(36),o()(),P(37,ze,14,1,"div",95),i(38,"div",24)(39,"div",12)(40,"label",79),a(41,"Numero Tavolo"),o(),i(42,"input",96),b("ngModelChange",function(t){d(e);let l=m();return h(l.tableForm.tableNumber,t)||(l.tableForm.tableNumber=t),c(t)}),o()(),i(43,"div",12)(44,"label",77),a(45,"Nome Tavolo (opzionale)"),o(),i(46,"input",97),b("ngModelChange",function(t){d(e);let l=m();return h(l.tableForm.tableName,t)||(l.tableForm.tableName=t),c(t)}),o()()(),i(47,"div",12)(48,"label",98),a(49,"Capacit\xE0 (persone)"),o(),i(50,"input",99),b("ngModelChange",function(t){d(e);let l=m();return h(l.tableForm.capacity,t)||(l.tableForm.capacity=t),c(t)}),o()(),i(51,"div",100)(52,"h4"),a(53,"Anteprima"),o(),i(54,"div",101)(55,"div",102)(56,"span",63),a(57),o(),i(58,"span",64),a(59),o()()()(),i(60,"div",83)(61,"button",84),u("click",function(){d(e);let t=m();return c(t.onCancelCreateTable())}),a(62," Annulla "),o(),i(63,"button",85),u("click",function(){d(e);let t=m();return c(t.onCreateTable())}),i(64,"span",27),a(65,"add"),o(),a(66," Crea Tavolo "),o()()()()()()()}if(p&2){let e=m();s(18),g("ngForOf",e.tableShapes),s(5),_("ngModel",e.tableForm.gridWidth),g("disabled",e.tableForm.shape==="circle"),s(2),y("1 quadrato = ",e.gridSize,"px"),s(4),_("ngModel",e.tableForm.gridHeight),g("disabled",e.tableForm.shape==="circle"||e.tableForm.shape==="square"),s(2),y("1 quadrato = ",e.gridSize,"px"),s(5),E("",e.tableForm.gridWidth*e.gridSize," \xD7 ",e.tableForm.gridHeight*e.gridSize," px"),s(),g("ngIf",e.tableForm.shape==="rectangle"||e.tableForm.shape==="square"),s(5),_("ngModel",e.tableForm.tableNumber),s(4),_("ngModel",e.tableForm.tableName),s(4),_("ngModel",e.tableForm.capacity),s(4),S("width",e.tableForm.gridWidth*20,"px")("height",e.tableForm.gridHeight*20,"px")("border-radius",e.tableForm.borderRadius,"px"),C("shape-circle",e.tableForm.shape==="circle"),s(3),w(e.tableForm.tableNumber||"1"),s(2),y("",e.tableForm.capacity," p")}}function Le(p,r){if(p&1){let e=f();i(0,"div",69),u("click",function(){d(e);let t=m();return c(t.onCancelDimensionsModal())}),i(1,"div",70),u("click",function(t){return d(e),c(t.stopPropagation())}),i(2,"div",71)(3,"div",72)(4,"div",73)(5,"span",27),a(6,"aspect_ratio"),o(),i(7,"h3",74),a(8,"Dimensioni Sala"),o()(),i(9,"button",75),u("click",function(){d(e);let t=m();return c(t.onCancelDimensionsModal())}),i(10,"span",27),a(11,"close"),o()()(),i(12,"div",9)(13,"form",76)(14,"div",24)(15,"div",12)(16,"label",113),a(17,"Larghezza (px)"),o(),i(18,"input",114),b("ngModelChange",function(t){d(e);let l=m();return h(l.dimensionsForm.width,t)||(l.dimensionsForm.width=t),c(t)}),o(),i(19,"small",7),a(20,"Min: 500px, Max: 5000px"),o()(),i(21,"div",12)(22,"label",115),a(23,"Altezza (px)"),o(),i(24,"input",116),b("ngModelChange",function(t){d(e);let l=m();return h(l.dimensionsForm.height,t)||(l.dimensionsForm.height=t),c(t)}),o(),i(25,"small",7),a(26,"Min: 500px, Max: 5000px"),o()()(),i(27,"div",12)(28,"label",13),a(29,"Dimensioni Predefinite"),o(),i(30,"div",117)(31,"button",118),u("click",function(){d(e);let t=m();return c(t.setDimensions(1e3,800))}),a(32," Piccola (1000\xD7800) "),o(),i(33,"button",118),u("click",function(){d(e);let t=m();return c(t.setDimensions(1500,1200))}),a(34," Media (1500\xD71200) "),o(),i(35,"button",118),u("click",function(){d(e);let t=m();return c(t.setDimensions(2e3,1600))}),a(36," Grande (2000\xD71600) "),o()()(),i(37,"div",100)(38,"h4"),a(39,"Anteprima Dimensioni"),o(),i(40,"div",119)(41,"div",120)(42,"div",121),a(43),o()()()(),i(44,"div",83)(45,"button",84),u("click",function(){d(e);let t=m();return c(t.onCancelDimensionsModal())}),a(46," Annulla "),o(),i(47,"button",85),u("click",function(){d(e);let t=m();return c(t.onSaveDimensions())}),i(48,"span",27),a(49,"save"),o(),a(50," Salva Dimensioni "),o()()()()()()()}if(p&2){let e=m();s(18),_("ngModel",e.dimensionsForm.width),s(6),_("ngModel",e.dimensionsForm.height),s(17),S("width",e.dimensionsForm.width*.1,"px")("height",e.dimensionsForm.height*.1,"px"),s(2),E(" ",e.dimensionsForm.width," \xD7 ",e.dimensionsForm.height," px ")}}var ve=class p{floorPlanService=F(L);tableService=F(A);authService=F(ie);supabaseService=F(ne);renderer=F(q);showEditTableModal=!1;canvasRef;floorPlans=[];currentFloorPlan=null;tables=[];tableShapes=[];selectedTable=null;isDrawing=!1;showTableModal=!1;gridSize=20;snapToGrid=!0;currentRestaurantId=null;modalPosition={x:0,y:0};showDimensionsModal=!1;dimensionsForm={width:1e3,height:800};tableForm={shape:"rectangle",gridWidth:6,gridHeight:4,capacity:4,borderRadius:0,tableName:"",tableNumber:""};editingFloorPlan=null;editedFloorPlanName="";subscriptions=new B;mouseMoveListener;mouseUpListener;pointerMoveListener;pointerUpListener;ngOnInit(){return x(this,null,function*(){console.log("\u{1F3C1} FloorPlanEditor ngOnInit"),this.tableShapes=this.floorPlanService.getTableShapes(),yield this.loadInitialData(),this.subscriptions.add(this.floorPlanService.floorPlans$.subscribe(r=>{this.floorPlans=r,r.length>0&&!this.currentFloorPlan?(this.currentFloorPlan=r[0],this.loadTablesForFloorPlan()):r.length===0&&this.createDefaultFloorPlan()})),this.subscriptions.add(this.tableService.data$.subscribe(()=>{this.loadTablesForFloorPlan()}))})}loadInitialData(){return x(this,null,function*(){try{let r=this.authService.currentUserValue;if(r){let{data:e,error:n}=yield this.supabaseService.getSupabaseClient().from("restaurants").select("id").eq("owner_id",r.id).limit(1);if(n){console.error("\u274C Error loading restaurants:",n);return}e&&e.length>0&&(this.currentRestaurantId=e[0].id)}yield this.floorPlanService.loadFloorPlans(),yield this.tableService.loadData()}catch(r){console.error("\u{1F4A5} Error in loadInitialData:",r)}})}ngAfterViewInit(){this.setupCanvasInteractions()}ngOnDestroy(){this.mouseMoveListener&&this.mouseMoveListener(),this.mouseUpListener&&this.mouseUpListener(),this.pointerMoveListener&&document.removeEventListener("pointermove",this.pointerMoveListener),this.pointerUpListener&&document.removeEventListener("pointerup",this.pointerUpListener),this.subscriptions.unsubscribe()}setupCanvasInteractions(){let r=this.canvasRef.nativeElement;this.renderer.listen(r,"click",e=>this.onCanvasClick(e)),this.renderer.listen(r,"pointerdown",e=>this.onCanvasPointerDown(e))}onCanvasClick(r){if(!this.isDrawing||!this.currentFloorPlan||!this.currentRestaurantId)return;let e=this.canvasRef.nativeElement.getBoundingClientRect(),n=r.clientX-e.left,t=r.clientY-e.top,l=this.snapToGrid?Math.round(n/this.gridSize)*this.gridSize:n,v=this.snapToGrid?Math.round(t/this.gridSize)*this.gridSize:t;this.modalPosition={x:l,y:v},this.showTableModal=!0,this.resetTableForm(),r.stopPropagation()}onCanvasPointerDown(r){if(this.isDrawing)return;let n=r.target.closest(".table-element");if(n){let t=n.getAttribute("data-table-id"),l=this.tables.find(v=>v.id===t);l&&(this.selectTable(l),this.startDrag(l,r,n))}else this.deselectAll();r.preventDefault(),r.stopPropagation()}startDrag(r,e,n){let t=this.canvasRef.nativeElement.getBoundingClientRect();if(!n)return;try{n.style.touchAction="none"}catch{}let l=e.pointerId;try{n.setPointerCapture(l)}catch{}let v=e.clientX,xe=e.clientY,fe=r.position_x,Pe=r.position_y,T=M=>{if(M.preventDefault(),!this.currentFloorPlan)return;let R=M.clientX-v,H=M.clientY-xe,k=fe+R,V=Pe+H;this.snapToGrid&&(k=Math.round(k/this.gridSize)*this.gridSize,V=Math.round(V/this.gridSize)*this.gridSize);let we=this.currentFloorPlan.width-r.width,Me=this.currentFloorPlan.height-r.height,D=Math.max(0,Math.min(k,we)),I=Math.max(0,Math.min(V,Me)),Ce=j(N({},r),{position_x:D,position_y:I});this.tableService.checkTableOverlap(Ce,r.id)||(r.position_x=D,r.position_y=I,n.style.left=D+"px",n.style.top=I+"px")},O=M=>x(this,null,function*(){let R=M;try{n.releasePointerCapture(l)}catch{}document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",O),this.selectedTable&&(yield this.saveTablePosition(this.selectedTable))});document.addEventListener("pointermove",T),document.addEventListener("pointerup",O),this.pointerMoveListener=T,this.pointerUpListener=O}saveTablePosition(r){return x(this,null,function*(){try{let e={position_x:r.position_x,position_y:r.position_y};yield this.tableService.updateTable(r.id,e)}catch(e){console.error("\u274C Error saving table position:",e)}})}getTableElement(r){return this.canvasRef.nativeElement.querySelector(`[data-table-id="${r.id}"]`)}loadTablesForFloorPlan(){if(!this.currentFloorPlan){this.tables=[];return}this.tables=this.tableService.getTablesByFloorPlan(this.currentFloorPlan.id)}onFloorPlanSelect(r){this.currentFloorPlan=r,this.loadTablesForFloorPlan(),this.deselectAll(),this.cancelEditFloorPlan()}resetTableForm(){this.tableForm={shape:"rectangle",gridWidth:6,gridHeight:4,capacity:4,borderRadius:0,tableName:"",tableNumber:this.generateNextTableNumber().toString()}}onShapeSelect(r){this.tableForm.shape=r.type,this.tableForm.gridWidth=Math.round(r.default_width/this.gridSize),this.tableForm.gridHeight=Math.round(r.default_height/this.gridSize),(r.type==="circle"||r.type==="square")&&(this.tableForm.gridHeight=this.tableForm.gridWidth)}onCreateTable(){return x(this,null,function*(){if(!this.currentFloorPlan||!this.currentRestaurantId){console.error("\u274C Missing required data");return}try{let r=this.tableForm.gridWidth*this.gridSize,e=this.tableForm.gridHeight*this.gridSize,n={restaurant_id:this.currentRestaurantId,floor_plan_id:this.currentFloorPlan.id,table_name:this.tableForm.tableName||`Tavolo ${this.tableForm.tableNumber}`,table_number:this.tableForm.tableNumber,capacity:this.tableForm.capacity,shape:this.tableForm.shape,position_x:this.modalPosition.x,position_y:this.modalPosition.y,width:r,height:e,rotation:0,is_active:!0};if(this.tableService.checkTableOverlap(n)){alert("Il tavolo si sovrappone a un altro tavolo. Scegli una posizione diversa.");return}console.log("\u{1F4DD} Creating table:",n),(yield this.tableService.createTable(n))?(console.log("\u2705 Table created successfully"),this.showTableModal=!1,this.isDrawing=!1):console.error("\u274C Table creation failed")}catch(r){console.error("\u{1F4A5} Error creating table:",r)}})}onCancelCreateTable(){this.showTableModal=!1,this.isDrawing=!1}selectTable(r){this.deselectAll(),this.selectedTable=r}openEditTableModal(r){this.selectedTable=r,this.showEditTableModal=!0}deselectAll(){this.selectedTable=null,this.showEditTableModal=!1}onUpdateTable(){return x(this,null,function*(){if(this.selectedTable)try{let r=N({},this.selectedTable);(yield this.tableService.updateTable(this.selectedTable.id,r))&&this.deselectAll()}catch(r){console.error("\u274C Error updating table:",r)}})}onDeleteTable(){return x(this,null,function*(){if(this.selectedTable&&confirm("Sei sicuro di voler eliminare questo tavolo?"))try{(yield this.tableService.deleteTable(this.selectedTable.id))&&this.deselectAll()}catch(r){console.error("\u274C Error deleting table:",r)}})}createNewFloorPlan(){return x(this,null,function*(){if(this.currentRestaurantId)try{let r=window.innerWidth<768,e=r?800:1e3,n=r?600:800,t={restaurant_id:this.currentRestaurantId,name:`Mappa ${this.floorPlans.length+1}`,width:e,height:n,is_active:!0},l=yield this.floorPlanService.createFloorPlan(t);l&&(this.currentFloorPlan=l,setTimeout(()=>this.openDimensionsModal(),100))}catch(r){console.error("\u{1F4A5} Error creating floor plan:",r)}})}onDeleteFloorPlan(r,e){return x(this,null,function*(){if(e.stopPropagation(),!!confirm(`Sei sicuro di voler eliminare la mappa "${r.name}"?`))try{(yield this.floorPlanService.deleteFloorPlan(r.id))&&this.currentFloorPlan?.id===r.id&&(this.currentFloorPlan=this.floorPlans.find(t=>t.id!==r.id)||null,this.loadTablesForFloorPlan())}catch(n){console.error("\u{1F4A5} Error deleting floor plan:",n)}})}startEditFloorPlan(r,e){e.stopPropagation(),r&&(this.editingFloorPlan=r,this.editedFloorPlanName=r.name)}saveFloorPlanName(){return x(this,null,function*(){if(!(!this.editingFloorPlan||!this.editedFloorPlanName.trim()))try{(yield this.floorPlanService.updateFloorPlan(this.editingFloorPlan.id,{name:this.editedFloorPlanName}))&&(this.currentFloorPlan?.id===this.editingFloorPlan.id&&(this.currentFloorPlan.name=this.editedFloorPlanName),yield this.floorPlanService.loadFloorPlans(),this.editingFloorPlan=null,this.editedFloorPlanName="")}catch(r){console.error("\u274C Error saving floor plan name:",r)}})}cancelEditFloorPlan(){this.editingFloorPlan=null}toggleDrawingMode(){this.isDrawing=!this.isDrawing,this.isDrawing||this.deselectAll()}generateNextTableNumber(){let r=this.tables.map(e=>parseInt(e.table_number)).filter(e=>!isNaN(e));return r.length>0?Math.max(...r)+1:1}getTableStyle(r){let e=r.shape==="rectangle"||r.shape==="square"?"8px":"50%";return{left:r.position_x+"px",top:r.position_y+"px",width:r.width+"px",height:r.height+"px","border-radius":e,transform:`rotate(${r.rotation}deg)`}}getTableClass(r){let e=["table-element",`shape-${r.shape}`];return this.selectedTable?.id===r.id&&e.push("selected"),e.join(" ")}testCreateTable(){if(!this.currentFloorPlan||!this.currentRestaurantId)return;let r={restaurant_id:this.currentRestaurantId,floor_plan_id:this.currentFloorPlan.id,table_name:"Tavolo Test",table_number:"999",capacity:4,shape:"rectangle",position_x:100,position_y:100,width:120,height:80,rotation:0,is_active:!0};this.tableService.createTable(r)}createDefaultFloorPlan(){return x(this,null,function*(){if(this.currentRestaurantId)try{let r={restaurant_id:this.currentRestaurantId,name:"Mappa Principale",width:1e3,height:800,is_active:!0},e=yield this.floorPlanService.createFloorPlan(r);e&&(this.currentFloorPlan=e)}catch(r){console.error("\u{1F4A5} Error creating default floor plan:",r)}})}openDimensionsModal(){this.currentFloorPlan&&(this.dimensionsForm={width:this.currentFloorPlan.width,height:this.currentFloorPlan.height},this.showDimensionsModal=!0)}onCancelDimensionsModal(){this.showDimensionsModal=!1}onSaveDimensions(){return x(this,null,function*(){if(this.currentFloorPlan)try{let r=this.tables.filter(n=>n.position_x+n.width>this.dimensionsForm.width||n.position_y+n.height>this.dimensionsForm.height);if(r.length>0){if(!confirm(`${r.length} tavolo(i) escono dai nuovi bordi della mappa. Vuoi continuare? I tavoli verranno spostati automaticamente.`))return;for(let t of r)t.position_x=Math.min(t.position_x,this.dimensionsForm.width-t.width),t.position_y=Math.min(t.position_y,this.dimensionsForm.height-t.height),yield this.saveTablePosition(t)}(yield this.floorPlanService.updateFloorPlan(this.currentFloorPlan.id,{width:this.dimensionsForm.width,height:this.dimensionsForm.height}))&&(this.currentFloorPlan.width=this.dimensionsForm.width,this.currentFloorPlan.height=this.dimensionsForm.height,this.showDimensionsModal=!1)}catch(r){console.error("\u274C Error updating floor plan dimensions:",r)}})}setDimensions(r,e){this.dimensionsForm.width=r,this.dimensionsForm.height=e}get isMobileView(){return window.innerWidth<768}static \u0275fac=function(e){return new(e||p)};static \u0275cmp=U({type:p,selectors:[["app-floor-plan"]],viewQuery:function(e,n){if(e&1&&G(ye,5),e&2){let t;X(t=Q())&&(n.canvasRef=t.first)}},features:[Z([L,A])],decls:86,vars:36,consts:[["canvasContainer",""],["floorPlanCanvas",""],[1,"floor-plan-editor"],[1,"section-header"],[1,"material-icons","header-icon"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"card","tools-bar"],[1,"card-content"],[1,"tools-main-row"],[1,"map-section"],[1,"form-group"],[1,"form-label"],[1,"form-input","compact",3,"ngModelChange","change","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],["class","map-actions",4,"ngIf"],["class","floor-plan-edit",4,"ngIf"],[1,"form-group","small"],[1,"checkbox-container","inline"],[1,"checkbox-label","small"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"center-section"],[1,"form-row"],[1,"action-buttons","compact"],[1,"promethea-button","primary","x-small",3,"click"],[1,"material-icons"],[1,"promethea-button","secondary","x-small",3,"click","disabled"],[1,"promethea-button","secondary","x-small",3,"click"],[1,"mode-buttons"],[1,"promethea-button","ghost","x-small",3,"click"],["class","selected-table-section",4,"ngIf"],[1,"status-section"],[1,"status-info"],[1,"mode-indicator"],[1,"mode-text"],[1,"canvas-stats"],[1,"editor-main-area"],[1,"canvas-section"],[1,"canvas-controls"],[1,"canvas-info"],[1,"canvas-container"],[1,"floor-plan-canvas"],["class","grid-overlay",4,"ngIf"],["class","table-element",3,"class","style",4,"ngFor","ngForOf"],["class","canvas-instructions",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","edit-table-modal-overlay",3,"click",4,"ngIf"],[3,"ngValue"],[1,"map-actions"],["title","Modifica nome mappa",1,"icon-button","small",3,"click","disabled"],["title","Elimina mappa",1,"icon-button","small",3,"click","disabled"],[1,"floor-plan-edit"],["type","text","placeholder","Nome mappa",1,"form-input","x-small",3,"ngModelChange","keyup.enter","keyup.escape","ngModel"],["title","Salva",1,"icon-button","x-small","save-btn",3,"click"],["title","Annulla",1,"icon-button","x-small","cancel-btn",3,"click"],[1,"selected-table-section"],[1,"selected-table-header"],[1,"selected-table-actions"],[1,"grid-overlay"],[1,"table-element"],[1,"table-content"],[1,"table-number"],[1,"table-capacity"],[1,"canvas-instructions"],[1,"instruction-card"],[1,"empty-state"],[1,"promethea-button","primary",3,"click"],[1,"edit-table-modal-overlay",3,"click"],[1,"edit-table-modal",3,"click"],[1,"card"],[1,"card-header"],[1,"modal-title"],[1,"card-title"],["title","Chiudi",1,"icon-button",3,"click"],[1,"generic-form"],["for","tableName",1,"form-label"],["id","tableName","type","text","name","tableName","placeholder","Nome tavolo",1,"form-input",3,"ngModelChange","ngModel"],["for","tableNumber",1,"form-label"],["id","tableNumber","type","text","name","tableNumber","placeholder","Numero",1,"form-input",3,"ngModelChange","ngModel"],["for","tableCapacity",1,"form-label"],["id","tableCapacity","type","number","name","tableCapacity","min","1","max","20",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","button",1,"promethea-button","secondary",3,"click"],["type","button",1,"promethea-button","primary",3,"click"],[1,"danger-zone"],[1,"promethea-button","danger","full-width",3,"click"],[1,"shape-selection"],["class","shape-option",3,"selected","click",4,"ngFor","ngForOf"],["for","gridWidth",1,"form-label"],["id","gridWidth","type","number","name","gridWidth","min","2","max","20",1,"form-input",3,"ngModelChange","ngModel","disabled"],["for","gridHeight",1,"form-label"],["id","gridHeight","type","number","name","gridHeight","min","2","max","20",1,"form-input",3,"ngModelChange","ngModel","disabled"],[1,"size-preview"],["class","form-group",4,"ngIf"],["id","tableNumber","type","text","name","tableNumber","placeholder","Es: 1",1,"form-input",3,"ngModelChange","ngModel"],["id","tableName","type","text","name","tableName","placeholder","Es: Tavolo VIP",1,"form-input",3,"ngModelChange","ngModel"],["for","capacity",1,"form-label"],["id","capacity","type","number","name","capacity","min","1","max","20",1,"form-input",3,"ngModelChange","ngModel"],[1,"preview-section"],[1,"table-preview"],[1,"preview-content"],[1,"shape-option",3,"click"],[1,"shape-preview"],[1,"shape-name"],["for","borderRadius",1,"form-label"],["id","borderRadius","name","borderRadius",1,"form-input",3,"ngModelChange","ngModel"],["value","0"],["value","5"],["value","10"],["value","15"],["value","20"],["for","floorPlanWidth",1,"form-label"],["id","floorPlanWidth","type","number","name","floorPlanWidth","min","500","max","5000","step","50",1,"form-input",3,"ngModelChange","ngModel"],["for","floorPlanHeight",1,"form-label"],["id","floorPlanHeight","type","number","name","floorPlanHeight","min","500","max","5000","step","50",1,"form-input",3,"ngModelChange","ngModel"],[1,"preset-buttons"],["type","button",1,"promethea-button","ghost","x-small",3,"click"],[1,"dimension-preview"],[1,"preview-canvas"],[1,"preview-label"]],template:function(e,n){if(e&1){let t=f();i(0,"div",2)(1,"div",3)(2,"span",4),a(3,"map"),o(),i(4,"div",5)(5,"h1",6),a(6,"Editor Mappa Ristorante"),o(),i(7,"p",7),a(8,"Crea e modifica la disposizione dei tavoli nel tuo ristorante"),o()()(),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"Mappa"),o(),i(16,"select",14),b("ngModelChange",function(v){return d(t),h(n.currentFloorPlan,v)||(n.currentFloorPlan=v),c(v)}),u("change",function(){return d(t),c(n.onFloorPlanSelect(n.currentFloorPlan))}),P(17,Fe,2,2,"option",15),o()(),P(18,Ee,7,2,"div",16)(19,Se,8,1,"div",17),o(),i(20,"div",18)(21,"label",13),a(22,"Opzioni"),o(),i(23,"div",19)(24,"label",20)(25,"input",21),b("ngModelChange",function(v){return d(t),h(n.snapToGrid,v)||(n.snapToGrid=v),c(v)}),o(),z(26,"span",22),a(27),o()()()(),i(28,"div",23)(29,"div",24)(30,"div",12)(31,"label",13),a(32,"Azioni"),o(),i(33,"div",25)(34,"button",26),u("click",function(){return d(t),c(n.createNewFloorPlan())}),i(35,"span",27),a(36,"add"),o(),a(37," Nuova Mappa "),o(),i(38,"button",28),u("click",function(){return d(t),c(n.openDimensionsModal())}),i(39,"span",27),a(40,"aspect_ratio"),o(),a(41," Dimensioni "),o(),i(42,"button",29),u("click",function(){return d(t),c(n.deselectAll())}),i(43,"span",27),a(44,"clear_all"),o(),a(45," Desel. "),o()()(),i(46,"div",12)(47,"label",13),a(48,"Modalit\xE0"),o(),i(49,"div",30)(50,"button",31),u("click",function(){return d(t),c(n.isDrawing=!1)}),i(51,"span",27),a(52,"open_with"),o(),a(53," Sposta "),o(),i(54,"button",31),u("click",function(){return d(t),c(n.toggleDrawingMode())}),i(55,"span",27),a(56,"add_circle"),o(),a(57," Aggiungi Tavoli "),o()()()()(),P(58,Te,15,2,"div",32),i(59,"div",33)(60,"div",34)(61,"div",35)(62,"span",27),a(63),o(),i(64,"span",36),a(65),o()(),i(66,"div",37)(67,"span",7),a(68),o()()()()()(),i(69,"div",38)(70,"div",39)(71,"div",40)(72,"div",41)(73,"span",7),a(74),o()()(),i(75,"div",42,0)(77,"div",43,1),P(79,Oe,1,0,"div",44)(80,ke,6,7,"div",45)(81,Ve,8,0,"div",46)(82,De,11,0,"div",47),o()()(),P(83,Ie,39,4,"div",48),o(),P(84,We,67,23,"div",48)(85,Le,51,8,"div",48),o()}e&2&&(s(16),_("ngModel",n.currentFloorPlan),s(),g("ngForOf",n.floorPlans),s(),g("ngIf",!n.editingFloorPlan),s(),g("ngIf",n.editingFloorPlan&&(n.currentFloorPlan==null?null:n.currentFloorPlan.id)===n.editingFloorPlan.id),s(6),_("ngModel",n.snapToGrid),s(2),y(" Snap (",n.gridSize,"px) "),s(11),g("disabled",!n.currentFloorPlan),s(12),C("active",!n.isDrawing),s(4),C("active",n.isDrawing),s(4),g("ngIf",n.selectedTable&&!n.isDrawing),s(3),C("drawing-mode",n.isDrawing),s(2),w(n.isDrawing?"add_circle":"open_with"),s(2),w(n.isDrawing?"Modalit\xE0 Inserimento":"Modalit\xE0 Spostamento"),s(3),K(" ",(n.currentFloorPlan==null?null:n.currentFloorPlan.width)||1e3,"\xD7",(n.currentFloorPlan==null?null:n.currentFloorPlan.height)||800," | Tavoli: ",n.tables.length," "),s(6),E(" Mappa: ",n.currentFloorPlan==null?null:n.currentFloorPlan.name," | Tavoli: ",n.tables.length," "),s(3),S("width",(n.currentFloorPlan==null?null:n.currentFloorPlan.width)||1e3,"px")("height",(n.currentFloorPlan==null?null:n.currentFloorPlan.height)||800,"px"),C("drawing-mode",n.isDrawing)("mobile-view",n.isMobileView),s(2),g("ngIf",n.snapToGrid||n.isDrawing),s(),g("ngForOf",n.tables),s(),g("ngIf",n.isDrawing),s(),g("ngIf",n.tables.length===0&&!n.isDrawing),s(),g("ngIf",n.showEditTableModal&&n.selectedTable),s(),g("ngIf",n.showTableModal),s(),g("ngIf",n.showDimensionsModal))},dependencies:[te,$,ee,be,ce,ue,ge,oe,me,re,pe,ae,le,he,_e,de,se],styles:[".floor-plan-editor[_ngcontent-%COMP%]{min-height:100vh;background:var(--background);padding:var(--gutter-md);display:flex;flex-direction:column;gap:var(--gutter-lg)}.tools-bar[_ngcontent-%COMP%]{margin-bottom:0}.tools-bar[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:0;display:flex;flex-direction:column;gap:var(--gutter-md)}.tools-main-row[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);align-items:flex-start;flex-wrap:wrap}.map-section[_ngcontent-%COMP%]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:var(--gutter-sm)}.map-section[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0}.map-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm)}.floor-plan-edit[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);margin-top:var(--gutter-sm)}.floor-plan-edit[_ngcontent-%COMP%]   .form-input.x-small[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px;min-width:120px;flex:1}.center-section[_ngcontent-%COMP%]{flex:2;min-width:300px}.actions-row[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);align-items:flex-end;flex-wrap:wrap}.actions-row[_ngcontent-%COMP%]   .form-group.small[_ngcontent-%COMP%]{margin-bottom:0;min-width:0}.mode-buttons[_ngcontent-%COMP%], .action-buttons.compact[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm)}.actions-row[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{padding:0}.actions-row[_ngcontent-%COMP%]   .checkbox-label.small[_ngcontent-%COMP%]{padding:4px 0;white-space:nowrap}.selected-table-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--gutter-md);padding:var(--gutter-sm);background:color-mix(in srgb,var(--primary) 5%,transparent);border:1px solid color-mix(in srgb,var(--primary) 20%,transparent);border-radius:8px;flex-wrap:wrap}.selected-table-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-md);flex:1;min-width:0}.selected-table-header[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{margin-bottom:0;white-space:nowrap}.selected-table-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);flex-shrink:0}.selected-table-actions[_ngcontent-%COMP%]   .promethea-button.x-small[_ngcontent-%COMP%]{padding:6px 12px;min-height:32px;font-size:var(--fs-sm)}.status-section[_ngcontent-%COMP%]{border-top:1px solid var(--smoke-color-1);padding-top:var(--gutter-md)}.status-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--gutter-md);flex-wrap:wrap}.mode-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:8px 12px;background:color-mix(in srgb,#10b981 15%,transparent);color:#10b981;border-radius:8px;font-weight:600;font-size:var(--fs-sm);transition:all .3s ease}.mode-indicator.drawing-mode[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 15%,transparent);color:#f59e0b}.mode-indicator[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px}.canvas-stats[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-muted);white-space:nowrap}.editor-main-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-lg);flex:1;min-height:600px}.canvas-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--background);border-radius:16px;padding:0;box-shadow:var(--shadow-sm);height:100%}.canvas-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:var(--gutter-sm);background:var(--background);border-radius:12px}.canvas-container[_ngcontent-%COMP%]{flex:1;border:2px solid var(--smoke-color-1);border-radius:12px;overflow:auto;background:#f8f9fa;position:relative;display:flex;align-items:center;justify-content:center;min-height:500px}.floor-plan-canvas[_ngcontent-%COMP%]{position:relative;background:var(--background);border-radius:8px;box-shadow:var(--shadow-md);cursor:default;margin:0;min-width:min(100%,1000px);min-height:min(100%,800px)}.floor-plan-canvas.drawing-mode[_ngcontent-%COMP%]{cursor:crosshair}.grid-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:linear-gradient(var(--smoke-color-1) 1px,transparent 1px),linear-gradient(90deg,var(--smoke-color-1) 1px,transparent 1px);background-size:20px 20px;pointer-events:none;opacity:.5;z-index:1}.table-element[_ngcontent-%COMP%]{position:absolute;border:2px solid var(--smoke-color-1);background:var(--background);cursor:grab;display:flex;align-items:center;justify-content:center;transition:all .2s ease;-webkit-user-select:none;user-select:none;box-shadow:var(--shadow-sm);z-index:10;border-radius:8px}.table-element[_ngcontent-%COMP%]:active{cursor:grabbing}.table-element[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:scale(1.02);box-shadow:var(--shadow-md);z-index:20}.table-element.selected[_ngcontent-%COMP%]{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 10%,transparent);z-index:30;box-shadow:var(--shadow-lg)}.table-element.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.table-content[_ngcontent-%COMP%]{text-align:center;pointer-events:none;padding:8px}.table-number[_ngcontent-%COMP%]{font-weight:700;font-size:14px;color:var(--text-color);margin-bottom:2px}.table-capacity[_ngcontent-%COMP%]{font-size:12px;color:var(--text-muted)}.canvas-instructions[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;z-index:5}.instruction-card[_ngcontent-%COMP%]{background:#fffffff2;padding:var(--gutter-lg);border-radius:16px;border:2px dashed var(--primary);text-align:center;box-shadow:var(--shadow-lg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);max-width:300px}.empty-state[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:var(--text-muted);z-index:5}.edit-table-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:var(--gutter-md);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.edit-table-modal[_ngcontent-%COMP%]{background:var(--background);padding:var(--gutter-lg);border-radius:16px;box-shadow:var(--shadow-lg);max-width:500px;width:100%;max-height:90vh;overflow-y:auto;border:1px solid var(--smoke-color-1);animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.edit-table-modal[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:0;margin:0}.edit-table-modal[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--gutter-lg);padding-bottom:var(--gutter-md);border-bottom:1px solid var(--smoke-color-1)}.edit-table-modal[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{margin:0;font-size:var(--fs-md);color:var(--text-color)}.edit-table-modal[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:0}.modal-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm)}.modal-title[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--primary)}.edit-table-modal[_ngcontent-%COMP%]   .generic-form[_ngcontent-%COMP%]{gap:var(--gutter-md)}.edit-table-modal[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:var(--gutter-lg);padding-top:var(--gutter-md);border-top:1px solid var(--smoke-color-1)}.edit-table-modal[_ngcontent-%COMP%]   .danger-zone[_ngcontent-%COMP%]{margin-top:var(--gutter-lg);padding-top:var(--gutter-md);border-top:1px solid color-mix(in srgb,#ef4444 30%,transparent)}.preview-section[_ngcontent-%COMP%]{margin:var(--gutter-md) 0;padding:var(--gutter-md);background:var(--smoke-color-1);border-radius:8px;text-align:center}.table-preview[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;background:var(--primary);color:#fff;border:2px solid var(--primary);margin-top:var(--gutter-sm);border-radius:8px}.table-preview.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.preview-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2px;padding:8px}.shape-selection[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:var(--gutter-sm);margin-top:var(--gutter-sm)}.shape-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm);border:2px solid var(--smoke-color-1);border-radius:8px;cursor:pointer;transition:all .2s ease}.shape-option[_ngcontent-%COMP%]:hover{border-color:var(--primary)}.shape-option.selected[_ngcontent-%COMP%]{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 10%,transparent)}.shape-preview[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:var(--smoke-color-1);border-radius:4px}.shape-preview.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.shape-name[_ngcontent-%COMP%]{font-size:var(--fs-sm);font-weight:500}@media (max-width: 768px){.tools-main-row[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-md)}.map-section[_ngcontent-%COMP%], .center-section[_ngcontent-%COMP%]{min-width:100%}.actions-row[_ngcontent-%COMP%]{justify-content:space-between}.selected-table-section[_ngcontent-%COMP%], .selected-table-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--gutter-sm)}.status-info[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm);text-align:center}}.preset-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm);margin-top:var(--gutter-sm)}.preset-buttons[_ngcontent-%COMP%]   .promethea-button.ghost.x-small[_ngcontent-%COMP%]{padding:8px 12px;justify-content:flex-start}.dimension-preview[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:var(--gutter-sm)}.preview-canvas[_ngcontent-%COMP%]{background:var(--smoke-color-1);border:2px dashed var(--primary);border-radius:8px;display:flex;align-items:center;justify-content:center;min-width:50px;min-height:50px;max-width:200px;max-height:200px}.preview-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);font-weight:600;color:var(--text-color);text-align:center;padding:var(--gutter-sm)}@media (max-width: 768px){.floor-plan-editor[_ngcontent-%COMP%]{padding:var(--gutter-sm);gap:var(--gutter-md)}.tools-bar[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:var(--gutter-sm)}.tools-main-row[_ngcontent-%COMP%], .center-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-md)}.action-buttons.compact[_ngcontent-%COMP%]{flex-direction:column}.action-buttons.compact[_ngcontent-%COMP%]   .promethea-button.x-small[_ngcontent-%COMP%]{justify-content:center}.mode-buttons[_ngcontent-%COMP%]{flex-direction:column}.mode-buttons[_ngcontent-%COMP%]   .promethea-button.ghost.x-small[_ngcontent-%COMP%]{justify-content:center}.canvas-container[_ngcontent-%COMP%]{min-height:400px;border-radius:8px}.floor-plan-canvas[_ngcontent-%COMP%]{min-width:100%!important;min-height:400px!important;margin:0}.selected-table-section[_ngcontent-%COMP%], .selected-table-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--gutter-sm)}.selected-table-actions[_ngcontent-%COMP%]{justify-content:stretch}.status-info[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm);text-align:center}.mode-indicator[_ngcontent-%COMP%]{justify-content:center}.table-element[_ngcontent-%COMP%]{min-width:60px;min-height:60px}.table-content[_ngcontent-%COMP%]{padding:6px}.table-number[_ngcontent-%COMP%]{font-size:12px}.table-capacity[_ngcontent-%COMP%]{font-size:10px}.instruction-card[_ngcontent-%COMP%]{padding:var(--gutter-md);margin:var(--gutter-sm);max-width:none}.empty-state[_ngcontent-%COMP%]{padding:var(--gutter-md)}.empty-state[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 480px){.section-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:var(--gutter-sm)}.section-titles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:var(--fs-md)}.map-section[_ngcontent-%COMP%]{min-width:100%}.map-actions[_ngcontent-%COMP%]{justify-content:center}.floor-plan-edit[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}.edit-table-modal[_ngcontent-%COMP%]{margin:var(--gutter-sm);padding:var(--gutter-md)}.shape-selection[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.preset-buttons[_ngcontent-%COMP%]{flex-direction:column}.canvas-container[_ngcontent-%COMP%]{min-height:300px}.floor-plan-canvas[_ngcontent-%COMP%]{min-height:300px!important}.grid-overlay[_ngcontent-%COMP%]{background-size:30px 30px}}@media (hover: none) and (pointer: coarse){.table-element[_ngcontent-%COMP%]:hover{transform:none}.icon-button[_ngcontent-%COMP%], .promethea-button[_ngcontent-%COMP%]{min-height:44px;min-width:44px}.canvas-container[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch}}.edit-table-modal[_ngcontent-%COMP%]{max-width:95vw;max-height:90vh}@media (max-width: 480px){.edit-table-modal[_ngcontent-%COMP%]{max-width:100vw;max-height:100vh;margin:0;border-radius:0;height:100vh}}.table-element[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-user-drag:none}"]})};export{ve as FloorPlanEditor};
