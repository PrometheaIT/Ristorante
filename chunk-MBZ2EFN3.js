import{a as le}from"./chunk-AHVTCP4Y.js";import{a as ce}from"./chunk-5IUMXHBR.js";import{a as se}from"./chunk-DX445BSI.js";import{a as re}from"./chunk-3V7QE66H.js";import{a as oe}from"./chunk-OZI6VC4V.js";import"./chunk-JVDFXZVZ.js";import"./chunk-NREUF4AQ.js";import{a as J,b as Q,d as X,h as Z,q as ee,r as te,s as ie,v as ne,x as ae}from"./chunk-PZ6IGEMS.js";import"./chunk-F35UPSG6.js";import"./chunk-4GBXVLF4.js";import"./chunk-37GYPR4T.js";import{j as U,k as Y,s as H}from"./chunk-PWZZTUE6.js";import{$a as m,Cb as j,Eb as F,Ga as l,H as N,Hb as s,Ib as S,J as G,Jb as h,K as q,Kb as O,Lb as D,Nb as f,Ob as b,Pb as x,Sb as K,Wa as L,a as W,ba as C,f as A,ha as u,hb as d,ia as g,ib as n,jb as r,oa as $,ob as T,pb as E,qb as w,tb as p,u as B,vb as _}from"./chunk-DU5L5MFQ.js";import{a as V,b as z,j as M}from"./chunk-4ZZIO3ZI.js";var _e=()=>[1,2,3,4,5,6,7,8,9,10];function me(a,t){if(a&1&&(n(0,"option",38),s(1),r()),a&2){let e=t.$implicit;d("value",e.name),l(),D(" ",e.name," (",e.start_time.substring(0,5)," - ",e.end_time.substring(0,5),") ")}}function ue(a,t){if(a&1&&(n(0,"span",39),s(1),r()),a&2){let e=_();l(),h(" ",e.getActiveFiltersInfo().text," ")}}function ge(a,t){if(a&1){let e=w();n(0,"div",40)(1,"span",5),s(2,"error"),r(),s(3),n(4,"button",41),p("click",function(){u(e);let o=_();return g(o.error=null)}),n(5,"span",5),s(6,"close"),r()()()}if(a&2){let e=_();l(3),h(" ",e.error," ")}}function pe(a,t){if(a&1&&(n(0,"div",64),s(1),r()),a&2){let e=_().$implicit;l(),h(" ",e.customer_email," ")}}function ve(a,t){a&1&&(n(0,"div",5),s(1,"restaurant_menu"),r())}function he(a,t){if(a&1&&(n(0,"span",65),s(1),r()),a&2){let e=_().$implicit,i=_(3);l(),h(" ",i.getReservationMenuInfo(e)," ")}}function fe(a,t){if(a&1&&(n(0,"option",74),s(1),r()),a&2){let e=t.$implicit,i=_(6).$implicit;d("value",e.id)("title","Capacit\xE0: "+e.capacity+" posti"),l(),D(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ",e.capacity===i.party_size?"\u2B50":""," ")}}function be(a,t){if(a&1&&(n(0,"optgroup",72),m(1,fe,2,5,"option",73),r()),a&2){let e=_().$implicit;d("label",e.floorPlan.name),l(),d("ngForOf",e.tables)}}function xe(a,t){if(a&1&&(T(0),m(1,be,2,2,"optgroup",71),E()),a&2){let e=t.$implicit;l(),d("ngIf",e.tables&&e.tables.length>0)}}function Me(a,t){if(a&1&&(T(0),m(1,xe,2,1,"ng-container",48),E()),a&2){let e=_(3).$implicit,i=_(3);l(),d("ngForOf",i.getFilteredTableGroups(e.party_size))}}function ye(a,t){if(a&1&&(n(0,"option",38),s(1),r()),a&2){let e=t.$implicit,i=_(4).$implicit;d("value",e.id),l(),D(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ",e.capacity===i.party_size?"\u2B50":""," ")}}function we(a,t){if(a&1&&(T(0),m(1,ye,2,4,"option",27),E()),a&2){let e=_(3).$implicit,i=_(3);l(),d("ngForOf",i.getFilteredTables(e.party_size))}}function Se(a,t){a&1&&(n(0,"option",75),s(1," Nessun tavolo disponibile "),r())}function Re(a,t){if(a&1){let e=w();n(0,"select",67,0),p("change",function(){u(e);let o=j(1),c=_(2).$implicit,v=_(3);return g(v.assignTable(c.id,o.value))}),n(2,"option",68),s(3,"Assegna tavolo..."),r(),m(4,Me,2,1,"ng-container",69)(5,we,2,1,"ng-container",69)(6,Se,2,0,"option",70),r()}if(a&2){let e=_(5);l(4),d("ngIf",e.tableGroups&&e.tableGroups.length>0),l(),d("ngIf",(!e.tableGroups||e.tableGroups.length===0)&&e.tables.length>0),l(),d("ngIf",e.tables.length===0&&e.tableGroups.length===0)}}function Ce(a,t){if(a&1&&(n(0,"div",31),m(1,Re,7,3,"select",66),r()),a&2){let e=_().$implicit;l(),d("ngIf",!e.table_id)}}function Te(a,t){a&1&&(n(0,"span",64),s(1," Nessun tavolo "),r())}function Ee(a,t){if(a&1){let e=w();n(0,"button",76),p("click",function(){u(e);let o=_().$implicit,c=_(3);return g(c.unassignTable(o.id))}),n(1,"span",5),s(2,"close"),r()()}}function Ie(a,t){if(a&1){let e=w();n(0,"button",77),p("click",function(){u(e);let o=_().$implicit,c=_(3);return g(c.updateStatus(o.id,"confirmed"))}),n(1,"span",5),s(2,"check"),r()()}}function Pe(a,t){if(a&1){let e=w();n(0,"button",78),p("click",function(){u(e);let o=_().$implicit,c=_(3);return g(c.updateStatus(o.id,"pending"))}),n(1,"span",5),s(2,"schedule"),r()()}}function Fe(a,t){if(a&1){let e=w();n(0,"tr")(1,"td"),s(2),r(),n(3,"td"),s(4),r(),n(5,"td")(6,"div",49)(7,"strong"),s(8),r(),m(9,pe,2,1,"div",50),n(10,"span",51),s(11),r()()(),n(12,"td"),s(13),r(),n(14,"td"),s(15),r(),n(16,"td")(17,"div",52)(18,"div",53),m(19,ve,2,0,"div",54)(20,he,2,1,"span",55),r(),n(21,"div",56)(22,"span"),s(23),r(),m(24,Ce,2,1,"div",57)(25,Te,2,0,"span",50)(26,Ee,3,0,"button",58),r()()(),n(27,"td")(28,"span",59),s(29),r()(),n(30,"td")(31,"span",59),s(32),r()(),n(33,"td")(34,"div",31),m(35,Ie,3,0,"button",60)(36,Pe,3,0,"button",61),n(37,"button",62),p("click",function(){let o=u(e).$implicit,c=_(3);return g(c.openEditModal(o))}),n(38,"span",5),s(39,"edit"),r()(),n(40,"button",63),p("click",function(){let o=u(e).$implicit,c=_(3);return g(c.deleteReservation(o.id))}),n(41,"span",5),s(42,"delete"),r()()()()()}if(a&2){let e=t.$implicit,i=_(3);l(2),S(i.formatDate(e.reservation_date)),l(2),S(i.formatTime(e.reservation_time)),l(4),S(i.getCustomerFullName(e)),l(),d("ngIf",e.customer_email),l(),F("active",e.customer_id),l(),h(" ",e.customer_id?"Cliente Registrato":"Nuovo Cliente"," "),l(2),S(i.getCustomerContact(e)),l(2),S(e.party_size),l(4),d("ngIf",i.getReservationMenuInfo(e)),l(),d("ngIf",i.getReservationMenuInfo(e)),l(3),S(i.getTableName(e)),l(),d("ngIf",i.tables.length>0||i.tableGroups.length>0),l(),d("ngIf",i.tables.length===0&&i.tableGroups.length===0),l(),d("ngIf",e.table_id),l(2),F("active",i.getStatusColor(e.status)),l(),h(" ",i.getStatusText(e.status)," "),l(2),F("active",i.getReservationShift(e)!=="N/D"),l(),h(" ",i.getReservationShift(e)," "),l(3),d("ngIf",e.status!=="confirmed"),l(),d("ngIf",e.status!=="pending")}}function Oe(a,t){if(a&1&&(n(0,"table",45)(1,"thead")(2,"tr")(3,"th"),s(4,"Data"),r(),n(5,"th"),s(6,"Ora"),r(),n(7,"th"),s(8,"Cliente"),r(),n(9,"th",46)(10,"span",47),s(11,"phone_enabled"),r()(),n(12,"th",46)(13,"span",47),s(14,"groups"),r()(),n(15,"th",46)(16,"span",47),s(17,"table_restaurant"),r()(),n(18,"th"),s(19,"Stato"),r(),n(20,"th"),s(21,"Turno"),r(),n(22,"th"),s(23,"Azioni"),r()()(),n(24,"tbody"),m(25,Fe,43,23,"tr",48),r()()),a&2){let e=_(2);l(25),d("ngForOf",e.filteredReservations)}}function De(a,t){a&1&&(n(0,"div",79)(1,"span",5),s(2,"event_busy"),r(),n(3,"p",6),s(4,"Nessuna prenotazione trovata con i filtri selezionati"),r()())}function ke(a,t){if(a&1&&(n(0,"div",42),m(1,Oe,26,1,"table",43)(2,De,5,0,"div",44),r()),a&2){let e=_();l(),d("ngIf",e.filteredReservations.length>0),l(),d("ngIf",e.filteredReservations.length===0)}}function Ve(a,t){a&1&&(n(0,"div",110)(1,"span",111),s(2,"refresh"),r(),s(3," Caricamento orari... "),r())}function ze(a,t){a&1&&(n(0,"div",112)(1,"span",5),s(2,"warning"),r(),s(3," Nessun turno disponibile per questa data "),r())}function We(a,t){a&1&&(n(0,"span",6),s(1," - Non disponibile"),r())}function Ae(a,t){if(a&1&&(n(0,"option",116),s(1),m(2,We,2,0,"span",105),r()),a&2){let e=t.$implicit;d("value",e.value)("disabled",e.disabled)("title",e.disabled?e.disabledReason:""),l(),h(" ",e.display," "),l(),d("ngIf",e.disabled)}}function Be(a,t){if(a&1&&(n(0,"optgroup",72),m(1,Ae,3,5,"option",115),r()),a&2){let e=_().$implicit,i=_(3);d("label",i.getShiftLabel(e.shift)),l(),d("ngForOf",e.times)}}function Ne(a,t){a&1&&(n(0,"span",6),s(1," - Non disponibile"),r())}function Ge(a,t){if(a&1&&(n(0,"option",116),s(1),m(2,Ne,2,0,"span",105),r()),a&2){let e=t.$implicit;d("value",e.value)("disabled",e.disabled)("title",e.disabled?e.disabledReason:""),l(),h(" ",e.display," "),l(),d("ngIf",e.disabled)}}function qe(a,t){if(a&1&&(T(0),m(1,Ge,3,5,"option",115),E()),a&2){let e=_().$implicit;l(),d("ngForOf",e.times)}}function $e(a,t){if(a&1&&(T(0),m(1,Be,2,2,"optgroup",71)(2,qe,2,1,"ng-container",69),E()),a&2){let e=_(3);l(),d("ngIf",e.getAvailableTimesByShift().length>1),l(),d("ngIf",e.getAvailableTimesByShift().length===1)}}function Le(a,t){if(a&1){let e=w();n(0,"select",113),x("ngModelChange",function(o){u(e);let c=_(2);return b(c.newReservation.reservation_time,o)||(c.newReservation.reservation_time=o),g(o)}),n(1,"option",114),s(2),r(),m(3,$e,3,2,"ng-container",48),r()}if(a&2){let e=_(2);f("ngModel",e.newReservation.reservation_time),d("disabled",e.loadingTimes),l(2),h(" ",e.getAvailableTimesByShift().length>1?"Seleziona un orario":"Seleziona"," "),l(),d("ngForOf",e.getAvailableTimesByShift())}}function je(a,t){if(a&1&&(n(0,"div",99)(1,"small")(2,"span",100),s(3,"info"),r(),s(4),r()()),a&2){let e=_(2);l(4),h(" ",e.getAvailableTimesSummary()," ")}}function Ke(a,t){if(a&1&&(n(0,"option",38),s(1),r()),a&2){let e=t.$implicit;d("value",e),l(),O(" ",e," ",e===1?"persona":"persone"," ")}}function Ue(a,t){a&1&&(n(0,"span"),s(1,"\u2B50"),r())}function Ye(a,t){if(a&1&&(n(0,"option",96),s(1),m(2,Ue,2,0,"span",69),r()),a&2){let e=t.$implicit;d("ngValue",e.id),l(),h(" ",e.name," "),l(),d("ngIf",e.is_default)}}function He(a,t){if(a&1&&(n(0,"optgroup",117),m(1,Ye,3,3,"option",118),r()),a&2){let e=_(2);l(),d("ngForOf",e.globalMenus)}}function Je(a,t){if(a&1&&(n(0,"option",96),s(1),n(2,"span",6),s(3,"(dedicato)"),r()()),a&2){let e=t.$implicit;d("ngValue",e.id),l(),h(" ",e.name," ")}}function Qe(a,t){if(a&1&&(n(0,"optgroup",119),m(1,Je,4,2,"option",118),r()),a&2){let e=_(2);l(),d("ngForOf",e.dedicatedMenus)}}function Xe(a,t){if(a&1&&(n(0,"div",120)(1,"div",121)(2,"span",100),s(3,"restaurant_menu"),r(),n(4,"span",122),s(5),r(),n(6,"span",123),s(7),r()()()),a&2){let e=_(2);l(5),h(" Menu selezionato: ",e.getSelectedMenuName()," "),l(2),h(" ",e.getSelectedMenuType()==="global"?"Globale":"Dedicato"," ")}}function Ze(a,t){if(a&1){let e=w();n(0,"div",124)(1,"button",125),p("click",function(){u(e);let o=_(2);return g(o.createNewDedicatedMenu())}),n(2,"span",5),s(3,"add_circle"),r(),s(4," Crea nuovo menu dedicato per questa prenotazione "),r()()}}function et(a,t){if(a&1&&(n(0,"option",128),s(1),r()),a&2){let e=t.$implicit,i=_(3);d("value",e.id)("selected",e.id===i.newReservation.table_id),l(),O(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ")}}function tt(a,t){if(a&1&&(n(0,"optgroup",126),m(1,et,2,4,"option",127),r()),a&2){let e=_(2);l(),d("ngForOf",e.getTablesByExactCapacity(e.newReservation.party_size))}}function it(a,t){if(a&1&&(n(0,"option",128),s(1),r()),a&2){let e=t.$implicit,i=_(3);d("value",e.id)("selected",e.id===i.newReservation.table_id),l(),O(" ",e.table_name||"Tavolo "+e.table_number," (",e.capacity," posti) ")}}function nt(a,t){if(a&1&&(n(0,"optgroup",129),m(1,it,2,4,"option",127),r()),a&2){let e=_(2);l(),d("ngForOf",e.getTablesByGreaterCapacity(e.newReservation.party_size))}}function at(a,t){if(a&1&&(n(0,"option",75),s(1),r()),a&2){let e=_(2);l(),h(" Nessun tavolo disponibile per ",e.newReservation.party_size," persone ")}}function rt(a,t){if(a&1&&(n(0,"small",6),s(1),r()),a&2){let e=_(2);l(),h(" Capacit\xE0 tavolo: ",e.getSelectedTableCapacity()," posti ")}}function ot(a,t){if(a&1&&(n(0,"small",6),s(1),r()),a&2){let e=_(2);l(),h(" \u2B50 Mostra tavoli con capacit\xE0 esatta per ",e.newReservation.party_size," persone ")}}function st(a,t){a&1&&(n(0,"span",5),s(1,"refresh"),r())}function lt(a,t){if(a&1){let e=w();n(0,"div",80)(1,"div",81)(2,"div",82)(3,"h2",3)(4,"span",5),s(5),r(),s(6),r(),n(7,"button",41),p("click",function(){u(e);let o=_();return g(o.closeCreateModal())}),n(8,"span",5),s(9,"close"),r()()(),n(10,"div",83)(11,"div",40)(12,"span",5),s(13,"info"),r(),n(14,"span"),s(15,"Stai creando una prenotazione per un cliente (registrato o nuovo)"),r()(),n(16,"div",84)(17,"div",8)(18,"label",9),s(19,"Nome *"),r(),n(20,"input",85),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.customer_name,o)||(c.newReservation.customer_name=o),g(o)}),r()(),n(21,"div",8)(22,"label",9),s(23,"Cognome *"),r(),n(24,"input",86),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.customer_surname,o)||(c.newReservation.customer_surname=o),g(o)}),r()()(),n(25,"div",84)(26,"div",8)(27,"label",9),s(28,"Telefono *"),r(),n(29,"input",87),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.customer_phone,o)||(c.newReservation.customer_phone=o),g(o)}),r()(),n(30,"div",8)(31,"label",9),s(32,"Email (opzionale)"),r(),n(33,"input",88),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.customer_email,o)||(c.newReservation.customer_email=o),g(o)}),r()()(),n(34,"div",84)(35,"div",8)(36,"label",9),s(37,"Data *"),r(),n(38,"input",89),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.reservation_date,o)||(c.newReservation.reservation_date=o),g(o)}),p("change",function(){u(e);let o=_();return g(o.onReservationDateChange())}),r()(),n(39,"div",8)(40,"label",9),s(41,"Ora *"),r(),m(42,Ve,4,0,"div",90)(43,ze,4,0,"div",91)(44,Le,4,4,"select",92)(45,je,5,1,"div",93),r()(),n(46,"div",84)(47,"div",8)(48,"label",9),s(49,"Numero Persone *"),r(),n(50,"select",94),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.party_size,o)||(c.newReservation.party_size=o),g(o)}),m(51,Ke,2,3,"option",27),r()(),n(52,"div",8)(53,"label",9),s(54,"Stato"),r(),n(55,"select",95),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.status,o)||(c.newReservation.status=o),g(o)}),n(56,"option",24),s(57,"Confermata"),r(),n(58,"option",25),s(59,"In attesa"),r()()()(),n(60,"div",84)(61,"div",8)(62,"label",9),s(63,"Menu Dedicato (opzionale)"),r(),n(64,"select",95),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.menu_id,o)||(c.newReservation.menu_id=o),g(o)}),n(65,"option",96),s(66,"Nessun menu dedicato"),r(),m(67,He,2,1,"optgroup",97)(68,Qe,2,1,"optgroup",98),r(),n(69,"small",99)(70,"span",100),s(71,"info"),r(),s(72," Se selezionato, questo menu sar\xE0 visibile solo per questa prenotazione "),r(),m(73,Xe,8,2,"div",101)(74,Ze,5,0,"div",102),r()(),n(75,"div",84)(76,"div",8)(77,"label",9),s(78,"Tavolo (opzionale)"),r(),n(79,"select",95),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.table_id,o)||(c.newReservation.table_id=o),g(o)}),n(80,"option",38),s(81,"Nessun tavolo assegnato"),r(),m(82,tt,2,1,"optgroup",103)(83,nt,2,1,"optgroup",104)(84,at,2,1,"option",70),r(),m(85,rt,2,1,"small",105)(86,ot,2,1,"small",105),r()(),n(87,"div",14)(88,"div",8)(89,"label",9),s(90,"Richieste Speciali"),r(),n(91,"textarea",106),x("ngModelChange",function(o){u(e);let c=_();return b(c.newReservation.special_requests,o)||(c.newReservation.special_requests=o),g(o)}),r()()()(),n(92,"div",107)(93,"button",108),p("click",function(){u(e);let o=_();return g(o.closeCreateModal())}),s(94," Annulla "),r(),n(95,"button",109),p("click",function(){u(e);let o=_();return g(o.createReservation())}),m(96,st,2,0,"span",54),s(97),r()()()()}if(a&2){let e=_();l(5),S(e.isEditing?"edit":"add_circle"),l(),h(" ",e.isEditing?"Modifica Prenotazione":"Nuova Prenotazione Ristorante"," "),l(14),f("ngModel",e.newReservation.customer_name),d("required",!e.newReservation.customer_id),l(4),f("ngModel",e.newReservation.customer_surname),d("required",!e.newReservation.customer_id),l(5),f("ngModel",e.newReservation.customer_phone),d("required",!e.newReservation.customer_id),l(4),f("ngModel",e.newReservation.customer_email),l(5),f("ngModel",e.newReservation.reservation_date),d("min",e.getTodayDate()),l(4),d("ngIf",e.loadingTimes),l(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length===0),l(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length>0),l(),d("ngIf",!e.loadingTimes&&e.getAvailableTimesByShift().length>0),l(5),f("ngModel",e.newReservation.party_size),l(),d("ngForOf",K(35,_e)),l(4),f("ngModel",e.newReservation.status),l(9),f("ngModel",e.newReservation.menu_id),l(),d("ngValue",null),l(2),d("ngIf",e.hasGlobalMenus()),l(),d("ngIf",e.hasDedicatedMenus()),l(5),d("ngIf",e.newReservation.menu_id),l(),d("ngIf",e.isEditing),l(5),f("ngModel",e.newReservation.table_id),l(),d("value",void 0),l(2),d("ngIf",e.getTablesByExactCapacity(e.newReservation.party_size).length>0),l(),d("ngIf",e.getTablesByGreaterCapacity(e.newReservation.party_size).length>0),l(),d("ngIf",e.getTablesByExactCapacity(e.newReservation.party_size).length===0&&e.getTablesByGreaterCapacity(e.newReservation.party_size).length===0),l(),d("ngIf",e.newReservation.table_id),l(),d("ngIf",!e.newReservation.table_id),l(5),f("ngModel",e.newReservation.special_requests),l(4),d("disabled",!e.isFormValid()||e.loading),l(),d("ngIf",e.loading),l(),h(" ",e.isEditing?"Aggiorna Prenotazione":"Crea Prenotazione"," ")}}var de=class a{reservationService=C(oe);tableService=C(re);menuService=C(se);floorManagementService=C(le);subscriptions=new W;allRestaurantReservations=[];filteredReservations=[];tables=[];tableGroups=[];loading=!1;error=null;showCreateModal=!1;newReservation={restaurant_id:"",customer_name:"",customer_surname:"",customer_phone:"",customer_email:"",reservation_date:"",reservation_time:"19:00",party_size:2,special_requests:"",table_id:void 0,status:"confirmed"};loadingTimes=!1;dateChangeSubject=new A;dateChangeSubscription;cachedTimes=$(new Map);selectedDate=null;startDate=null;endDate=null;statusFilter="all";viewMode="future";useDateFilter=!1;useDateRangeFilter=!1;shiftFilter="all";availableMenus=[];isEditing=!1;editingReservationId=null;shiftService=C(ce);shifts=[];ngOnInit(){this.loadData(),this.subscriptions.add(this.reservationService.restaurantReservations$.subscribe(t=>{this.allRestaurantReservations=t,this.filterReservations()})),this.subscriptions.add(this.shiftService.shifts$.subscribe(t=>{this.shifts=t,console.log("\u{1F504} Turni caricati:",t.length),this.cachedTimes.set(new Map)})),this.dateChangeSubscription=this.dateChangeSubject.pipe(N(300),q()).subscribe(()=>{this.updateAvailableTimes()}),this.subscriptions.add(this.tableService.data$.subscribe(t=>{this.tables=t,console.log("Tavoli caricati:",t.length)})),this.loadAvailableMenus()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.dateChangeSubscription?.unsubscribe()}loadData(){return M(this,null,function*(){this.loading=!0;try{yield this.reservationService.loadRestaurantReservations(),yield this.shiftService.loadShifts(),yield this.tableService.loadData(),yield this.loadTablesGroupedByFloorPlan()}catch(t){console.error("Error loading data:",t),this.error="Errore nel caricamento dei dati"}finally{this.loading=!1}})}onDateFilterToggle(){this.useDateFilter&&(this.useDateRangeFilter=!1),this.filterReservations()}onDateRangeFilterToggle(){this.useDateRangeFilter&&(this.useDateFilter=!1),this.filterReservations()}closeCreateModal(){this.showCreateModal=!1,this.isEditing=!1,this.editingReservationId=null}createReservation(){return M(this,null,function*(){if(this.isFormValid()){this.loading=!0;try{let t;this.isEditing&&this.editingReservationId?t=yield this.updateExistingReservation(this.editingReservationId,this.newReservation):t=yield this.reservationService.createRestaurantReservation(this.newReservation),t?(yield this.loadData(),this.closeCreateModal(),this.error=null,console.log("\u2705 Prenotazione salvata con successo")):this.error="Errore durante il salvataggio della prenotazione"}catch(t){console.error("Error saving reservation:",t),this.error=t.message||"Errore durante il salvataggio della prenotazione"}finally{this.loading=!1}}})}updateExistingReservation(t,e){return M(this,null,function*(){try{console.log("\u{1F50D} DEBUG menu_id:",{original:e.menu_id,type:typeof e.menu_id});let i={customer_name:e.customer_name,customer_surname:e.customer_surname,customer_phone:e.customer_phone,customer_email:e.customer_email,reservation_date:e.reservation_date,reservation_time:e.reservation_time,party_size:e.party_size,special_requests:e.special_requests,table_id:e.table_id,status:e.status};return e.customer_id&&(i.customer_id=e.customer_id),e.menu_id!==void 0&&(e.menu_id==="null"||e.menu_id===""?i.menu_id=null:i.menu_id=e.menu_id),console.log("\u{1F527} Dati di aggiornamento (con menu_id):",i),(yield this.reservationService.updateReservation(t,i))?yield this.reservationService.getReservationWithMenu(t):null}catch(i){throw console.error("Error updating reservation:",i),i}})}isFormValid(){return this.newReservation.customer_id?!!(this.newReservation.customer_id&&this.newReservation.reservation_date&&this.newReservation.reservation_time&&this.newReservation.party_size):!!(this.newReservation.customer_name&&this.newReservation.customer_surname&&this.newReservation.customer_phone&&this.newReservation.reservation_date&&this.newReservation.reservation_time&&this.newReservation.party_size)}assignTable(t,e){return M(this,null,function*(){if(e){this.loading=!0;try{(yield this.floorManagementService.assignTableToReservation(t,e))?(yield this.reservationService.loadRestaurantReservations(),console.log("\u2705 Tavolo assegnato e mappa aggiornata")):this.error="Errore nell'assegnazione del tavolo"}catch(i){console.error("Error assigning table:",i),this.error="Errore nell'assegnazione del tavolo"}finally{this.loading=!1}}})}unassignTable(t){return M(this,null,function*(){this.loading=!0;try{(yield this.floorManagementService.removeTableAssignment(t))?(yield this.reservationService.loadRestaurantReservations(),console.log("\u2705 Assegnazione rimossa e mappa aggiornata")):this.error="Errore nella rimozione del tavolo"}catch(e){console.error("Error unassigning table:",e),this.error="Errore nella rimozione del tavolo"}finally{this.loading=!1}})}updateStatus(t,e){return M(this,null,function*(){this.loading=!0;try{(yield this.reservationService.updateReservationStatus(t,e))||(this.error="Errore nell'aggiornamento dello stato")}catch(i){console.error("Error updating status:",i),this.error="Errore nell'aggiornamento dello stato"}finally{this.loading=!1}})}deleteReservation(t){return M(this,null,function*(){if(confirm("Sei sicuro di voler eliminare questa prenotazione?")){this.loading=!0;try{(yield this.reservationService.deleteReservation(t))||(this.error="Errore nell'eliminazione della prenotazione")}catch(e){console.error("Error deleting reservation:",e),this.error="Errore nell'eliminazione della prenotazione"}finally{this.loading=!1}}})}getSelectedTableCapacity(){if(!this.newReservation.table_id)return 0;for(let e of this.tableGroups){let i=e.tables.find(o=>o.id===this.newReservation.table_id);if(i)return i.capacity}let t=this.tables.find(e=>e.id===this.newReservation.table_id);return t?t.capacity:0}formatTime(t){return t.substring(0,5)}formatDate(t){if(!t)return"";let e=new Date(t),i=e.getDate().toString().padStart(2,"0"),o=(e.getMonth()+1).toString().padStart(2,"0"),c=e.getFullYear();return`${i}/${o}/${c}`}getCustomerName(t){return this.reservationService.getCustomerName(t)}getCustomerContact(t){return this.reservationService.getCustomerContact(t)}getTableName(t){return this.reservationService.getTableInfo(t)}getStatusColor(t){switch(t){case"confirmed":return"active";case"pending":return"";case"cancelled":return"";default:return""}}getStatusText(t){switch(t){case"confirmed":return"Confermata";case"pending":return"In attesa";case"cancelled":return"Cancellata";default:return t}}getAvailableTimes(){return["12:00","12:30","13:00","13:30","14:00","19:00","19:30","20:00","20:30","21:00","21:30"]}onDateChange(){this.filterReservations()}onStatusFilterChange(){this.filterReservations()}onViewModeChange(){this.filterReservations()}refreshData(){this.loadData()}loadTablesGroupedByFloorPlan(){return M(this,null,function*(){try{this.tableGroups=yield this.floorManagementService.getAllTablesGroupedByFloorPlan(),console.log("Table groups:",this.tableGroups),(!this.tableGroups||this.tableGroups.length===0)&&(yield this.groupTablesManually())}catch(t){console.error("Error loading tables grouped by floor plan:",t),yield this.groupTablesManually()}})}groupTablesManually(){return M(this,null,function*(){console.log("\u26A0\uFE0F Raggruppamento manuale dei tavoli...");let t={};this.tables.forEach(e=>{let i=e.floor_plan_id||"no-floor-plan";t[i]||(t[i]={floorPlan:{id:i,name:`Mappa ${i==="no-floor-plan"?"senza nome":i}`},tables:[]}),t[i].tables.push(e)}),this.tableGroups=Object.values(t),console.log("\u2705 Tavoli raggruppati manualmente:",this.tableGroups)})}getFilteredTables(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(i=>i.capacity>=t).sort((i,o)=>i.capacity===t&&o.capacity!==t?-1:i.capacity!==t&&o.capacity===t?1:i.capacity-o.capacity)}getFilteredTableGroups(t){return!this.tableGroups||this.tableGroups.length===0?[]:this.tableGroups.map(e=>{let i=e.tables.filter(o=>o.capacity>=t).sort((o,c)=>o.capacity===t&&c.capacity!==t?-1:o.capacity!==t&&c.capacity===t?1:o.capacity-c.capacity);return z(V({},e),{tables:i})}).filter(e=>e.tables.length>0)}getTablesByExactCapacity(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(e=>e.capacity===t)}getTablesByGreaterCapacity(t){if(!this.tables||this.tables.length===0)return[];let e=this.tables.filter(c=>c.capacity>=t).sort((c,v)=>c.capacity-v.capacity),i=this.getTablesByExactCapacity(t),o=new Set(i.map(c=>c.id));return e.filter(c=>!o.has(c.id))}getAllAvailableTables(t){return!this.tables||this.tables.length===0?[]:this.tables.filter(e=>e.capacity>=t).sort((e,i)=>e.capacity===t&&i.capacity!==t?-1:e.capacity!==t&&i.capacity===t?1:e.capacity-i.capacity)}getCustomerFullName(t){return t.users?`${t.users.first_name||""} ${t.users.last_name||""}`.trim():t.customer_name||t.customer_surname?`${t.customer_name||""} ${t.customer_surname||""}`.trim():"Cliente"}formatTimeForInput(t){return t?t.length>5?t.substring(0,5):t:"19:00"}getReservationShift(t){if(!this.shifts||this.shifts.length===0)return"N/D";let i=new Date(t.reservation_date).getDay(),o=i===0?7:i,c=t.reservation_time.substring(0,5),v=this.timeToSeconds(c);for(let y of this.shifts)if(y.is_active&&y.days_of_week.includes(o)){let I=this.timeToSeconds(y.start_time.substring(0,5)),R=this.timeToSeconds(y.end_time.substring(0,5));if(v>=I&&v<=R)return y.name}return this.getClosestShift(c,o)||"N/D"}timeToSeconds(t){let[e,i]=t.split(":").map(Number);return e*3600+i*60}getClosestShift(t,e){let i=null,o=1/0,c=this.timeToSeconds(t);for(let v of this.shifts){if(!v.is_active||!v.days_of_week.includes(e))continue;let y=this.timeToSeconds(v.start_time.substring(0,5)),I=this.timeToSeconds(v.end_time.substring(0,5)),R=Math.abs(c-y),k=Math.abs(c-I),P=Math.min(R,k);P<o&&(o=P,i=v)}return i&&o<=3600?`${i.name} (\u2248)`:null}get activeShifts(){return this.shifts.filter(t=>t.is_active)}getReservationShiftName(t){return this.getReservationShift(t)}filterReservations(){let t=this.allRestaurantReservations,e=new Date().toISOString().split("T")[0];switch(this.viewMode){case"today":t=this.reservationService.getActiveReservations(t);break;case"future":t=this.reservationService.getFutureReservations(t);break;case"all":break}this.useDateFilter&&this.selectedDate&&(t=t.filter(i=>i.reservation_date===this.selectedDate)),this.useDateRangeFilter&&this.startDate&&this.endDate&&(t=t.filter(i=>i.reservation_date>=this.startDate&&i.reservation_date<=this.endDate)),this.statusFilter!=="all"&&(t=t.filter(i=>i.status===this.statusFilter)),this.shiftFilter!=="all"&&(t=t.filter(i=>this.getReservationShiftName(i)===this.shiftFilter)),this.filteredReservations=t}resetFilters(){this.viewMode="future",this.selectedDate=null,this.startDate=null,this.endDate=null,this.statusFilter="all",this.shiftFilter="all",this.useDateFilter=!1,this.useDateRangeFilter=!1,this.filterReservations()}getActiveFiltersInfo(){let t=this.getActiveFiltersCount();return t===1?{count:t,text:"1 filtro attivo"}:t>1?{count:t,text:`${t} filtri attivi`}:{count:0,text:""}}getActiveFiltersCount(){let t=0;return this.viewMode!=="future"&&t++,this.useDateFilter&&this.selectedDate&&t++,this.useDateRangeFilter&&this.startDate&&this.endDate&&t++,this.statusFilter!=="all"&&t++,this.shiftFilter!=="all"&&t++,t}loadAvailableMenus(){return M(this,null,function*(){try{yield this.menuService.loadData(),this.availableMenus=(yield this.menuService.data$.pipe(G(1),B(t=>t.filter(e=>e.is_active))).toPromise())||[],console.log("\u{1F4CB} Menu disponibili per assegnazione:",this.availableMenus.length)}catch(t){console.error("\u274C Errore caricamento menu:",t),this.availableMenus=[]}})}createDedicatedMenuForReservation(t,e){return M(this,null,function*(){try{console.log(`\u2795 Creazione menu dedicato per prenotazione ${t}`);let i=yield this.menuService.createDedicatedMenu(`${e} - Prenotazione ${t.slice(0,8)}`);return i?(console.log(`\u2705 Menu dedicato creato: ${i.id}`),i.id):(console.error("\u274C Errore creazione menu dedicato"),null)}catch(i){return console.error("\u274C Errore creazione menu dedicato:",i),null}})}getSelectedMenuName(){if(!this.newReservation.menu_id)return"Nessuno";let t=this.availableMenus.find(e=>e.id===this.newReservation.menu_id);return t?t.name:"Menu non trovato"}getReservationMenuInfo(t){if(!t.menu_id)return"";if(t.menus)return t.menus.name;let e=this.availableMenus.find(i=>i.id===t.menu_id);return e?e.name:"(menu dedicato)"}get globalMenus(){return!this.availableMenus||this.availableMenus.length===0?[]:this.availableMenus.filter(t=>t.type==="global")}get dedicatedMenus(){return!this.availableMenus||this.availableMenus.length===0?[]:this.availableMenus.filter(t=>t.type==="dedicated")}hasGlobalMenus(){return this.globalMenus.length>0}hasDedicatedMenus(){return this.dedicatedMenus.length>0}createNewDedicatedMenu(){return M(this,null,function*(){if(!this.editingReservationId){alert("Devi essere in modalit\xE0 modifica per creare un menu dedicato");return}let t=prompt("Nome del nuovo menu dedicato:");if(!(!t||t.trim()===""))try{let e=yield this.menuService.createDedicatedMenu(`${t} - Prenotazione ${this.editingReservationId.slice(0,8)}`,`Menu dedicato per la prenotazione ${this.editingReservationId.slice(0,8)}`);e?(yield this.loadAvailableMenus(),this.newReservation.menu_id=e.id,alert(`\u2705 Menu dedicato "${e.name}" creato e assegnato!`)):alert("\u274C Errore nella creazione del menu dedicato")}catch(e){console.error("Errore creazione menu dedicato:",e),alert("\u274C Errore nella creazione del menu dedicato")}})}getSelectedMenuType(){return this.newReservation.menu_id&&this.availableMenus.find(e=>e.id===this.newReservation.menu_id)?.type||null}onReservationDateChange(){this.dateChangeSubject.next()}updateAvailableTimes(){return M(this,null,function*(){if(!this.newReservation.reservation_date)return;let t=this.newReservation.reservation_date;if(this.cachedTimes().get(t)){console.log("\u26A1 Orari dalla cache per",t);return}this.loadingTimes=!0;try{let i=this.calculateAvailableTimesForDate(this.newReservation.reservation_date),o=new Map(this.cachedTimes());o.set(t,i),this.cachedTimes.set(o),this.validateAndResetSelectedTime(i),console.log("\u2705 Orari calcolati per",t,":",i)}catch(i){console.error("\u274C Errore calcolo orari:",i)}finally{this.loadingTimes=!1}})}calculateAvailableTimesForDate(t){if(!t||!this.shifts?.length)return[];let i=new Date(t).getDay(),o=i===0?7:i,c=this.shifts.filter(v=>v.is_active&&v.days_of_week.includes(o));return c.length===0?[]:c.map(v=>{let y=this.generateTimeSlotsForShift(v);return{shift:v,times:y}})}generateTimeSlotsForShift(t){let e=[],i=t.start_time.substring(0,5),o=t.end_time.substring(0,5),c=this.timeToMinutes(i),v=this.timeToMinutes(o),y=v<c?v+1440:v,I=t.interval_minutes||30;for(let R=c;R<y;R+=I){let k=R%1440,P=this.minutesToTime(k);e.push({value:P,display:P,shiftId:t.id})}return e}getAvailableTimesByShift(){if(!this.newReservation.reservation_date)return[];let t=this.newReservation.reservation_date;return this.cachedTimes().get(t)||[]}validateAndResetSelectedTime(t){if(!this.newReservation.reservation_time)return;t.some(i=>i.times.some(o=>o.value===this.newReservation.reservation_time&&!o.disabled))||(this.newReservation.reservation_time="")}timeToMinutes(t){let[e,i]=t.split(":").map(Number);return e*60+i}minutesToTime(t){let e=Math.floor(t/60),i=t%60;return`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}getShiftLabel(t){let e=t.start_time.substring(0,5),i=t.end_time.substring(0,5);return`${t.name} (${e} - ${i})`}getAvailableTimesSummary(){let t=this.getAvailableTimesByShift();if(t.length===0)return"Nessun turno disponibile";if(t.length===1){let i=t[0].shift;return`Turno ${i.name}: ${i.start_time.substring(0,5)} - ${i.end_time.substring(0,5)}`}let e=t.map(i=>i.shift.name).join(", ");return`${t.length} turni disponibili: ${e}`}getTodayDate(){return new Date().toISOString().split("T")[0]}openCreateModal(){this.newReservation={restaurant_id:"",customer_name:"",customer_surname:"",customer_phone:"",customer_email:"",reservation_date:this.selectedDate||new Date().toISOString().split("T")[0],reservation_time:"",party_size:2,special_requests:"",table_id:void 0,status:"confirmed"},this.showCreateModal=!0,setTimeout(()=>{this.updateAvailableTimes()},100)}openEditModal(t){this.isEditing=!0,this.editingReservationId=t.id,this.newReservation={restaurant_id:t.restaurant_id||"",customer_name:t.customer_name||"",customer_surname:t.customer_surname||"",customer_phone:t.customer_phone||"",customer_email:t.customer_email||"",reservation_date:t.reservation_date,reservation_time:this.formatTimeForInput(t.reservation_time),party_size:t.party_size,special_requests:t.special_requests||"",table_id:t.table_id||void 0,status:t.status,customer_id:t.customer_id||void 0,menu_id:t.menu_id||void 0},this.showCreateModal=!0,setTimeout(()=>{this.updateAvailableTimes()},100)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=L({type:a,selectors:[["app-reservation-manager"]],decls:73,vars:16,consts:[["tableSelect",""],[1,"page-container"],[1,"section-header"],[1,"section-title"],[1,"header-icon"],[1,"material-icons"],[1,"text-muted"],[1,"form-card","mb-lg"],[1,"form-group"],[1,"standard-label"],[1,"p-sm",3,"ngModelChange","change","ngModel"],["value","today"],["value","future"],["value","all"],[1,"form-row"],[1,"flex","align-center","gap-sm"],["type","checkbox","id","dateFilter",3,"ngModelChange","change","ngModel"],["for","dateFilter",1,"standard-label"],["type","date",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["type","checkbox","id","dateRangeFilter",3,"ngModelChange","change","ngModel"],["for","dateRangeFilter",1,"standard-label"],[1,"flex","gap-sm","flex-wrap"],["type","date","placeholder","Da",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["type","date","placeholder","A",1,"p-sm",2,"max-width","fit-content",3,"ngModelChange","change","ngModel","disabled"],["value","confirmed"],["value","pending"],["value","cancelled"],[3,"value",4,"ngFor","ngForOf"],["value","N/D"],[1,"modal-footer",2,"width","100%"],["class","filter-badge",4,"ngIf"],[1,"flex","gap-sm"],["title","Resetta filtri",1,"icon-button",3,"click"],["title","Aggiorna",1,"icon-button",3,"click"],[1,"promethea-button",3,"click"],["class","info-message mb-lg",4,"ngIf"],["class","table-section",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[3,"value"],[1,"filter-badge"],[1,"info-message","mb-lg"],[1,"icon-button",3,"click"],[1,"table-section"],["class","crm-table custom-widths",4,"ngIf"],["class","empty-state p-lg",4,"ngIf"],[1,"crm-table","custom-widths"],[2,"text-align","center"],[1,"material-icons","text-md"],[4,"ngFor","ngForOf"],[1,"flex","gap-sm","justify-between","flex-wrap","items-center"],["class","text-mini text-muted",4,"ngIf"],[1,"chip","text-mini",2,"max-width","fit-content"],[1,"flex","gap-sm","flex-col","items-center","flex-wrap"],[1,"flex","gap-sm","items-center"],["class","material-icons",4,"ngIf"],["class","flex",4,"ngIf"],[1,"flex","justify-between","items-center","gap-sm"],["class","flex gap-sm",4,"ngIf"],["class","icon-button","title","Rimuovi tavolo",3,"click",4,"ngIf"],[1,"chip"],["class","icon-button","title","Conferma",3,"click",4,"ngIf"],["class","icon-button","title","Metti in attesa",3,"click",4,"ngIf"],["title","Modifica",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],[1,"text-mini","text-muted"],[1,"flex"],["style","max-width: fit-content;","class","text-mini x-small custom-select",3,"change",4,"ngIf"],[1,"text-mini","x-small","custom-select",2,"max-width","fit-content",3,"change"],["value",""],[4,"ngIf"],["disabled","",4,"ngIf"],[3,"label",4,"ngIf"],[3,"label"],[3,"value","title",4,"ngFor","ngForOf"],[3,"value","title"],["disabled",""],["title","Rimuovi tavolo",1,"icon-button",3,"click"],["title","Conferma",1,"icon-button",3,"click"],["title","Metti in attesa",1,"icon-button",3,"click"],[1,"empty-state","p-lg"],[1,"modal-overlay"],[1,"modal-container","modal-lg"],[1,"modal-header"],[1,"form-card"],[1,"form-row","mb-md"],["type","text","placeholder","Inserisci nome",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","text","placeholder","Inserisci cognome",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","tel","placeholder","Inserisci telefono",1,"p-sm",3,"ngModelChange","ngModel","required"],["type","email","placeholder","Inserisci email",1,"p-sm",3,"ngModelChange","ngModel"],["type","date","required","",1,"p-sm",3,"ngModelChange","change","ngModel","min"],["class","loading-indicator",4,"ngIf"],["class","alert warning",4,"ngIf"],["class","p-sm","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["class","text-muted mt-sm",4,"ngIf"],["required","",1,"p-sm",3,"ngModelChange","ngModel"],[1,"p-sm",3,"ngModelChange","ngModel"],[3,"ngValue"],["label","Menu globali (visibili a tutti)",4,"ngIf"],["label","Menu dedicati esistenti",4,"ngIf"],[1,"text-muted","mt-sm"],[1,"material-icons","text-mini"],["class","mt-sm p-sm bg-smoke rounded",4,"ngIf"],["class","mt-sm",4,"ngIf"],["label","Tavoli con capacit\xE0 esatta \u2B50",4,"ngIf"],["label","Tavoli con capacit\xE0 maggiore",4,"ngIf"],["class","text-muted",4,"ngIf"],["placeholder","Note o richieste speciali del cliente...","rows","3",1,"p-sm",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"promethea-button","ghost",3,"click"],[1,"promethea-button",3,"click","disabled"],[1,"loading-indicator"],[1,"material-icons","rotating"],[1,"alert","warning"],["required","",1,"p-sm",3,"ngModelChange","ngModel","disabled"],["value","","disabled","","selected",""],[3,"value","disabled","title",4,"ngFor","ngForOf"],[3,"value","disabled","title"],["label","Menu globali (visibili a tutti)"],[3,"ngValue",4,"ngFor","ngForOf"],["label","Menu dedicati esistenti"],[1,"mt-sm","p-sm","bg-smoke","rounded"],[1,"flex","items-center","gap-sm"],[1,"text-mini","font-semibold"],[1,"chip","bg-glass","ml-auto"],[1,"mt-sm"],["type","button",1,"promethea-button","ghost",3,"click"],["label","Tavoli con capacit\xE0 esatta \u2B50"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"],["label","Tavoli con capacit\xE0 maggiore"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"h1",3)(3,"span",4)(4,"span",5),s(5,"event_available"),r()(),s(6," Gestione Prenotazioni "),r(),n(7,"p",6),s(8,"Gestisci le prenotazioni del ristorante - Clienti registrati e nuovi clienti"),r()(),n(9,"div",7)(10,"div",8)(11,"label",9),s(12,"Visualizza"),r(),n(13,"select",10),x("ngModelChange",function(c){return b(i.viewMode,c)||(i.viewMode=c),c}),p("change",function(){return i.filterReservations()}),n(14,"option",11),s(15,"Oggi"),r(),n(16,"option",12),s(17,"Prenotazioni Future"),r(),n(18,"option",13),s(19,"Tutte le Prenotazioni"),r()()(),n(20,"div",14)(21,"div",8)(22,"div",15)(23,"input",16),x("ngModelChange",function(c){return b(i.useDateFilter,c)||(i.useDateFilter=c),c}),p("change",function(){return i.onDateFilterToggle()}),r(),n(24,"label",17),s(25,"Data specifica"),r()(),n(26,"input",18),x("ngModelChange",function(c){return b(i.selectedDate,c)||(i.selectedDate=c),c}),p("change",function(){return i.filterReservations()}),r()(),n(27,"div",8)(28,"div",15)(29,"input",19),x("ngModelChange",function(c){return b(i.useDateRangeFilter,c)||(i.useDateRangeFilter=c),c}),p("change",function(){return i.onDateRangeFilterToggle()}),r(),n(30,"label",20),s(31,"Intervallo date"),r()(),n(32,"div",21)(33,"input",22),x("ngModelChange",function(c){return b(i.startDate,c)||(i.startDate=c),c}),p("change",function(){return i.filterReservations()}),r(),n(34,"input",23),x("ngModelChange",function(c){return b(i.endDate,c)||(i.endDate=c),c}),p("change",function(){return i.filterReservations()}),r()()()(),n(35,"div",14)(36,"div",8)(37,"label",9),s(38,"Stato"),r(),n(39,"select",10),x("ngModelChange",function(c){return b(i.statusFilter,c)||(i.statusFilter=c),c}),p("change",function(){return i.filterReservations()}),n(40,"option",13),s(41,"Tutti"),r(),n(42,"option",24),s(43,"Confermate"),r(),n(44,"option",25),s(45,"In attesa"),r(),n(46,"option",26),s(47,"Cancellate"),r()()(),n(48,"div",8)(49,"label",9),s(50,"Turno"),r(),n(51,"select",10),x("ngModelChange",function(c){return b(i.shiftFilter,c)||(i.shiftFilter=c),c}),p("change",function(){return i.filterReservations()}),n(52,"option",13),s(53,"Tutti i turni"),r(),m(54,me,2,4,"option",27),n(55,"option",28),s(56,"Fuori orario"),r()()(),n(57,"div",29),m(58,ue,2,1,"span",30),n(59,"div",31)(60,"button",32),p("click",function(){return i.resetFilters()}),n(61,"span",5),s(62,"filter_alt_off"),r()(),n(63,"button",33),p("click",function(){return i.refreshData()}),n(64,"span",5),s(65,"refresh"),r()(),n(66,"button",34),p("click",function(){return i.openCreateModal()}),n(67,"span",5),s(68,"add"),r(),s(69," Nuova Prenotazione "),r()()()()(),m(70,ge,7,1,"div",35)(71,ke,3,2,"div",36)(72,lt,98,36,"div",37),r()),e&2&&(l(13),f("ngModel",i.viewMode),l(10),f("ngModel",i.useDateFilter),l(3),f("ngModel",i.selectedDate),d("disabled",!i.useDateFilter),l(3),f("ngModel",i.useDateRangeFilter),l(4),f("ngModel",i.startDate),d("disabled",!i.useDateRangeFilter),l(),f("ngModel",i.endDate),d("disabled",!i.useDateRangeFilter),l(5),f("ngModel",i.statusFilter),l(12),f("ngModel",i.shiftFilter),l(3),d("ngForOf",i.activeShifts),l(4),d("ngIf",i.getActiveFiltersInfo().count>0),l(12),d("ngIf",i.error),l(),d("ngIf",!i.loading),l(),d("ngIf",i.showCreateModal))},dependencies:[H,U,Y,ae,te,ie,Q,J,ee,X,ne,Z],styles:["select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]{font-weight:600;background-color:var(--smoke-1);padding:var(--gap-sm);border-bottom:1px solid var(--smoke-2)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-weight:400;padding-left:var(--gap-sm);background-color:var(--background)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:hover{background-color:var(--smoke-1)}select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{font-style:italic;background-color:var(--smoke-1)}select[_ngcontent-%COMP%]:focus   optgroup[_ngcontent-%COMP%]{background-color:var(--smoke-1)}.filter-badge[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-weight:500;padding:var(--gap-sm);background:var(--smoke-1);border-radius:12px}.custom-select[_ngcontent-%COMP%]{max-width:fit-content!important;min-width:150px;overflow:hidden;text-overflow:ellipsis}.custom-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.custom-select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]{max-width:200px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){width:8%;min-width:90px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){width:6%;min-width:70px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){width:25%;min-width:250px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){width:8%;min-width:80px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){width:6%;min-width:70px;text-align:center}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(6){width:15%;min-width:150px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(7), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(7){width:12%;min-width:120px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(8), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(8){width:10%;min-width:100px}.crm-table.custom-widths[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(9), .crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(9){width:10%;min-width:140px;text-align:center}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:var(--gap-sm) calc(var(--gap-sm) / 2)}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){padding:var(--gap-sm)}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3)   .flex-col[_ngcontent-%COMP%]{gap:4px}.crm-table.custom-widths[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3)   strong[_ngcontent-%COMP%]{white-space:normal;line-height:1.3;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}"]})};export{de as ReservationManager};
